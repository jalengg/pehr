2025-10-19 23:16:27,353 - INFO - ================================================================================
2025-10-19 23:16:27,353 - INFO - PromptEHR Synthetic Patient Generation
2025-10-19 23:16:27,353 - INFO - ================================================================================
2025-10-19 23:16:27,431 - INFO - Device: cpu
2025-10-19 23:16:27,431 - INFO - 
Loading vocabulary...
2025-10-19 23:16:27,431 - INFO - Loading MIMIC-III data files
2025-10-19 23:16:27,482 - INFO - Loaded 46520 patients
2025-10-19 23:16:27,602 - INFO - Loaded 58976 admissions
2025-10-19 23:16:27,734 - INFO - Loaded 651047 diagnosis records
2025-10-19 23:16:27,970 - INFO - Processing patient records
2025-10-19 23:16:29,828 - INFO - Loaded 3000 patient records
2025-10-19 23:16:29,828 - INFO - Diagnosis vocabulary size: 2823
2025-10-19 23:16:29,830 - INFO - Average visits per patient: 1.27
2025-10-19 23:16:29,831 - INFO - Average codes per visit: 9.27
2025-10-19 23:16:29,832 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-19 23:16:29,833 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-19 23:16:29,851 - INFO - Tokenizer vocab size: 2830
2025-10-19 23:16:29,855 - INFO - Using checkpoint: /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-19 23:16:29,855 - INFO - Loading model from /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-19 23:16:32,388 - INFO - Model loaded from epoch 28
2025-10-19 23:16:32,389 - INFO - Validation loss: 0.0005
2025-10-19 23:16:32,422 - INFO - 
================================================================================
2025-10-19 23:16:32,422 - INFO - Generating Synthetic Patients
2025-10-19 23:16:32,422 - INFO - ================================================================================
2025-10-19 23:16:32,422 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:32,422 - INFO - Patient 1:
2025-10-19 23:16:32,422 - INFO -   Demographics: 65.0yo WHITE M
2025-10-19 23:16:33,732 - INFO -   Generated Sequence:
2025-10-19 23:16:33,732 - INFO -     <BOS> <v> V071 5650 30000 86121 57471 7061 80605 80106 4264 86121 80605 9221 4264 1808 9221 <\v> <v> 86819 V4569 V170 3570 86819 3570 30393 3570 30393 9221 80605 3570 80605 86819 41092 <\v> <v> 20300 9221 85300 20152 30393 3570 80605 1348 7061 75739 34591 3010 1808 3570 30393
2025-10-19 23:16:33,732 - INFO -   Statistics:
2025-10-19 23:16:33,732 - INFO -     Visits: 3
2025-10-19 23:16:33,732 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:33,732 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:33,732 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:33,732 - INFO - Patient 2:
2025-10-19 23:16:33,732 - INFO -   Demographics: 45.0yo BLACK F
2025-10-19 23:16:34,890 - INFO -   Generated Sequence:
2025-10-19 23:16:34,890 - INFO -     <BOS> <v> 0880 47831 38300 80605 7061 77214 86121 86819 80605 3010 80605 3314 20300 77212 70400 <\v> <v> 80605 4841 86100 7061 86819 80607 2352 3010 9221 3570 80605 3570 86819 V625 V1251 <\v> <v> 4414 47833 V170 3010 30393 9221 V1251 86819 28983 3570 9221 3570 40492 3570 30393
2025-10-19 23:16:34,890 - INFO -   Statistics:
2025-10-19 23:16:34,890 - INFO -     Visits: 3
2025-10-19 23:16:34,890 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:34,891 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:34,891 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:34,891 - INFO - Patient 3:
2025-10-19 23:16:34,891 - INFO -   Demographics: 30.0yo HISPANIC M
2025-10-19 23:16:36,046 - INFO -   Generated Sequence:
2025-10-19 23:16:36,046 - INFO -     <BOS> <v> 96909 77083 47833 57471 86121 5168 80605 86819 80605 86819 V1251 20300 4264 9221 80607 <\v> <v> 86819 4841 37943 V170 30303 30393 3570 70400 5258 9221 80605 3570 4841 80605 86819 <\v> <v> 8731 57510 73022 80703 2897 30393 05479 86819 37943 3570 9221 80416 9221 80607 3570
2025-10-19 23:16:36,046 - INFO -   Statistics:
2025-10-19 23:16:36,046 - INFO -     Visits: 3
2025-10-19 23:16:36,046 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:36,046 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:36,046 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:36,046 - INFO - Patient 4:
2025-10-19 23:16:36,046 - INFO -   Demographics: 70.0yo WHITE F
2025-10-19 23:16:37,185 - INFO -   Generated Sequence:
2025-10-19 23:16:37,185 - INFO -     <BOS> <v> 3804 217 3570 37943 80106 7061 V625 30000 80605 47833 80605 3570 9221 9711 7061 <\v> <v> 2699 86819 37943 4841 V4569 38300 78052 V170 9221 5168 80605 82003 73710 2352 2699 <\v> <v> 80605 82003 9221 3570 05479 4847 V1251 25082 80605 56401 9221 3570 2352 1808 3570
2025-10-19 23:16:37,185 - INFO -   Statistics:
2025-10-19 23:16:37,185 - INFO -     Visits: 3
2025-10-19 23:16:37,185 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:37,185 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:37,185 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:37,185 - INFO - Patient 5:
2025-10-19 23:16:37,185 - INFO -   Demographics: 55.0yo ASIAN M
2025-10-19 23:16:38,284 - INFO -   Generated Sequence:
2025-10-19 23:16:38,284 - INFO -     <BOS> <v> 3804 86819 80607 86819 V170 7061 76526 2116 7061 80605 78052 3570 1725 80220 77214 <\v> <v> 80605 2699 2700 82003 990 80416 77214 4847 30393 3570 80605 V3401 4841 2352 3570 <\v> <v> 30393 1808 78051 9221 05479 30393 3570 25082 2116 82003 80607 3570 V1251 4847 30393
2025-10-19 23:16:38,284 - INFO -   Statistics:
2025-10-19 23:16:38,284 - INFO -     Visits: 3
2025-10-19 23:16:38,284 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:38,284 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:38,284 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:38,284 - INFO - Patient 6:
2025-10-19 23:16:38,284 - INFO -   Demographics: 80.0yo WHITE F
2025-10-19 23:16:39,437 - INFO -   Generated Sequence:
2025-10-19 23:16:39,437 - INFO -     <BOS> <v> 3804 77083 86819 37943 86121 5168 80605 86819 7061 4841 20300 86121 60886 9221 77214 <\v> <v> 80605 25082 V1251 80607 4841 1175 05479 9221 30393 3570 80605 3570 1348 2352 3570 <\v> <v> 3570 1808 38300 7061 86121 30393 80605 2699 86819 30393 75739 9221 80605 3570 80605
2025-10-19 23:16:39,437 - INFO -   Statistics:
2025-10-19 23:16:39,437 - INFO -     Visits: 3
2025-10-19 23:16:39,437 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:39,437 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:39,437 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:39,437 - INFO - Patient 7:
2025-10-19 23:16:39,437 - INFO -   Demographics: 25.0yo HISPANIC F
2025-10-19 23:16:40,779 - INFO -   Generated Sequence:
2025-10-19 23:16:40,779 - INFO -     <BOS> <v> 76526 4264 77214 86819 86121 80106 80605 47833 80605 86819 2699 80607 86121 80607 04184 <\v> <v> 25082 86819 37943 80605 05479 7061 80605 9221 7061 77214 3570 77214 80605 30393 3570 <\v> <v> 80703 30303 3570 47833 30393 1808 2699 V625 3010 57510 75739 9221 86819 9221 3570
2025-10-19 23:16:40,779 - INFO -   Statistics:
2025-10-19 23:16:40,779 - INFO -     Visits: 3
2025-10-19 23:16:40,779 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:40,779 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:40,779 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:40,779 - INFO - Patient 8:
2025-10-19 23:16:40,779 - INFO -   Demographics: 60.0yo BLACK M
2025-10-19 23:16:42,013 - INFO -   Generated Sequence:
2025-10-19 23:16:42,013 - INFO -     <BOS> <v> V071 7061 4294 37943 80605 86121 86819 V1021 4841 86819 86121 86819 4264 3570 77212 <\v> <v> 80605 2897 37943 80607 V4569 9221 86819 3570 30393 3570 2699 75567 V1251 7061 3570 <\v> <v> 28983 V170 9221 86819 80605 1808 80605 9583 V170 70400 82003 3570 30393 9221 1808
2025-10-19 23:16:42,013 - INFO -   Statistics:
2025-10-19 23:16:42,013 - INFO -     Visits: 3
2025-10-19 23:16:42,013 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:42,013 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:42,013 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:42,013 - INFO - Patient 9:
2025-10-19 23:16:42,013 - INFO -   Demographics: 50.0yo OTHER F
2025-10-19 23:16:43,197 - INFO -   Generated Sequence:
2025-10-19 23:16:43,198 - INFO -     <BOS> <v> 217 86819 78051 86819 80605 E9248 78001 86819 7061 2897 86819 78051 20300 4294 9221 <\v> <v> 80605 5224 86819 80416 80605 38300 2352 3010 V3401 3570 80605 4847 80605 45372 30393 <\v> <v> 7061 1808 80416 9221 3570 47833 V1251 1808 3010 3570 77214 7061 80605 44381 57510
2025-10-19 23:16:43,198 - INFO -   Statistics:
2025-10-19 23:16:43,198 - INFO -     Visits: 3
2025-10-19 23:16:43,198 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:43,198 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:43,198 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:43,198 - INFO - Patient 10:
2025-10-19 23:16:43,198 - INFO -   Demographics: 75.0yo WHITE M
2025-10-19 23:16:44,271 - INFO -   Generated Sequence:
2025-10-19 23:16:44,271 - INFO -     <BOS> <v> 3804 V071 37943 99604 80106 80605 86819 47833 86819 80605 2699 7061 E9248 77214 V3401 <\v> <v> 80605 86819 80607 3570 V4569 9221 1348 38300 7061 1808 64822 78051 V4569 25082 V1251 <\v> <v> 8731 70400 1808 80416 86819 80607 V1251 3570 30393 82003 8731 9221 V625 44381 3570
2025-10-19 23:16:44,271 - INFO -   Statistics:
2025-10-19 23:16:44,271 - INFO -     Visits: 3
2025-10-19 23:16:44,271 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:44,271 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:44,271 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:44,271 - INFO - Patient 11:
2025-10-19 23:16:44,271 - INFO -   Demographics: 40.0yo WHITE F
2025-10-19 23:16:45,286 - INFO -   Generated Sequence:
2025-10-19 23:16:45,286 - INFO -     <BOS> <v> 3804 V4973 55092 37943 57471 3010 86819 80607 7061 75529 V1251 30393 73022 04184 55092 <\v> <v> 4841 80605 47833 20300 86819 9221 80605 77214 5168 3570 80605 3570 4841 7842 86819 <\v> <v> 30393 3010 3570 86819 80605 04184 80605 70400 1808 4847 9221 9711 3570 5168 3570
2025-10-19 23:16:45,286 - INFO -   Statistics:
2025-10-19 23:16:45,286 - INFO -     Visits: 3
2025-10-19 23:16:45,286 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:45,286 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:45,286 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:45,286 - INFO - Patient 12:
2025-10-19 23:16:45,286 - INFO -   Demographics: 85.0yo WHITE M
2025-10-19 23:16:46,488 - INFO -   Generated Sequence:
2025-10-19 23:16:46,488 - INFO -     <BOS> <v> 217 63320 3570 86819 86121 V4981 86121 90254 7061 1175 V1251 70400 4264 30000 4414 <\v> <v> 86819 7061 86121 9221 8820 80607 80703 47833 05479 80416 57510 82003 V4569 78052 57510 <\v> <v> 20300 05479 30393 80605 30303 4847 80605 3570 1808 30393 3570 9221 V1251 80607 70400
2025-10-19 23:16:46,488 - INFO -   Statistics:
2025-10-19 23:16:46,488 - INFO -     Visits: 3
2025-10-19 23:16:46,488 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:46,488 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:46,488 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:46,488 - INFO - Patient 13:
2025-10-19 23:16:46,488 - INFO -   Demographics: 35.0yo BLACK M
2025-10-19 23:16:47,699 - INFO -   Generated Sequence:
2025-10-19 23:16:47,699 - INFO -     <BOS> <v> V071 3804 80607 37943 2116 V4981 80605 47833 86819 7061 29630 30393 1175 04184 20300 <\v> <v> 2352 80605 E9502 86819 990 5168 44381 9221 1808 3570 4413 V170 45372 86819 80605 <\v> <v> 40492 47833 9221 80416 80605 4847 1348 86819 80605 3010 3570 30393 80605 80625 2352
2025-10-19 23:16:47,699 - INFO -   Statistics:
2025-10-19 23:16:47,699 - INFO -     Visits: 3
2025-10-19 23:16:47,699 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:47,699 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:47,699 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:47,699 - INFO - Patient 14:
2025-10-19 23:16:47,699 - INFO -   Demographics: 72.0yo ASIAN F
2025-10-19 23:16:48,708 - INFO -   Generated Sequence:
2025-10-19 23:16:48,708 - INFO -     <BOS> <v> 1725 3210 47833 80605 7061 80106 80605 57471 2699 86819 30303 3570 4264 44381 9221 <\v> <v> 80605 2699 2890 80607 80605 3570 75529 4414 8731 3570 80605 5168 7078 25082 V1251 <\v> <v> 2352 3570 2352 3570 30393 4847 80605 1808 57471 9221 55092 75567 99529 38300 0415
2025-10-19 23:16:48,708 - INFO -   Statistics:
2025-10-19 23:16:48,708 - INFO -     Visits: 3
2025-10-19 23:16:48,708 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:48,708 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:48,708 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:48,708 - INFO - Patient 15:
2025-10-19 23:16:48,708 - INFO -   Demographics: 28.0yo HISPANIC F
2025-10-19 23:16:49,808 - INFO -   Generated Sequence:
2025-10-19 23:16:49,808 - INFO -     <BOS> <v> 99939 V1085 3570 3010 37943 V4981 80605 V1021 80605 86819 V1251 3570 60886 3570 77214 <\v> <v> 30393 V4569 80605 70400 56738 1808 86819 30000 44381 1808 7061 5168 42843 80605 85300 <\v> <v> 3010 8731 9221 86819 V1251 4847 V1251 80605 57471 80607 04184 75567 80416 5168 80416
2025-10-19 23:16:49,808 - INFO -   Statistics:
2025-10-19 23:16:49,808 - INFO -     Visits: 3
2025-10-19 23:16:49,808 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:49,808 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:49,808 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:49,808 - INFO - Patient 16:
2025-10-19 23:16:49,808 - INFO -   Demographics: 58.0yo WHITE M
2025-10-19 23:16:50,881 - INFO -   Generated Sequence:
2025-10-19 23:16:50,881 - INFO -     <BOS> <v> 34591 7754 47833 57471 86121 55092 V1279 47833 3210 2699 86819 7061 86121 80605 80607 <\v> <v> 86819 73741 2116 47833 4841 1808 5991 5168 75529 3570 80607 4414 80605 7955 86819 <\v> <v> 04184 30000 1808 80416 7132 3570 05479 57510 70400 1808 80416 1808 2699 3570 30393
2025-10-19 23:16:50,881 - INFO -   Statistics:
2025-10-19 23:16:50,881 - INFO -     Visits: 3
2025-10-19 23:16:50,881 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:50,881 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:50,881 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:50,881 - INFO - Patient 17:
2025-10-19 23:16:50,881 - INFO -   Demographics: 48.0yo BLACK F
2025-10-19 23:16:52,027 - INFO -   Generated Sequence:
2025-10-19 23:16:52,027 - INFO -     <BOS> <v> 99644 8712 4847 37943 7754 5168 80605 86819 25082 86819 80605 3570 E9010 3570 9221 <\v> <v> 2897 86819 80605 V170 4841 7061 80605 3570 30393 3010 3570 77214 2699 4841 2699 <\v> <v> 2352 1808 80416 70400 30393 44381 30303 2699 V1021 3708 80607 3570 45372 37943 V170
2025-10-19 23:16:52,027 - INFO -   Statistics:
2025-10-19 23:16:52,027 - INFO -     Visits: 3
2025-10-19 23:16:52,027 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:52,027 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:52,027 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:52,027 - INFO - Patient 18:
2025-10-19 23:16:52,027 - INFO -   Demographics: 90.0yo WHITE F
2025-10-19 23:16:53,159 - INFO -   Generated Sequence:
2025-10-19 23:16:53,159 - INFO -     <BOS> <v> V1085 E9248 77214 57471 80605 7061 80605 86819 4264 86819 2699 70400 80416 44381 3570 <\v> <v> 5991 05479 47833 3570 4841 9221 80605 9221 77214 30000 64244 4847 80605 45372 3570 <\v> <v> 5192 82003 3570 30303 3570 9221 4841 41092 57510 9221 30393 5168 53012 7061 9221
2025-10-19 23:16:53,159 - INFO -   Statistics:
2025-10-19 23:16:53,159 - INFO -     Visits: 3
2025-10-19 23:16:53,159 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:53,159 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:53,159 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:53,159 - INFO - Patient 19:
2025-10-19 23:16:53,159 - INFO -   Demographics: 62.0yo OTHER M
2025-10-19 23:16:54,279 - INFO -   Generated Sequence:
2025-10-19 23:16:54,279 - INFO -     <BOS> <v> 99604 3804 04184 37943 86121 8601 V625 37943 80605 86819 20300 7061 86121 77214 80416 <\v> <v> 80605 4841 37943 80605 4841 04184 9221 75567 3010 64822 30393 82003 80605 4841 2699 <\v> <v> 7132 1808 3570 2352 28983 3010 V1251 37943 80605 9711 9221 30393 8760 9221 30393
2025-10-19 23:16:54,279 - INFO -   Statistics:
2025-10-19 23:16:54,279 - INFO -     Visits: 3
2025-10-19 23:16:54,279 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:54,279 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:54,279 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 23:16:54,279 - INFO - Patient 20:
2025-10-19 23:16:54,279 - INFO -   Demographics: 42.0yo ASIAN F
2025-10-19 23:16:55,305 - INFO -   Generated Sequence:
2025-10-19 23:16:55,305 - INFO -     <BOS> <v> 53641 86819 9221 86819 47833 80607 2352 86819 2699 3010 25082 80605 20300 80607 9221 <\v> <v> 4841 2699 86819 3570 V1251 80416 8731 5168 E9248 77214 80605 9221 4841 45372 86819 <\v> <v> 28983 80607 30393 9221 28983 47833 80605 07070 04184 3570 9221 1808 V1251 30000 9221
2025-10-19 23:16:55,305 - INFO -   Statistics:
2025-10-19 23:16:55,305 - INFO -     Visits: 3
2025-10-19 23:16:55,305 - INFO -     Diagnosis Codes: 48
2025-10-19 23:16:55,305 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 23:16:55,305 - INFO - 
================================================================================
2025-10-19 23:16:55,305 - INFO - Generation Complete!
2025-10-19 23:16:55,305 - INFO - ================================================================================
