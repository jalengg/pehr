2025-10-17 10:52:16,363 - INFO - ================================================================================
2025-10-17 10:52:16,363 - INFO - PromptEHR Synthetic Patient Generation
2025-10-17 10:52:16,363 - INFO - ================================================================================
2025-10-17 10:52:16,451 - INFO - Device: cpu
2025-10-17 10:52:16,451 - INFO - 
Loading vocabulary...
2025-10-17 10:52:16,451 - INFO - Loading MIMIC-III data files
2025-10-17 10:52:16,520 - INFO - Loaded 46520 patients
2025-10-17 10:52:17,235 - INFO - Loaded 58976 admissions
2025-10-17 10:52:19,042 - INFO - Loaded 651047 diagnosis records
2025-10-17 10:52:19,455 - INFO - Processing patient records
2025-10-17 10:52:21,161 - INFO - Loaded 3000 patient records
2025-10-17 10:52:21,162 - INFO - Diagnosis vocabulary size: 2823
2025-10-17 10:52:21,163 - INFO - Average visits per patient: 1.27
2025-10-17 10:52:21,163 - INFO - Average codes per visit: 9.27
2025-10-17 10:52:21,164 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-17 10:52:21,164 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-17 10:52:21,180 - INFO - Tokenizer vocab size: 2830
2025-10-17 10:52:21,181 - INFO - Using checkpoint: /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-17 10:52:21,181 - INFO - Loading model from /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-17 10:52:25,570 - INFO - Model loaded from epoch 30
2025-10-17 10:52:25,571 - INFO - Validation loss: 0.0001
2025-10-17 10:52:25,651 - INFO - 
================================================================================
2025-10-17 10:52:25,651 - INFO - Generating Synthetic Patients
2025-10-17 10:52:25,651 - INFO - ================================================================================
2025-10-17 10:52:25,651 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:52:25,651 - INFO - Patient 1:
2025-10-17 10:52:25,651 - INFO -   Demographics: 65.0yo WHITE M
2025-10-17 10:52:47,342 - INFO -   Generated Sequence:
2025-10-17 10:52:47,343 - INFO -     <BOS> <v> 4295 82521 7098 42971 3010 5968 82521 7718 E8493 73022 9053 E8120 <END>
2025-10-17 10:52:47,343 - INFO -   Statistics:
2025-10-17 10:52:47,343 - INFO -     Visits: 1
2025-10-17 10:52:47,343 - INFO -     Diagnosis Codes: 14
2025-10-17 10:52:47,343 - INFO -     Avg Codes per Visit: 14.0
2025-10-17 10:52:47,343 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:52:47,343 - INFO - Patient 2:
2025-10-17 10:52:47,343 - INFO -   Demographics: 45.0yo BLACK F
2025-10-17 10:53:02,162 - INFO -   Generated Sequence:
2025-10-17 10:53:02,162 - INFO -     <BOS> <v> 7795 8600 8072 7313 43882 99791 53641 99939 42091 25082 1174 78839 87320 73022 V8381 <\v> <v> 9053 75567 99939 V0251 6089 76522 V0381 5198 9053 7098 V4573 73022 7140 <END>
2025-10-17 10:53:02,162 - INFO -   Statistics:
2025-10-17 10:53:02,162 - INFO -     Visits: 2
2025-10-17 10:53:02,162 - INFO -     Diagnosis Codes: 31
2025-10-17 10:53:02,162 - INFO -     Avg Codes per Visit: 15.5
2025-10-17 10:53:02,162 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:02,162 - INFO - Patient 3:
2025-10-17 10:53:02,162 - INFO -   Demographics: 30.0yo HISPANIC M
2025-10-17 10:53:05,029 - INFO -   Generated Sequence:
2025-10-17 10:53:05,030 - INFO -     <BOS> <v> 92400 5968 78839 76407 87349 42971 7718 5258 7313 76496 V4569 7313 0839 9701 5224 <\v> <v> 5258 99939 76496 3010 37943 V3201 3010 73022 80221 8731 76522 73022 5695 72888 3090 <\v> <v> 3010 25071 73022 25071 9053 37943 99831 83905 42091 4295 28319 80625 5641 7778 5641
2025-10-17 10:53:05,030 - INFO -   Statistics:
2025-10-17 10:53:05,030 - INFO -     Visits: 3
2025-10-17 10:53:05,030 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:05,030 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:05,030 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:05,030 - INFO - Patient 4:
2025-10-17 10:53:05,030 - INFO -   Demographics: 70.0yo WHITE F
2025-10-17 10:53:06,631 - INFO -   Generated Sequence:
2025-10-17 10:53:06,631 - INFO -     <BOS> <v> 7098 9053 5370 99939 6089 E8493 3688 42091 5968 E8538 4267 5224 30560 5370 E8493 <\v> <v> 83905 5080 99791 9950 92400 76525 42091 7098 46451 07020 7718 7098 76496 E8493 34680 <\v> <v> 99791 25071 4295 80426 E8493 46410 7061 85142 3010 25071 81341 87320 6089 E8493 99831
2025-10-17 10:53:06,631 - INFO -   Statistics:
2025-10-17 10:53:06,632 - INFO -     Visits: 3
2025-10-17 10:53:06,632 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:06,632 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:06,632 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:06,632 - INFO - Patient 5:
2025-10-17 10:53:06,632 - INFO -   Demographics: 55.0yo ASIAN M
2025-10-17 10:53:09,099 - INFO -   Generated Sequence:
2025-10-17 10:53:09,100 - INFO -     <BOS> <v> 45189 99939 V8541 99939 76496 5080 7718 76526 7718 4254 3310 76496 4254 73022 5650 <\v> <v> 53641 77083 5968 4847 V4573 25071 87320 V0381 7098 80229 9092 4295 46451 25071 V0381 <\v> <v> 7313 30928 87320 5192 5258 2733 5370 V0381 5081 29633 80605 87349 7098 2518 99831
2025-10-17 10:53:09,100 - INFO -   Statistics:
2025-10-17 10:53:09,100 - INFO -     Visits: 3
2025-10-17 10:53:09,100 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:09,100 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:09,100 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:09,100 - INFO - Patient 6:
2025-10-17 10:53:09,100 - INFO -   Demographics: 80.0yo WHITE F
2025-10-17 10:53:10,690 - INFO -   Generated Sequence:
2025-10-17 10:53:10,690 - INFO -     <BOS> <v> 56211 5224 80700 2858 8731 99791 V8801 5651 36210 5224 92810 76525 76077 V0381 E8493 <\v> <v> E8493 9053 5224 5370 V4573 7098 E8538 5370 5695 7061 46451 76496 5370 71107 30928 <\v> <v> 75567 25071 30928 V4579 78839 7313 5071 83905 3010 4295 2734 80229 5224 5060 075
2025-10-17 10:53:10,690 - INFO -   Statistics:
2025-10-17 10:53:10,690 - INFO -     Visits: 3
2025-10-17 10:53:10,690 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:10,690 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:10,690 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:10,690 - INFO - Patient 7:
2025-10-17 10:53:10,691 - INFO -   Demographics: 25.0yo HISPANIC F
2025-10-17 10:53:12,490 - INFO -   Generated Sequence:
2025-10-17 10:53:12,491 - INFO -     <BOS> <v> 3556 3010 99831 3010 7098 9211 7718 56941 1419 7098 80221 E8528 30560 44329 83905 <\v> <v> 76496 7534 9754 76525 73022 87320 73022 3558 30560 3010 6144 80505 80625 37943 83905 <\v> <v> 75567 7458 92400 36210 1419 6089 76407 34680 85142 7098 80625 73022 6089 47832 73022
2025-10-17 10:53:12,491 - INFO -   Statistics:
2025-10-17 10:53:12,491 - INFO -     Visits: 3
2025-10-17 10:53:12,491 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:12,491 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:12,491 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:12,491 - INFO - Patient 8:
2025-10-17 10:53:12,491 - INFO -   Demographics: 60.0yo BLACK M
2025-10-17 10:53:12,865 - INFO -   Generated Sequence:
2025-10-17 10:53:12,865 - INFO -     <BOS> <v> 5198 E8493 25071 87320 76525 9053 87363 7718 42091 4295 37943 <END>
2025-10-17 10:53:12,866 - INFO -   Statistics:
2025-10-17 10:53:12,866 - INFO -     Visits: 1
2025-10-17 10:53:12,866 - INFO -     Diagnosis Codes: 13
2025-10-17 10:53:12,866 - INFO -     Avg Codes per Visit: 13.0
2025-10-17 10:53:12,866 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:12,866 - INFO - Patient 9:
2025-10-17 10:53:12,866 - INFO -   Demographics: 50.0yo OTHER F
2025-10-17 10:53:14,374 - INFO -   Generated Sequence:
2025-10-17 10:53:14,374 - INFO -     <BOS> <v> 45189 9053 5570 5109 46410 92810 7313 9663 E8493 76496 V4569 87320 E8120 2989 99939 <\v> <v> 76526 99939 76496 E8120 2939 3090 34680 3574 5370 7098 4295 76496 99831 59589 5641 <\v> <v> 1642 3090 25082 83905 36210 5060 56211 3010 4295 76496 7098 5081 6089 2518 46410
2025-10-17 10:53:14,374 - INFO -   Statistics:
2025-10-17 10:53:14,374 - INFO -     Visits: 3
2025-10-17 10:53:14,374 - INFO -     Diagnosis Codes: 48
2025-10-17 10:53:14,374 - INFO -     Avg Codes per Visit: 16.0
2025-10-17 10:53:14,374 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-17 10:53:14,375 - INFO - Patient 10:
2025-10-17 10:53:14,375 - INFO -   Demographics: 75.0yo WHITE M
2025-10-17 10:53:14,722 - INFO -   Generated Sequence:
2025-10-17 10:53:14,722 - INFO -     <BOS> <v> 23879 99791 9950 5224 7718 82032 E8493 99939 2553 7718 36210 75567 <END>
2025-10-17 10:53:14,723 - INFO -   Statistics:
2025-10-17 10:53:14,723 - INFO -     Visits: 1
2025-10-17 10:53:14,723 - INFO -     Diagnosis Codes: 14
2025-10-17 10:53:14,723 - INFO -     Avg Codes per Visit: 14.0
2025-10-17 10:53:14,723 - INFO - 
================================================================================
2025-10-17 10:53:14,723 - INFO - Generation Complete!
2025-10-17 10:53:14,723 - INFO - ================================================================================
