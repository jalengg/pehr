2025-10-19 22:50:00,373 - INFO - ================================================================================
2025-10-19 22:50:00,373 - INFO - PromptEHR Synthetic Patient Generation
2025-10-19 22:50:00,373 - INFO - ================================================================================
2025-10-19 22:50:00,455 - INFO - Device: cpu
2025-10-19 22:50:00,456 - INFO - 
Loading vocabulary...
2025-10-19 22:50:00,456 - INFO - Loading MIMIC-III data files
2025-10-19 22:50:00,511 - INFO - Loaded 46520 patients
2025-10-19 22:50:00,641 - INFO - Loaded 58976 admissions
2025-10-19 22:50:00,876 - INFO - Loaded 651047 diagnosis records
2025-10-19 22:50:01,228 - INFO - Processing patient records
2025-10-19 22:50:02,881 - INFO - Loaded 3000 patient records
2025-10-19 22:50:02,881 - INFO - Diagnosis vocabulary size: 2823
2025-10-19 22:50:02,882 - INFO - Average visits per patient: 1.27
2025-10-19 22:50:02,882 - INFO - Average codes per visit: 9.27
2025-10-19 22:50:02,883 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-19 22:50:02,883 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-19 22:50:02,899 - INFO - Tokenizer vocab size: 2830
2025-10-19 22:50:02,900 - INFO - Using checkpoint: /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-19 22:50:02,900 - INFO - Loading model from /scratch/jalenj4/promptehr_checkpoints/best_model.pt
2025-10-19 22:50:07,039 - INFO - Model loaded from epoch 28
2025-10-19 22:50:07,039 - INFO - Validation loss: 0.0005
2025-10-19 22:50:07,105 - INFO - 
================================================================================
2025-10-19 22:50:07,106 - INFO - Generating Synthetic Patients
2025-10-19 22:50:07,106 - INFO - ================================================================================
2025-10-19 22:50:07,106 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:07,106 - INFO - Patient 1:
2025-10-19 22:50:07,107 - INFO -   Demographics: 65.0yo WHITE M
2025-10-19 22:50:08,991 - INFO -   Generated Sequence:
2025-10-19 22:50:08,991 - INFO -     <BOS> <v> 76522 4264 8731 86819 7061 2165 V1279 86121 20300 86121 4841 78051 4264 04184 77214 <\v> <v> 80605 4841 90254 80416 4841 9221 4841 4847 7132 80605 3570 80607 V1251 2897 4841 <\v> <v> 80416 1808 3570 3010 86819 4847 80605 37943 3010 82003 9221 3570 80605 70400 3570
2025-10-19 22:50:08,992 - INFO -   Statistics:
2025-10-19 22:50:08,993 - INFO -     Visits: 3
2025-10-19 22:50:08,994 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:08,994 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:08,995 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:08,996 - INFO - Patient 2:
2025-10-19 22:50:08,997 - INFO -   Demographics: 45.0yo BLACK F
2025-10-19 22:50:11,120 - INFO -   Generated Sequence:
2025-10-19 22:50:11,120 - INFO -     <BOS> <v> 77084 V0482 77214 86819 86121 57471 86121 7061 25082 80605 2699 86819 7061 04184 3570 <\v> <v> 80605 4841 37943 V1251 80605 9221 2352 30000 1808 30393 80605 30000 V1251 4841 2699 <\v> <v> 80607 V170 9221 1808 7061 4847 80605 78052 3570 07070 04184 80220 V1251 04184 80416
2025-10-19 22:50:11,121 - INFO -   Statistics:
2025-10-19 22:50:11,122 - INFO -     Visits: 3
2025-10-19 22:50:11,122 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:11,122 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:11,122 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:11,122 - INFO - Patient 3:
2025-10-19 22:50:11,122 - INFO -   Demographics: 30.0yo HISPANIC M
2025-10-19 22:50:37,019 - INFO -   Generated Sequence:
2025-10-19 22:50:37,020 - INFO -     <BOS> <v> 1725 3210 78051 7061 86121 5168 4841 47833 86121 80605 3570 86819 4264 82003 70400 <\v> <v> 80605 86819 90254 7061 80605 99529 9221 75567 1808 57510 1348 38300 4841 V4569 86819 <\v> <v> 20300 3570 30393 80605 3570 47833 80605 86819 80605 3570 5168 9221 3570 78051 57510
2025-10-19 22:50:37,021 - INFO -   Statistics:
2025-10-19 22:50:37,022 - INFO -     Visits: 3
2025-10-19 22:50:37,022 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:37,023 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:37,024 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:37,025 - INFO - Patient 4:
2025-10-19 22:50:37,026 - INFO -   Demographics: 70.0yo WHITE F
2025-10-19 22:50:38,031 - INFO -   Generated Sequence:
2025-10-19 22:50:38,031 - INFO -     <BOS> <v> 3804 63320 9221 2116 80106 57471 86819 80106 80605 86819 2699 78051 4264 3570 9221 <\v> <v> 7061 41092 80605 1808 4841 9221 05479 9221 7061 57510 V1251 5168 2699 V1251 42843 <\v> <v> 5168 V170 9711 9221 86819 3570 2352 3570 V625 9221 3570 9221 V1251 4847 56401
2025-10-19 22:50:38,032 - INFO -   Statistics:
2025-10-19 22:50:38,033 - INFO -     Visits: 3
2025-10-19 22:50:38,034 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:38,035 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:38,035 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:38,036 - INFO - Patient 5:
2025-10-19 22:50:38,037 - INFO -   Demographics: 55.0yo ASIAN M
2025-10-19 22:50:39,028 - INFO -   Generated Sequence:
2025-10-19 22:50:39,028 - INFO -     <BOS> <v> 3804 3210 3570 27549 7061 V4981 80605 86819 4264 75529 3570 80607 76522 77214 9221 <\v> <v> 4841 80605 30000 V1251 4841 80607 3570 3010 7061 V170 3570 5168 V4569 V1251 75529 <\v> <v> 8731 1808 3570 3010 75529 1808 80605 2699 86819 80607 4414 8731 75529 4847 70400
2025-10-19 22:50:39,029 - INFO -   Statistics:
2025-10-19 22:50:39,030 - INFO -     Visits: 3
2025-10-19 22:50:39,031 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:39,031 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:39,032 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:39,033 - INFO - Patient 6:
2025-10-19 22:50:39,034 - INFO -   Demographics: 80.0yo WHITE F
2025-10-19 22:50:40,156 - INFO -   Generated Sequence:
2025-10-19 22:50:40,156 - INFO -     <BOS> <v> 3804 V071 80607 37943 86819 7061 80605 30000 76526 30303 80605 7061 5650 3570 1808 <\v> <v> 80605 86819 80106 77214 85300 9583 V4569 80607 3570 30000 80416 4847 2699 V4569 7061 <\v> <v> 80607 9221 V170 4847 80605 4847 V1251 2699 80605 3570 55092 78051 30303 4847 3570
2025-10-19 22:50:40,157 - INFO -   Statistics:
2025-10-19 22:50:40,158 - INFO -     Visits: 3
2025-10-19 22:50:40,159 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:40,160 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:40,161 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:40,161 - INFO - Patient 7:
2025-10-19 22:50:40,162 - INFO -   Demographics: 25.0yo HISPANIC F
2025-10-19 22:50:41,197 - INFO -   Generated Sequence:
2025-10-19 22:50:41,198 - INFO -     <BOS> <v> 3804 77083 9221 86819 30303 57471 80605 V1021 86819 3010 80605 30000 7061 04184 77214 <\v> <v> 7078 2699 37943 3570 05479 9221 80605 04184 7061 3010 3570 80625 25082 45372 86819 <\v> <v> 80703 7061 9221 80416 57471 3570 80605 3570 80605 3570 80416 78051 4841 V3401 3010
2025-10-19 22:50:41,199 - INFO -   Statistics:
2025-10-19 22:50:41,200 - INFO -     Visits: 3
2025-10-19 22:50:41,200 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:41,201 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:41,202 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:41,203 - INFO - Patient 8:
2025-10-19 22:50:41,204 - INFO -   Demographics: 60.0yo BLACK M
2025-10-19 22:50:42,237 - INFO -   Generated Sequence:
2025-10-19 22:50:42,238 - INFO -     <BOS> <v> 5650 4264 78051 37943 86121 7061 76522 86121 80605 86819 V1251 V170 9221 3570 9221 <\v> <v> 86819 4841 99604 80416 4841 7061 86819 4847 77214 3010 80605 30000 72888 80605 3570 <\v> <v> 7061 9221 30000 V170 7061 4847 3570 2352 80605 3570 1808 3570 5991 77214 37943
2025-10-19 22:50:42,239 - INFO -   Statistics:
2025-10-19 22:50:42,239 - INFO -     Visits: 3
2025-10-19 22:50:42,240 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:42,241 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:42,242 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:42,242 - INFO - Patient 9:
2025-10-19 22:50:42,243 - INFO -   Demographics: 50.0yo OTHER F
2025-10-19 22:50:43,275 - INFO -   Generated Sequence:
2025-10-19 22:50:43,275 - INFO -     <BOS> <v> 99604 990 80607 37943 99604 73022 80605 86819 7061 80605 3010 80607 60886 70400 9221 <\v> <v> 80605 2897 37943 3570 80605 04184 86819 9221 7061 55092 80605 3570 80605 45372 25082 <\v> <v> 80605 8731 1808 80416 1808 2812 80605 30303 2116 80607 70400 34591 V1251 82003 80416
2025-10-19 22:50:43,276 - INFO -   Statistics:
2025-10-19 22:50:43,277 - INFO -     Visits: 3
2025-10-19 22:50:43,278 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:43,278 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:43,279 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-19 22:50:43,280 - INFO - Patient 10:
2025-10-19 22:50:43,281 - INFO -   Demographics: 75.0yo WHITE M
2025-10-19 22:50:44,525 - INFO -   Generated Sequence:
2025-10-19 22:50:44,525 - INFO -     <BOS> <v> 76522 5650 9221 86819 56941 7061 3210 37943 3210 86819 05479 9221 73022 37943 55092 <\v> <v> 80605 86819 3010 80607 20300 2352 3570 70400 77214 9221 3570 4414 V4569 80605 2699 <\v> <v> 8731 82003 9221 75529 80605 82003 80605 86819 3010 47833 70400 9221 2352 04184 1808
2025-10-19 22:50:44,526 - INFO -   Statistics:
2025-10-19 22:50:44,527 - INFO -     Visits: 3
2025-10-19 22:50:44,528 - INFO -     Diagnosis Codes: 48
2025-10-19 22:50:44,529 - INFO -     Avg Codes per Visit: 16.0
2025-10-19 22:50:44,529 - INFO - 
================================================================================
2025-10-19 22:50:44,530 - INFO - Generation Complete!
2025-10-19 22:50:44,531 - INFO - ================================================================================
