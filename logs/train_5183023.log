2025-10-09 04:01:35 | INFO     | <module>:562 | === EHR Generation Training Started ===
2025-10-09 04:01:35 | INFO     | <module>:583 | Configuration: {'model_name': 'facebook/bart-base', 'num_patients': 3000, 'max_seq_length': 256, 'batch_size': 16, 'num_epochs': 30, 'learning_rate': 5e-05, 'generation_temp': 1.3, 'generation_max_length': 256, 'num_warmup_steps': 0, 'top_k': 50, 'data_dir': 'data_files', 'mimic_paths': {'patients_path': 'data_files/PATIENTS.csv', 'admissions_path': 'data_files/ADMISSIONS.csv', 'diagnoses_path': 'data_files/DIAGNOSES_ICD.csv'}}
2025-10-09 04:01:35 | INFO     | <module>:587 | Using device: cuda
2025-10-09 04:01:35 | INFO     | <module>:590 | Loading pretrained BART model: facebook/bart-base
2025-10-09 04:01:36 | INFO     | <module>:599 | Added 3 special tokens: <v>, <\v>, <END>
2025-10-09 04:01:36 | INFO     | <module>:603 | Resized model embeddings to 50268 tokens
2025-10-09 04:01:36 | DEBUG    | <module>:606 | Token ID for <v>: 50265
2025-10-09 04:01:36 | DEBUG    | <module>:607 | Token ID for <\v>: 50266
2025-10-09 04:01:36 | DEBUG    | <module>:608 | Token ID for <END>: 50267
2025-10-09 04:01:36 | INFO     | load_and_format_mimic_data:147 | Loading MIMIC-III data files
2025-10-09 04:01:36 | DEBUG    | load_and_format_mimic_data:148 | Patients: data_files/PATIENTS.csv
2025-10-09 04:01:36 | DEBUG    | load_and_format_mimic_data:149 | Admissions: data_files/ADMISSIONS.csv
2025-10-09 04:01:36 | DEBUG    | load_and_format_mimic_data:150 | Diagnoses: data_files/DIAGNOSES_ICD.csv
2025-10-09 04:01:36 | INFO     | load_and_format_mimic_data:155 | Loaded 46520 patients
2025-10-09 04:01:36 | INFO     | load_and_format_mimic_data:158 | Loaded 58976 admissions
2025-10-09 04:01:37 | INFO     | load_and_format_mimic_data:161 | Loaded 651047 diagnosis records
2025-10-09 04:01:37 | INFO     | load_and_format_mimic_data:219 | Data processing complete. Formatting sequences...
2025-10-09 04:01:39 | INFO     | load_and_format_mimic_data:258 | Sequence formatting complete. Generated 3000 patient sequences
2025-10-09 04:01:39 | DEBUG    | load_and_format_mimic_data:262 | Sample sequence: 0 ASIAN M <demo> <v> V3001 V053 V290 <\v> <END>...
2025-10-09 04:01:39 | INFO     | load_and_format_mimic_data:267 | Average visits per patient: 1.27
2025-10-09 04:01:39 | INFO     | load_and_format_mimic_data:268 | Average tokens per sequence: 19.69
2025-10-09 04:01:39 | INFO     | <module>:622 | Sample patient sequences:
2025-10-09 04:01:39 | INFO     | <module>:624 | Sample 1: 37 WHITE F <demo> <v> 5770 5070 79902 27650 5771 30981 311 V1251 53370 <\v> <END>...
2025-10-09 04:01:39 | INFO     | <module>:624 | Sample 2: 56 UNKNOWN/NOT SPECIFIED M <demo> <v> 41401 2720 4019 4240 56210 5533 2859 49390 <\v> <END>...
2025-10-09 04:01:39 | INFO     | <module>:624 | Sample 3: 0 WHITE M <demo> <v> V3001 77089 2861 7484 <\v> <END>...
2025-10-09 04:01:39 | INFO     | <module>:624 | Sample 4: 46 WHITE F <demo> <v> 74561 4240 <\v> <END>...
2025-10-09 04:01:39 | INFO     | <module>:624 | Sample 5: 60 WHITE F <demo> <v> 51882 4659 33520 3578 <\v> <END>...
2025-10-09 04:01:39 | DEBUG    | __init__:294 | First sequence length: 24 tokens
2025-10-09 04:01:39 | DEBUG    | __init__:295 | Pad token ID: 1
2025-10-09 04:01:39 | INFO     | <module>:628 | Created dataset with 3000 samples, 188 batches
2025-10-09 04:01:39 | INFO     | <module>:639 | Optimizer: AdamW with lr=5e-05
2025-10-09 04:01:39 | INFO     | <module>:640 | Scheduler: linear with 0 warmup steps
2025-10-09 04:01:40 | INFO     | train_model:351 | Starting model training for 30 epochs
2025-10-09 04:01:40 | INFO     | train_model:352 | Training steps: 5640
2025-10-09 04:01:40 | INFO     | train_model:353 | Device: cuda
2025-10-09 04:01:40 | DEBUG    | train_model:372 | First batch input_ids shape: torch.Size([16, 256])
2025-10-09 04:01:40 | DEBUG    | train_model:373 | First batch labels shape: torch.Size([16, 256])
2025-10-09 04:01:40 | DEBUG    | train_model:374 | First batch attention_mask shape: torch.Size([16, 256])
2025-10-09 04:01:40 | DEBUG    | train_model:375 | Initial loss: 2.4891
2025-10-09 04:01:40 | DEBUG    | train_model:382 | Special tokens in first batch: {'pad': 3405, 'masked_labels': 3405}
2025-10-09 04:02:27 | INFO     | train_model:401 | Epoch 1/30 completed | Avg Loss: 0.6491
2025-10-09 04:03:13 | INFO     | train_model:401 | Epoch 2/30 completed | Avg Loss: 0.1141
2025-10-09 04:04:00 | INFO     | train_model:401 | Epoch 3/30 completed | Avg Loss: 0.0487
2025-10-09 04:04:47 | INFO     | train_model:401 | Epoch 4/30 completed | Avg Loss: 0.0178
2025-10-09 04:05:33 | INFO     | train_model:401 | Epoch 5/30 completed | Avg Loss: 0.0071
2025-10-09 04:06:20 | INFO     | train_model:401 | Epoch 6/30 completed | Avg Loss: 0.0045
2025-10-09 04:07:06 | INFO     | train_model:401 | Epoch 7/30 completed | Avg Loss: 0.0047
2025-10-09 04:07:53 | INFO     | train_model:401 | Epoch 8/30 completed | Avg Loss: 0.0034
2025-10-09 04:08:40 | INFO     | train_model:401 | Epoch 9/30 completed | Avg Loss: 0.0029
2025-10-09 04:09:26 | INFO     | train_model:401 | Epoch 10/30 completed | Avg Loss: 0.0023
2025-10-09 04:10:13 | INFO     | train_model:401 | Epoch 11/30 completed | Avg Loss: 0.0026
2025-10-09 04:10:59 | INFO     | train_model:401 | Epoch 12/30 completed | Avg Loss: 0.0021
2025-10-09 04:11:46 | INFO     | train_model:401 | Epoch 13/30 completed | Avg Loss: 0.0025
2025-10-09 04:12:33 | INFO     | train_model:401 | Epoch 14/30 completed | Avg Loss: 0.0025
2025-10-09 04:13:19 | INFO     | train_model:401 | Epoch 15/30 completed | Avg Loss: 0.0018
2025-10-09 04:14:06 | INFO     | train_model:401 | Epoch 16/30 completed | Avg Loss: 0.0023
2025-10-09 04:14:52 | INFO     | train_model:401 | Epoch 17/30 completed | Avg Loss: 0.0028
2025-10-09 04:15:39 | INFO     | train_model:401 | Epoch 18/30 completed | Avg Loss: 0.0020
2025-10-09 04:16:26 | INFO     | train_model:401 | Epoch 19/30 completed | Avg Loss: 0.0028
2025-10-09 04:17:12 | INFO     | train_model:401 | Epoch 20/30 completed | Avg Loss: 0.0013
2025-10-09 04:17:59 | INFO     | train_model:401 | Epoch 21/30 completed | Avg Loss: 0.0016
2025-10-09 04:18:45 | INFO     | train_model:401 | Epoch 22/30 completed | Avg Loss: 0.0008
2025-10-09 04:19:32 | INFO     | train_model:401 | Epoch 23/30 completed | Avg Loss: 0.0013
2025-10-09 04:20:19 | INFO     | train_model:401 | Epoch 24/30 completed | Avg Loss: 0.0007
2025-10-09 04:21:05 | INFO     | train_model:401 | Epoch 25/30 completed | Avg Loss: 0.0010
2025-10-09 04:21:52 | INFO     | train_model:401 | Epoch 26/30 completed | Avg Loss: 0.0007
2025-10-09 04:22:38 | INFO     | train_model:401 | Epoch 27/30 completed | Avg Loss: 0.0008
2025-10-09 04:23:25 | INFO     | train_model:401 | Epoch 28/30 completed | Avg Loss: 0.0004
2025-10-09 04:24:11 | INFO     | train_model:401 | Epoch 29/30 completed | Avg Loss: 0.0005
2025-10-09 04:24:58 | INFO     | train_model:401 | Epoch 30/30 completed | Avg Loss: 0.0003
2025-10-09 04:24:58 | INFO     | train_model:403 | Training complete
2025-10-09 04:24:58 | INFO     | train_model:404 | Final average loss: 0.0003
2025-10-09 04:24:58 | DEBUG    | train_model:405 | Loss history: [0.6491451535690972, 0.11406541052967945, 0.04872589789955144, 0.01775675372869529, 0.007134577392555892, 0.0045032061941728515, 0.004712755305747046, 0.0034249018140241226, 0.0028519266572325152, 0.002315432515504344, 0.002552731671652935, 0.0021147570107441812, 0.0024862616832870893, 0.0024504981816751248, 0.0017549930449372079, 0.002294041519331934, 0.0027517884373856817, 0.001954884082961337, 0.0027763659743365505, 0.0012869456602740993, 0.0016396141823435677, 0.0007888236574759271, 0.0012521295892780626, 0.0006812140316934018, 0.0010029191455148666, 0.0007324343970004578, 0.0007818391842831377, 0.00040629462095471643, 0.0005208324755779146, 0.0003265668373329545]
2025-10-09 04:24:58 | INFO     | <module>:654 | === Generating synthetic patient data ===
2025-10-09 04:24:58 | INFO     | <module>:663 | 
--- Sample 1/5 ---
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '84 BLACK F <demo>'
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 6232, 34101, 274, 28696, 12789, 139, 15698, 2]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '84', ' BLACK', ' F', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 6232, 34101, 274, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.002124
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.001684
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.990781
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.990781 | ID: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <v>                  | Prob: 0.002124 | ID: 50265
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 3:  BLACK               | Prob: 0.002083 | ID: 34101
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <END>                | Prob: 0.001684 | ID: 50267
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 5:                      | Prob: 0.000384 | ID: 1437
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 6:  WHITE               | Prob: 0.000172 | ID: 38503
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 7: 84                   | Prob: 0.000158 | ID: 6232
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 8:  1985                | Prob: 0.000143 | ID: 12497
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 9: <\v>                 | Prob: 0.000140 | ID: 50266
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 10: >                    | Prob: 0.000135 | ID: 15698
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 11: dem                  | Prob: 0.000126 | ID: 12789
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 12:  1890                | Prob: 0.000085 | ID: 37708
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 13:  1984                | Prob: 0.000078 | ID: 11724
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 14:  1983                | Prob: 0.000071 | ID: 13668
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 001                  | Prob: 0.000065 | ID: 19089
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  F                   | Prob: 0.000060 | ID: 274
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 17: AF                   | Prob: 0.000059 | ID: 8573
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 1                    | Prob: 0.000036 | ID: 134
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 19:  <                   | Prob: 0.000035 | ID: 28696
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 0                    | Prob: 0.000033 | ID: 288
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=50, max_length=256
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 6232, 34101, 274, 28696, 12789, 139, 15698, 2, 50265, 34101, 274, 2, 2, 2, 50267]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:521 | Generated length: 17 tokens
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>84 BLACK F <demo></s> <v>  BLACK F</s></s></s> <END>
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 84 BLACK F <demo> BLACK F
2025-10-09 04:24:58 | INFO     | <module>:663 | 
--- Sample 2/5 ---
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '20 WHITE M <demo>'
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 844, 38503, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '20', ' WHITE', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 844, 38503, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.003341
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.001450
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.963388
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.963388 | ID: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 2:  WHITE               | Prob: 0.027174 | ID: 38503
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.003341 | ID: 50265
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <END>                | Prob: 0.001450 | ID: 50267
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 5:                      | Prob: 0.000936 | ID: 1437
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 6:  <                   | Prob: 0.000445 | ID: 28696
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 7: dem                  | Prob: 0.000276 | ID: 12789
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 20                   | Prob: 0.000169 | ID: 844
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 9: <\v>                 | Prob: 0.000146 | ID: 50266
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 10:  SPEC                | Prob: 0.000116 | ID: 44921
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  20                  | Prob: 0.000099 | ID: 291
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 0                    | Prob: 0.000086 | ID: 288
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 2                    | Prob: 0.000081 | ID: 176
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 14:  F                   | Prob: 0.000081 | ID: 274
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 002                  | Prob: 0.000080 | ID: 19130
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  BLACK               | Prob: 0.000076 | ID: 34101
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 17:  1972                | Prob: 0.000058 | ID: 15002
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  OR                  | Prob: 0.000051 | ID: 6532
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 19: >                    | Prob: 0.000051 | ID: 15698
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 20:  00                  | Prob: 0.000039 | ID: 16273
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=50, max_length=256
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 844, 38503, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 50266, 2, 50267]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:521 | Generated length: 17 tokens
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>20 WHITE M <demo></s> <v> </s></s></s> <\v> </s> <END>
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 20 WHITE M <demo>
2025-10-09 04:24:58 | INFO     | <module>:663 | 
--- Sample 3/5 ---
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '67 UNABLE TO OBTAIN F <demo>'
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 4111, 121, 4444, 30876, 3842, 28214, 23177, 274, 28696, 12789, 139, 15698, 2]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '67', ' U', 'NA', 'BLE', ' TO', ' OB', 'TAIN', ' F', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 4111, 121, 4444, 30876, 3842, 28214, 23177, 274, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000962
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.001180
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.997036
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.997036 | ID: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <END>                | Prob: 0.001180 | ID: 50267
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.000962 | ID: 50265
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 4:  <                   | Prob: 0.000056 | ID: 28696
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 5:                      | Prob: 0.000052 | ID: 1437
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 6: <\v>                 | Prob: 0.000046 | ID: 50266
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 7: >                    | Prob: 0.000042 | ID: 15698
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 8:  AMER                | Prob: 0.000033 | ID: 37501
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 9:  SPEC                | Prob: 0.000030 | ID: 44921
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 1                    | Prob: 0.000023 | ID: 134
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  E                   | Prob: 0.000021 | ID: 381
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 2                    | Prob: 0.000020 | ID: 176
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 13:  F                   | Prob: 0.000019 | ID: 274
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 14: /                    | Prob: 0.000015 | ID: 73
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 3                    | Prob: 0.000015 | ID: 246
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 9                    | Prob: 0.000013 | ID: 466
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 5                    | Prob: 0.000012 | ID: 245
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  5                   | Prob: 0.000011 | ID: 195
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 19:  OR                  | Prob: 0.000011 | ID: 6532
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 0                    | Prob: 0.000011 | ID: 288
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=50, max_length=256
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 4111, 121, 4444, 30876, 3842, 28214, 23177, 274, 28696, 12789, 139, 15698, 2, 50265, 2, 50267]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:521 | Generated length: 18 tokens
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>67 UNABLE TO OBTAIN F <demo></s> <v> </s> <END>
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 67 UNABLE TO OBTAIN F <demo>
2025-10-09 04:24:58 | INFO     | <module>:663 | 
--- Sample 4/5 ---
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '86 OTHER F <demo>'
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 5334, 16536, 274, 28696, 12789, 139, 15698, 2]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '86', ' OTHER', ' F', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 5334, 16536, 274, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.003286
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.002411
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.988107
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.988107 | ID: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <v>                  | Prob: 0.003286 | ID: 50265
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <END>                | Prob: 0.002411 | ID: 50267
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 4: dem                  | Prob: 0.000627 | ID: 12789
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 5:  SPEC                | Prob: 0.000285 | ID: 44921
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 6: 86                   | Prob: 0.000264 | ID: 5334
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 7:                      | Prob: 0.000243 | ID: 1437
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 2                    | Prob: 0.000240 | ID: 176
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 9:  OTHER               | Prob: 0.000231 | ID: 16536
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 10: >                    | Prob: 0.000231 | ID: 15698
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  1985                | Prob: 0.000207 | ID: 12497
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 12: <\v>                 | Prob: 0.000190 | ID: 50266
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 13: IENT                 | Prob: 0.000111 | ID: 44735
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 14:  <                   | Prob: 0.000086 | ID: 28696
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 15:  WHITE               | Prob: 0.000074 | ID: 38503
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  F                   | Prob: 0.000068 | ID: 274
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 17:  OR                  | Prob: 0.000068 | ID: 6532
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  85                  | Prob: 0.000059 | ID: 5663
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 800                  | Prob: 0.000056 | ID: 3913
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 20:  DEC                 | Prob: 0.000055 | ID: 16718
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=50, max_length=256
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 5334, 16536, 274, 28696, 12789, 139, 15698, 2, 50265, 16536, 274, 41552, 12789, 139, 48691, 2, 2, 50267]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:521 | Generated length: 20 tokens
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>86 OTHER F <demo></s> <v>  OTHER F<demo>.</s></s> <END>
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 86 OTHER F <demo> OTHER F<demo>.
2025-10-09 04:24:58 | INFO     | <module>:663 | 
--- Sample 5/5 ---
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '22 BLACK M <demo>'
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 2036, 34101, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '22', ' BLACK', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 2036, 34101, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.001821
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.001668
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.993488
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.993488 | ID: 2
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <v>                  | Prob: 0.001821 | ID: 50265
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <END>                | Prob: 0.001668 | ID: 50267
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 4:  BLACK               | Prob: 0.001112 | ID: 34101
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 5: dem                  | Prob: 0.000446 | ID: 12789
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 6: 2                    | Prob: 0.000145 | ID: 176
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 7: <\v>                 | Prob: 0.000112 | ID: 50266
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 8:                      | Prob: 0.000100 | ID: 1437
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 9: >                    | Prob: 0.000050 | ID: 15698
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 10:  WHITE               | Prob: 0.000048 | ID: 38503
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  SPEC                | Prob: 0.000045 | ID: 44921
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 002                  | Prob: 0.000041 | ID: 19130
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 0                    | Prob: 0.000033 | ID: 288
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 22                   | Prob: 0.000029 | ID: 2036
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 3                    | Prob: 0.000021 | ID: 246
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  AMER                | Prob: 0.000019 | ID: 37501
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 800                  | Prob: 0.000017 | ID: 3913
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  E                   | Prob: 0.000017 | ID: 381
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 9                    | Prob: 0.000015 | ID: 466
2025-10-09 04:24:58 | DEBUG    | generate_patient_sequence:503 |   Rank 20:  F                   | Prob: 0.000015 | ID: 274
2025-10-09 04:24:58 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=50, max_length=256
2025-10-09 04:24:59 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 2036, 34101, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 50266, 2, 50267]
2025-10-09 04:24:59 | DEBUG    | generate_patient_sequence:521 | Generated length: 17 tokens
2025-10-09 04:24:59 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-09 04:24:59 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>22 BLACK M <demo></s> <v> </s></s></s> <\v> </s> <END>
2025-10-09 04:24:59 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 22 BLACK M <demo>
2025-10-09 04:24:59 | INFO     | <module>:677 | === Training and generation complete ===
