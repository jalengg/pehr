2025-10-10 01:52:33 | INFO     | <module>:563 | === EHR Generation Training Started ===
2025-10-10 01:52:33 | INFO     | <module>:584 | Configuration: {'model_name': 'facebook/bart-base', 'num_patients': 3000, 'max_seq_length': 256, 'batch_size': 16, 'num_epochs': 20, 'learning_rate': 0.0001, 'generation_temp': 1.0, 'generation_max_length': 256, 'num_warmup_steps': 0, 'top_k': 50, 'data_dir': 'data_files', 'mimic_paths': {'patients_path': 'data_files/PATIENTS.csv', 'admissions_path': 'data_files/ADMISSIONS.csv', 'diagnoses_path': 'data_files/DIAGNOSES_ICD.csv'}}
2025-10-10 01:52:33 | INFO     | <module>:588 | Using device: cuda
2025-10-10 01:52:33 | INFO     | <module>:591 | Loading pretrained BART model: facebook/bart-base
2025-10-10 01:52:33 | INFO     | <module>:598 | Added 4 special tokens: <demo>, <v>, <\v>, <END>
2025-10-10 01:52:34 | INFO     | <module>:601 | Resized model embeddings to 50269 tokens
2025-10-10 01:52:34 | INFO     | <module>:609 | Initialized 4 new embeddings from pretrained mean
2025-10-10 01:52:34 | DEBUG    | <module>:611 | Token ID for <demo>: 50265
2025-10-10 01:52:34 | DEBUG    | <module>:612 | Token ID for <v>: 50266
2025-10-10 01:52:34 | DEBUG    | <module>:613 | Token ID for <\v>: 50267
2025-10-10 01:52:34 | DEBUG    | <module>:614 | Token ID for <END>: 50268
2025-10-10 01:52:34 | INFO     | load_and_format_mimic_data:147 | Loading MIMIC-III data files
2025-10-10 01:52:34 | DEBUG    | load_and_format_mimic_data:148 | Patients: data_files/PATIENTS.csv
2025-10-10 01:52:34 | DEBUG    | load_and_format_mimic_data:149 | Admissions: data_files/ADMISSIONS.csv
2025-10-10 01:52:34 | DEBUG    | load_and_format_mimic_data:150 | Diagnoses: data_files/DIAGNOSES_ICD.csv
2025-10-10 01:52:34 | INFO     | load_and_format_mimic_data:155 | Loaded 46520 patients
2025-10-10 01:52:34 | INFO     | load_and_format_mimic_data:158 | Loaded 58976 admissions
2025-10-10 01:52:34 | INFO     | load_and_format_mimic_data:161 | Loaded 651047 diagnosis records
2025-10-10 01:52:34 | INFO     | load_and_format_mimic_data:219 | Data processing complete. Formatting sequences...
2025-10-10 01:52:37 | INFO     | load_and_format_mimic_data:258 | Sequence formatting complete. Generated 3000 patient sequences
2025-10-10 01:52:37 | DEBUG    | load_and_format_mimic_data:262 | Sample sequence: 0 ASIAN M <demo> <v> V3001 V053 V290 <\v> <END>...
2025-10-10 01:52:37 | INFO     | load_and_format_mimic_data:267 | Average visits per patient: 1.27
2025-10-10 01:52:37 | INFO     | load_and_format_mimic_data:268 | Average tokens per sequence: 19.69
2025-10-10 01:52:37 | INFO     | <module>:628 | Sample patient sequences:
2025-10-10 01:52:37 | INFO     | <module>:630 | Sample 1: 41 WHITE F <demo> <v> 86405 80709 8244 E8150 <\v> <END>...
2025-10-10 01:52:37 | INFO     | <module>:630 | Sample 2: 0 WHITE M <demo> <v> V3001 76518 7742 7793 76527 77081 77981 V502 V053 V290 <\v> <END>...
2025-10-10 01:52:37 | INFO     | <module>:630 | Sample 3: 36 WHITE F <demo> <v> 430 07054 72989 2768 49390 53081 3051 <\v> <END>...
2025-10-10 01:52:37 | INFO     | <module>:630 | Sample 4: 52 BLACK/AFRICAN AMERICAN F <demo> <v> 4019 2720 58389 25000 4412 2859 V1581 <\v> <v> 99662 5856 4592 40391 4538 E8791 41401 25201 2720 28521 32723 V4...
2025-10-10 01:52:37 | INFO     | <module>:630 | Sample 5: 0 WHITE M <demo> <v> V3100 76517 76528 7756 76407 <\v> <END>...
2025-10-10 01:52:37 | DEBUG    | __init__:294 | First sequence length: 22 tokens
2025-10-10 01:52:37 | DEBUG    | __init__:295 | Pad token ID: 1
2025-10-10 01:52:37 | INFO     | <module>:634 | Created dataset with 3000 samples, 188 batches
2025-10-10 01:52:37 | INFO     | <module>:645 | Optimizer: AdamW with lr=0.0001
2025-10-10 01:52:37 | INFO     | <module>:646 | Scheduler: linear with 0 warmup steps
2025-10-10 01:52:37 | INFO     | train_model:351 | Starting model training for 20 epochs
2025-10-10 01:52:37 | INFO     | train_model:352 | Training steps: 3760
2025-10-10 01:52:37 | INFO     | train_model:353 | Device: cuda
2025-10-10 01:52:38 | DEBUG    | train_model:372 | First batch input_ids shape: torch.Size([16, 256])
2025-10-10 01:52:38 | DEBUG    | train_model:373 | First batch labels shape: torch.Size([16, 256])
2025-10-10 01:52:38 | DEBUG    | train_model:374 | First batch attention_mask shape: torch.Size([16, 256])
2025-10-10 01:52:38 | DEBUG    | train_model:375 | Initial loss: 3.3267
2025-10-10 01:52:38 | DEBUG    | train_model:382 | Special tokens in first batch: {'pad': 3461, 'masked_labels': 3461}
2025-10-10 01:53:24 | INFO     | train_model:401 | Epoch 1/20 completed | Avg Loss: 0.6163
2025-10-10 01:54:11 | INFO     | train_model:401 | Epoch 2/20 completed | Avg Loss: 0.0609
2025-10-10 01:54:57 | INFO     | train_model:401 | Epoch 3/20 completed | Avg Loss: 0.0155
2025-10-10 01:55:44 | INFO     | train_model:401 | Epoch 4/20 completed | Avg Loss: 0.0105
2025-10-10 01:56:31 | INFO     | train_model:401 | Epoch 5/20 completed | Avg Loss: 0.0117
2025-10-10 01:57:17 | INFO     | train_model:401 | Epoch 6/20 completed | Avg Loss: 0.0081
2025-10-10 01:58:04 | INFO     | train_model:401 | Epoch 7/20 completed | Avg Loss: 0.0135
2025-10-10 01:58:50 | INFO     | train_model:401 | Epoch 8/20 completed | Avg Loss: 0.0067
2025-10-10 01:59:37 | INFO     | train_model:401 | Epoch 9/20 completed | Avg Loss: 0.0086
2025-10-10 02:00:23 | INFO     | train_model:401 | Epoch 10/20 completed | Avg Loss: 0.0048
2025-10-10 02:01:10 | INFO     | train_model:401 | Epoch 11/20 completed | Avg Loss: 0.0063
2025-10-10 02:01:57 | INFO     | train_model:401 | Epoch 12/20 completed | Avg Loss: 0.0043
2025-10-10 02:02:43 | INFO     | train_model:401 | Epoch 13/20 completed | Avg Loss: 0.0023
2025-10-10 02:03:30 | INFO     | train_model:401 | Epoch 14/20 completed | Avg Loss: 0.0019
2025-10-10 02:04:16 | INFO     | train_model:401 | Epoch 15/20 completed | Avg Loss: 0.0032
2025-10-10 02:05:03 | INFO     | train_model:401 | Epoch 16/20 completed | Avg Loss: 0.0016
2025-10-10 02:05:50 | INFO     | train_model:401 | Epoch 17/20 completed | Avg Loss: 0.0016
2025-10-10 02:06:36 | INFO     | train_model:401 | Epoch 18/20 completed | Avg Loss: 0.0015
2025-10-10 02:07:23 | INFO     | train_model:401 | Epoch 19/20 completed | Avg Loss: 0.0010
2025-10-10 02:08:09 | INFO     | train_model:401 | Epoch 20/20 completed | Avg Loss: 0.0008
2025-10-10 02:08:09 | INFO     | train_model:403 | Training complete
2025-10-10 02:08:09 | INFO     | train_model:404 | Final average loss: 0.0008
2025-10-10 02:08:09 | DEBUG    | train_model:405 | Loss history: [0.6163190050407293, 0.0608669150586022, 0.015545917314506988, 0.01051032907413715, 0.011741033403210322, 0.0080573123466704, 0.013502517557192712, 0.006698587731621724, 0.008582397585454832, 0.004778514339859805, 0.006312891615380067, 0.0043417107514502045, 0.002282386417565694, 0.0018737158831580482, 0.003238347097918604, 0.001592829534777767, 0.0015729763309014317, 0.0015431179509757017, 0.0009779728174412702, 0.0008247710249750216]
2025-10-10 02:08:09 | INFO     | <module>:660 | === Generating synthetic patient data ===
2025-10-10 02:08:09 | INFO     | <module>:669 | 
--- Sample 1/5 ---
2025-10-10 02:08:09 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '79 ASIAN F <demo>'
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 5220, 6015, 10296, 274, 1437, 50265, 2]
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '79', ' AS', 'IAN', ' F', ' ', '<demo>', '</s>']
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50266, <\v>: 50267, <END>: 50268, PAD: 1, EOS: 2
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 5220, 6015, 10296, 274, 1437, 50265, 2, 50266]
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.011181
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.590775
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.394817
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <END>                | Prob: 0.590775 | ID: 50268
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.394817 | ID: 2
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.011181 | ID: 50266
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <\v>                 | Prob: 0.002325 | ID: 50267
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 5: <demo>               | Prob: 0.000296 | ID: 50265
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 6:                      | Prob: 0.000018 | ID: 1437
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 7: P                    | Prob: 0.000017 | ID: 510
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 139                  | Prob: 0.000009 | ID: 25488
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 9: KNOWN                | Prob: 0.000008 | ID: 47300
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 290                  | Prob: 0.000007 | ID: 24675
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 790                  | Prob: 0.000007 | ID: 34504
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 789                  | Prob: 0.000007 | ID: 39413
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 681                  | Prob: 0.000007 | ID: 38149
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 441                  | Prob: 0.000006 | ID: 36011
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 15:  F                   | Prob: 0.000006 | ID: 274
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  OTHER               | Prob: 0.000006 | ID: 16536
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 186                  | Prob: 0.000006 | ID: 29024
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  401                 | Prob: 0.000006 | ID: 17936
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 690                  | Prob: 0.000005 | ID: 33636
2025-10-10 02:08:09 | DEBUG    | generate_patient_sequence:503 |   Rank 20:  nan                 | Prob: 0.000005 | ID: 14770
2025-10-10 02:08:09 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.0, top_k=50, max_length=256
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:521 | Generated token IDs: [2, 0, 5220, 6015, 10296, 274, 1437, 50265, 2, 50266, 7589, 6015, 10296, 256, 1437, 50265, 1437, 50268]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:522 | Generated length: 18 tokens
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:530 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:538 | Raw generated sequence: </s><s>79 ASIAN F  <demo> </s> <v>  79 ASIAN M  <demo>   <END>
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:541 | Generated sequence (clean): 79 ASIAN F  79 ASIAN M  
2025-10-10 02:08:10 | INFO     | <module>:669 | 
--- Sample 2/5 ---
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '23 UNKNOWN/NOT SPECIFIED M <demo>'
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 1922, 2604, 47300, 73, 37049, 44921, 36482, 256, 1437, 50265, 2]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '23', ' UN', 'KNOWN', '/', 'NOT', ' SPEC', 'IFIED', ' M', ' ', '<demo>', '</s>']
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50266, <\v>: 50267, <END>: 50268, PAD: 1, EOS: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 1922, 2604, 47300, 73, 37049, 44921, 36482, 256, 1437, 50265, 2, 50266]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.021272
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.636972
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.332242
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <END>                | Prob: 0.636972 | ID: 50268
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.332242 | ID: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.021272 | ID: 50266
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <\v>                 | Prob: 0.007562 | ID: 50267
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 5: <demo>               | Prob: 0.001173 | ID: 50265
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 6: P                    | Prob: 0.000052 | ID: 510
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 7: KNOWN                | Prob: 0.000018 | ID: 47300
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 8:                      | Prob: 0.000018 | ID: 1437
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 9: LIN                  | Prob: 0.000011 | ID: 13748
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 681                  | Prob: 0.000011 | ID: 38149
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 290                  | Prob: 0.000010 | ID: 24675
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 139                  | Prob: 0.000010 | ID: 25488
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 13:  F                   | Prob: 0.000009 | ID: 274
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 14:  OTHER               | Prob: 0.000008 | ID: 16536
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 1945                 | Prob: 0.000007 | ID: 45391
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 000                  | Prob: 0.000007 | ID: 151
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 271                  | Prob: 0.000006 | ID: 32145
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 690                  | Prob: 0.000006 | ID: 33636
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 441                  | Prob: 0.000006 | ID: 36011
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 186                  | Prob: 0.000006 | ID: 29024
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.0, top_k=50, max_length=256
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:521 | Generated token IDs: [2, 0, 1922, 2604, 47300, 73, 37049, 44921, 36482, 256, 1437, 50265, 2, 50266, 883, 2604, 47300, 1589, 37049, 44921, 36497, 256, 1437, 50267, 1437, 50268]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:522 | Generated length: 26 tokens
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:530 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:538 | Raw generated sequence: </s><s>23 UNKNOWN/NOT SPECIFIED M  <demo> </s> <v>  23 UNKNOWN /NOT SPECIFIC M  <\v>   <END>
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:541 | Generated sequence (clean): 23 UNKNOWN/NOT SPECIFIED M  23 UNKNOWN /NOT SPECIFIC M  
2025-10-10 02:08:10 | INFO     | <module>:669 | 
--- Sample 3/5 ---
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '68 UNKNOWN/NOT SPECIFIED F <demo>'
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 4671, 2604, 47300, 73, 37049, 44921, 36482, 274, 1437, 50265, 2]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '68', ' UN', 'KNOWN', '/', 'NOT', ' SPEC', 'IFIED', ' F', ' ', '<demo>', '</s>']
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50266, <\v>: 50267, <END>: 50268, PAD: 1, EOS: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 4671, 2604, 47300, 73, 37049, 44921, 36482, 274, 1437, 50265, 2, 50266]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.022001
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.447062
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.518597
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.518597 | ID: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <END>                | Prob: 0.447062 | ID: 50268
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.022001 | ID: 50266
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <\v>                 | Prob: 0.009919 | ID: 50267
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 5: <demo>               | Prob: 0.001575 | ID: 50265
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 6: P                    | Prob: 0.000047 | ID: 510
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 7: KNOWN                | Prob: 0.000019 | ID: 47300
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 8:                      | Prob: 0.000014 | ID: 1437
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 9: 139                  | Prob: 0.000014 | ID: 25488
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 10: LIN                  | Prob: 0.000014 | ID: 13748
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 681                  | Prob: 0.000013 | ID: 38149
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 12:  F                   | Prob: 0.000011 | ID: 274
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 13:  OTHER               | Prob: 0.000010 | ID: 16536
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 290                  | Prob: 0.000010 | ID: 24675
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 1945                 | Prob: 0.000009 | ID: 45391
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 000                  | Prob: 0.000008 | ID: 151
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 118                  | Prob: 0.000007 | ID: 21369
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 690                  | Prob: 0.000006 | ID: 33636
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 271                  | Prob: 0.000006 | ID: 32145
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 674                  | Prob: 0.000006 | ID: 38715
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.0, top_k=50, max_length=256
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:521 | Generated token IDs: [2, 0, 4671, 2604, 47300, 73, 37049, 44921, 36482, 274, 1437, 50265, 2, 50266, 231, 4111, 2604, 47300, 11665, 37049, 44921, 36497, 274, 1437, 50267, 1437, 50268]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:522 | Generated length: 27 tokens
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:530 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:538 | Raw generated sequence: </s><s>68 UNKNOWN/NOT SPECIFIED F  <demo> </s> <v>  667 UNKNOWN/.NOT SPECIFIC F  <\v>   <END>
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:541 | Generated sequence (clean): 68 UNKNOWN/NOT SPECIFIED F  667 UNKNOWN/.NOT SPECIFIC F  
2025-10-10 02:08:10 | INFO     | <module>:669 | 
--- Sample 4/5 ---
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '83 ASIAN F <demo>'
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 6361, 6015, 10296, 274, 1437, 50265, 2]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '83', ' AS', 'IAN', ' F', ' ', '<demo>', '</s>']
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50266, <\v>: 50267, <END>: 50268, PAD: 1, EOS: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 6361, 6015, 10296, 274, 1437, 50265, 2, 50266]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.010687
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.536476
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.449384
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <END>                | Prob: 0.536476 | ID: 50268
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.449384 | ID: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.010687 | ID: 50266
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <\v>                 | Prob: 0.002549 | ID: 50267
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 5: <demo>               | Prob: 0.000306 | ID: 50265
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 6:                      | Prob: 0.000027 | ID: 1437
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 7: P                    | Prob: 0.000016 | ID: 510
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 8: KNOWN                | Prob: 0.000010 | ID: 47300
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 9:  OTHER               | Prob: 0.000008 | ID: 16536
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 10:  F                   | Prob: 0.000008 | ID: 274
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 441                  | Prob: 0.000007 | ID: 36011
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 290                  | Prob: 0.000007 | ID: 24675
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 681                  | Prob: 0.000007 | ID: 38149
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 789                  | Prob: 0.000006 | ID: 39413
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 15:  nan                 | Prob: 0.000006 | ID: 14770
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 790                  | Prob: 0.000006 | ID: 34504
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 139                  | Prob: 0.000006 | ID: 25488
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 186                  | Prob: 0.000006 | ID: 29024
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 19:  401                 | Prob: 0.000006 | ID: 17936
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 373                  | Prob: 0.000005 | ID: 34099
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.0, top_k=50, max_length=256
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:521 | Generated token IDs: [2, 0, 6361, 6015, 10296, 274, 1437, 50265, 2, 50266, 290, 1366, 6668, 6015, 10296, 256, 1437, 50265, 1437, 50268]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:522 | Generated length: 20 tokens
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:530 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:538 | Raw generated sequence: </s><s>83 ASIAN F  <demo> </s> <v>  81881 ASIAN M  <demo>   <END>
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:541 | Generated sequence (clean): 83 ASIAN F  81881 ASIAN M  
2025-10-10 02:08:10 | INFO     | <module>:669 | 
--- Sample 5/5 ---
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '32 HISPANIC OR LATINO M <demo>'
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 2881, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 1437, 50265, 2]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '32', ' HIS', 'P', 'AN', 'IC', ' OR', ' LAT', 'INO', ' M', ' ', '<demo>', '</s>']
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50266, <\v>: 50267, <END>: 50268, PAD: 1, EOS: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 2881, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 1437, 50265, 2, 50266]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.007227
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.917225
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.071549
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <END>                | Prob: 0.917225 | ID: 50268
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.071549 | ID: 2
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 3: <v>                  | Prob: 0.007227 | ID: 50266
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <\v>                 | Prob: 0.003397 | ID: 50267
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 5: <demo>               | Prob: 0.000239 | ID: 50265
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 6: P                    | Prob: 0.000017 | ID: 510
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 7: KNOWN                | Prob: 0.000010 | ID: 47300
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 8:                      | Prob: 0.000009 | ID: 1437
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 9:  LAT                 | Prob: 0.000008 | ID: 21455
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 681                  | Prob: 0.000007 | ID: 38149
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  OTHER               | Prob: 0.000007 | ID: 16536
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 12: LIN                  | Prob: 0.000005 | ID: 13748
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 139                  | Prob: 0.000004 | ID: 25488
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 271                  | Prob: 0.000004 | ID: 32145
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 15:  F                   | Prob: 0.000003 | ID: 274
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 441                  | Prob: 0.000003 | ID: 36011
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 690                  | Prob: 0.000003 | ID: 33636
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 18:  AMER                | Prob: 0.000003 | ID: 37501
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 290                  | Prob: 0.000003 | ID: 24675
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 186                  | Prob: 0.000003 | ID: 29024
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.0, top_k=50, max_length=256
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:521 | Generated token IDs: [2, 0, 2881, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 1437, 50265, 2, 50266, 262, 4652, 256, 1437, 50267, 1437, 50268]
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:522 | Generated length: 22 tokens
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:530 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-10 02:08:10 | DEBUG    | generate_patient_sequence:538 | Raw generated sequence: </s><s>32 HISPANIC OR LATINO M  <demo> </s> <v>  788 M  <\v>   <END>
2025-10-10 02:08:10 | INFO     | generate_patient_sequence:541 | Generated sequence (clean): 32 HISPANIC OR LATINO M  788 M  
2025-10-10 02:08:10 | INFO     | <module>:683 | === Training and generation complete ===
