2025-10-13 02:15:22,815 - INFO - ================================================================================
2025-10-13 02:15:22,815 - INFO - PromptEHR Synthetic Patient Generation
2025-10-13 02:15:22,815 - INFO - ================================================================================
2025-10-13 02:15:22,900 - INFO - Device: cpu
2025-10-13 02:15:22,900 - INFO - 
Loading vocabulary...
2025-10-13 02:15:22,901 - INFO - Loading MIMIC-III data files
2025-10-13 02:15:22,952 - INFO - Loaded 46520 patients
2025-10-13 02:15:23,079 - INFO - Loaded 58976 admissions
2025-10-13 02:15:23,521 - INFO - Loaded 651047 diagnosis records
2025-10-13 02:15:23,877 - INFO - Processing patient records
2025-10-13 02:15:25,505 - INFO - Loaded 3000 patient records
2025-10-13 02:15:25,505 - INFO - Diagnosis vocabulary size: 2823
2025-10-13 02:15:25,506 - INFO - Average visits per patient: 1.27
2025-10-13 02:15:25,506 - INFO - Average codes per visit: 9.27
2025-10-13 02:15:25,507 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-13 02:15:25,508 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-13 02:15:25,524 - INFO - Tokenizer vocab size: 2829
2025-10-13 02:15:25,524 - INFO - Using checkpoint: checkpoints/best_model.pt
2025-10-13 02:15:25,525 - INFO - Loading model from checkpoints/best_model.pt
2025-10-13 02:15:27,748 - INFO - Model loaded from epoch 30
2025-10-13 02:15:27,748 - INFO - Validation loss: 0.0560
2025-10-13 02:15:27,811 - INFO - 
================================================================================
2025-10-13 02:15:27,811 - INFO - Generating Synthetic Patients
2025-10-13 02:15:27,811 - INFO - ================================================================================
2025-10-13 02:15:27,811 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:27,811 - INFO - Patient 1:
2025-10-13 02:15:27,811 - INFO -   Demographics: 65.0yo WHITE M
2025-10-13 02:15:27,969 - INFO -   Generated Sequence:
2025-10-13 02:15:27,969 - INFO -     <BOS> <v> V053 430 8240 80111 E9585 44022 7061 <END>
2025-10-13 02:15:27,969 - INFO -   Statistics:
2025-10-13 02:15:27,969 - INFO -     Visits: 1
2025-10-13 02:15:27,969 - INFO -     Diagnosis Codes: 9
2025-10-13 02:15:27,969 - INFO -     Avg Codes per Visit: 9.0
2025-10-13 02:15:27,969 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:27,969 - INFO - Patient 2:
2025-10-13 02:15:27,969 - INFO -   Demographics: 45.0yo BLACK F
2025-10-13 02:15:28,393 - INFO -   Generated Sequence:
2025-10-13 02:15:28,393 - INFO -     <BOS> <v> 2899 80125 85011 2861 48249 4413 86113 2839 1572 49392 33811 7830 7830 2971 2859 <\v> <v> 61801 7336 82525 2971 <END>
2025-10-13 02:15:28,393 - INFO -   Statistics:
2025-10-13 02:15:28,393 - INFO -     Visits: 2
2025-10-13 02:15:28,393 - INFO -     Diagnosis Codes: 22
2025-10-13 02:15:28,393 - INFO -     Avg Codes per Visit: 11.0
2025-10-13 02:15:28,393 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:28,393 - INFO - Patient 3:
2025-10-13 02:15:28,393 - INFO -   Demographics: 30.0yo HISPANIC M
2025-10-13 02:15:28,891 - INFO -   Generated Sequence:
2025-10-13 02:15:28,891 - INFO -     <BOS> <v> 5920 V610 86113 E8146 E8146 E8146 E8851 4110 48249 V053 88002 88002 2929 2929 V1011 <\v> <v> E8851 3009 2859 <END>
2025-10-13 02:15:28,891 - INFO -   Statistics:
2025-10-13 02:15:28,891 - INFO -     Visits: 2
2025-10-13 02:15:28,891 - INFO -     Diagnosis Codes: 21
2025-10-13 02:15:28,891 - INFO -     Avg Codes per Visit: 10.5
2025-10-13 02:15:28,891 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:28,891 - INFO - Patient 4:
2025-10-13 02:15:28,891 - INFO -   Demographics: 70.0yo WHITE F
2025-10-13 02:15:29,339 - INFO -   Generated Sequence:
2025-10-13 02:15:29,340 - INFO -     <BOS> <v> 2899 V291 86350 1915 85246 E8146 8900 5264 41020 7580 56731 56731 80625 V053 430 <\v> <v> 430 E9198 V053 88002 86804 2572 <END>
2025-10-13 02:15:29,340 - INFO -   Statistics:
2025-10-13 02:15:29,340 - INFO -     Visits: 2
2025-10-13 02:15:29,340 - INFO -     Diagnosis Codes: 24
2025-10-13 02:15:29,340 - INFO -     Avg Codes per Visit: 12.0
2025-10-13 02:15:29,340 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:29,340 - INFO - Patient 5:
2025-10-13 02:15:29,340 - INFO -   Demographics: 55.0yo ASIAN M
2025-10-13 02:15:29,464 - INFO -   Generated Sequence:
2025-10-13 02:15:29,464 - INFO -     <BOS> <v> 30300 5933 99832 E8227 82123 <END>
2025-10-13 02:15:29,464 - INFO -   Statistics:
2025-10-13 02:15:29,464 - INFO -     Visits: 1
2025-10-13 02:15:29,464 - INFO -     Diagnosis Codes: 7
2025-10-13 02:15:29,464 - INFO -     Avg Codes per Visit: 7.0
2025-10-13 02:15:29,464 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:29,464 - INFO - Patient 6:
2025-10-13 02:15:29,464 - INFO -   Demographics: 80.0yo WHITE F
2025-10-13 02:15:30,049 - INFO -   Generated Sequence:
2025-10-13 02:15:30,049 - INFO -     <BOS> <v> 20150 20150 9551 80111 73381 2531 42971 2859 1270 5559 75559 430 430 82525 29590 <\v> <v> 7197 V1082 70219 V230 48249 2874 30000 2859 V5417 <END>
2025-10-13 02:15:30,049 - INFO -   Statistics:
2025-10-13 02:15:30,049 - INFO -     Visits: 2
2025-10-13 02:15:30,049 - INFO -     Diagnosis Codes: 27
2025-10-13 02:15:30,049 - INFO -     Avg Codes per Visit: 13.5
2025-10-13 02:15:30,049 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:30,049 - INFO - Patient 7:
2025-10-13 02:15:30,049 - INFO -   Demographics: 25.0yo HISPANIC F
2025-10-13 02:15:30,941 - INFO -   Generated Sequence:
2025-10-13 02:15:30,941 - INFO -     <BOS> <v> 430 2929 2929 82032 88002 E8187 86804 2773 85181 71846 48249 8860 2929 7830 E8809 <\v> <v> 30400 E8499 2859 80111 E8508 V3000 80012 27549 41402 E8146 1539 2899 55090 5184 E8499 <\v> <v> V714 48249 48249 7318 7318 7318 80625 80625 <END>
2025-10-13 02:15:30,941 - INFO -   Statistics:
2025-10-13 02:15:30,941 - INFO -     Visits: 3
2025-10-13 02:15:30,941 - INFO -     Diagnosis Codes: 42
2025-10-13 02:15:30,941 - INFO -     Avg Codes per Visit: 14.0
2025-10-13 02:15:30,941 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:30,941 - INFO - Patient 8:
2025-10-13 02:15:30,941 - INFO -   Demographics: 60.0yo BLACK M
2025-10-13 02:15:32,107 - INFO -   Generated Sequence:
2025-10-13 02:15:32,107 - INFO -     <BOS> <v> 25081 5264 07044 42971 42971 42971 42971 2859 48249 2859 59582 V714 V180 5307 25062 <\v> <v> 86113 2859 4299 7718 7718 2899 2899 2899 2839 2859 <\v> <v> 48249 55090 1991 2859 E9585 E9585 E9585 2859 49392 E966 85011 <\v> <v> 07044 8601 2536 430 2859 2859 49392
2025-10-13 02:15:32,107 - INFO -   Statistics:
2025-10-13 02:15:32,107 - INFO -     Visits: 4
2025-10-13 02:15:32,107 - INFO -     Diagnosis Codes: 47
2025-10-13 02:15:32,107 - INFO -     Avg Codes per Visit: 11.8
2025-10-13 02:15:32,107 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:32,107 - INFO - Patient 9:
2025-10-13 02:15:32,107 - INFO -   Demographics: 50.0yo OTHER F
2025-10-13 02:15:32,928 - INFO -   Generated Sequence:
2025-10-13 02:15:32,929 - INFO -     <BOS> <v> 7197 7197 E9585 E9585 E9585 E9585 E9585 85202 48249 55090 7061 V4365 V053 2899 2899 <\v> <v> 3575 E8227 85202 1573 35800 85202 8028 8028 2859 E9342 79902 58389 07044 V1089 2859 <\v> <v> 8860 E8146 49392 4401 <END>
2025-10-13 02:15:32,929 - INFO -   Statistics:
2025-10-13 02:15:32,929 - INFO -     Visits: 3
2025-10-13 02:15:32,929 - INFO -     Diagnosis Codes: 38
2025-10-13 02:15:32,929 - INFO -     Avg Codes per Visit: 12.7
2025-10-13 02:15:32,929 - INFO - 
────────────────────────────────────────────────────────────────────────────────
2025-10-13 02:15:32,929 - INFO - Patient 10:
2025-10-13 02:15:32,929 - INFO -   Demographics: 75.0yo WHITE M
2025-10-13 02:15:33,087 - INFO -   Generated Sequence:
2025-10-13 02:15:33,087 - INFO -     <BOS> <v> 8240 57460 57460 E9502 E9502 80238 V230 <END>
2025-10-13 02:15:33,087 - INFO -   Statistics:
2025-10-13 02:15:33,087 - INFO -     Visits: 1
2025-10-13 02:15:33,087 - INFO -     Diagnosis Codes: 9
2025-10-13 02:15:33,087 - INFO -     Avg Codes per Visit: 9.0
2025-10-13 02:15:33,087 - INFO - 
================================================================================
2025-10-13 02:15:33,087 - INFO - Generation Complete!
2025-10-13 02:15:33,087 - INFO - ================================================================================
