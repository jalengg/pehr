2025-10-13 01:01:51,716 - INFO - ================================================================================
2025-10-13 01:01:51,717 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-13 01:01:51,717 - INFO - ================================================================================
2025-10-13 01:01:51,717 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 16
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda
2025-10-13 01:01:51,727 - INFO - 
Random seed: 42
2025-10-13 01:01:51,987 - INFO - Device: cuda
2025-10-13 01:01:51,988 - INFO - 
================================================================================
2025-10-13 01:01:51,988 - INFO - Loading MIMIC-III Data
2025-10-13 01:01:51,988 - INFO - ================================================================================
2025-10-13 01:01:51,988 - INFO - Loading MIMIC-III data files
2025-10-13 01:01:52,049 - INFO - Loaded 46520 patients
2025-10-13 01:01:52,199 - INFO - Loaded 58976 admissions
2025-10-13 01:01:52,376 - INFO - Loaded 651047 diagnosis records
2025-10-13 01:01:52,657 - INFO - Processing patient records
2025-10-13 01:01:55,205 - INFO - Loaded 3000 patient records
2025-10-13 01:01:55,206 - INFO - Diagnosis vocabulary size: 2823
2025-10-13 01:01:55,207 - INFO - Average visits per patient: 1.27
2025-10-13 01:01:55,207 - INFO - Average codes per visit: 9.27
2025-10-13 01:01:55,208 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-13 01:01:55,209 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-13 01:01:55,226 - INFO - Loaded 3000 patients
2025-10-13 01:01:55,226 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-13 01:01:55,226 - INFO - Tokenizer vocab size: 2829
2025-10-13 01:01:55,226 - INFO - Dataset size: 3000 patients
2025-10-13 01:01:55,226 - INFO - Train size: 2400, Validation size: 600
2025-10-13 01:01:55,227 - INFO - Train batches: 150, Validation batches: 38
2025-10-13 01:01:55,227 - INFO - 
================================================================================
2025-10-13 01:01:55,227 - INFO - Initializing Model
2025-10-13 01:01:55,227 - INFO - ================================================================================
2025-10-13 01:01:55,391 - INFO - BART config vocab size: 2829
2025-10-13 01:01:57,490 - INFO - Total parameters: 102,997,248
2025-10-13 01:01:57,490 - INFO - Trainable parameters: 102,997,248
2025-10-13 01:01:57,492 - INFO - Total training steps: 4500
2025-10-13 01:01:57,492 - INFO - Warmup steps: 500
2025-10-13 01:01:57,492 - INFO - 
================================================================================
2025-10-13 01:01:57,492 - INFO - Starting Training
2025-10-13 01:01:57,492 - INFO - ================================================================================
2025-10-13 01:02:07,358 - INFO - Epoch 1, Step 50/150 - Loss: 6.9795, Perplexity: 1323.7614, LR: 1.00e-05
2025-10-13 01:02:16,936 - INFO - Epoch 1, Step 100/150 - Loss: 6.2147, Perplexity: 789.0978, LR: 2.00e-05
2025-10-13 01:02:26,516 - INFO - Epoch 1, Step 150/150 - Loss: 5.7660, Perplexity: 573.3345, LR: 3.00e-05
2025-10-13 01:02:26,517 - INFO - Epoch 1 Complete - Avg Loss: 5.7660, Avg Perplexity: 573.3345
2025-10-13 01:02:28,781 - INFO - Validation - Loss: 4.6012, Perplexity: 104.5094, Token Accuracy: 0.3205, Code Accuracy: 0.0640
2025-10-13 01:02:28,781 - INFO - New best model! Validation loss: 4.6012
2025-10-13 01:02:32,565 - INFO - Checkpoint saved: epoch 1
2025-10-13 01:02:42,163 - INFO - Epoch 2, Step 50/150 - Loss: 4.4004, Perplexity: 87.5821, LR: 4.00e-05
2025-10-13 01:02:51,742 - INFO - Epoch 2, Step 100/150 - Loss: 4.3532, Perplexity: 84.8713, LR: 5.00e-05
2025-10-13 01:03:01,325 - INFO - Epoch 2, Step 150/150 - Loss: 4.1708, Perplexity: 73.4170, LR: 6.00e-05
2025-10-13 01:03:01,325 - INFO - Epoch 2 Complete - Avg Loss: 4.1708, Avg Perplexity: 73.4170
2025-10-13 01:03:03,563 - INFO - Validation - Loss: 3.5863, Perplexity: 39.1152, Token Accuracy: 0.4419, Code Accuracy: 0.2331
2025-10-13 01:03:03,563 - INFO - New best model! Validation loss: 3.5863
2025-10-13 01:03:07,529 - INFO - Checkpoint saved: epoch 2
2025-10-13 01:03:17,126 - INFO - Epoch 3, Step 50/150 - Loss: 3.1813, Perplexity: 29.0400, LR: 7.00e-05
2025-10-13 01:03:26,700 - INFO - Epoch 3, Step 100/150 - Loss: 2.8358, Perplexity: 22.2423, LR: 8.00e-05
2025-10-13 01:03:36,275 - INFO - Epoch 3, Step 150/150 - Loss: 2.4274, Perplexity: 16.8419, LR: 9.00e-05
2025-10-13 01:03:36,276 - INFO - Epoch 3 Complete - Avg Loss: 2.4274, Avg Perplexity: 16.8419
2025-10-13 01:03:38,511 - INFO - Validation - Loss: 1.2031, Perplexity: 3.8968, Token Accuracy: 0.8698, Code Accuracy: 0.8358
2025-10-13 01:03:38,512 - INFO - New best model! Validation loss: 1.2031
2025-10-13 01:03:42,614 - INFO - Checkpoint saved: epoch 3
2025-10-13 01:03:52,203 - INFO - Epoch 4, Step 50/150 - Loss: 1.1247, Perplexity: 3.6754, LR: 1.00e-04
2025-10-13 01:04:01,780 - INFO - Epoch 4, Step 100/150 - Loss: 0.9538, Perplexity: 3.0621, LR: 9.88e-05
2025-10-13 01:04:11,356 - INFO - Epoch 4, Step 150/150 - Loss: 0.8667, Perplexity: 2.9315, LR: 9.75e-05
2025-10-13 01:04:11,357 - INFO - Epoch 4 Complete - Avg Loss: 0.8667, Avg Perplexity: 2.9315
2025-10-13 01:04:13,593 - INFO - Validation - Loss: 0.5111, Perplexity: 1.8451, Token Accuracy: 0.9486, Code Accuracy: 0.9338
2025-10-13 01:04:13,593 - INFO - New best model! Validation loss: 0.5111
2025-10-13 01:04:17,779 - INFO - Checkpoint saved: epoch 4
2025-10-13 01:04:27,385 - INFO - Epoch 5, Step 50/150 - Loss: 0.5519, Perplexity: 2.1136, LR: 9.63e-05
2025-10-13 01:04:36,960 - INFO - Epoch 5, Step 100/150 - Loss: 0.4726, Perplexity: 1.8784, LR: 9.50e-05
2025-10-13 01:04:46,533 - INFO - Epoch 5, Step 150/150 - Loss: 0.4125, Perplexity: 1.7280, LR: 9.38e-05
2025-10-13 01:04:46,534 - INFO - Epoch 5 Complete - Avg Loss: 0.4125, Avg Perplexity: 1.7280
2025-10-13 01:04:48,770 - INFO - Validation - Loss: 0.3076, Perplexity: 1.4492, Token Accuracy: 0.9697, Code Accuracy: 0.9618
2025-10-13 01:04:48,770 - INFO - New best model! Validation loss: 0.3076
2025-10-13 01:04:52,689 - INFO - Checkpoint saved: epoch 5
2025-10-13 01:05:02,295 - INFO - Epoch 6, Step 50/150 - Loss: 0.2592, Perplexity: 1.3947, LR: 9.25e-05
2025-10-13 01:05:11,868 - INFO - Epoch 6, Step 100/150 - Loss: 0.2515, Perplexity: 1.3950, LR: 9.12e-05
2025-10-13 01:05:21,440 - INFO - Epoch 6, Step 150/150 - Loss: 0.2249, Perplexity: 1.3352, LR: 9.00e-05
2025-10-13 01:05:21,441 - INFO - Epoch 6 Complete - Avg Loss: 0.2249, Avg Perplexity: 1.3352
2025-10-13 01:05:23,675 - INFO - Validation - Loss: 0.1936, Perplexity: 1.2583, Token Accuracy: 0.9827, Code Accuracy: 0.9781
2025-10-13 01:05:23,675 - INFO - New best model! Validation loss: 0.1936
2025-10-13 01:05:27,597 - INFO - Checkpoint saved: epoch 6
2025-10-13 01:05:37,186 - INFO - Epoch 7, Step 50/150 - Loss: 0.1331, Perplexity: 1.2090, LR: 8.88e-05
2025-10-13 01:05:46,757 - INFO - Epoch 7, Step 100/150 - Loss: 0.1530, Perplexity: 1.2310, LR: 8.75e-05
2025-10-13 01:05:56,330 - INFO - Epoch 7, Step 150/150 - Loss: 0.1298, Perplexity: 1.1873, LR: 8.63e-05
2025-10-13 01:05:56,331 - INFO - Epoch 7 Complete - Avg Loss: 0.1298, Avg Perplexity: 1.1873
2025-10-13 01:05:58,566 - INFO - Validation - Loss: 0.1471, Perplexity: 1.1829, Token Accuracy: 0.9877, Code Accuracy: 0.9847
2025-10-13 01:05:58,566 - INFO - New best model! Validation loss: 0.1471
2025-10-13 01:06:02,599 - INFO - Checkpoint saved: epoch 7
2025-10-13 01:06:12,188 - INFO - Epoch 8, Step 50/150 - Loss: 0.0879, Perplexity: 1.1070, LR: 8.50e-05
2025-10-13 01:06:21,761 - INFO - Epoch 8, Step 100/150 - Loss: 0.0812, Perplexity: 1.0956, LR: 8.38e-05
2025-10-13 01:06:31,334 - INFO - Epoch 8, Step 150/150 - Loss: 0.0824, Perplexity: 1.1047, LR: 8.25e-05
2025-10-13 01:06:31,334 - INFO - Epoch 8 Complete - Avg Loss: 0.0824, Avg Perplexity: 1.1047
2025-10-13 01:06:33,570 - INFO - Validation - Loss: 0.1155, Perplexity: 1.1341, Token Accuracy: 0.9924, Code Accuracy: 0.9901
2025-10-13 01:06:33,570 - INFO - New best model! Validation loss: 0.1155
2025-10-13 01:24:54,736 - INFO - ================================================================================
2025-10-13 01:24:54,736 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-13 01:24:54,736 - INFO - ================================================================================
2025-10-13 01:24:54,736 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 16
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda
2025-10-13 01:24:54,740 - INFO - 
Random seed: 42
2025-10-13 01:24:54,998 - INFO - Device: cuda
2025-10-13 01:24:54,998 - INFO - 
================================================================================
2025-10-13 01:24:54,998 - INFO - Loading MIMIC-III Data
2025-10-13 01:24:54,998 - INFO - ================================================================================
2025-10-13 01:24:54,998 - INFO - Loading MIMIC-III data files
2025-10-13 01:24:55,060 - INFO - Loaded 46520 patients
2025-10-13 01:24:55,208 - INFO - Loaded 58976 admissions
2025-10-13 01:24:55,374 - INFO - Loaded 651047 diagnosis records
2025-10-13 01:24:55,649 - INFO - Processing patient records
2025-10-13 01:24:58,155 - INFO - Loaded 3000 patient records
2025-10-13 01:24:58,155 - INFO - Diagnosis vocabulary size: 2823
2025-10-13 01:24:58,156 - INFO - Average visits per patient: 1.27
2025-10-13 01:24:58,156 - INFO - Average codes per visit: 9.27
2025-10-13 01:24:58,157 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-13 01:24:58,158 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-13 01:24:58,180 - INFO - Loaded 3000 patients
2025-10-13 01:24:58,180 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-13 01:24:58,180 - INFO - Tokenizer vocab size: 2829
2025-10-13 01:24:58,180 - INFO - Dataset size: 3000 patients
2025-10-13 01:24:58,181 - INFO - Train size: 2400, Validation size: 600
2025-10-13 01:24:58,181 - INFO - Train batches: 150, Validation batches: 38
2025-10-13 01:24:58,181 - INFO - 
================================================================================
2025-10-13 01:24:58,181 - INFO - Initializing Model
2025-10-13 01:24:58,181 - INFO - ================================================================================
2025-10-13 01:24:58,281 - INFO - BART config vocab size: 2829
2025-10-13 01:25:00,572 - INFO - Total parameters: 102,997,248
2025-10-13 01:25:00,572 - INFO - Trainable parameters: 102,997,248
2025-10-13 01:25:00,573 - INFO - Total training steps: 4500
2025-10-13 01:25:00,573 - INFO - Warmup steps: 500
2025-10-13 01:25:00,574 - INFO - 
================================================================================
2025-10-13 01:25:00,574 - INFO - Starting Training
2025-10-13 01:25:00,574 - INFO - ================================================================================
2025-10-13 01:25:10,300 - INFO - Epoch 1, Step 50/150 - Loss: 6.9795, Perplexity: 1323.7613, LR: 1.00e-05
2025-10-13 01:25:19,880 - INFO - Epoch 1, Step 100/150 - Loss: 6.2147, Perplexity: 789.0978, LR: 2.00e-05
2025-10-13 01:25:29,463 - INFO - Epoch 1, Step 150/150 - Loss: 5.7660, Perplexity: 573.3345, LR: 3.00e-05
2025-10-13 01:25:29,463 - INFO - Epoch 1 Complete - Avg Loss: 5.7660, Avg Perplexity: 573.3345
2025-10-13 01:25:31,710 - INFO - Validation - Loss: 4.6012, Perplexity: 104.5094, Token Accuracy: 0.3205, Code Accuracy: 0.0640
2025-10-13 01:25:31,710 - INFO - New best model! Validation loss: 4.6012
2025-10-13 01:25:35,476 - INFO - Checkpoint saved: epoch 1
2025-10-13 01:25:45,088 - INFO - Epoch 2, Step 50/150 - Loss: 4.4004, Perplexity: 87.5821, LR: 4.00e-05
2025-10-13 01:25:54,669 - INFO - Epoch 2, Step 100/150 - Loss: 4.3532, Perplexity: 84.8713, LR: 5.00e-05
2025-10-13 01:26:04,253 - INFO - Epoch 2, Step 150/150 - Loss: 4.1708, Perplexity: 73.4170, LR: 6.00e-05
2025-10-13 01:26:04,253 - INFO - Epoch 2 Complete - Avg Loss: 4.1708, Avg Perplexity: 73.4170
2025-10-13 01:26:06,493 - INFO - Validation - Loss: 3.5863, Perplexity: 39.1152, Token Accuracy: 0.4419, Code Accuracy: 0.2331
2025-10-13 01:26:06,493 - INFO - New best model! Validation loss: 3.5863
2025-10-13 01:26:10,311 - INFO - Checkpoint saved: epoch 2
2025-10-13 01:26:19,911 - INFO - Epoch 3, Step 50/150 - Loss: 3.1813, Perplexity: 29.0400, LR: 7.00e-05
2025-10-13 01:26:29,490 - INFO - Epoch 3, Step 100/150 - Loss: 2.8358, Perplexity: 22.2423, LR: 8.00e-05
2025-10-13 01:26:39,069 - INFO - Epoch 3, Step 150/150 - Loss: 2.4274, Perplexity: 16.8419, LR: 9.00e-05
2025-10-13 01:26:39,070 - INFO - Epoch 3 Complete - Avg Loss: 2.4274, Avg Perplexity: 16.8419
2025-10-13 01:26:41,308 - INFO - Validation - Loss: 1.2031, Perplexity: 3.8968, Token Accuracy: 0.8698, Code Accuracy: 0.8358
2025-10-13 01:26:41,308 - INFO - New best model! Validation loss: 1.2031
2025-10-13 01:26:45,312 - INFO - Checkpoint saved: epoch 3
2025-10-13 01:26:54,910 - INFO - Epoch 4, Step 50/150 - Loss: 1.1247, Perplexity: 3.6754, LR: 1.00e-04
2025-10-13 01:27:04,490 - INFO - Epoch 4, Step 100/150 - Loss: 0.9538, Perplexity: 3.0622, LR: 9.88e-05
2025-10-13 01:27:14,067 - INFO - Epoch 4, Step 150/150 - Loss: 0.8670, Perplexity: 2.9322, LR: 9.75e-05
2025-10-13 01:27:14,068 - INFO - Epoch 4 Complete - Avg Loss: 0.8670, Avg Perplexity: 2.9322
2025-10-13 01:27:16,305 - INFO - Validation - Loss: 0.5117, Perplexity: 1.8459, Token Accuracy: 0.9487, Code Accuracy: 0.9340
2025-10-13 01:27:16,305 - INFO - New best model! Validation loss: 0.5117
2025-10-13 01:27:19,941 - INFO - Checkpoint saved: epoch 4
2025-10-13 01:27:29,539 - INFO - Epoch 5, Step 50/150 - Loss: 0.5525, Perplexity: 2.1145, LR: 9.63e-05
2025-10-13 01:27:39,117 - INFO - Epoch 5, Step 100/150 - Loss: 0.4707, Perplexity: 1.8752, LR: 9.50e-05
2025-10-13 01:27:48,691 - INFO - Epoch 5, Step 150/150 - Loss: 0.4126, Perplexity: 1.7261, LR: 9.38e-05
2025-10-13 01:27:48,692 - INFO - Epoch 5 Complete - Avg Loss: 0.4126, Avg Perplexity: 1.7261
2025-10-13 01:27:50,928 - INFO - Validation - Loss: 0.3117, Perplexity: 1.4625, Token Accuracy: 0.9676, Code Accuracy: 0.9597
2025-10-13 01:27:50,929 - INFO - New best model! Validation loss: 0.3117
2025-10-13 01:27:54,682 - INFO - Checkpoint saved: epoch 5
2025-10-13 01:28:04,290 - INFO - Epoch 6, Step 50/150 - Loss: 0.2602, Perplexity: 1.3998, LR: 9.25e-05
2025-10-13 01:28:13,867 - INFO - Epoch 6, Step 100/150 - Loss: 0.2477, Perplexity: 1.3891, LR: 9.12e-05
2025-10-13 01:28:23,441 - INFO - Epoch 6, Step 150/150 - Loss: 0.2231, Perplexity: 1.3322, LR: 9.00e-05
2025-10-13 01:28:23,442 - INFO - Epoch 6 Complete - Avg Loss: 0.2231, Avg Perplexity: 1.3322
2025-10-13 01:28:25,679 - INFO - Validation - Loss: 0.2046, Perplexity: 1.2777, Token Accuracy: 0.9811, Code Accuracy: 0.9764
2025-10-13 01:28:25,679 - INFO - New best model! Validation loss: 0.2046
2025-10-13 01:28:29,724 - INFO - Checkpoint saved: epoch 6
2025-10-13 01:28:39,323 - INFO - Epoch 7, Step 50/150 - Loss: 0.1315, Perplexity: 1.1958, LR: 8.88e-05
2025-10-13 01:28:48,899 - INFO - Epoch 7, Step 100/150 - Loss: 0.1505, Perplexity: 1.2219, LR: 8.75e-05
2025-10-13 01:28:58,474 - INFO - Epoch 7, Step 150/150 - Loss: 0.1273, Perplexity: 1.1805, LR: 8.63e-05
2025-10-13 01:28:58,475 - INFO - Epoch 7 Complete - Avg Loss: 0.1273, Avg Perplexity: 1.1805
2025-10-13 01:29:00,717 - INFO - Validation - Loss: 0.1420, Perplexity: 1.1805, Token Accuracy: 0.9880, Code Accuracy: 0.9848
2025-10-13 01:29:00,717 - INFO - New best model! Validation loss: 0.1420
2025-10-13 01:29:04,979 - INFO - Checkpoint saved: epoch 7
2025-10-13 01:29:14,604 - INFO - Epoch 8, Step 50/150 - Loss: 0.0871, Perplexity: 1.1052, LR: 8.50e-05
2025-10-13 01:29:24,180 - INFO - Epoch 8, Step 100/150 - Loss: 0.0808, Perplexity: 1.0948, LR: 8.38e-05
2025-10-13 01:29:33,758 - INFO - Epoch 8, Step 150/150 - Loss: 0.0807, Perplexity: 1.1008, LR: 8.25e-05
2025-10-13 01:29:33,759 - INFO - Epoch 8 Complete - Avg Loss: 0.0807, Avg Perplexity: 1.1008
2025-10-13 01:29:35,995 - INFO - Validation - Loss: 0.1065, Perplexity: 1.1246, Token Accuracy: 0.9929, Code Accuracy: 0.9906
2025-10-13 01:29:35,995 - INFO - New best model! Validation loss: 0.1065
2025-10-13 01:29:40,165 - INFO - Checkpoint saved: epoch 8
2025-10-13 01:29:49,757 - INFO - Epoch 9, Step 50/150 - Loss: 0.0466, Perplexity: 1.0519, LR: 8.13e-05
2025-10-13 01:29:59,331 - INFO - Epoch 9, Step 100/150 - Loss: 0.0423, Perplexity: 1.0459, LR: 8.00e-05
2025-10-13 01:30:08,911 - INFO - Epoch 9, Step 150/150 - Loss: 0.0533, Perplexity: 1.0625, LR: 7.88e-05
2025-10-13 01:30:08,912 - INFO - Epoch 9 Complete - Avg Loss: 0.0533, Avg Perplexity: 1.0625
2025-10-13 01:30:11,148 - INFO - Validation - Loss: 0.0949, Perplexity: 1.1058, Token Accuracy: 0.9949, Code Accuracy: 0.9937
2025-10-13 01:30:11,148 - INFO - New best model! Validation loss: 0.0949
2025-10-13 01:30:15,342 - INFO - Checkpoint saved: epoch 9
2025-10-13 01:30:24,989 - INFO - Epoch 10, Step 50/150 - Loss: 0.0250, Perplexity: 1.0258, LR: 7.75e-05
2025-10-13 01:30:34,565 - INFO - Epoch 10, Step 100/150 - Loss: 0.0282, Perplexity: 1.0297, LR: 7.62e-05
2025-10-13 01:30:44,139 - INFO - Epoch 10, Step 150/150 - Loss: 0.0370, Perplexity: 1.0413, LR: 7.50e-05
2025-10-13 01:30:44,139 - INFO - Epoch 10 Complete - Avg Loss: 0.0370, Avg Perplexity: 1.0413
2025-10-13 01:30:46,375 - INFO - Validation - Loss: 0.0956, Perplexity: 1.1065, Token Accuracy: 0.9953, Code Accuracy: 0.9940
2025-10-13 01:30:48,546 - INFO - Checkpoint saved: epoch 10
2025-10-13 01:30:58,137 - INFO - Epoch 11, Step 50/150 - Loss: 0.0226, Perplexity: 1.0235, LR: 7.38e-05
2025-10-13 01:31:07,716 - INFO - Epoch 11, Step 100/150 - Loss: 0.0206, Perplexity: 1.0213, LR: 7.25e-05
2025-10-13 01:31:17,289 - INFO - Epoch 11, Step 150/150 - Loss: 0.0262, Perplexity: 1.0282, LR: 7.13e-05
2025-10-13 01:31:17,290 - INFO - Epoch 11 Complete - Avg Loss: 0.0262, Avg Perplexity: 1.0282
2025-10-13 01:31:19,525 - INFO - Validation - Loss: 0.0800, Perplexity: 1.0866, Token Accuracy: 0.9961, Code Accuracy: 0.9951
2025-10-13 01:31:19,525 - INFO - New best model! Validation loss: 0.0800
2025-10-13 01:31:23,657 - INFO - Checkpoint saved: epoch 11
2025-10-13 01:31:33,257 - INFO - Epoch 12, Step 50/150 - Loss: 0.0106, Perplexity: 1.0107, LR: 7.00e-05
2025-10-13 01:31:42,831 - INFO - Epoch 12, Step 100/150 - Loss: 0.0159, Perplexity: 1.0163, LR: 6.88e-05
2025-10-13 01:31:52,405 - INFO - Epoch 12, Step 150/150 - Loss: 0.0187, Perplexity: 1.0197, LR: 6.75e-05
2025-10-13 01:31:52,406 - INFO - Epoch 12 Complete - Avg Loss: 0.0187, Avg Perplexity: 1.0197
2025-10-13 01:31:54,643 - INFO - Validation - Loss: 0.0771, Perplexity: 1.0828, Token Accuracy: 0.9968, Code Accuracy: 0.9961
2025-10-13 01:31:54,643 - INFO - New best model! Validation loss: 0.0771
2025-10-13 01:31:58,803 - INFO - Checkpoint saved: epoch 12
2025-10-13 01:32:08,395 - INFO - Epoch 13, Step 50/150 - Loss: 0.0126, Perplexity: 1.0127, LR: 6.62e-05
2025-10-13 01:32:17,969 - INFO - Epoch 13, Step 100/150 - Loss: 0.0110, Perplexity: 1.0111, LR: 6.50e-05
2025-10-13 01:32:27,544 - INFO - Epoch 13, Step 150/150 - Loss: 0.0141, Perplexity: 1.0146, LR: 6.38e-05
2025-10-13 01:32:27,545 - INFO - Epoch 13 Complete - Avg Loss: 0.0141, Avg Perplexity: 1.0146
2025-10-13 01:32:29,782 - INFO - Validation - Loss: 0.0750, Perplexity: 1.0803, Token Accuracy: 0.9970, Code Accuracy: 0.9962
2025-10-13 01:32:29,782 - INFO - New best model! Validation loss: 0.0750
2025-10-13 01:32:33,992 - INFO - Checkpoint saved: epoch 13
2025-10-13 01:32:43,580 - INFO - Epoch 14, Step 50/150 - Loss: 0.0084, Perplexity: 1.0085, LR: 6.25e-05
2025-10-13 01:32:53,157 - INFO - Epoch 14, Step 100/150 - Loss: 0.0097, Perplexity: 1.0100, LR: 6.13e-05
2025-10-13 01:33:02,738 - INFO - Epoch 14, Step 150/150 - Loss: 0.0103, Perplexity: 1.0106, LR: 6.00e-05
2025-10-13 01:33:02,738 - INFO - Epoch 14 Complete - Avg Loss: 0.0103, Avg Perplexity: 1.0106
2025-10-13 01:33:04,976 - INFO - Validation - Loss: 0.0727, Perplexity: 1.0775, Token Accuracy: 0.9972, Code Accuracy: 0.9963
2025-10-13 01:33:04,977 - INFO - New best model! Validation loss: 0.0727
2025-10-13 01:33:09,009 - INFO - Checkpoint saved: epoch 14
2025-10-13 01:33:18,619 - INFO - Epoch 15, Step 50/150 - Loss: 0.0105, Perplexity: 1.0107, LR: 5.88e-05
2025-10-13 01:33:28,193 - INFO - Epoch 15, Step 100/150 - Loss: 0.0097, Perplexity: 1.0098, LR: 5.75e-05
2025-10-13 01:33:37,767 - INFO - Epoch 15, Step 150/150 - Loss: 0.0091, Perplexity: 1.0092, LR: 5.63e-05
2025-10-13 01:33:37,768 - INFO - Epoch 15 Complete - Avg Loss: 0.0091, Avg Perplexity: 1.0092
2025-10-13 01:33:40,004 - INFO - Validation - Loss: 0.0711, Perplexity: 1.0758, Token Accuracy: 0.9975, Code Accuracy: 0.9967
2025-10-13 01:33:40,004 - INFO - New best model! Validation loss: 0.0711
2025-10-13 01:33:44,559 - INFO - Checkpoint saved: epoch 15
2025-10-13 01:33:54,196 - INFO - Epoch 16, Step 50/150 - Loss: 0.0080, Perplexity: 1.0082, LR: 5.50e-05
2025-10-13 01:34:03,776 - INFO - Epoch 16, Step 100/150 - Loss: 0.0072, Perplexity: 1.0073, LR: 5.37e-05
2025-10-13 01:34:13,349 - INFO - Epoch 16, Step 150/150 - Loss: 0.0066, Perplexity: 1.0067, LR: 5.25e-05
2025-10-13 01:34:13,350 - INFO - Epoch 16 Complete - Avg Loss: 0.0066, Avg Perplexity: 1.0067
2025-10-13 01:34:15,587 - INFO - Validation - Loss: 0.0658, Perplexity: 1.0699, Token Accuracy: 0.9979, Code Accuracy: 0.9973
2025-10-13 01:34:15,587 - INFO - New best model! Validation loss: 0.0658
2025-10-13 01:34:19,769 - INFO - Checkpoint saved: epoch 16
2025-10-13 01:34:29,355 - INFO - Epoch 17, Step 50/150 - Loss: 0.0037, Perplexity: 1.0037, LR: 5.12e-05
2025-10-13 01:34:38,931 - INFO - Epoch 17, Step 100/150 - Loss: 0.0060, Perplexity: 1.0061, LR: 5.00e-05
2025-10-13 01:34:48,504 - INFO - Epoch 17, Step 150/150 - Loss: 0.0060, Perplexity: 1.0060, LR: 4.87e-05
2025-10-13 01:34:48,505 - INFO - Epoch 17 Complete - Avg Loss: 0.0060, Avg Perplexity: 1.0060
2025-10-13 01:34:50,740 - INFO - Validation - Loss: 0.0663, Perplexity: 1.0700, Token Accuracy: 0.9981, Code Accuracy: 0.9975
2025-10-13 01:35:00,319 - INFO - Epoch 18, Step 50/150 - Loss: 0.0047, Perplexity: 1.0047, LR: 4.75e-05
2025-10-13 01:35:09,896 - INFO - Epoch 18, Step 100/150 - Loss: 0.0045, Perplexity: 1.0045, LR: 4.63e-05
2025-10-13 01:35:19,474 - INFO - Epoch 18, Step 150/150 - Loss: 0.0050, Perplexity: 1.0050, LR: 4.50e-05
2025-10-13 01:35:19,475 - INFO - Epoch 18 Complete - Avg Loss: 0.0050, Avg Perplexity: 1.0050
2025-10-13 01:35:21,711 - INFO - Validation - Loss: 0.0669, Perplexity: 1.0708, Token Accuracy: 0.9980, Code Accuracy: 0.9973
2025-10-13 01:35:31,285 - INFO - Epoch 19, Step 50/150 - Loss: 0.0045, Perplexity: 1.0045, LR: 4.37e-05
2025-10-13 01:35:40,858 - INFO - Epoch 19, Step 100/150 - Loss: 0.0051, Perplexity: 1.0052, LR: 4.25e-05
2025-10-13 01:35:50,432 - INFO - Epoch 19, Step 150/150 - Loss: 0.0054, Perplexity: 1.0054, LR: 4.12e-05
2025-10-13 01:35:50,433 - INFO - Epoch 19 Complete - Avg Loss: 0.0054, Avg Perplexity: 1.0054
2025-10-13 01:35:52,667 - INFO - Validation - Loss: 0.0691, Perplexity: 1.0732, Token Accuracy: 0.9974, Code Accuracy: 0.9966
2025-10-13 01:36:02,247 - INFO - Epoch 20, Step 50/150 - Loss: 0.0046, Perplexity: 1.0046, LR: 4.00e-05
2025-10-13 01:36:11,821 - INFO - Epoch 20, Step 100/150 - Loss: 0.0058, Perplexity: 1.0058, LR: 3.87e-05
2025-10-13 01:36:21,395 - INFO - Epoch 20, Step 150/150 - Loss: 0.0052, Perplexity: 1.0053, LR: 3.75e-05
2025-10-13 01:36:21,396 - INFO - Epoch 20 Complete - Avg Loss: 0.0052, Avg Perplexity: 1.0053
2025-10-13 01:36:23,631 - INFO - Validation - Loss: 0.0674, Perplexity: 1.0717, Token Accuracy: 0.9977, Code Accuracy: 0.9971
2025-10-13 01:36:25,549 - INFO - Checkpoint saved: epoch 20
2025-10-13 01:36:35,143 - INFO - Epoch 21, Step 50/150 - Loss: 0.0034, Perplexity: 1.0034, LR: 3.63e-05
2025-10-13 01:36:44,718 - INFO - Epoch 21, Step 100/150 - Loss: 0.0034, Perplexity: 1.0035, LR: 3.50e-05
2025-10-13 01:36:54,292 - INFO - Epoch 21, Step 150/150 - Loss: 0.0033, Perplexity: 1.0033, LR: 3.38e-05
2025-10-13 01:36:54,293 - INFO - Epoch 21 Complete - Avg Loss: 0.0033, Avg Perplexity: 1.0033
2025-10-13 01:36:56,529 - INFO - Validation - Loss: 0.0626, Perplexity: 1.0662, Token Accuracy: 0.9982, Code Accuracy: 0.9976
2025-10-13 01:36:56,529 - INFO - New best model! Validation loss: 0.0626
2025-10-13 01:37:00,936 - INFO - Checkpoint saved: epoch 21
2025-10-13 01:37:10,529 - INFO - Epoch 22, Step 50/150 - Loss: 0.0034, Perplexity: 1.0035, LR: 3.25e-05
2025-10-13 01:37:20,103 - INFO - Epoch 22, Step 100/150 - Loss: 0.0034, Perplexity: 1.0034, LR: 3.13e-05
2025-10-13 01:37:29,676 - INFO - Epoch 22, Step 150/150 - Loss: 0.0032, Perplexity: 1.0032, LR: 3.00e-05
2025-10-13 01:37:29,677 - INFO - Epoch 22 Complete - Avg Loss: 0.0032, Avg Perplexity: 1.0032
2025-10-13 01:37:31,912 - INFO - Validation - Loss: 0.0606, Perplexity: 1.0641, Token Accuracy: 0.9984, Code Accuracy: 0.9978
2025-10-13 01:37:31,912 - INFO - New best model! Validation loss: 0.0606
2025-10-13 01:37:35,741 - INFO - Checkpoint saved: epoch 22
2025-10-13 01:37:45,335 - INFO - Epoch 23, Step 50/150 - Loss: 0.0020, Perplexity: 1.0020, LR: 2.87e-05
2025-10-13 01:37:54,908 - INFO - Epoch 23, Step 100/150 - Loss: 0.0022, Perplexity: 1.0022, LR: 2.75e-05
2025-10-13 01:38:04,486 - INFO - Epoch 23, Step 150/150 - Loss: 0.0023, Perplexity: 1.0023, LR: 2.63e-05
2025-10-13 01:38:04,486 - INFO - Epoch 23 Complete - Avg Loss: 0.0023, Avg Perplexity: 1.0023
2025-10-13 01:38:06,723 - INFO - Validation - Loss: 0.0596, Perplexity: 1.0631, Token Accuracy: 0.9983, Code Accuracy: 0.9977
2025-10-13 01:38:06,723 - INFO - New best model! Validation loss: 0.0596
2025-10-13 01:38:10,710 - INFO - Checkpoint saved: epoch 23
2025-10-13 01:38:20,306 - INFO - Epoch 24, Step 50/150 - Loss: 0.0022, Perplexity: 1.0022, LR: 2.50e-05
2025-10-13 01:38:29,878 - INFO - Epoch 24, Step 100/150 - Loss: 0.0020, Perplexity: 1.0020, LR: 2.38e-05
2025-10-13 01:38:39,451 - INFO - Epoch 24, Step 150/150 - Loss: 0.0020, Perplexity: 1.0020, LR: 2.25e-05
2025-10-13 01:38:39,452 - INFO - Epoch 24 Complete - Avg Loss: 0.0020, Avg Perplexity: 1.0020
2025-10-13 01:38:41,689 - INFO - Validation - Loss: 0.0581, Perplexity: 1.0614, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:38:41,689 - INFO - New best model! Validation loss: 0.0581
2025-10-13 01:38:45,634 - INFO - Checkpoint saved: epoch 24
2025-10-13 01:38:55,235 - INFO - Epoch 25, Step 50/150 - Loss: 0.0019, Perplexity: 1.0019, LR: 2.13e-05
2025-10-13 01:39:04,816 - INFO - Epoch 25, Step 100/150 - Loss: 0.0018, Perplexity: 1.0018, LR: 2.00e-05
2025-10-13 01:39:14,389 - INFO - Epoch 25, Step 150/150 - Loss: 0.0019, Perplexity: 1.0019, LR: 1.88e-05
2025-10-13 01:39:14,390 - INFO - Epoch 25 Complete - Avg Loss: 0.0019, Avg Perplexity: 1.0019
2025-10-13 01:39:16,626 - INFO - Validation - Loss: 0.0573, Perplexity: 1.0605, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:39:16,626 - INFO - New best model! Validation loss: 0.0573
2025-10-13 01:39:20,561 - INFO - Checkpoint saved: epoch 25
2025-10-13 01:39:30,151 - INFO - Epoch 26, Step 50/150 - Loss: 0.0017, Perplexity: 1.0017, LR: 1.75e-05
2025-10-13 01:39:39,724 - INFO - Epoch 26, Step 100/150 - Loss: 0.0018, Perplexity: 1.0018, LR: 1.63e-05
2025-10-13 01:39:49,297 - INFO - Epoch 26, Step 150/150 - Loss: 0.0017, Perplexity: 1.0018, LR: 1.50e-05
2025-10-13 01:39:49,298 - INFO - Epoch 26 Complete - Avg Loss: 0.0017, Avg Perplexity: 1.0018
2025-10-13 01:39:51,533 - INFO - Validation - Loss: 0.0567, Perplexity: 1.0599, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:39:51,534 - INFO - New best model! Validation loss: 0.0567
2025-10-13 01:39:55,342 - INFO - Checkpoint saved: epoch 26
2025-10-13 01:40:04,939 - INFO - Epoch 27, Step 50/150 - Loss: 0.0017, Perplexity: 1.0017, LR: 1.38e-05
2025-10-13 01:40:14,511 - INFO - Epoch 27, Step 100/150 - Loss: 0.0017, Perplexity: 1.0017, LR: 1.25e-05
2025-10-13 01:40:24,084 - INFO - Epoch 27, Step 150/150 - Loss: 0.0017, Perplexity: 1.0017, LR: 1.13e-05
2025-10-13 01:40:24,085 - INFO - Epoch 27 Complete - Avg Loss: 0.0017, Avg Perplexity: 1.0017
2025-10-13 01:40:26,320 - INFO - Validation - Loss: 0.0565, Perplexity: 1.0596, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:40:26,320 - INFO - New best model! Validation loss: 0.0565
2025-10-13 01:40:30,186 - INFO - Checkpoint saved: epoch 27
2025-10-13 01:40:39,776 - INFO - Epoch 28, Step 50/150 - Loss: 0.0015, Perplexity: 1.0015, LR: 1.00e-05
2025-10-13 01:40:49,348 - INFO - Epoch 28, Step 100/150 - Loss: 0.0016, Perplexity: 1.0016, LR: 8.75e-06
2025-10-13 01:40:58,920 - INFO - Epoch 28, Step 150/150 - Loss: 0.0016, Perplexity: 1.0016, LR: 7.50e-06
2025-10-13 01:40:58,921 - INFO - Epoch 28 Complete - Avg Loss: 0.0016, Avg Perplexity: 1.0016
2025-10-13 01:41:01,163 - INFO - Validation - Loss: 0.0562, Perplexity: 1.0593, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:41:01,163 - INFO - New best model! Validation loss: 0.0562
2025-10-13 01:41:05,118 - INFO - Checkpoint saved: epoch 28
2025-10-13 01:41:14,712 - INFO - Epoch 29, Step 50/150 - Loss: 0.0016, Perplexity: 1.0016, LR: 6.25e-06
2025-10-13 01:41:24,288 - INFO - Epoch 29, Step 100/150 - Loss: 0.0017, Perplexity: 1.0017, LR: 5.00e-06
2025-10-13 01:41:33,862 - INFO - Epoch 29, Step 150/150 - Loss: 0.0016, Perplexity: 1.0016, LR: 3.75e-06
2025-10-13 01:41:33,862 - INFO - Epoch 29 Complete - Avg Loss: 0.0016, Avg Perplexity: 1.0016
2025-10-13 01:41:36,098 - INFO - Validation - Loss: 0.0560, Perplexity: 1.0591, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:41:36,098 - INFO - New best model! Validation loss: 0.0560
2025-10-13 01:41:40,032 - INFO - Checkpoint saved: epoch 29
2025-10-13 01:41:49,632 - INFO - Epoch 30, Step 50/150 - Loss: 0.0013, Perplexity: 1.0013, LR: 2.50e-06
2025-10-13 01:41:59,205 - INFO - Epoch 30, Step 100/150 - Loss: 0.0015, Perplexity: 1.0015, LR: 1.25e-06
2025-10-13 01:42:08,784 - INFO - Epoch 30, Step 150/150 - Loss: 0.0016, Perplexity: 1.0016, LR: 0.00e+00
2025-10-13 01:42:08,785 - INFO - Epoch 30 Complete - Avg Loss: 0.0016, Avg Perplexity: 1.0016
2025-10-13 01:42:11,020 - INFO - Validation - Loss: 0.0560, Perplexity: 1.0590, Token Accuracy: 0.9985, Code Accuracy: 0.9979
2025-10-13 01:42:11,020 - INFO - New best model! Validation loss: 0.0560
2025-10-13 01:42:15,061 - INFO - Checkpoint saved: epoch 30
2025-10-13 01:42:15,061 - INFO - 
================================================================================
2025-10-13 01:42:15,061 - INFO - Training Complete!
2025-10-13 01:42:15,061 - INFO - ================================================================================
2025-10-13 01:42:15,061 - INFO - Best validation loss: 0.0560
2025-10-13 01:42:15,061 - INFO - Best validation perplexity: 1.0575
2025-10-17 04:23:05,716 - INFO - ================================================================================
2025-10-17 04:23:05,716 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-17 04:23:05,716 - INFO - ================================================================================
2025-10-17 04:23:05,717 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-17 04:23:05,728 - INFO - 
Random seed: 42
2025-10-17 04:23:06,010 - INFO - Device: cuda
2025-10-17 04:23:06,010 - INFO - 
================================================================================
2025-10-17 04:23:06,010 - INFO - Loading MIMIC-III Data
2025-10-17 04:23:06,010 - INFO - ================================================================================
2025-10-17 04:23:06,010 - INFO - Loading MIMIC-III data files
2025-10-17 04:23:06,095 - INFO - Loaded 46520 patients
2025-10-17 04:23:06,290 - INFO - Loaded 58976 admissions
2025-10-17 04:23:06,531 - INFO - Loaded 651047 diagnosis records
2025-10-17 04:23:06,842 - INFO - Processing patient records
2025-10-17 04:23:09,407 - INFO - Loaded 3000 patient records
2025-10-17 04:23:09,407 - INFO - Diagnosis vocabulary size: 2823
2025-10-17 04:23:09,409 - INFO - Average visits per patient: 1.27
2025-10-17 04:23:09,409 - INFO - Average codes per visit: 9.27
2025-10-17 04:23:09,410 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-17 04:23:09,411 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-17 04:23:09,426 - INFO - Loaded 3000 patients
2025-10-17 04:23:09,427 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-17 04:23:09,427 - INFO - Tokenizer vocab size: 2830
2025-10-17 04:23:09,427 - INFO - Dataset size: 3000 patients
2025-10-17 04:23:09,431 - INFO - Train size: 2400, Validation size: 600
2025-10-17 04:23:09,432 - INFO - Train batches: 300, Validation batches: 75
2025-10-17 04:23:09,432 - INFO - 
================================================================================
2025-10-17 04:23:09,432 - INFO - Initializing Model
2025-10-17 04:23:09,432 - INFO - ================================================================================
2025-10-17 04:23:09,549 - INFO - BART config vocab size: 2830
2025-10-17 04:23:11,672 - INFO - Total parameters: 102,998,016
2025-10-17 04:23:11,672 - INFO - Trainable parameters: 102,998,016
2025-10-17 04:23:11,673 - INFO - Total training steps: 9000
2025-10-17 04:23:11,673 - INFO - Warmup steps: 500
2025-10-17 04:23:11,673 - INFO - 
================================================================================
2025-10-17 04:23:11,673 - INFO - Starting Training
2025-10-17 04:23:11,674 - INFO - ================================================================================
2025-10-17 04:31:59,953 - INFO - ================================================================================
2025-10-17 04:31:59,954 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-17 04:31:59,954 - INFO - ================================================================================
2025-10-17 04:31:59,954 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-17 04:31:59,957 - INFO - 
Random seed: 42
2025-10-17 04:32:00,232 - INFO - Device: cuda
2025-10-17 04:32:00,233 - INFO - 
================================================================================
2025-10-17 04:32:00,233 - INFO - Loading MIMIC-III Data
2025-10-17 04:32:00,233 - INFO - ================================================================================
2025-10-17 04:32:00,233 - INFO - Loading MIMIC-III data files
2025-10-17 04:32:00,293 - INFO - Loaded 46520 patients
2025-10-17 04:32:00,447 - INFO - Loaded 58976 admissions
2025-10-17 04:32:00,617 - INFO - Loaded 651047 diagnosis records
2025-10-17 04:32:00,902 - INFO - Processing patient records
2025-10-17 04:32:03,420 - INFO - Loaded 3000 patient records
2025-10-17 04:32:03,421 - INFO - Diagnosis vocabulary size: 2823
2025-10-17 04:32:03,422 - INFO - Average visits per patient: 1.27
2025-10-17 04:32:03,423 - INFO - Average codes per visit: 9.27
2025-10-17 04:32:03,424 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-17 04:32:03,424 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-17 04:32:03,447 - INFO - Loaded 3000 patients
2025-10-17 04:32:03,447 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-17 04:32:03,447 - INFO - Tokenizer vocab size: 2830
2025-10-17 04:32:03,447 - INFO - Dataset size: 3000 patients
2025-10-17 04:32:03,447 - INFO - Train size: 2400, Validation size: 600
2025-10-17 04:32:03,448 - INFO - Train batches: 300, Validation batches: 75
2025-10-17 04:32:03,448 - INFO - 
================================================================================
2025-10-17 04:32:03,448 - INFO - Initializing Model
2025-10-17 04:32:03,448 - INFO - ================================================================================
2025-10-17 04:32:03,549 - INFO - BART config vocab size: 2830
2025-10-17 04:32:05,633 - INFO - Total parameters: 102,998,016
2025-10-17 04:32:05,633 - INFO - Trainable parameters: 102,998,016
2025-10-17 04:32:05,634 - INFO - Total training steps: 9000
2025-10-17 04:32:05,634 - INFO - Warmup steps: 500
2025-10-17 04:32:05,634 - INFO - 
================================================================================
2025-10-17 04:32:05,634 - INFO - Starting Training
2025-10-17 04:32:05,634 - INFO - ================================================================================
2025-10-17 04:32:18,517 - INFO - Epoch 1, Step 50/300 - Loss: 6.8559, Perplexity: 1279.1738, LR: 1.00e-05
2025-10-17 04:32:30,827 - INFO - Epoch 1, Step 100/300 - Loss: 6.1047, Perplexity: 774.0218, LR: 2.00e-05
2025-10-17 04:32:43,236 - INFO - Epoch 1, Step 150/300 - Loss: 5.6653, Perplexity: 562.9043, LR: 3.00e-05
2025-10-17 04:32:55,328 - INFO - Epoch 1, Step 200/300 - Loss: 5.3695, Perplexity: 448.6464, LR: 4.00e-05
2025-10-17 04:33:08,068 - INFO - Epoch 1, Step 250/300 - Loss: 5.1627, Perplexity: 376.8854, LR: 5.00e-05
2025-10-17 04:33:20,347 - INFO - Epoch 1, Step 300/300 - Loss: 4.9577, Perplexity: 325.0629, LR: 6.00e-05
2025-10-17 04:33:20,348 - INFO - Epoch 1 Complete - Avg Loss: 4.9577, Avg Perplexity: 325.0629
2025-10-17 04:33:26,186 - INFO - Validation - Loss: 3.6359, Perplexity: 46.4916, Token Accuracy: 0.4475, Code Accuracy: 0.2131
2025-10-17 04:33:26,186 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:33:27,102 - INFO - TPL computed on 93 samples: 93.2579
2025-10-17 04:33:27,102 - INFO - Temporal Perplexity (TPL): 93.2579
2025-10-17 04:33:27,102 - INFO - New best model! Validation loss: 3.6359
2025-10-17 04:33:31,489 - INFO - Checkpoint saved: epoch 1
2025-10-17 04:33:43,375 - INFO - Epoch 2, Step 50/300 - Loss: 3.3345, Perplexity: 39.6251, LR: 7.00e-05
2025-10-17 04:33:56,107 - INFO - Epoch 2, Step 100/300 - Loss: 2.9546, Perplexity: 29.3333, LR: 8.00e-05
2025-10-17 04:34:08,437 - INFO - Epoch 2, Step 150/300 - Loss: 2.5821, Perplexity: 22.8365, LR: 9.00e-05
2025-10-17 04:34:20,888 - INFO - Epoch 2, Step 200/300 - Loss: 2.2628, Perplexity: 18.3034, LR: 1.00e-04
2025-10-17 04:34:33,135 - INFO - Epoch 2, Step 250/300 - Loss: 2.0044, Perplexity: 15.3441, LR: 9.94e-05
2025-10-17 04:34:45,572 - INFO - Epoch 2, Step 300/300 - Loss: 1.8029, Perplexity: 13.3493, LR: 9.88e-05
2025-10-17 04:34:45,573 - INFO - Epoch 2 Complete - Avg Loss: 1.8029, Avg Perplexity: 13.3493
2025-10-17 04:34:51,358 - INFO - Validation - Loss: 0.4745, Perplexity: 2.1316, Token Accuracy: 0.9594, Code Accuracy: 0.9514
2025-10-17 04:34:51,359 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:34:52,236 - INFO - TPL computed on 93 samples: 2.4394
2025-10-17 04:34:52,236 - INFO - Temporal Perplexity (TPL): 2.4394
2025-10-17 04:34:52,236 - INFO - New best model! Validation loss: 0.4745
2025-10-17 04:34:56,242 - INFO - Checkpoint saved: epoch 2
2025-10-17 04:35:08,776 - INFO - Epoch 3, Step 50/300 - Loss: 0.5500, Perplexity: 2.1809, LR: 9.82e-05
2025-10-17 04:35:21,181 - INFO - Epoch 3, Step 100/300 - Loss: 0.5226, Perplexity: 2.2934, LR: 9.76e-05
2025-10-17 04:35:33,277 - INFO - Epoch 3, Step 150/300 - Loss: 0.4750, Perplexity: 2.3656, LR: 9.71e-05
2025-10-17 04:35:45,726 - INFO - Epoch 3, Step 200/300 - Loss: 0.4182, Perplexity: 2.1133, LR: 9.65e-05
2025-10-17 04:35:58,234 - INFO - Epoch 3, Step 250/300 - Loss: 0.3970, Perplexity: 2.0062, LR: 9.59e-05
2025-10-17 04:36:10,471 - INFO - Epoch 3, Step 300/300 - Loss: 0.3638, Perplexity: 1.8893, LR: 9.53e-05
2025-10-17 04:36:10,472 - INFO - Epoch 3 Complete - Avg Loss: 0.3638, Avg Perplexity: 1.8893
2025-10-17 04:36:16,301 - INFO - Validation - Loss: 0.1339, Perplexity: 1.1890, Token Accuracy: 0.9868, Code Accuracy: 0.9838
2025-10-17 04:36:16,302 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:36:17,180 - INFO - TPL computed on 93 samples: 1.3261
2025-10-17 04:36:17,181 - INFO - Temporal Perplexity (TPL): 1.3261
2025-10-17 04:36:17,181 - INFO - New best model! Validation loss: 0.1339
2025-10-17 04:36:21,762 - INFO - Checkpoint saved: epoch 3
2025-10-17 04:36:34,074 - INFO - Epoch 4, Step 50/300 - Loss: 0.2171, Perplexity: 1.4506, LR: 9.47e-05
2025-10-17 04:36:46,483 - INFO - Epoch 4, Step 100/300 - Loss: 0.1717, Perplexity: 1.3138, LR: 9.41e-05
2025-10-17 04:36:58,549 - INFO - Epoch 4, Step 150/300 - Loss: 0.1395, Perplexity: 1.2374, LR: 9.35e-05
2025-10-17 04:37:11,138 - INFO - Epoch 4, Step 200/300 - Loss: 0.1532, Perplexity: 1.3254, LR: 9.29e-05
2025-10-17 04:37:23,404 - INFO - Epoch 4, Step 250/300 - Loss: 0.1404, Perplexity: 1.2830, LR: 9.24e-05
2025-10-17 04:37:35,879 - INFO - Epoch 4, Step 300/300 - Loss: 0.1489, Perplexity: 1.3097, LR: 9.18e-05
2025-10-17 04:37:35,880 - INFO - Epoch 4 Complete - Avg Loss: 0.1489, Avg Perplexity: 1.3097
2025-10-17 04:37:41,564 - INFO - Validation - Loss: 0.0707, Perplexity: 1.1037, Token Accuracy: 0.9924, Code Accuracy: 0.9909
2025-10-17 04:37:41,565 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:37:42,442 - INFO - TPL computed on 93 samples: 1.1288
2025-10-17 04:37:42,442 - INFO - Temporal Perplexity (TPL): 1.1288
2025-10-17 04:37:42,442 - INFO - New best model! Validation loss: 0.0707
2025-10-17 04:37:46,998 - INFO - Checkpoint saved: epoch 4
2025-10-17 04:37:59,120 - INFO - Epoch 5, Step 50/300 - Loss: 0.0863, Perplexity: 1.1386, LR: 9.12e-05
2025-10-17 04:38:11,251 - INFO - Epoch 5, Step 100/300 - Loss: 0.0680, Perplexity: 1.0993, LR: 9.06e-05
2025-10-17 04:38:23,777 - INFO - Epoch 5, Step 150/300 - Loss: 0.0700, Perplexity: 1.1280, LR: 9.00e-05
2025-10-17 04:38:36,452 - INFO - Epoch 5, Step 200/300 - Loss: 0.0792, Perplexity: 1.1456, LR: 8.94e-05
2025-10-17 04:38:48,630 - INFO - Epoch 5, Step 250/300 - Loss: 0.0747, Perplexity: 1.1302, LR: 8.88e-05
2025-10-17 04:39:00,660 - INFO - Epoch 5, Step 300/300 - Loss: 0.0768, Perplexity: 1.1384, LR: 8.82e-05
2025-10-17 04:39:00,660 - INFO - Epoch 5 Complete - Avg Loss: 0.0768, Avg Perplexity: 1.1384
2025-10-17 04:39:06,536 - INFO - Validation - Loss: 0.0352, Perplexity: 1.0413, Token Accuracy: 0.9960, Code Accuracy: 0.9953
2025-10-17 04:39:06,537 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:39:07,417 - INFO - TPL computed on 93 samples: 1.0688
2025-10-17 04:39:07,417 - INFO - Temporal Perplexity (TPL): 1.0688
2025-10-17 04:39:07,417 - INFO - New best model! Validation loss: 0.0352
2025-10-17 04:39:12,043 - INFO - Checkpoint saved: epoch 5
2025-10-17 04:39:24,291 - INFO - Epoch 6, Step 50/300 - Loss: 0.0662, Perplexity: 1.1599, LR: 8.76e-05
2025-10-17 04:39:36,464 - INFO - Epoch 6, Step 100/300 - Loss: 0.0703, Perplexity: 1.1543, LR: 8.71e-05
2025-10-17 04:39:48,554 - INFO - Epoch 6, Step 150/300 - Loss: 0.0731, Perplexity: 1.1519, LR: 8.65e-05
2025-10-17 04:40:00,888 - INFO - Epoch 6, Step 200/300 - Loss: 0.0612, Perplexity: 1.1207, LR: 8.59e-05
2025-10-17 04:40:12,967 - INFO - Epoch 6, Step 250/300 - Loss: 0.0561, Perplexity: 1.1044, LR: 8.53e-05
2025-10-17 04:40:25,379 - INFO - Epoch 6, Step 300/300 - Loss: 0.0520, Perplexity: 1.0925, LR: 8.47e-05
2025-10-17 04:40:25,379 - INFO - Epoch 6 Complete - Avg Loss: 0.0520, Avg Perplexity: 1.0925
2025-10-17 04:40:31,159 - INFO - Validation - Loss: 0.0181, Perplexity: 1.0200, Token Accuracy: 0.9982, Code Accuracy: 0.9979
2025-10-17 04:40:31,160 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:40:32,034 - INFO - TPL computed on 93 samples: 1.0403
2025-10-17 04:40:32,034 - INFO - Temporal Perplexity (TPL): 1.0403
2025-10-17 04:40:32,034 - INFO - New best model! Validation loss: 0.0181
2025-10-17 04:40:36,468 - INFO - Checkpoint saved: epoch 6
2025-10-17 04:40:48,663 - INFO - Epoch 7, Step 50/300 - Loss: 0.0502, Perplexity: 1.1088, LR: 8.41e-05
2025-10-17 04:41:01,364 - INFO - Epoch 7, Step 100/300 - Loss: 0.0534, Perplexity: 1.1263, LR: 8.35e-05
2025-10-17 04:41:13,578 - INFO - Epoch 7, Step 150/300 - Loss: 0.0439, Perplexity: 1.0931, LR: 8.29e-05
2025-10-17 04:41:25,819 - INFO - Epoch 7, Step 200/300 - Loss: 0.0500, Perplexity: 1.0948, LR: 8.24e-05
2025-10-17 04:41:37,984 - INFO - Epoch 7, Step 250/300 - Loss: 0.0418, Perplexity: 1.0777, LR: 8.18e-05
2025-10-17 04:41:50,160 - INFO - Epoch 7, Step 300/300 - Loss: 0.0360, Perplexity: 1.0659, LR: 8.12e-05
2025-10-17 04:41:50,161 - INFO - Epoch 7 Complete - Avg Loss: 0.0360, Avg Perplexity: 1.0659
2025-10-17 04:41:56,034 - INFO - Validation - Loss: 0.0092, Perplexity: 1.0100, Token Accuracy: 0.9993, Code Accuracy: 0.9991
2025-10-17 04:41:56,035 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:41:56,909 - INFO - TPL computed on 93 samples: 1.0206
2025-10-17 04:41:56,910 - INFO - Temporal Perplexity (TPL): 1.0206
2025-10-17 04:41:56,910 - INFO - New best model! Validation loss: 0.0092
2025-10-17 04:42:01,278 - INFO - Checkpoint saved: epoch 7
2025-10-17 04:42:13,616 - INFO - Epoch 8, Step 50/300 - Loss: 0.0407, Perplexity: 1.0531, LR: 8.06e-05
2025-10-17 04:42:25,984 - INFO - Epoch 8, Step 100/300 - Loss: 0.0388, Perplexity: 1.0641, LR: 8.00e-05
2025-10-17 04:42:38,537 - INFO - Epoch 8, Step 150/300 - Loss: 0.0319, Perplexity: 1.0491, LR: 7.94e-05
2025-10-17 04:42:50,434 - INFO - Epoch 8, Step 200/300 - Loss: 0.0271, Perplexity: 1.0401, LR: 7.88e-05
2025-10-17 04:43:02,780 - INFO - Epoch 8, Step 250/300 - Loss: 0.0247, Perplexity: 1.0351, LR: 7.82e-05
2025-10-17 04:43:15,026 - INFO - Epoch 8, Step 300/300 - Loss: 0.0280, Perplexity: 1.0398, LR: 7.76e-05
2025-10-17 04:43:15,026 - INFO - Epoch 8 Complete - Avg Loss: 0.0280, Avg Perplexity: 1.0398
2025-10-17 04:43:20,663 - INFO - Validation - Loss: 0.0116, Perplexity: 1.0127, Token Accuracy: 0.9989, Code Accuracy: 0.9986
2025-10-17 04:43:20,664 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:43:21,540 - INFO - TPL computed on 93 samples: 1.0221
2025-10-17 04:43:21,540 - INFO - Temporal Perplexity (TPL): 1.0221
2025-10-17 04:43:34,043 - INFO - Epoch 9, Step 50/300 - Loss: 0.0101, Perplexity: 1.0103, LR: 7.71e-05
2025-10-17 04:43:46,344 - INFO - Epoch 9, Step 100/300 - Loss: 0.0107, Perplexity: 1.0109, LR: 7.65e-05
2025-10-17 04:43:58,486 - INFO - Epoch 9, Step 150/300 - Loss: 0.0091, Perplexity: 1.0093, LR: 7.59e-05
2025-10-17 04:44:10,852 - INFO - Epoch 9, Step 200/300 - Loss: 0.0218, Perplexity: 1.0332, LR: 7.53e-05
2025-10-17 04:44:23,183 - INFO - Epoch 9, Step 250/300 - Loss: 0.0188, Perplexity: 1.0280, LR: 7.47e-05
2025-10-17 04:44:35,383 - INFO - Epoch 9, Step 300/300 - Loss: 0.0214, Perplexity: 1.0315, LR: 7.41e-05
2025-10-17 04:44:35,383 - INFO - Epoch 9 Complete - Avg Loss: 0.0214, Avg Perplexity: 1.0315
2025-10-17 04:44:41,115 - INFO - Validation - Loss: 0.0099, Perplexity: 1.0112, Token Accuracy: 0.9990, Code Accuracy: 0.9990
2025-10-17 04:44:41,116 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:44:41,991 - INFO - TPL computed on 93 samples: 1.0226
2025-10-17 04:44:41,991 - INFO - Temporal Perplexity (TPL): 1.0226
2025-10-17 04:44:54,267 - INFO - Epoch 10, Step 50/300 - Loss: 0.0485, Perplexity: 1.0717, LR: 7.35e-05
2025-10-17 04:45:06,468 - INFO - Epoch 10, Step 100/300 - Loss: 0.0296, Perplexity: 1.0416, LR: 7.29e-05
2025-10-17 04:45:18,841 - INFO - Epoch 10, Step 150/300 - Loss: 0.0212, Perplexity: 1.0292, LR: 7.24e-05
2025-10-17 04:45:31,316 - INFO - Epoch 10, Step 200/300 - Loss: 0.0202, Perplexity: 1.0276, LR: 7.18e-05
2025-10-17 04:45:43,606 - INFO - Epoch 10, Step 250/300 - Loss: 0.0182, Perplexity: 1.0242, LR: 7.12e-05
2025-10-17 04:45:56,034 - INFO - Epoch 10, Step 300/300 - Loss: 0.0168, Perplexity: 1.0219, LR: 7.06e-05
2025-10-17 04:45:56,035 - INFO - Epoch 10 Complete - Avg Loss: 0.0168, Avg Perplexity: 1.0219
2025-10-17 04:46:01,863 - INFO - Validation - Loss: 0.0069, Perplexity: 1.0071, Token Accuracy: 0.9990, Code Accuracy: 0.9988
2025-10-17 04:46:01,864 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:46:02,736 - INFO - TPL computed on 93 samples: 1.0238
2025-10-17 04:46:02,736 - INFO - Temporal Perplexity (TPL): 1.0238
2025-10-17 04:46:02,736 - INFO - New best model! Validation loss: 0.0069
2025-10-17 04:46:07,317 - INFO - Checkpoint saved: epoch 10
2025-10-17 04:46:19,793 - INFO - Epoch 11, Step 50/300 - Loss: 0.0066, Perplexity: 1.0066, LR: 7.00e-05
2025-10-17 04:46:31,967 - INFO - Epoch 11, Step 100/300 - Loss: 0.0078, Perplexity: 1.0080, LR: 6.94e-05
2025-10-17 04:46:44,211 - INFO - Epoch 11, Step 150/300 - Loss: 0.0167, Perplexity: 1.0211, LR: 6.88e-05
2025-10-17 04:46:56,296 - INFO - Epoch 11, Step 200/300 - Loss: 0.0153, Perplexity: 1.0188, LR: 6.82e-05
2025-10-17 04:47:08,893 - INFO - Epoch 11, Step 250/300 - Loss: 0.0198, Perplexity: 1.0266, LR: 6.76e-05
2025-10-17 04:47:21,030 - INFO - Epoch 11, Step 300/300 - Loss: 0.0175, Perplexity: 1.0232, LR: 6.71e-05
2025-10-17 04:47:21,030 - INFO - Epoch 11 Complete - Avg Loss: 0.0175, Avg Perplexity: 1.0232
2025-10-17 04:47:26,800 - INFO - Validation - Loss: 0.0079, Perplexity: 1.0085, Token Accuracy: 0.9990, Code Accuracy: 0.9988
2025-10-17 04:47:26,801 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:47:27,675 - INFO - TPL computed on 93 samples: 1.0220
2025-10-17 04:47:27,675 - INFO - Temporal Perplexity (TPL): 1.0220
2025-10-17 04:47:40,076 - INFO - Epoch 12, Step 50/300 - Loss: 0.0242, Perplexity: 1.0270, LR: 6.65e-05
2025-10-17 04:47:52,534 - INFO - Epoch 12, Step 100/300 - Loss: 0.0246, Perplexity: 1.0303, LR: 6.59e-05
2025-10-17 04:48:04,842 - INFO - Epoch 12, Step 150/300 - Loss: 0.0177, Perplexity: 1.0215, LR: 6.53e-05
2025-10-17 04:48:17,109 - INFO - Epoch 12, Step 200/300 - Loss: 0.0140, Perplexity: 1.0169, LR: 6.47e-05
2025-10-17 04:48:29,440 - INFO - Epoch 12, Step 250/300 - Loss: 0.0122, Perplexity: 1.0146, LR: 6.41e-05
2025-10-17 04:48:41,943 - INFO - Epoch 12, Step 300/300 - Loss: 0.0136, Perplexity: 1.0167, LR: 6.35e-05
2025-10-17 04:48:41,944 - INFO - Epoch 12 Complete - Avg Loss: 0.0136, Avg Perplexity: 1.0167
2025-10-17 04:48:47,759 - INFO - Validation - Loss: 0.0051, Perplexity: 1.0054, Token Accuracy: 0.9994, Code Accuracy: 0.9992
2025-10-17 04:48:47,760 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:48:48,637 - INFO - TPL computed on 93 samples: 1.0145
2025-10-17 04:48:48,638 - INFO - Temporal Perplexity (TPL): 1.0145
2025-10-17 04:48:48,638 - INFO - New best model! Validation loss: 0.0051
2025-10-17 04:48:52,739 - INFO - Checkpoint saved: epoch 12
2025-10-17 04:49:05,124 - INFO - Epoch 13, Step 50/300 - Loss: 0.0047, Perplexity: 1.0047, LR: 6.29e-05
2025-10-17 04:49:17,246 - INFO - Epoch 13, Step 100/300 - Loss: 0.0104, Perplexity: 1.0121, LR: 6.24e-05
2025-10-17 04:49:29,601 - INFO - Epoch 13, Step 150/300 - Loss: 0.0132, Perplexity: 1.0164, LR: 6.18e-05
2025-10-17 04:49:42,078 - INFO - Epoch 13, Step 200/300 - Loss: 0.0116, Perplexity: 1.0141, LR: 6.12e-05
2025-10-17 04:49:54,549 - INFO - Epoch 13, Step 250/300 - Loss: 0.0117, Perplexity: 1.0137, LR: 6.06e-05
2025-10-17 04:50:06,655 - INFO - Epoch 13, Step 300/300 - Loss: 0.0134, Perplexity: 1.0167, LR: 6.00e-05
2025-10-17 04:50:06,656 - INFO - Epoch 13 Complete - Avg Loss: 0.0134, Avg Perplexity: 1.0167
2025-10-17 04:50:12,381 - INFO - Validation - Loss: 0.0038, Perplexity: 1.0040, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-17 04:50:12,382 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:50:13,254 - INFO - TPL computed on 93 samples: 1.0127
2025-10-17 04:50:13,254 - INFO - Temporal Perplexity (TPL): 1.0127
2025-10-17 04:50:13,254 - INFO - New best model! Validation loss: 0.0038
2025-10-17 04:50:17,713 - INFO - Checkpoint saved: epoch 13
2025-10-17 04:50:30,046 - INFO - Epoch 14, Step 50/300 - Loss: 0.0106, Perplexity: 1.0116, LR: 5.94e-05
2025-10-17 04:50:42,337 - INFO - Epoch 14, Step 100/300 - Loss: 0.0069, Perplexity: 1.0074, LR: 5.88e-05
2025-10-17 04:50:54,846 - INFO - Epoch 14, Step 150/300 - Loss: 0.0109, Perplexity: 1.0136, LR: 5.82e-05
2025-10-17 04:51:07,601 - INFO - Epoch 14, Step 200/300 - Loss: 0.0107, Perplexity: 1.0130, LR: 5.76e-05
2025-10-17 04:51:19,747 - INFO - Epoch 14, Step 250/300 - Loss: 0.0108, Perplexity: 1.0131, LR: 5.71e-05
2025-10-17 04:51:31,592 - INFO - Epoch 14, Step 300/300 - Loss: 0.0098, Perplexity: 1.0117, LR: 5.65e-05
2025-10-17 04:51:31,593 - INFO - Epoch 14 Complete - Avg Loss: 0.0098, Avg Perplexity: 1.0117
2025-10-17 04:51:37,399 - INFO - Validation - Loss: 0.0031, Perplexity: 1.0033, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-17 04:51:37,400 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:51:38,286 - INFO - TPL computed on 93 samples: 1.0123
2025-10-17 04:51:38,286 - INFO - Temporal Perplexity (TPL): 1.0123
2025-10-17 04:51:38,286 - INFO - New best model! Validation loss: 0.0031
2025-10-17 04:51:42,700 - INFO - Checkpoint saved: epoch 14
2025-10-17 04:51:54,903 - INFO - Epoch 15, Step 50/300 - Loss: 0.0069, Perplexity: 1.0072, LR: 5.59e-05
2025-10-17 04:52:07,099 - INFO - Epoch 15, Step 100/300 - Loss: 0.0085, Perplexity: 1.0095, LR: 5.53e-05
2025-10-17 04:52:19,141 - INFO - Epoch 15, Step 150/300 - Loss: 0.0074, Perplexity: 1.0081, LR: 5.47e-05
2025-10-17 04:52:31,452 - INFO - Epoch 15, Step 200/300 - Loss: 0.0068, Perplexity: 1.0073, LR: 5.41e-05
2025-10-17 04:52:43,558 - INFO - Epoch 15, Step 250/300 - Loss: 0.0071, Perplexity: 1.0075, LR: 5.35e-05
2025-10-17 04:52:55,781 - INFO - Epoch 15, Step 300/300 - Loss: 0.0095, Perplexity: 1.0110, LR: 5.29e-05
2025-10-17 04:52:55,781 - INFO - Epoch 15 Complete - Avg Loss: 0.0095, Avg Perplexity: 1.0110
2025-10-17 04:53:01,543 - INFO - Validation - Loss: 0.0034, Perplexity: 1.0035, Token Accuracy: 0.9996, Code Accuracy: 0.9996
2025-10-17 04:53:01,544 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:53:02,425 - INFO - TPL computed on 93 samples: 1.0136
2025-10-17 04:53:02,425 - INFO - Temporal Perplexity (TPL): 1.0136
2025-10-17 04:53:04,620 - INFO - Checkpoint saved: epoch 15
2025-10-17 04:53:16,874 - INFO - Epoch 16, Step 50/300 - Loss: 0.0074, Perplexity: 1.0082, LR: 5.24e-05
2025-10-17 04:53:29,195 - INFO - Epoch 16, Step 100/300 - Loss: 0.0048, Perplexity: 1.0053, LR: 5.18e-05
2025-10-17 04:53:41,765 - INFO - Epoch 16, Step 150/300 - Loss: 0.0112, Perplexity: 1.0137, LR: 5.12e-05
2025-10-17 04:53:54,118 - INFO - Epoch 16, Step 200/300 - Loss: 0.0094, Perplexity: 1.0113, LR: 5.06e-05
2025-10-17 04:54:06,170 - INFO - Epoch 16, Step 250/300 - Loss: 0.0079, Perplexity: 1.0094, LR: 5.00e-05
2025-10-17 04:54:18,745 - INFO - Epoch 16, Step 300/300 - Loss: 0.0095, Perplexity: 1.0119, LR: 4.94e-05
2025-10-17 04:54:18,745 - INFO - Epoch 16 Complete - Avg Loss: 0.0095, Avg Perplexity: 1.0119
2025-10-17 04:54:24,581 - INFO - Validation - Loss: 0.0020, Perplexity: 1.0020, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-17 04:54:24,582 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:54:25,463 - INFO - TPL computed on 93 samples: 1.0094
2025-10-17 04:54:25,463 - INFO - Temporal Perplexity (TPL): 1.0094
2025-10-17 04:54:25,463 - INFO - New best model! Validation loss: 0.0020
2025-10-17 04:54:29,888 - INFO - Checkpoint saved: epoch 16
2025-10-17 04:54:42,348 - INFO - Epoch 17, Step 50/300 - Loss: 0.0058, Perplexity: 1.0061, LR: 4.88e-05
2025-10-17 04:54:54,725 - INFO - Epoch 17, Step 100/300 - Loss: 0.0080, Perplexity: 1.0090, LR: 4.82e-05
2025-10-17 04:55:07,115 - INFO - Epoch 17, Step 150/300 - Loss: 0.0073, Perplexity: 1.0081, LR: 4.76e-05
2025-10-17 04:55:19,065 - INFO - Epoch 17, Step 200/300 - Loss: 0.0057, Perplexity: 1.0064, LR: 4.71e-05
2025-10-17 04:55:31,325 - INFO - Epoch 17, Step 250/300 - Loss: 0.0079, Perplexity: 1.0095, LR: 4.65e-05
2025-10-17 04:55:43,414 - INFO - Epoch 17, Step 300/300 - Loss: 0.0067, Perplexity: 1.0081, LR: 4.59e-05
2025-10-17 04:55:43,415 - INFO - Epoch 17 Complete - Avg Loss: 0.0067, Avg Perplexity: 1.0081
2025-10-17 04:55:49,319 - INFO - Validation - Loss: 0.0013, Perplexity: 1.0014, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-17 04:55:49,320 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:55:50,196 - INFO - TPL computed on 93 samples: 1.0082
2025-10-17 04:55:50,196 - INFO - Temporal Perplexity (TPL): 1.0082
2025-10-17 04:55:50,196 - INFO - New best model! Validation loss: 0.0013
2025-10-17 04:55:54,836 - INFO - Checkpoint saved: epoch 17
2025-10-17 04:56:07,287 - INFO - Epoch 18, Step 50/300 - Loss: 0.0284, Perplexity: 1.0348, LR: 4.53e-05
2025-10-17 04:56:19,385 - INFO - Epoch 18, Step 100/300 - Loss: 0.0158, Perplexity: 1.0190, LR: 4.47e-05
2025-10-17 04:56:31,637 - INFO - Epoch 18, Step 150/300 - Loss: 0.0116, Perplexity: 1.0138, LR: 4.41e-05
2025-10-17 04:56:44,085 - INFO - Epoch 18, Step 200/300 - Loss: 0.0089, Perplexity: 1.0106, LR: 4.35e-05
2025-10-17 04:56:56,341 - INFO - Epoch 18, Step 250/300 - Loss: 0.0074, Perplexity: 1.0087, LR: 4.29e-05
2025-10-17 04:57:08,420 - INFO - Epoch 18, Step 300/300 - Loss: 0.0065, Perplexity: 1.0076, LR: 4.24e-05
2025-10-17 04:57:08,420 - INFO - Epoch 18 Complete - Avg Loss: 0.0065, Avg Perplexity: 1.0076
2025-10-17 04:57:14,332 - INFO - Validation - Loss: 0.0017, Perplexity: 1.0018, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-17 04:57:14,333 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:57:15,208 - INFO - TPL computed on 93 samples: 1.0062
2025-10-17 04:57:15,208 - INFO - Temporal Perplexity (TPL): 1.0062
2025-10-17 04:57:27,511 - INFO - Epoch 19, Step 50/300 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.18e-05
2025-10-17 04:57:39,422 - INFO - Epoch 19, Step 100/300 - Loss: 0.0020, Perplexity: 1.0020, LR: 4.12e-05
2025-10-17 04:57:51,478 - INFO - Epoch 19, Step 150/300 - Loss: 0.0023, Perplexity: 1.0024, LR: 4.06e-05
2025-10-17 04:58:03,707 - INFO - Epoch 19, Step 200/300 - Loss: 0.0042, Perplexity: 1.0047, LR: 4.00e-05
2025-10-17 04:58:15,908 - INFO - Epoch 19, Step 250/300 - Loss: 0.0041, Perplexity: 1.0045, LR: 3.94e-05
2025-10-17 04:58:28,294 - INFO - Epoch 19, Step 300/300 - Loss: 0.0048, Perplexity: 1.0054, LR: 3.88e-05
2025-10-17 04:58:28,294 - INFO - Epoch 19 Complete - Avg Loss: 0.0048, Avg Perplexity: 1.0054
2025-10-17 04:58:34,063 - INFO - Validation - Loss: 0.0027, Perplexity: 1.0028, Token Accuracy: 0.9997, Code Accuracy: 0.9997
2025-10-17 04:58:34,064 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:58:34,943 - INFO - TPL computed on 93 samples: 1.0190
2025-10-17 04:58:34,943 - INFO - Temporal Perplexity (TPL): 1.0190
2025-10-17 04:58:47,095 - INFO - Epoch 20, Step 50/300 - Loss: 0.0027, Perplexity: 1.0027, LR: 3.82e-05
2025-10-17 04:58:58,929 - INFO - Epoch 20, Step 100/300 - Loss: 0.0035, Perplexity: 1.0036, LR: 3.76e-05
2025-10-17 04:59:11,013 - INFO - Epoch 20, Step 150/300 - Loss: 0.0049, Perplexity: 1.0054, LR: 3.71e-05
2025-10-17 04:59:23,345 - INFO - Epoch 20, Step 200/300 - Loss: 0.0042, Perplexity: 1.0046, LR: 3.65e-05
2025-10-17 04:59:35,706 - INFO - Epoch 20, Step 250/300 - Loss: 0.0051, Perplexity: 1.0056, LR: 3.59e-05
2025-10-17 04:59:48,026 - INFO - Epoch 20, Step 300/300 - Loss: 0.0062, Perplexity: 1.0071, LR: 3.53e-05
2025-10-17 04:59:48,027 - INFO - Epoch 20 Complete - Avg Loss: 0.0062, Avg Perplexity: 1.0071
2025-10-17 04:59:53,845 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0008, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-17 04:59:53,846 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 04:59:54,717 - INFO - TPL computed on 93 samples: 1.0033
2025-10-17 04:59:54,717 - INFO - Temporal Perplexity (TPL): 1.0033
2025-10-17 04:59:54,717 - INFO - New best model! Validation loss: 0.0008
2025-10-17 04:59:59,244 - INFO - Checkpoint saved: epoch 20
2025-10-17 05:00:11,680 - INFO - Epoch 21, Step 50/300 - Loss: 0.0082, Perplexity: 1.0090, LR: 3.47e-05
2025-10-17 05:00:23,903 - INFO - Epoch 21, Step 100/300 - Loss: 0.0045, Perplexity: 1.0049, LR: 3.41e-05
2025-10-17 05:00:36,048 - INFO - Epoch 21, Step 150/300 - Loss: 0.0070, Perplexity: 1.0085, LR: 3.35e-05
2025-10-17 05:00:48,595 - INFO - Epoch 21, Step 200/300 - Loss: 0.0058, Perplexity: 1.0070, LR: 3.29e-05
2025-10-17 05:01:00,647 - INFO - Epoch 21, Step 250/300 - Loss: 0.0050, Perplexity: 1.0059, LR: 3.24e-05
2025-10-17 05:01:12,791 - INFO - Epoch 21, Step 300/300 - Loss: 0.0046, Perplexity: 1.0054, LR: 3.18e-05
2025-10-17 05:01:12,792 - INFO - Epoch 21 Complete - Avg Loss: 0.0046, Avg Perplexity: 1.0054
2025-10-17 05:01:18,555 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0008, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-17 05:01:18,556 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:01:19,436 - INFO - TPL computed on 93 samples: 1.0060
2025-10-17 05:01:19,437 - INFO - Temporal Perplexity (TPL): 1.0060
2025-10-17 05:01:19,437 - INFO - New best model! Validation loss: 0.0008
2025-10-17 05:01:24,022 - INFO - Checkpoint saved: epoch 21
2025-10-17 05:01:36,452 - INFO - Epoch 22, Step 50/300 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.12e-05
2025-10-17 05:01:49,213 - INFO - Epoch 22, Step 100/300 - Loss: 0.0020, Perplexity: 1.0020, LR: 3.06e-05
2025-10-17 05:02:01,403 - INFO - Epoch 22, Step 150/300 - Loss: 0.0038, Perplexity: 1.0042, LR: 3.00e-05
2025-10-17 05:02:13,633 - INFO - Epoch 22, Step 200/300 - Loss: 0.0044, Perplexity: 1.0048, LR: 2.94e-05
2025-10-17 05:02:25,981 - INFO - Epoch 22, Step 250/300 - Loss: 0.0038, Perplexity: 1.0042, LR: 2.88e-05
2025-10-17 05:02:38,125 - INFO - Epoch 22, Step 300/300 - Loss: 0.0038, Perplexity: 1.0042, LR: 2.82e-05
2025-10-17 05:02:38,126 - INFO - Epoch 22 Complete - Avg Loss: 0.0038, Avg Perplexity: 1.0042
2025-10-17 05:02:44,071 - INFO - Validation - Loss: 0.0003, Perplexity: 1.0003, Token Accuracy: 1.0000, Code Accuracy: 0.9999
2025-10-17 05:02:44,072 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:02:44,944 - INFO - TPL computed on 93 samples: 1.0019
2025-10-17 05:02:44,944 - INFO - Temporal Perplexity (TPL): 1.0019
2025-10-17 05:02:44,944 - INFO - New best model! Validation loss: 0.0003
2025-10-17 05:02:49,597 - INFO - Checkpoint saved: epoch 22
2025-10-17 05:03:01,748 - INFO - Epoch 23, Step 50/300 - Loss: 0.0091, Perplexity: 1.0110, LR: 2.76e-05
2025-10-17 05:03:13,884 - INFO - Epoch 23, Step 100/300 - Loss: 0.0049, Perplexity: 1.0058, LR: 2.71e-05
2025-10-17 05:03:26,414 - INFO - Epoch 23, Step 150/300 - Loss: 0.0068, Perplexity: 1.0081, LR: 2.65e-05
2025-10-17 05:03:38,797 - INFO - Epoch 23, Step 200/300 - Loss: 0.0052, Perplexity: 1.0062, LR: 2.59e-05
2025-10-17 05:03:51,295 - INFO - Epoch 23, Step 250/300 - Loss: 0.0050, Perplexity: 1.0059, LR: 2.53e-05
2025-10-17 05:04:03,858 - INFO - Epoch 23, Step 300/300 - Loss: 0.0045, Perplexity: 1.0052, LR: 2.47e-05
2025-10-17 05:04:03,859 - INFO - Epoch 23 Complete - Avg Loss: 0.0045, Avg Perplexity: 1.0052
2025-10-17 05:04:09,621 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:04:09,622 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:04:10,497 - INFO - TPL computed on 93 samples: 1.0011
2025-10-17 05:04:10,497 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-17 05:04:10,497 - INFO - New best model! Validation loss: 0.0002
2025-10-17 05:04:14,956 - INFO - Checkpoint saved: epoch 23
2025-10-17 05:04:27,339 - INFO - Epoch 24, Step 50/300 - Loss: 0.0030, Perplexity: 1.0030, LR: 2.41e-05
2025-10-17 05:04:39,491 - INFO - Epoch 24, Step 100/300 - Loss: 0.0018, Perplexity: 1.0018, LR: 2.35e-05
2025-10-17 05:04:51,733 - INFO - Epoch 24, Step 150/300 - Loss: 0.0026, Perplexity: 1.0028, LR: 2.29e-05
2025-10-17 05:05:04,510 - INFO - Epoch 24, Step 200/300 - Loss: 0.0026, Perplexity: 1.0027, LR: 2.24e-05
2025-10-17 05:05:17,232 - INFO - Epoch 24, Step 250/300 - Loss: 0.0022, Perplexity: 1.0023, LR: 2.18e-05
2025-10-17 05:05:29,455 - INFO - Epoch 24, Step 300/300 - Loss: 0.0031, Perplexity: 1.0034, LR: 2.12e-05
2025-10-17 05:05:29,456 - INFO - Epoch 24 Complete - Avg Loss: 0.0031, Avg Perplexity: 1.0034
2025-10-17 05:05:35,132 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:05:35,133 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:05:36,008 - INFO - TPL computed on 93 samples: 1.0016
2025-10-17 05:05:36,008 - INFO - Temporal Perplexity (TPL): 1.0016
2025-10-17 05:05:48,293 - INFO - Epoch 25, Step 50/300 - Loss: 0.0024, Perplexity: 1.0025, LR: 2.06e-05
2025-10-17 05:06:00,421 - INFO - Epoch 25, Step 100/300 - Loss: 0.0019, Perplexity: 1.0019, LR: 2.00e-05
2025-10-17 05:06:12,655 - INFO - Epoch 25, Step 150/300 - Loss: 0.0035, Perplexity: 1.0039, LR: 1.94e-05
2025-10-17 05:06:24,890 - INFO - Epoch 25, Step 200/300 - Loss: 0.0029, Perplexity: 1.0031, LR: 1.88e-05
2025-10-17 05:06:36,935 - INFO - Epoch 25, Step 250/300 - Loss: 0.0028, Perplexity: 1.0030, LR: 1.82e-05
2025-10-17 05:06:48,971 - INFO - Epoch 25, Step 300/300 - Loss: 0.0025, Perplexity: 1.0028, LR: 1.76e-05
2025-10-17 05:06:48,972 - INFO - Epoch 25 Complete - Avg Loss: 0.0025, Avg Perplexity: 1.0028
2025-10-17 05:06:54,859 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:06:54,860 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:06:55,738 - INFO - TPL computed on 93 samples: 1.0014
2025-10-17 05:06:55,738 - INFO - Temporal Perplexity (TPL): 1.0014
2025-10-17 05:06:55,738 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:07:00,311 - INFO - Checkpoint saved: epoch 25
2025-10-17 05:07:12,578 - INFO - Epoch 26, Step 50/300 - Loss: 0.0097, Perplexity: 1.0108, LR: 1.71e-05
2025-10-17 05:07:25,010 - INFO - Epoch 26, Step 100/300 - Loss: 0.0051, Perplexity: 1.0056, LR: 1.65e-05
2025-10-17 05:07:37,645 - INFO - Epoch 26, Step 150/300 - Loss: 0.0037, Perplexity: 1.0040, LR: 1.59e-05
2025-10-17 05:07:50,164 - INFO - Epoch 26, Step 200/300 - Loss: 0.0031, Perplexity: 1.0034, LR: 1.53e-05
2025-10-17 05:08:02,444 - INFO - Epoch 26, Step 250/300 - Loss: 0.0025, Perplexity: 1.0028, LR: 1.47e-05
2025-10-17 05:08:14,923 - INFO - Epoch 26, Step 300/300 - Loss: 0.0028, Perplexity: 1.0030, LR: 1.41e-05
2025-10-17 05:08:14,923 - INFO - Epoch 26 Complete - Avg Loss: 0.0028, Avg Perplexity: 1.0030
2025-10-17 05:08:20,752 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:08:20,753 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:08:21,624 - INFO - TPL computed on 93 samples: 1.0014
2025-10-17 05:08:21,625 - INFO - Temporal Perplexity (TPL): 1.0014
2025-10-17 05:08:21,625 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:08:26,061 - INFO - Checkpoint saved: epoch 26
2025-10-17 05:08:38,171 - INFO - Epoch 27, Step 50/300 - Loss: 0.0010, Perplexity: 1.0010, LR: 1.35e-05
2025-10-17 05:08:50,607 - INFO - Epoch 27, Step 100/300 - Loss: 0.0034, Perplexity: 1.0038, LR: 1.29e-05
2025-10-17 05:09:03,232 - INFO - Epoch 27, Step 150/300 - Loss: 0.0024, Perplexity: 1.0026, LR: 1.24e-05
2025-10-17 05:09:15,908 - INFO - Epoch 27, Step 200/300 - Loss: 0.0040, Perplexity: 1.0044, LR: 1.18e-05
2025-10-17 05:09:28,204 - INFO - Epoch 27, Step 250/300 - Loss: 0.0033, Perplexity: 1.0036, LR: 1.12e-05
2025-10-17 05:09:40,291 - INFO - Epoch 27, Step 300/300 - Loss: 0.0029, Perplexity: 1.0032, LR: 1.06e-05
2025-10-17 05:09:40,292 - INFO - Epoch 27 Complete - Avg Loss: 0.0029, Avg Perplexity: 1.0032
2025-10-17 05:09:46,062 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:09:46,063 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:09:46,939 - INFO - TPL computed on 93 samples: 1.0013
2025-10-17 05:09:46,939 - INFO - Temporal Perplexity (TPL): 1.0013
2025-10-17 05:09:46,939 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:09:51,612 - INFO - Checkpoint saved: epoch 27
2025-10-17 05:10:04,135 - INFO - Epoch 28, Step 50/300 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.00e-05
2025-10-17 05:10:16,326 - INFO - Epoch 28, Step 100/300 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.41e-06
2025-10-17 05:10:28,823 - INFO - Epoch 28, Step 150/300 - Loss: 0.0004, Perplexity: 1.0004, LR: 8.82e-06
2025-10-17 05:10:41,074 - INFO - Epoch 28, Step 200/300 - Loss: 0.0004, Perplexity: 1.0004, LR: 8.24e-06
2025-10-17 05:10:53,363 - INFO - Epoch 28, Step 250/300 - Loss: 0.0021, Perplexity: 1.0023, LR: 7.65e-06
2025-10-17 05:11:05,739 - INFO - Epoch 28, Step 300/300 - Loss: 0.0019, Perplexity: 1.0020, LR: 7.06e-06
2025-10-17 05:11:05,739 - INFO - Epoch 28 Complete - Avg Loss: 0.0019, Avg Perplexity: 1.0020
2025-10-17 05:11:11,460 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:11:11,461 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:11:12,338 - INFO - TPL computed on 93 samples: 1.0011
2025-10-17 05:11:12,339 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-17 05:11:12,339 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:11:16,783 - INFO - Checkpoint saved: epoch 28
2025-10-17 05:11:29,197 - INFO - Epoch 29, Step 50/300 - Loss: 0.0017, Perplexity: 1.0018, LR: 6.47e-06
2025-10-17 05:11:41,229 - INFO - Epoch 29, Step 100/300 - Loss: 0.0010, Perplexity: 1.0011, LR: 5.88e-06
2025-10-17 05:11:53,493 - INFO - Epoch 29, Step 150/300 - Loss: 0.0008, Perplexity: 1.0009, LR: 5.29e-06
2025-10-17 05:12:05,955 - INFO - Epoch 29, Step 200/300 - Loss: 0.0007, Perplexity: 1.0007, LR: 4.71e-06
2025-10-17 05:12:18,189 - INFO - Epoch 29, Step 250/300 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.12e-06
2025-10-17 05:12:30,670 - INFO - Epoch 29, Step 300/300 - Loss: 0.0020, Perplexity: 1.0022, LR: 3.53e-06
2025-10-17 05:12:30,670 - INFO - Epoch 29 Complete - Avg Loss: 0.0020, Avg Perplexity: 1.0022
2025-10-17 05:12:36,419 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:12:36,420 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:12:37,295 - INFO - TPL computed on 93 samples: 1.0010
2025-10-17 05:12:37,295 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-17 05:12:37,295 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:12:41,768 - INFO - Checkpoint saved: epoch 29
2025-10-17 05:12:54,082 - INFO - Epoch 30, Step 50/300 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.94e-06
2025-10-17 05:13:06,470 - INFO - Epoch 30, Step 100/300 - Loss: 0.0029, Perplexity: 1.0030, LR: 2.35e-06
2025-10-17 05:13:18,685 - INFO - Epoch 30, Step 150/300 - Loss: 0.0020, Perplexity: 1.0021, LR: 1.76e-06
2025-10-17 05:13:30,996 - INFO - Epoch 30, Step 200/300 - Loss: 0.0016, Perplexity: 1.0017, LR: 1.18e-06
2025-10-17 05:13:43,505 - INFO - Epoch 30, Step 250/300 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.88e-07
2025-10-17 05:13:55,809 - INFO - Epoch 30, Step 300/300 - Loss: 0.0018, Perplexity: 1.0019, LR: 0.00e+00
2025-10-17 05:13:55,809 - INFO - Epoch 30 Complete - Avg Loss: 0.0018, Avg Perplexity: 1.0019
2025-10-17 05:14:01,626 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-17 05:14:01,627 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-17 05:14:02,503 - INFO - TPL computed on 93 samples: 1.0010
2025-10-17 05:14:02,503 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-17 05:14:02,503 - INFO - New best model! Validation loss: 0.0001
2025-10-17 05:14:07,197 - INFO - Checkpoint saved: epoch 30
2025-10-17 05:14:07,197 - INFO - 
================================================================================
2025-10-17 05:14:07,197 - INFO - Training Complete!
2025-10-17 05:14:07,197 - INFO - ================================================================================
2025-10-17 05:14:07,197 - INFO - Best validation loss: 0.0001
2025-10-17 05:14:07,197 - INFO - Best validation perplexity: 1.0001
2025-10-19 19:41:51,850 - INFO - ================================================================================
2025-10-19 19:41:51,850 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-19 19:41:51,850 - INFO - ================================================================================
2025-10-19 19:41:51,850 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-19 19:41:51,862 - INFO - 
Random seed: 42
2025-10-19 19:41:52,023 - INFO - Device: cuda
2025-10-19 19:41:52,023 - INFO - 
================================================================================
2025-10-19 19:41:52,023 - INFO - Loading MIMIC-III Data
2025-10-19 19:41:52,024 - INFO - ================================================================================
2025-10-19 19:41:52,024 - INFO - Loading MIMIC-III data files
2025-10-19 19:41:52,101 - INFO - Loaded 46520 patients
2025-10-19 19:41:52,301 - INFO - Loaded 58976 admissions
2025-10-19 19:41:52,551 - INFO - Loaded 651047 diagnosis records
2025-10-19 19:41:52,853 - INFO - Processing patient records
2025-10-19 19:41:55,364 - INFO - Loaded 3000 patient records
2025-10-19 19:41:55,365 - INFO - Diagnosis vocabulary size: 2823
2025-10-19 19:41:55,366 - INFO - Average visits per patient: 1.27
2025-10-19 19:41:55,366 - INFO - Average codes per visit: 9.27
2025-10-19 19:41:55,367 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-19 19:41:55,368 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-19 19:41:55,385 - INFO - Loaded 3000 patients
2025-10-19 19:41:55,385 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-19 19:41:55,385 - INFO - Tokenizer vocab size: 2830
2025-10-19 19:41:55,385 - INFO - Dataset size: 3000 patients
2025-10-19 19:41:55,390 - INFO - Train size: 2400, Validation size: 600
2025-10-19 19:41:55,390 - INFO - Train batches: 300, Validation batches: 75
2025-10-19 19:41:55,390 - INFO - 
================================================================================
2025-10-19 19:41:55,391 - INFO - Initializing Model
2025-10-19 19:41:55,391 - INFO - ================================================================================
2025-10-19 19:41:55,516 - INFO - BART config vocab size: 2830
2025-10-19 19:41:57,618 - INFO - Total parameters: 103,386,624
2025-10-19 19:41:57,618 - INFO - Trainable parameters: 103,386,624
2025-10-19 19:41:57,619 - INFO - Total training steps: 9000
2025-10-19 19:41:57,619 - INFO - Warmup steps: 500
2025-10-19 19:41:57,619 - INFO - 
================================================================================
2025-10-19 19:41:57,619 - INFO - Starting Training
2025-10-19 19:41:57,619 - INFO - ================================================================================
2025-10-19 19:42:10,743 - INFO - Epoch 1, Step 50/300 - Loss: 6.9357, Perplexity: 1322.2690, LR: 1.00e-05
2025-10-19 19:42:22,711 - INFO - Epoch 1, Step 100/300 - Loss: 6.0834, Perplexity: 773.0955, LR: 2.00e-05
2025-10-19 19:42:34,805 - INFO - Epoch 1, Step 150/300 - Loss: 5.6289, Perplexity: 558.4196, LR: 3.00e-05
2025-10-19 19:42:47,018 - INFO - Epoch 1, Step 200/300 - Loss: 5.3750, Perplexity: 448.5619, LR: 4.00e-05
2025-10-19 19:42:59,252 - INFO - Epoch 1, Step 250/300 - Loss: 5.1433, Perplexity: 375.0017, LR: 5.00e-05
2025-10-19 19:43:11,508 - INFO - Epoch 1, Step 300/300 - Loss: 4.9267, Perplexity: 323.4117, LR: 6.00e-05
2025-10-19 19:43:11,509 - INFO - Epoch 1 Complete - Avg Loss: 4.9267, Avg Perplexity: 323.4117
2025-10-19 19:43:17,220 - INFO - Validation - Loss: 3.7406, Perplexity: 52.5766, Token Accuracy: 0.4320, Code Accuracy: 0.1905
2025-10-19 19:43:17,221 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:43:18,136 - INFO - TPL computed on 93 samples: 94.9981
2025-10-19 19:43:18,136 - INFO - Temporal Perplexity (TPL): 94.9981
2025-10-19 19:43:18,136 - INFO - New best model! Validation loss: 3.7406
2025-10-19 19:43:22,478 - INFO - Checkpoint saved: epoch 1
2025-10-19 19:43:34,536 - INFO - Epoch 2, Step 50/300 - Loss: 3.4520, Perplexity: 39.6078, LR: 7.00e-05
2025-10-19 19:43:46,989 - INFO - Epoch 2, Step 100/300 - Loss: 3.0837, Perplexity: 31.0122, LR: 8.00e-05
2025-10-19 19:43:59,484 - INFO - Epoch 2, Step 150/300 - Loss: 2.7122, Perplexity: 23.8646, LR: 9.00e-05
2025-10-19 19:44:11,969 - INFO - Epoch 2, Step 200/300 - Loss: 2.3664, Perplexity: 19.5297, LR: 1.00e-04
2025-10-19 19:44:24,445 - INFO - Epoch 2, Step 250/300 - Loss: 2.0820, Perplexity: 16.5605, LR: 9.94e-05
2025-10-19 19:44:36,959 - INFO - Epoch 2, Step 300/300 - Loss: 1.8486, Perplexity: 14.2685, LR: 9.88e-05
2025-10-19 19:44:36,959 - INFO - Epoch 2 Complete - Avg Loss: 1.8486, Avg Perplexity: 14.2685
2025-10-19 19:44:42,604 - INFO - Validation - Loss: 0.4502, Perplexity: 1.8982, Token Accuracy: 0.9606, Code Accuracy: 0.9511
2025-10-19 19:44:42,605 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:44:43,494 - INFO - TPL computed on 93 samples: 2.4535
2025-10-19 19:44:43,494 - INFO - Temporal Perplexity (TPL): 2.4535
2025-10-19 19:44:43,495 - INFO - New best model! Validation loss: 0.4502
2025-10-19 19:44:47,491 - INFO - Checkpoint saved: epoch 2
2025-10-19 19:45:00,105 - INFO - Epoch 3, Step 50/300 - Loss: 0.4871, Perplexity: 1.8606, LR: 9.82e-05
2025-10-19 19:45:12,245 - INFO - Epoch 3, Step 100/300 - Loss: 0.4679, Perplexity: 2.1487, LR: 9.76e-05
2025-10-19 19:45:24,587 - INFO - Epoch 3, Step 150/300 - Loss: 0.4672, Perplexity: 2.4309, LR: 9.71e-05
2025-10-19 19:45:37,163 - INFO - Epoch 3, Step 200/300 - Loss: 0.4309, Perplexity: 2.2256, LR: 9.65e-05
2025-10-19 19:45:49,573 - INFO - Epoch 3, Step 250/300 - Loss: 0.4057, Perplexity: 2.0808, LR: 9.59e-05
2025-10-19 19:46:02,074 - INFO - Epoch 3, Step 300/300 - Loss: 0.3611, Perplexity: 1.9295, LR: 9.53e-05
2025-10-19 19:46:02,074 - INFO - Epoch 3 Complete - Avg Loss: 0.3611, Avg Perplexity: 1.9295
2025-10-19 19:46:07,952 - INFO - Validation - Loss: 0.1517, Perplexity: 1.2430, Token Accuracy: 0.9841, Code Accuracy: 0.9806
2025-10-19 19:46:07,953 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:46:08,842 - INFO - TPL computed on 93 samples: 1.3318
2025-10-19 19:46:08,842 - INFO - Temporal Perplexity (TPL): 1.3318
2025-10-19 19:46:08,842 - INFO - New best model! Validation loss: 0.1517
2025-10-19 19:46:13,229 - INFO - Checkpoint saved: epoch 3
2025-10-19 19:46:25,496 - INFO - Epoch 4, Step 50/300 - Loss: 0.2666, Perplexity: 1.6646, LR: 9.47e-05
2025-10-19 19:46:37,578 - INFO - Epoch 4, Step 100/300 - Loss: 0.1755, Perplexity: 1.3843, LR: 9.41e-05
2025-10-19 19:46:50,188 - INFO - Epoch 4, Step 150/300 - Loss: 0.1763, Perplexity: 1.3580, LR: 9.35e-05
2025-10-19 19:47:02,532 - INFO - Epoch 4, Step 200/300 - Loss: 0.1765, Perplexity: 1.3696, LR: 9.29e-05
2025-10-19 19:47:15,048 - INFO - Epoch 4, Step 250/300 - Loss: 0.1564, Perplexity: 1.3150, LR: 9.24e-05
2025-10-19 19:47:27,337 - INFO - Epoch 4, Step 300/300 - Loss: 0.1432, Perplexity: 1.2780, LR: 9.18e-05
2025-10-19 19:47:27,338 - INFO - Epoch 4 Complete - Avg Loss: 0.1432, Avg Perplexity: 1.2780
2025-10-19 19:47:33,134 - INFO - Validation - Loss: 0.0682, Perplexity: 1.0944, Token Accuracy: 0.9929, Code Accuracy: 0.9917
2025-10-19 19:47:33,135 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:47:34,019 - INFO - TPL computed on 93 samples: 1.1378
2025-10-19 19:47:34,020 - INFO - Temporal Perplexity (TPL): 1.1378
2025-10-19 19:47:34,020 - INFO - New best model! Validation loss: 0.0682
2025-10-19 19:47:38,325 - INFO - Checkpoint saved: epoch 4
2025-10-19 19:47:50,534 - INFO - Epoch 5, Step 50/300 - Loss: 0.0619, Perplexity: 1.0734, LR: 9.12e-05
2025-10-19 19:48:02,875 - INFO - Epoch 5, Step 100/300 - Loss: 0.0645, Perplexity: 1.0947, LR: 9.06e-05
2025-10-19 19:48:15,317 - INFO - Epoch 5, Step 150/300 - Loss: 0.0723, Perplexity: 1.1030, LR: 9.00e-05
2025-10-19 19:48:27,785 - INFO - Epoch 5, Step 200/300 - Loss: 0.0776, Perplexity: 1.1254, LR: 8.94e-05
2025-10-19 19:48:40,173 - INFO - Epoch 5, Step 250/300 - Loss: 0.0726, Perplexity: 1.1188, LR: 8.88e-05
2025-10-19 19:48:52,472 - INFO - Epoch 5, Step 300/300 - Loss: 0.0839, Perplexity: 1.1488, LR: 8.82e-05
2025-10-19 19:48:52,473 - INFO - Epoch 5 Complete - Avg Loss: 0.0839, Avg Perplexity: 1.1488
2025-10-19 19:48:58,234 - INFO - Validation - Loss: 0.0349, Perplexity: 1.0404, Token Accuracy: 0.9965, Code Accuracy: 0.9958
2025-10-19 19:48:58,235 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:48:59,126 - INFO - TPL computed on 93 samples: 1.0864
2025-10-19 19:48:59,126 - INFO - Temporal Perplexity (TPL): 1.0864
2025-10-19 19:48:59,126 - INFO - New best model! Validation loss: 0.0349
2025-10-19 19:49:03,403 - INFO - Checkpoint saved: epoch 5
2025-10-19 19:49:15,859 - INFO - Epoch 6, Step 50/300 - Loss: 0.0992, Perplexity: 1.2312, LR: 8.76e-05
2025-10-19 19:49:28,147 - INFO - Epoch 6, Step 100/300 - Loss: 0.0871, Perplexity: 1.1691, LR: 8.71e-05
2025-10-19 19:49:40,324 - INFO - Epoch 6, Step 150/300 - Loss: 0.0658, Perplexity: 1.1210, LR: 8.65e-05
2025-10-19 19:49:52,814 - INFO - Epoch 6, Step 200/300 - Loss: 0.0563, Perplexity: 1.0982, LR: 8.59e-05
2025-10-19 19:50:05,342 - INFO - Epoch 6, Step 250/300 - Loss: 0.0498, Perplexity: 1.0837, LR: 8.53e-05
2025-10-19 19:50:17,655 - INFO - Epoch 6, Step 300/300 - Loss: 0.0528, Perplexity: 1.0860, LR: 8.47e-05
2025-10-19 19:50:17,656 - INFO - Epoch 6 Complete - Avg Loss: 0.0528, Avg Perplexity: 1.0860
2025-10-19 19:50:23,501 - INFO - Validation - Loss: 0.0223, Perplexity: 1.0252, Token Accuracy: 0.9976, Code Accuracy: 0.9975
2025-10-19 19:50:23,502 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:50:24,385 - INFO - TPL computed on 93 samples: 1.0552
2025-10-19 19:50:24,385 - INFO - Temporal Perplexity (TPL): 1.0552
2025-10-19 19:50:24,385 - INFO - New best model! Validation loss: 0.0223
2025-10-19 19:50:29,301 - INFO - Checkpoint saved: epoch 6
2025-10-19 19:50:41,504 - INFO - Epoch 7, Step 50/300 - Loss: 0.0464, Perplexity: 1.0757, LR: 8.41e-05
2025-10-19 19:50:54,176 - INFO - Epoch 7, Step 100/300 - Loss: 0.0577, Perplexity: 1.1051, LR: 8.35e-05
2025-10-19 19:51:06,578 - INFO - Epoch 7, Step 150/300 - Loss: 0.0454, Perplexity: 1.0777, LR: 8.29e-05
2025-10-19 19:51:18,793 - INFO - Epoch 7, Step 200/300 - Loss: 0.0372, Perplexity: 1.0615, LR: 8.24e-05
2025-10-19 19:51:31,269 - INFO - Epoch 7, Step 250/300 - Loss: 0.0372, Perplexity: 1.0588, LR: 8.18e-05
2025-10-19 19:51:43,373 - INFO - Epoch 7, Step 300/300 - Loss: 0.0379, Perplexity: 1.0604, LR: 8.12e-05
2025-10-19 19:51:43,374 - INFO - Epoch 7 Complete - Avg Loss: 0.0379, Avg Perplexity: 1.0604
2025-10-19 19:51:49,083 - INFO - Validation - Loss: 0.0211, Perplexity: 1.0236, Token Accuracy: 0.9975, Code Accuracy: 0.9967
2025-10-19 19:51:49,084 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:51:49,972 - INFO - TPL computed on 93 samples: 1.0445
2025-10-19 19:51:49,972 - INFO - Temporal Perplexity (TPL): 1.0445
2025-10-19 19:51:49,972 - INFO - New best model! Validation loss: 0.0211
2025-10-19 19:51:53,982 - INFO - Checkpoint saved: epoch 7
2025-10-19 19:52:06,092 - INFO - Epoch 8, Step 50/300 - Loss: 0.0119, Perplexity: 1.0121, LR: 8.06e-05
2025-10-19 19:52:18,616 - INFO - Epoch 8, Step 100/300 - Loss: 0.0167, Perplexity: 1.0173, LR: 8.00e-05
2025-10-19 19:52:30,930 - INFO - Epoch 8, Step 150/300 - Loss: 0.0195, Perplexity: 1.0216, LR: 7.94e-05
2025-10-19 19:52:43,230 - INFO - Epoch 8, Step 200/300 - Loss: 0.0167, Perplexity: 1.0183, LR: 7.88e-05
2025-10-19 19:52:55,565 - INFO - Epoch 8, Step 250/300 - Loss: 0.0248, Perplexity: 1.0325, LR: 7.82e-05
2025-10-19 19:53:07,934 - INFO - Epoch 8, Step 300/300 - Loss: 0.0313, Perplexity: 1.0465, LR: 7.76e-05
2025-10-19 19:53:07,935 - INFO - Epoch 8 Complete - Avg Loss: 0.0313, Avg Perplexity: 1.0465
2025-10-19 19:53:13,789 - INFO - Validation - Loss: 0.0126, Perplexity: 1.0140, Token Accuracy: 0.9987, Code Accuracy: 0.9984
2025-10-19 19:53:13,790 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:53:14,677 - INFO - TPL computed on 93 samples: 1.0261
2025-10-19 19:53:14,677 - INFO - Temporal Perplexity (TPL): 1.0261
2025-10-19 19:53:14,677 - INFO - New best model! Validation loss: 0.0126
2025-10-19 19:53:18,951 - INFO - Checkpoint saved: epoch 8
2025-10-19 19:53:31,283 - INFO - Epoch 9, Step 50/300 - Loss: 0.0052, Perplexity: 1.0052, LR: 7.71e-05
2025-10-19 19:53:43,852 - INFO - Epoch 9, Step 100/300 - Loss: 0.0262, Perplexity: 1.0435, LR: 7.65e-05
2025-10-19 19:53:55,920 - INFO - Epoch 9, Step 150/300 - Loss: 0.0270, Perplexity: 1.0405, LR: 7.59e-05
2025-10-19 19:54:08,328 - INFO - Epoch 9, Step 200/300 - Loss: 0.0238, Perplexity: 1.0340, LR: 7.53e-05
2025-10-19 19:54:20,653 - INFO - Epoch 9, Step 250/300 - Loss: 0.0267, Perplexity: 1.0373, LR: 7.47e-05
2025-10-19 19:54:32,839 - INFO - Epoch 9, Step 300/300 - Loss: 0.0268, Perplexity: 1.0380, LR: 7.41e-05
2025-10-19 19:54:32,840 - INFO - Epoch 9 Complete - Avg Loss: 0.0268, Avg Perplexity: 1.0380
2025-10-19 19:54:38,654 - INFO - Validation - Loss: 0.0085, Perplexity: 1.0090, Token Accuracy: 0.9991, Code Accuracy: 0.9991
2025-10-19 19:54:38,655 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:54:39,536 - INFO - TPL computed on 93 samples: 1.0234
2025-10-19 19:54:39,536 - INFO - Temporal Perplexity (TPL): 1.0234
2025-10-19 19:54:39,536 - INFO - New best model! Validation loss: 0.0085
2025-10-19 19:54:43,803 - INFO - Checkpoint saved: epoch 9
2025-10-19 19:54:56,157 - INFO - Epoch 10, Step 50/300 - Loss: 0.0255, Perplexity: 1.0294, LR: 7.35e-05
2025-10-19 19:55:08,147 - INFO - Epoch 10, Step 100/300 - Loss: 0.0314, Perplexity: 1.0435, LR: 7.29e-05
2025-10-19 19:55:20,813 - INFO - Epoch 10, Step 150/300 - Loss: 0.0236, Perplexity: 1.0318, LR: 7.24e-05
2025-10-19 19:55:33,133 - INFO - Epoch 10, Step 200/300 - Loss: 0.0196, Perplexity: 1.0257, LR: 7.18e-05
2025-10-19 19:55:45,374 - INFO - Epoch 10, Step 250/300 - Loss: 0.0172, Perplexity: 1.0222, LR: 7.12e-05
2025-10-19 19:55:57,394 - INFO - Epoch 10, Step 300/300 - Loss: 0.0199, Perplexity: 1.0271, LR: 7.06e-05
2025-10-19 19:55:57,395 - INFO - Epoch 10 Complete - Avg Loss: 0.0199, Avg Perplexity: 1.0271
2025-10-19 19:56:03,336 - INFO - Validation - Loss: 0.0102, Perplexity: 1.0107, Token Accuracy: 0.9985, Code Accuracy: 0.9981
2025-10-19 19:56:03,337 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:56:04,224 - INFO - TPL computed on 93 samples: 1.0312
2025-10-19 19:56:04,224 - INFO - Temporal Perplexity (TPL): 1.0312
2025-10-19 19:56:06,346 - INFO - Checkpoint saved: epoch 10
2025-10-19 19:56:18,668 - INFO - Epoch 11, Step 50/300 - Loss: 0.0171, Perplexity: 1.0197, LR: 7.00e-05
2025-10-19 19:56:30,760 - INFO - Epoch 11, Step 100/300 - Loss: 0.0131, Perplexity: 1.0145, LR: 6.94e-05
2025-10-19 19:56:42,819 - INFO - Epoch 11, Step 150/300 - Loss: 0.0118, Perplexity: 1.0129, LR: 6.88e-05
2025-10-19 19:56:55,253 - INFO - Epoch 11, Step 200/300 - Loss: 0.0188, Perplexity: 1.0269, LR: 6.82e-05
2025-10-19 19:57:07,574 - INFO - Epoch 11, Step 250/300 - Loss: 0.0191, Perplexity: 1.0265, LR: 6.76e-05
2025-10-19 19:57:20,093 - INFO - Epoch 11, Step 300/300 - Loss: 0.0171, Perplexity: 1.0233, LR: 6.71e-05
2025-10-19 19:57:20,094 - INFO - Epoch 11 Complete - Avg Loss: 0.0171, Avg Perplexity: 1.0233
2025-10-19 19:57:25,838 - INFO - Validation - Loss: 0.0063, Perplexity: 1.0066, Token Accuracy: 0.9991, Code Accuracy: 0.9989
2025-10-19 19:57:25,839 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:57:26,721 - INFO - TPL computed on 93 samples: 1.0138
2025-10-19 19:57:26,721 - INFO - Temporal Perplexity (TPL): 1.0138
2025-10-19 19:57:26,721 - INFO - New best model! Validation loss: 0.0063
2025-10-19 19:57:31,014 - INFO - Checkpoint saved: epoch 11
2025-10-19 19:57:43,152 - INFO - Epoch 12, Step 50/300 - Loss: 0.0066, Perplexity: 1.0067, LR: 6.65e-05
2025-10-19 19:57:55,532 - INFO - Epoch 12, Step 100/300 - Loss: 0.0080, Perplexity: 1.0084, LR: 6.59e-05
2025-10-19 19:58:07,952 - INFO - Epoch 12, Step 150/300 - Loss: 0.0071, Perplexity: 1.0074, LR: 6.53e-05
2025-10-19 19:58:20,263 - INFO - Epoch 12, Step 200/300 - Loss: 0.0122, Perplexity: 1.0148, LR: 6.47e-05
2025-10-19 19:58:32,557 - INFO - Epoch 12, Step 250/300 - Loss: 0.0109, Perplexity: 1.0130, LR: 6.41e-05
2025-10-19 19:58:44,875 - INFO - Epoch 12, Step 300/300 - Loss: 0.0120, Perplexity: 1.0143, LR: 6.35e-05
2025-10-19 19:58:44,875 - INFO - Epoch 12 Complete - Avg Loss: 0.0120, Avg Perplexity: 1.0143
2025-10-19 19:58:50,679 - INFO - Validation - Loss: 0.0081, Perplexity: 1.0088, Token Accuracy: 0.9988, Code Accuracy: 0.9986
2025-10-19 19:58:50,680 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 19:58:51,561 - INFO - TPL computed on 93 samples: 1.0148
2025-10-19 19:58:51,561 - INFO - Temporal Perplexity (TPL): 1.0148
2025-10-19 19:59:03,874 - INFO - Epoch 13, Step 50/300 - Loss: 0.0023, Perplexity: 1.0023, LR: 6.29e-05
2025-10-19 19:59:16,186 - INFO - Epoch 13, Step 100/300 - Loss: 0.0196, Perplexity: 1.0280, LR: 6.24e-05
2025-10-19 19:59:28,349 - INFO - Epoch 13, Step 150/300 - Loss: 0.0171, Perplexity: 1.0229, LR: 6.18e-05
2025-10-19 19:59:40,923 - INFO - Epoch 13, Step 200/300 - Loss: 0.0172, Perplexity: 1.0230, LR: 6.12e-05
2025-10-19 19:59:53,424 - INFO - Epoch 13, Step 250/300 - Loss: 0.0164, Perplexity: 1.0212, LR: 6.06e-05
2025-10-19 20:00:05,896 - INFO - Epoch 13, Step 300/300 - Loss: 0.0144, Perplexity: 1.0184, LR: 6.00e-05
2025-10-19 20:00:05,896 - INFO - Epoch 13 Complete - Avg Loss: 0.0144, Avg Perplexity: 1.0184
2025-10-19 20:00:11,672 - INFO - Validation - Loss: 0.0033, Perplexity: 1.0035, Token Accuracy: 0.9995, Code Accuracy: 0.9993
2025-10-19 20:00:11,673 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:00:12,559 - INFO - TPL computed on 93 samples: 1.0106
2025-10-19 20:00:12,559 - INFO - Temporal Perplexity (TPL): 1.0106
2025-10-19 20:00:12,559 - INFO - New best model! Validation loss: 0.0033
2025-10-19 20:00:16,681 - INFO - Checkpoint saved: epoch 13
2025-10-19 20:00:28,886 - INFO - Epoch 14, Step 50/300 - Loss: 0.0209, Perplexity: 1.0297, LR: 5.94e-05
2025-10-19 20:00:41,572 - INFO - Epoch 14, Step 100/300 - Loss: 0.0170, Perplexity: 1.0220, LR: 5.88e-05
2025-10-19 20:00:53,480 - INFO - Epoch 14, Step 150/300 - Loss: 0.0211, Perplexity: 1.0283, LR: 5.82e-05
2025-10-19 20:01:05,761 - INFO - Epoch 14, Step 200/300 - Loss: 0.0177, Perplexity: 1.0232, LR: 5.76e-05
2025-10-19 20:01:18,085 - INFO - Epoch 14, Step 250/300 - Loss: 0.0154, Perplexity: 1.0198, LR: 5.71e-05
2025-10-19 20:01:30,340 - INFO - Epoch 14, Step 300/300 - Loss: 0.0135, Perplexity: 1.0172, LR: 5.65e-05
2025-10-19 20:01:30,341 - INFO - Epoch 14 Complete - Avg Loss: 0.0135, Avg Perplexity: 1.0172
2025-10-19 20:01:36,126 - INFO - Validation - Loss: 0.0035, Perplexity: 1.0036, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-19 20:01:36,127 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:01:37,015 - INFO - TPL computed on 93 samples: 1.0113
2025-10-19 20:01:37,015 - INFO - Temporal Perplexity (TPL): 1.0113
2025-10-19 20:01:48,962 - INFO - Epoch 15, Step 50/300 - Loss: 0.0231, Perplexity: 1.0349, LR: 5.59e-05
2025-10-19 20:02:01,614 - INFO - Epoch 15, Step 100/300 - Loss: 0.0136, Perplexity: 1.0195, LR: 5.53e-05
2025-10-19 20:02:13,884 - INFO - Epoch 15, Step 150/300 - Loss: 0.0125, Perplexity: 1.0168, LR: 5.47e-05
2025-10-19 20:02:26,091 - INFO - Epoch 15, Step 200/300 - Loss: 0.0115, Perplexity: 1.0150, LR: 5.41e-05
2025-10-19 20:02:38,359 - INFO - Epoch 15, Step 250/300 - Loss: 0.0127, Perplexity: 1.0169, LR: 5.35e-05
2025-10-19 20:02:51,112 - INFO - Epoch 15, Step 300/300 - Loss: 0.0116, Perplexity: 1.0152, LR: 5.29e-05
2025-10-19 20:02:51,113 - INFO - Epoch 15 Complete - Avg Loss: 0.0116, Avg Perplexity: 1.0152
2025-10-19 20:02:56,947 - INFO - Validation - Loss: 0.0025, Perplexity: 1.0025, Token Accuracy: 0.9997, Code Accuracy: 0.9996
2025-10-19 20:02:56,948 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:02:57,831 - INFO - TPL computed on 93 samples: 1.0072
2025-10-19 20:02:57,832 - INFO - Temporal Perplexity (TPL): 1.0072
2025-10-19 20:02:57,832 - INFO - New best model! Validation loss: 0.0025
2025-10-19 20:03:02,780 - INFO - Checkpoint saved: epoch 15
2025-10-19 20:03:15,215 - INFO - Epoch 16, Step 50/300 - Loss: 0.0096, Perplexity: 1.0103, LR: 5.24e-05
2025-10-19 20:03:27,262 - INFO - Epoch 16, Step 100/300 - Loss: 0.0069, Perplexity: 1.0073, LR: 5.18e-05
2025-10-19 20:03:39,386 - INFO - Epoch 16, Step 150/300 - Loss: 0.0136, Perplexity: 1.0175, LR: 5.12e-05
2025-10-19 20:03:51,667 - INFO - Epoch 16, Step 200/300 - Loss: 0.0112, Perplexity: 1.0142, LR: 5.06e-05
2025-10-19 20:04:04,239 - INFO - Epoch 16, Step 250/300 - Loss: 0.0094, Perplexity: 1.0118, LR: 5.00e-05
2025-10-19 20:04:16,063 - INFO - Epoch 16, Step 300/300 - Loss: 0.0084, Perplexity: 1.0104, LR: 4.94e-05
2025-10-19 20:04:16,064 - INFO - Epoch 16 Complete - Avg Loss: 0.0084, Avg Perplexity: 1.0104
2025-10-19 20:04:21,806 - INFO - Validation - Loss: 0.0021, Perplexity: 1.0022, Token Accuracy: 0.9998, Code Accuracy: 0.9997
2025-10-19 20:04:21,807 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:04:22,710 - INFO - TPL computed on 93 samples: 1.0067
2025-10-19 20:04:22,710 - INFO - Temporal Perplexity (TPL): 1.0067
2025-10-19 20:04:22,711 - INFO - New best model! Validation loss: 0.0021
2025-10-19 20:04:27,416 - INFO - Checkpoint saved: epoch 16
2025-10-19 20:04:39,708 - INFO - Epoch 17, Step 50/300 - Loss: 0.0021, Perplexity: 1.0021, LR: 4.88e-05
2025-10-19 20:04:51,946 - INFO - Epoch 17, Step 100/300 - Loss: 0.0056, Perplexity: 1.0063, LR: 4.82e-05
2025-10-19 20:05:04,278 - INFO - Epoch 17, Step 150/300 - Loss: 0.0044, Perplexity: 1.0048, LR: 4.76e-05
2025-10-19 20:05:16,733 - INFO - Epoch 17, Step 200/300 - Loss: 0.0068, Perplexity: 1.0082, LR: 4.71e-05
2025-10-19 20:05:29,341 - INFO - Epoch 17, Step 250/300 - Loss: 0.0057, Perplexity: 1.0069, LR: 4.65e-05
2025-10-19 20:05:41,967 - INFO - Epoch 17, Step 300/300 - Loss: 0.0057, Perplexity: 1.0067, LR: 4.59e-05
2025-10-19 20:05:41,967 - INFO - Epoch 17 Complete - Avg Loss: 0.0057, Avg Perplexity: 1.0067
2025-10-19 20:05:47,649 - INFO - Validation - Loss: 0.0022, Perplexity: 1.0022, Token Accuracy: 0.9997, Code Accuracy: 0.9996
2025-10-19 20:05:47,650 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:05:48,546 - INFO - TPL computed on 93 samples: 1.0054
2025-10-19 20:05:48,547 - INFO - Temporal Perplexity (TPL): 1.0054
2025-10-19 20:06:00,754 - INFO - Epoch 18, Step 50/300 - Loss: 0.0112, Perplexity: 1.0127, LR: 4.53e-05
2025-10-19 20:06:12,909 - INFO - Epoch 18, Step 100/300 - Loss: 0.0064, Perplexity: 1.0071, LR: 4.47e-05
2025-10-19 20:06:25,113 - INFO - Epoch 18, Step 150/300 - Loss: 0.0058, Perplexity: 1.0063, LR: 4.41e-05
2025-10-19 20:06:37,366 - INFO - Epoch 18, Step 200/300 - Loss: 0.0054, Perplexity: 1.0058, LR: 4.35e-05
2025-10-19 20:06:49,575 - INFO - Epoch 18, Step 250/300 - Loss: 0.0099, Perplexity: 1.0116, LR: 4.29e-05
2025-10-19 20:07:01,958 - INFO - Epoch 18, Step 300/300 - Loss: 0.0086, Perplexity: 1.0100, LR: 4.24e-05
2025-10-19 20:07:01,959 - INFO - Epoch 18 Complete - Avg Loss: 0.0086, Avg Perplexity: 1.0100
2025-10-19 20:07:07,844 - INFO - Validation - Loss: 0.0033, Perplexity: 1.0033, Token Accuracy: 0.9993, Code Accuracy: 0.9991
2025-10-19 20:07:07,844 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:07:08,732 - INFO - TPL computed on 93 samples: 1.0097
2025-10-19 20:07:08,732 - INFO - Temporal Perplexity (TPL): 1.0097
2025-10-19 20:07:20,897 - INFO - Epoch 19, Step 50/300 - Loss: 0.0090, Perplexity: 1.0098, LR: 4.18e-05
2025-10-19 20:07:33,180 - INFO - Epoch 19, Step 100/300 - Loss: 0.0057, Perplexity: 1.0061, LR: 4.12e-05
2025-10-19 20:07:45,663 - INFO - Epoch 19, Step 150/300 - Loss: 0.0049, Perplexity: 1.0052, LR: 4.06e-05
2025-10-19 20:07:58,210 - INFO - Epoch 19, Step 200/300 - Loss: 0.0074, Perplexity: 1.0086, LR: 4.00e-05
2025-10-19 20:08:10,528 - INFO - Epoch 19, Step 250/300 - Loss: 0.0065, Perplexity: 1.0074, LR: 3.94e-05
2025-10-19 20:08:22,223 - INFO - Epoch 19, Step 300/300 - Loss: 0.0061, Perplexity: 1.0069, LR: 3.88e-05
2025-10-19 20:08:22,223 - INFO - Epoch 19 Complete - Avg Loss: 0.0061, Avg Perplexity: 1.0069
2025-10-19 20:08:28,034 - INFO - Validation - Loss: 0.0015, Perplexity: 1.0015, Token Accuracy: 0.9998, Code Accuracy: 0.9997
2025-10-19 20:08:28,035 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:08:28,926 - INFO - TPL computed on 93 samples: 1.0055
2025-10-19 20:08:28,927 - INFO - Temporal Perplexity (TPL): 1.0055
2025-10-19 20:08:28,927 - INFO - New best model! Validation loss: 0.0015
2025-10-19 20:08:33,698 - INFO - Checkpoint saved: epoch 19
2025-10-19 20:08:45,886 - INFO - Epoch 20, Step 50/300 - Loss: 0.0012, Perplexity: 1.0012, LR: 3.82e-05
2025-10-19 20:08:58,452 - INFO - Epoch 20, Step 100/300 - Loss: 0.0015, Perplexity: 1.0015, LR: 3.76e-05
2025-10-19 20:09:10,451 - INFO - Epoch 20, Step 150/300 - Loss: 0.0018, Perplexity: 1.0018, LR: 3.71e-05
2025-10-19 20:09:22,798 - INFO - Epoch 20, Step 200/300 - Loss: 0.0016, Perplexity: 1.0016, LR: 3.65e-05
2025-10-19 20:09:35,044 - INFO - Epoch 20, Step 250/300 - Loss: 0.0035, Perplexity: 1.0040, LR: 3.59e-05
2025-10-19 20:09:47,554 - INFO - Epoch 20, Step 300/300 - Loss: 0.0056, Perplexity: 1.0065, LR: 3.53e-05
2025-10-19 20:09:47,554 - INFO - Epoch 20 Complete - Avg Loss: 0.0056, Avg Perplexity: 1.0065
2025-10-19 20:09:53,361 - INFO - Validation - Loss: 0.0015, Perplexity: 1.0015, Token Accuracy: 0.9999, Code Accuracy: 0.9998
2025-10-19 20:09:53,362 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:09:54,258 - INFO - TPL computed on 93 samples: 1.0040
2025-10-19 20:09:54,258 - INFO - Temporal Perplexity (TPL): 1.0040
2025-10-19 20:09:54,258 - INFO - New best model! Validation loss: 0.0015
2025-10-19 20:09:59,314 - INFO - Checkpoint saved: epoch 20
2025-10-19 20:10:11,993 - INFO - Epoch 21, Step 50/300 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.47e-05
2025-10-19 20:10:24,156 - INFO - Epoch 21, Step 100/300 - Loss: 0.0128, Perplexity: 1.0175, LR: 3.41e-05
2025-10-19 20:10:36,285 - INFO - Epoch 21, Step 150/300 - Loss: 0.0099, Perplexity: 1.0131, LR: 3.35e-05
2025-10-19 20:10:48,804 - INFO - Epoch 21, Step 200/300 - Loss: 0.0076, Perplexity: 1.0100, LR: 3.29e-05
2025-10-19 20:11:01,187 - INFO - Epoch 21, Step 250/300 - Loss: 0.0068, Perplexity: 1.0088, LR: 3.24e-05
2025-10-19 20:11:13,363 - INFO - Epoch 21, Step 300/300 - Loss: 0.0063, Perplexity: 1.0080, LR: 3.18e-05
2025-10-19 20:11:13,363 - INFO - Epoch 21 Complete - Avg Loss: 0.0063, Avg Perplexity: 1.0080
2025-10-19 20:11:19,218 - INFO - Validation - Loss: 0.0013, Perplexity: 1.0013, Token Accuracy: 0.9999, Code Accuracy: 0.9998
2025-10-19 20:11:19,219 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:11:20,114 - INFO - TPL computed on 93 samples: 1.0036
2025-10-19 20:11:20,114 - INFO - Temporal Perplexity (TPL): 1.0036
2025-10-19 20:11:20,115 - INFO - New best model! Validation loss: 0.0013
2025-10-19 20:11:25,527 - INFO - Checkpoint saved: epoch 21
2025-10-19 20:11:38,252 - INFO - Epoch 22, Step 50/300 - Loss: 0.0015, Perplexity: 1.0015, LR: 3.12e-05
2025-10-19 20:11:50,698 - INFO - Epoch 22, Step 100/300 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.06e-05
2025-10-19 20:12:02,731 - INFO - Epoch 22, Step 150/300 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.00e-05
2025-10-19 20:12:14,915 - INFO - Epoch 22, Step 200/300 - Loss: 0.0053, Perplexity: 1.0063, LR: 2.94e-05
2025-10-19 20:12:27,307 - INFO - Epoch 22, Step 250/300 - Loss: 0.0070, Perplexity: 1.0089, LR: 2.88e-05
2025-10-19 20:12:39,841 - INFO - Epoch 22, Step 300/300 - Loss: 0.0061, Perplexity: 1.0077, LR: 2.82e-05
2025-10-19 20:12:39,842 - INFO - Epoch 22 Complete - Avg Loss: 0.0061, Avg Perplexity: 1.0077
2025-10-19 20:12:45,632 - INFO - Validation - Loss: 0.0019, Perplexity: 1.0020, Token Accuracy: 0.9998, Code Accuracy: 0.9997
2025-10-19 20:12:45,633 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:12:46,528 - INFO - TPL computed on 93 samples: 1.0043
2025-10-19 20:12:46,528 - INFO - Temporal Perplexity (TPL): 1.0043
2025-10-19 20:12:59,106 - INFO - Epoch 23, Step 50/300 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.76e-05
2025-10-19 20:13:11,313 - INFO - Epoch 23, Step 100/300 - Loss: 0.0023, Perplexity: 1.0023, LR: 2.71e-05
2025-10-19 20:13:23,569 - INFO - Epoch 23, Step 150/300 - Loss: 0.0022, Perplexity: 1.0023, LR: 2.65e-05
2025-10-19 20:13:36,317 - INFO - Epoch 23, Step 200/300 - Loss: 0.0022, Perplexity: 1.0022, LR: 2.59e-05
2025-10-19 20:13:48,750 - INFO - Epoch 23, Step 250/300 - Loss: 0.0034, Perplexity: 1.0037, LR: 2.53e-05
2025-10-19 20:14:01,267 - INFO - Epoch 23, Step 300/300 - Loss: 0.0037, Perplexity: 1.0041, LR: 2.47e-05
2025-10-19 20:14:01,267 - INFO - Epoch 23 Complete - Avg Loss: 0.0037, Avg Perplexity: 1.0041
2025-10-19 20:14:07,024 - INFO - Validation - Loss: 0.0010, Perplexity: 1.0010, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:14:07,025 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:14:07,911 - INFO - TPL computed on 93 samples: 1.0031
2025-10-19 20:14:07,911 - INFO - Temporal Perplexity (TPL): 1.0031
2025-10-19 20:14:07,911 - INFO - New best model! Validation loss: 0.0010
2025-10-19 20:14:12,514 - INFO - Checkpoint saved: epoch 23
2025-10-19 20:14:24,639 - INFO - Epoch 24, Step 50/300 - Loss: 0.0050, Perplexity: 1.0055, LR: 2.41e-05
2025-10-19 20:14:36,739 - INFO - Epoch 24, Step 100/300 - Loss: 0.0046, Perplexity: 1.0050, LR: 2.35e-05
2025-10-19 20:14:49,004 - INFO - Epoch 24, Step 150/300 - Loss: 0.0037, Perplexity: 1.0039, LR: 2.29e-05
2025-10-19 20:15:01,483 - INFO - Epoch 24, Step 200/300 - Loss: 0.0029, Perplexity: 1.0031, LR: 2.24e-05
2025-10-19 20:15:13,993 - INFO - Epoch 24, Step 250/300 - Loss: 0.0030, Perplexity: 1.0032, LR: 2.18e-05
2025-10-19 20:15:26,257 - INFO - Epoch 24, Step 300/300 - Loss: 0.0028, Perplexity: 1.0030, LR: 2.12e-05
2025-10-19 20:15:26,257 - INFO - Epoch 24 Complete - Avg Loss: 0.0028, Avg Perplexity: 1.0030
2025-10-19 20:15:31,973 - INFO - Validation - Loss: 0.0009, Perplexity: 1.0009, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:15:31,974 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:15:32,869 - INFO - TPL computed on 93 samples: 1.0036
2025-10-19 20:15:32,869 - INFO - Temporal Perplexity (TPL): 1.0036
2025-10-19 20:15:32,869 - INFO - New best model! Validation loss: 0.0009
2025-10-19 20:15:38,089 - INFO - Checkpoint saved: epoch 24
2025-10-19 20:15:50,624 - INFO - Epoch 25, Step 50/300 - Loss: 0.0027, Perplexity: 1.0029, LR: 2.06e-05
2025-10-19 20:16:02,764 - INFO - Epoch 25, Step 100/300 - Loss: 0.0018, Perplexity: 1.0019, LR: 2.00e-05
2025-10-19 20:16:14,959 - INFO - Epoch 25, Step 150/300 - Loss: 0.0053, Perplexity: 1.0066, LR: 1.94e-05
2025-10-19 20:16:27,262 - INFO - Epoch 25, Step 200/300 - Loss: 0.0048, Perplexity: 1.0059, LR: 1.88e-05
2025-10-19 20:16:39,769 - INFO - Epoch 25, Step 250/300 - Loss: 0.0040, Perplexity: 1.0048, LR: 1.82e-05
2025-10-19 20:16:51,805 - INFO - Epoch 25, Step 300/300 - Loss: 0.0046, Perplexity: 1.0056, LR: 1.76e-05
2025-10-19 20:16:51,806 - INFO - Epoch 25 Complete - Avg Loss: 0.0046, Avg Perplexity: 1.0056
2025-10-19 20:16:57,647 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0006, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:16:57,648 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:16:58,539 - INFO - TPL computed on 93 samples: 1.0017
2025-10-19 20:16:58,539 - INFO - Temporal Perplexity (TPL): 1.0017
2025-10-19 20:16:58,539 - INFO - New best model! Validation loss: 0.0006
2025-10-19 20:17:03,445 - INFO - Checkpoint saved: epoch 25
2025-10-19 20:17:15,776 - INFO - Epoch 26, Step 50/300 - Loss: 0.0030, Perplexity: 1.0032, LR: 1.71e-05
2025-10-19 20:17:28,155 - INFO - Epoch 26, Step 100/300 - Loss: 0.0034, Perplexity: 1.0037, LR: 1.65e-05
2025-10-19 20:17:40,829 - INFO - Epoch 26, Step 150/300 - Loss: 0.0024, Perplexity: 1.0026, LR: 1.59e-05
2025-10-19 20:17:53,411 - INFO - Epoch 26, Step 200/300 - Loss: 0.0022, Perplexity: 1.0023, LR: 1.53e-05
2025-10-19 20:18:05,832 - INFO - Epoch 26, Step 250/300 - Loss: 0.0038, Perplexity: 1.0042, LR: 1.47e-05
2025-10-19 20:18:18,341 - INFO - Epoch 26, Step 300/300 - Loss: 0.0032, Perplexity: 1.0036, LR: 1.41e-05
2025-10-19 20:18:18,342 - INFO - Epoch 26 Complete - Avg Loss: 0.0032, Avg Perplexity: 1.0036
2025-10-19 20:18:24,075 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0006, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:18:24,076 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:18:24,969 - INFO - TPL computed on 93 samples: 1.0017
2025-10-19 20:18:24,969 - INFO - Temporal Perplexity (TPL): 1.0017
2025-10-19 20:18:37,125 - INFO - Epoch 27, Step 50/300 - Loss: 0.0014, Perplexity: 1.0015, LR: 1.35e-05
2025-10-19 20:18:49,599 - INFO - Epoch 27, Step 100/300 - Loss: 0.0051, Perplexity: 1.0062, LR: 1.29e-05
2025-10-19 20:19:02,169 - INFO - Epoch 27, Step 150/300 - Loss: 0.0043, Perplexity: 1.0051, LR: 1.24e-05
2025-10-19 20:19:14,673 - INFO - Epoch 27, Step 200/300 - Loss: 0.0054, Perplexity: 1.0065, LR: 1.18e-05
2025-10-19 20:19:27,306 - INFO - Epoch 27, Step 250/300 - Loss: 0.0045, Perplexity: 1.0053, LR: 1.12e-05
2025-10-19 20:19:39,304 - INFO - Epoch 27, Step 300/300 - Loss: 0.0038, Perplexity: 1.0045, LR: 1.06e-05
2025-10-19 20:19:39,304 - INFO - Epoch 27 Complete - Avg Loss: 0.0038, Avg Perplexity: 1.0045
2025-10-19 20:19:45,173 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0007, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:19:45,174 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:19:46,065 - INFO - TPL computed on 93 samples: 1.0015
2025-10-19 20:19:46,065 - INFO - Temporal Perplexity (TPL): 1.0015
2025-10-19 20:19:58,361 - INFO - Epoch 28, Step 50/300 - Loss: 0.0061, Perplexity: 1.0070, LR: 1.00e-05
2025-10-19 20:20:11,009 - INFO - Epoch 28, Step 100/300 - Loss: 0.0033, Perplexity: 1.0037, LR: 9.41e-06
2025-10-19 20:20:23,492 - INFO - Epoch 28, Step 150/300 - Loss: 0.0023, Perplexity: 1.0026, LR: 8.82e-06
2025-10-19 20:20:35,916 - INFO - Epoch 28, Step 200/300 - Loss: 0.0018, Perplexity: 1.0021, LR: 8.24e-06
2025-10-19 20:20:48,129 - INFO - Epoch 28, Step 250/300 - Loss: 0.0015, Perplexity: 1.0017, LR: 7.65e-06
2025-10-19 20:21:00,740 - INFO - Epoch 28, Step 300/300 - Loss: 0.0028, Perplexity: 1.0031, LR: 7.06e-06
2025-10-19 20:21:00,741 - INFO - Epoch 28 Complete - Avg Loss: 0.0028, Avg Perplexity: 1.0031
2025-10-19 20:21:06,481 - INFO - Validation - Loss: 0.0005, Perplexity: 1.0005, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:21:06,482 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:21:07,378 - INFO - TPL computed on 93 samples: 1.0015
2025-10-19 20:21:07,379 - INFO - Temporal Perplexity (TPL): 1.0015
2025-10-19 20:21:07,379 - INFO - New best model! Validation loss: 0.0005
2025-10-19 20:21:12,608 - INFO - Checkpoint saved: epoch 28
2025-10-19 20:21:24,701 - INFO - Epoch 29, Step 50/300 - Loss: 0.0061, Perplexity: 1.0068, LR: 6.47e-06
2025-10-19 20:21:37,062 - INFO - Epoch 29, Step 100/300 - Loss: 0.0034, Perplexity: 1.0038, LR: 5.88e-06
2025-10-19 20:21:49,171 - INFO - Epoch 29, Step 150/300 - Loss: 0.0024, Perplexity: 1.0027, LR: 5.29e-06
2025-10-19 20:22:01,699 - INFO - Epoch 29, Step 200/300 - Loss: 0.0026, Perplexity: 1.0028, LR: 4.71e-06
2025-10-19 20:22:13,847 - INFO - Epoch 29, Step 250/300 - Loss: 0.0031, Perplexity: 1.0034, LR: 4.12e-06
2025-10-19 20:22:26,513 - INFO - Epoch 29, Step 300/300 - Loss: 0.0026, Perplexity: 1.0029, LR: 3.53e-06
2025-10-19 20:22:26,514 - INFO - Epoch 29 Complete - Avg Loss: 0.0026, Avg Perplexity: 1.0029
2025-10-19 20:22:32,287 - INFO - Validation - Loss: 0.0005, Perplexity: 1.0005, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:22:32,288 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:22:33,179 - INFO - TPL computed on 93 samples: 1.0014
2025-10-19 20:22:33,179 - INFO - Temporal Perplexity (TPL): 1.0014
2025-10-19 20:22:45,415 - INFO - Epoch 30, Step 50/300 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.94e-06
2025-10-19 20:22:57,890 - INFO - Epoch 30, Step 100/300 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.35e-06
2025-10-19 20:23:10,170 - INFO - Epoch 30, Step 150/300 - Loss: 0.0023, Perplexity: 1.0026, LR: 1.76e-06
2025-10-19 20:23:22,594 - INFO - Epoch 30, Step 200/300 - Loss: 0.0037, Perplexity: 1.0042, LR: 1.18e-06
2025-10-19 20:23:34,884 - INFO - Epoch 30, Step 250/300 - Loss: 0.0030, Perplexity: 1.0034, LR: 5.88e-07
2025-10-19 20:23:47,454 - INFO - Epoch 30, Step 300/300 - Loss: 0.0029, Perplexity: 1.0033, LR: 0.00e+00
2025-10-19 20:23:47,455 - INFO - Epoch 30 Complete - Avg Loss: 0.0029, Avg Perplexity: 1.0033
2025-10-19 20:23:53,224 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0007, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-19 20:23:53,225 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-19 20:23:54,115 - INFO - TPL computed on 93 samples: 1.0014
2025-10-19 20:23:54,115 - INFO - Temporal Perplexity (TPL): 1.0014
2025-10-19 20:23:56,315 - INFO - Checkpoint saved: epoch 30
2025-10-19 20:23:56,315 - INFO - 
================================================================================
2025-10-19 20:23:56,315 - INFO - Training Complete!
2025-10-19 20:23:56,315 - INFO - ================================================================================
2025-10-19 20:23:56,315 - INFO - Best validation loss: 0.0005
2025-10-19 20:23:56,316 - INFO - Best validation perplexity: 1.0005
2025-10-21 04:51:34,080 - INFO - ================================================================================
2025-10-21 04:51:34,080 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-21 04:51:34,081 - INFO - ================================================================================
2025-10-21 04:51:34,081 - INFO - 
Configuration:

[Data]
  Patients: 3000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 500
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-21 04:51:34,092 - INFO - 
Random seed: 42
2025-10-21 04:51:34,252 - INFO - Device: cuda
2025-10-21 04:51:34,252 - INFO - 
================================================================================
2025-10-21 04:51:34,252 - INFO - Loading MIMIC-III Data
2025-10-21 04:51:34,252 - INFO - ================================================================================
2025-10-21 04:51:34,252 - INFO - Loading MIMIC-III data files
2025-10-21 04:51:34,332 - INFO - Loaded 46520 patients
2025-10-21 04:51:34,526 - INFO - Loaded 58976 admissions
2025-10-21 04:51:34,755 - INFO - Loaded 651047 diagnosis records
2025-10-21 04:51:35,055 - INFO - Processing patient records
2025-10-21 04:51:37,563 - INFO - Loaded 3000 patient records
2025-10-21 04:51:37,563 - INFO - Diagnosis vocabulary size: 2823
2025-10-21 04:51:37,564 - INFO - Average visits per patient: 1.27
2025-10-21 04:51:37,564 - INFO - Average codes per visit: 9.27
2025-10-21 04:51:37,565 - INFO - Gender distribution: {'M': 1686, 'F': 1314}
2025-10-21 04:51:37,566 - INFO - Ethnicity distribution: {'WHITE': 1990, 'UNKNOWN/NOT SPECIFIED': 429, 'BLACK': 239, 'OTHER': 120, 'ASIAN': 119, 'HISPANIC OR LATINO': 103}
2025-10-21 04:51:37,587 - INFO - Loaded 3000 patients
2025-10-21 04:51:37,587 - INFO - Vocabulary size: 2823 diagnosis codes
2025-10-21 04:51:37,587 - INFO - Tokenizer vocab size: 2830
2025-10-21 04:51:37,587 - INFO - Dataset size: 3000 patients
2025-10-21 04:51:37,591 - INFO - Train size: 2400, Validation size: 600
2025-10-21 04:51:37,592 - INFO - Train batches: 300, Validation batches: 75
2025-10-21 04:51:37,592 - INFO - 
================================================================================
2025-10-21 04:51:37,592 - INFO - Initializing Model
2025-10-21 04:51:37,592 - INFO - ================================================================================
2025-10-21 04:51:37,710 - INFO - BART config vocab size: 2830
2025-10-21 04:51:39,815 - INFO - Total parameters: 103,386,624
2025-10-21 04:51:39,816 - INFO - Trainable parameters: 103,386,624
2025-10-21 04:51:39,817 - INFO - Total training steps: 9000
2025-10-21 04:51:39,817 - INFO - Warmup steps: 500
2025-10-21 04:51:39,817 - INFO - 
================================================================================
2025-10-21 04:51:39,817 - INFO - Starting Training
2025-10-21 04:51:39,817 - INFO - ================================================================================
2025-10-21 04:51:52,974 - INFO - Epoch 1, Step 50/300 - Loss: 6.9234, Perplexity: 1317.7680, LR: 1.00e-05
2025-10-21 04:52:05,238 - INFO - Epoch 1, Step 100/300 - Loss: 6.0653, Perplexity: 768.3777, LR: 2.00e-05
2025-10-21 04:52:17,281 - INFO - Epoch 1, Step 150/300 - Loss: 5.6223, Perplexity: 556.3372, LR: 3.00e-05
2025-10-21 04:52:29,594 - INFO - Epoch 1, Step 200/300 - Loss: 5.3847, Perplexity: 449.1740, LR: 4.00e-05
2025-10-21 04:52:42,244 - INFO - Epoch 1, Step 250/300 - Loss: 5.1862, Perplexity: 378.3048, LR: 5.00e-05
2025-10-21 04:52:54,634 - INFO - Epoch 1, Step 300/300 - Loss: 5.0032, Perplexity: 328.4236, LR: 6.00e-05
2025-10-21 04:52:54,635 - INFO - Epoch 1 Complete - Avg Loss: 5.0032, Avg Perplexity: 328.4236
2025-10-21 04:53:00,502 - INFO - Validation - Loss: 4.0284, Perplexity: 66.2265, Token Accuracy: 0.3825, Code Accuracy: 0.1295
2025-10-21 04:53:00,503 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 04:53:01,413 - INFO - TPL computed on 93 samples: 115.6087
2025-10-21 04:53:01,414 - INFO - Temporal Perplexity (TPL): 115.6087
2025-10-21 04:53:01,414 - INFO - New best model! Validation loss: 4.0284
2025-10-21 04:53:05,523 - INFO - Checkpoint saved: epoch 1
2025-10-21 04:53:17,965 - INFO - Epoch 2, Step 50/300 - Loss: 3.8017, Perplexity: 52.4999, LR: 7.00e-05
2025-10-21 04:53:30,273 - INFO - Epoch 2, Step 100/300 - Loss: 3.4054, Perplexity: 40.3782, LR: 8.00e-05
2025-10-21 04:53:42,547 - INFO - Epoch 2, Step 150/300 - Loss: 2.9840, Perplexity: 31.0987, LR: 9.00e-05
2025-10-21 04:53:54,577 - INFO - Epoch 2, Step 200/300 - Loss: 2.5779, Perplexity: 25.2789, LR: 1.00e-04
2025-10-21 04:54:06,903 - INFO - Epoch 2, Step 250/300 - Loss: 2.2443, Perplexity: 21.1192, LR: 9.94e-05
2025-10-21 04:54:19,305 - INFO - Epoch 2, Step 300/300 - Loss: 1.9793, Perplexity: 18.0799, LR: 9.88e-05
2025-10-21 04:54:19,305 - INFO - Epoch 2 Complete - Avg Loss: 1.9793, Avg Perplexity: 18.0799
2025-10-21 04:54:25,239 - INFO - Validation - Loss: 0.4030, Perplexity: 1.7819, Token Accuracy: 0.9667, Code Accuracy: 0.9596
2025-10-21 04:54:25,240 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 04:54:26,120 - INFO - TPL computed on 93 samples: 2.1910
2025-10-21 04:54:26,121 - INFO - Temporal Perplexity (TPL): 2.1910
2025-10-21 04:54:26,121 - INFO - New best model! Validation loss: 0.4030
2025-10-21 04:54:30,713 - INFO - Checkpoint saved: epoch 2
2025-10-21 04:54:43,178 - INFO - Epoch 3, Step 50/300 - Loss: 0.5013, Perplexity: 1.9336, LR: 9.82e-05
2025-10-21 04:54:55,545 - INFO - Epoch 3, Step 100/300 - Loss: 0.5058, Perplexity: 2.3615, LR: 9.76e-05
2025-10-21 04:55:07,990 - INFO - Epoch 3, Step 150/300 - Loss: 0.4918, Perplexity: 2.5964, LR: 9.71e-05
2025-10-21 04:55:20,522 - INFO - Epoch 3, Step 200/300 - Loss: 0.4428, Perplexity: 2.3318, LR: 9.65e-05
2025-10-21 04:55:33,072 - INFO - Epoch 3, Step 250/300 - Loss: 0.4237, Perplexity: 2.2148, LR: 9.59e-05
2025-10-21 04:55:45,547 - INFO - Epoch 3, Step 300/300 - Loss: 0.3765, Perplexity: 2.0420, LR: 9.53e-05
2025-10-21 04:55:45,548 - INFO - Epoch 3 Complete - Avg Loss: 0.3765, Avg Perplexity: 2.0420
2025-10-21 04:55:51,315 - INFO - Validation - Loss: 0.1525, Perplexity: 1.2587, Token Accuracy: 0.9827, Code Accuracy: 0.9787
2025-10-21 04:55:51,316 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 04:55:52,200 - INFO - TPL computed on 93 samples: 1.3722
2025-10-21 04:55:52,200 - INFO - Temporal Perplexity (TPL): 1.3722
2025-10-21 04:55:52,200 - INFO - New best model! Validation loss: 0.1525
2025-10-21 04:55:56,570 - INFO - Checkpoint saved: epoch 3
2025-10-21 04:56:09,054 - INFO - Epoch 4, Step 50/300 - Loss: 0.2965, Perplexity: 1.7888, LR: 9.47e-05
2025-10-21 04:56:21,364 - INFO - Epoch 4, Step 100/300 - Loss: 0.1981, Perplexity: 1.4702, LR: 9.41e-05
2025-10-21 04:56:34,012 - INFO - Epoch 4, Step 150/300 - Loss: 0.2047, Perplexity: 1.4996, LR: 9.35e-05
2025-10-21 04:56:46,322 - INFO - Epoch 4, Step 200/300 - Loss: 0.2109, Perplexity: 1.5377, LR: 9.29e-05
2025-10-21 04:56:58,785 - INFO - Epoch 4, Step 250/300 - Loss: 0.1892, Perplexity: 1.4570, LR: 9.24e-05
2025-10-21 04:57:11,129 - INFO - Epoch 4, Step 300/300 - Loss: 0.1765, Perplexity: 1.4043, LR: 9.18e-05
2025-10-21 04:57:11,130 - INFO - Epoch 4 Complete - Avg Loss: 0.1765, Avg Perplexity: 1.4043
2025-10-21 04:57:17,068 - INFO - Validation - Loss: 0.0827, Perplexity: 1.1209, Token Accuracy: 0.9897, Code Accuracy: 0.9872
2025-10-21 04:57:17,069 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 04:57:17,955 - INFO - TPL computed on 93 samples: 1.1932
2025-10-21 04:57:17,955 - INFO - Temporal Perplexity (TPL): 1.1932
2025-10-21 04:57:17,955 - INFO - New best model! Validation loss: 0.0827
2025-10-21 04:57:22,254 - INFO - Checkpoint saved: epoch 4
2025-10-21 04:57:34,406 - INFO - Epoch 5, Step 50/300 - Loss: 0.0864, Perplexity: 1.1198, LR: 9.12e-05
2025-10-21 04:57:46,860 - INFO - Epoch 5, Step 100/300 - Loss: 0.0814, Perplexity: 1.1452, LR: 9.06e-05
2025-10-21 04:57:59,251 - INFO - Epoch 5, Step 150/300 - Loss: 0.0844, Perplexity: 1.1367, LR: 9.00e-05
2025-10-21 04:58:11,759 - INFO - Epoch 5, Step 200/300 - Loss: 0.0939, Perplexity: 1.1880, LR: 8.94e-05
2025-10-21 04:58:23,903 - INFO - Epoch 5, Step 250/300 - Loss: 0.0890, Perplexity: 1.1798, LR: 8.88e-05
2025-10-21 04:58:36,208 - INFO - Epoch 5, Step 300/300 - Loss: 0.1022, Perplexity: 1.2361, LR: 8.82e-05
2025-10-21 04:58:36,209 - INFO - Epoch 5 Complete - Avg Loss: 0.1022, Avg Perplexity: 1.2361
2025-10-21 04:58:42,101 - INFO - Validation - Loss: 0.0349, Perplexity: 1.0420, Token Accuracy: 0.9965, Code Accuracy: 0.9959
2025-10-21 04:58:42,102 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 04:58:42,990 - INFO - TPL computed on 93 samples: 1.0688
2025-10-21 04:58:42,990 - INFO - Temporal Perplexity (TPL): 1.0688
2025-10-21 04:58:42,990 - INFO - New best model! Validation loss: 0.0349
2025-10-21 04:58:47,361 - INFO - Checkpoint saved: epoch 5
2025-10-21 04:58:59,773 - INFO - Epoch 6, Step 50/300 - Loss: 0.1423, Perplexity: 1.5022, LR: 8.76e-05
2025-10-21 04:59:12,140 - INFO - Epoch 6, Step 100/300 - Loss: 0.1269, Perplexity: 1.3476, LR: 8.71e-05
2025-10-21 04:59:24,414 - INFO - Epoch 6, Step 150/300 - Loss: 0.0919, Perplexity: 1.2397, LR: 8.65e-05
2025-10-21 04:59:37,012 - INFO - Epoch 6, Step 200/300 - Loss: 0.0801, Perplexity: 1.1946, LR: 8.59e-05
2025-10-21 04:59:49,315 - INFO - Epoch 6, Step 250/300 - Loss: 0.0710, Perplexity: 1.1639, LR: 8.53e-05
2025-10-21 05:00:01,318 - INFO - Epoch 6, Step 300/300 - Loss: 0.0737, Perplexity: 1.1615, LR: 8.47e-05
2025-10-21 05:00:01,319 - INFO - Epoch 6 Complete - Avg Loss: 0.0737, Avg Perplexity: 1.1615
2025-10-21 05:00:07,171 - INFO - Validation - Loss: 0.0248, Perplexity: 1.0289, Token Accuracy: 0.9975, Code Accuracy: 0.9967
2025-10-21 05:00:07,172 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:00:08,056 - INFO - TPL computed on 93 samples: 1.0605
2025-10-21 05:00:08,056 - INFO - Temporal Perplexity (TPL): 1.0605
2025-10-21 05:00:08,056 - INFO - New best model! Validation loss: 0.0248
2025-10-21 05:00:12,521 - INFO - Checkpoint saved: epoch 6
2025-10-21 05:00:24,854 - INFO - Epoch 7, Step 50/300 - Loss: 0.0862, Perplexity: 1.2222, LR: 8.41e-05
2025-10-21 05:00:37,010 - INFO - Epoch 7, Step 100/300 - Loss: 0.0950, Perplexity: 1.2208, LR: 8.35e-05
2025-10-21 05:00:49,439 - INFO - Epoch 7, Step 150/300 - Loss: 0.0750, Perplexity: 1.1614, LR: 8.29e-05
2025-10-21 05:01:01,662 - INFO - Epoch 7, Step 200/300 - Loss: 0.0630, Perplexity: 1.1284, LR: 8.24e-05
2025-10-21 05:01:13,911 - INFO - Epoch 7, Step 250/300 - Loss: 0.0627, Perplexity: 1.1231, LR: 8.18e-05
2025-10-21 05:01:26,013 - INFO - Epoch 7, Step 300/300 - Loss: 0.0614, Perplexity: 1.1242, LR: 8.12e-05
2025-10-21 05:01:26,014 - INFO - Epoch 7 Complete - Avg Loss: 0.0614, Avg Perplexity: 1.1242
2025-10-21 05:01:31,763 - INFO - Validation - Loss: 0.0231, Perplexity: 1.0276, Token Accuracy: 0.9975, Code Accuracy: 0.9971
2025-10-21 05:01:31,764 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:01:32,648 - INFO - TPL computed on 93 samples: 1.0533
2025-10-21 05:01:32,648 - INFO - Temporal Perplexity (TPL): 1.0533
2025-10-21 05:01:32,648 - INFO - New best model! Validation loss: 0.0231
2025-10-21 05:01:37,030 - INFO - Checkpoint saved: epoch 7
2025-10-21 05:01:49,049 - INFO - Epoch 8, Step 50/300 - Loss: 0.0089, Perplexity: 1.0090, LR: 8.06e-05
2025-10-21 05:02:01,565 - INFO - Epoch 8, Step 100/300 - Loss: 0.0219, Perplexity: 1.0249, LR: 8.00e-05
2025-10-21 05:02:13,897 - INFO - Epoch 8, Step 150/300 - Loss: 0.0268, Perplexity: 1.0323, LR: 7.94e-05
2025-10-21 05:02:26,151 - INFO - Epoch 8, Step 200/300 - Loss: 0.0243, Perplexity: 1.0289, LR: 7.88e-05
2025-10-21 05:02:38,822 - INFO - Epoch 8, Step 250/300 - Loss: 0.0375, Perplexity: 1.0708, LR: 7.82e-05
2025-10-21 05:02:50,993 - INFO - Epoch 8, Step 300/300 - Loss: 0.0472, Perplexity: 1.1004, LR: 7.76e-05
2025-10-21 05:02:50,994 - INFO - Epoch 8 Complete - Avg Loss: 0.0472, Avg Perplexity: 1.1004
2025-10-21 05:02:56,847 - INFO - Validation - Loss: 0.0152, Perplexity: 1.0174, Token Accuracy: 0.9984, Code Accuracy: 0.9980
2025-10-21 05:02:56,848 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:02:57,733 - INFO - TPL computed on 93 samples: 1.0365
2025-10-21 05:02:57,733 - INFO - Temporal Perplexity (TPL): 1.0365
2025-10-21 05:02:57,733 - INFO - New best model! Validation loss: 0.0152
2025-10-21 05:03:02,087 - INFO - Checkpoint saved: epoch 8
2025-10-21 05:03:14,597 - INFO - Epoch 9, Step 50/300 - Loss: 0.0096, Perplexity: 1.0098, LR: 7.71e-05
2025-10-21 05:03:27,148 - INFO - Epoch 9, Step 100/300 - Loss: 0.0424, Perplexity: 1.1163, LR: 7.65e-05
2025-10-21 05:03:39,104 - INFO - Epoch 9, Step 150/300 - Loss: 0.0437, Perplexity: 1.1020, LR: 7.59e-05
2025-10-21 05:03:51,457 - INFO - Epoch 9, Step 200/300 - Loss: 0.0369, Perplexity: 1.0808, LR: 7.53e-05
2025-10-21 05:04:03,684 - INFO - Epoch 9, Step 250/300 - Loss: 0.0451, Perplexity: 1.0948, LR: 7.47e-05
2025-10-21 05:04:15,766 - INFO - Epoch 9, Step 300/300 - Loss: 0.0432, Perplexity: 1.0873, LR: 7.41e-05
2025-10-21 05:04:15,767 - INFO - Epoch 9 Complete - Avg Loss: 0.0432, Avg Perplexity: 1.0873
2025-10-21 05:04:21,643 - INFO - Validation - Loss: 0.0098, Perplexity: 1.0108, Token Accuracy: 0.9989, Code Accuracy: 0.9986
2025-10-21 05:04:21,644 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:04:22,526 - INFO - TPL computed on 93 samples: 1.0255
2025-10-21 05:04:22,526 - INFO - Temporal Perplexity (TPL): 1.0255
2025-10-21 05:04:22,526 - INFO - New best model! Validation loss: 0.0098
2025-10-21 05:04:27,059 - INFO - Checkpoint saved: epoch 9
2025-10-21 05:04:39,631 - INFO - Epoch 10, Step 50/300 - Loss: 0.0656, Perplexity: 1.1088, LR: 7.35e-05
2025-10-21 05:04:52,032 - INFO - Epoch 10, Step 100/300 - Loss: 0.0663, Perplexity: 1.1238, LR: 7.29e-05
2025-10-21 05:05:04,162 - INFO - Epoch 10, Step 150/300 - Loss: 0.0510, Perplexity: 1.0905, LR: 7.24e-05
2025-10-21 05:05:16,590 - INFO - Epoch 10, Step 200/300 - Loss: 0.0404, Perplexity: 1.0701, LR: 7.18e-05
2025-10-21 05:05:28,859 - INFO - Epoch 10, Step 250/300 - Loss: 0.0348, Perplexity: 1.0588, LR: 7.12e-05
2025-10-21 05:05:41,044 - INFO - Epoch 10, Step 300/300 - Loss: 0.0385, Perplexity: 1.0760, LR: 7.06e-05
2025-10-21 05:05:41,044 - INFO - Epoch 10 Complete - Avg Loss: 0.0385, Avg Perplexity: 1.0760
2025-10-21 05:05:47,010 - INFO - Validation - Loss: 0.0074, Perplexity: 1.0078, Token Accuracy: 0.9992, Code Accuracy: 0.9990
2025-10-21 05:05:47,011 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:05:47,900 - INFO - TPL computed on 93 samples: 1.0200
2025-10-21 05:05:47,900 - INFO - Temporal Perplexity (TPL): 1.0200
2025-10-21 05:05:47,900 - INFO - New best model! Validation loss: 0.0074
2025-10-21 05:05:52,304 - INFO - Checkpoint saved: epoch 10
2025-10-21 05:06:04,467 - INFO - Epoch 11, Step 50/300 - Loss: 0.0320, Perplexity: 1.0511, LR: 7.00e-05
2025-10-21 05:06:16,834 - INFO - Epoch 11, Step 100/300 - Loss: 0.0215, Perplexity: 1.0314, LR: 6.94e-05
2025-10-21 05:06:28,825 - INFO - Epoch 11, Step 150/300 - Loss: 0.0193, Perplexity: 1.0265, LR: 6.88e-05
2025-10-21 05:06:41,632 - INFO - Epoch 11, Step 200/300 - Loss: 0.0343, Perplexity: 1.0756, LR: 6.82e-05
2025-10-21 05:06:53,963 - INFO - Epoch 11, Step 250/300 - Loss: 0.0364, Perplexity: 1.0759, LR: 6.76e-05
2025-10-21 05:07:06,108 - INFO - Epoch 11, Step 300/300 - Loss: 0.0337, Perplexity: 1.0670, LR: 6.71e-05
2025-10-21 05:07:06,108 - INFO - Epoch 11 Complete - Avg Loss: 0.0337, Avg Perplexity: 1.0670
2025-10-21 05:07:12,053 - INFO - Validation - Loss: 0.0128, Perplexity: 1.0138, Token Accuracy: 0.9982, Code Accuracy: 0.9978
2025-10-21 05:07:12,054 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:07:12,938 - INFO - TPL computed on 93 samples: 1.0278
2025-10-21 05:07:12,939 - INFO - Temporal Perplexity (TPL): 1.0278
2025-10-21 05:07:25,178 - INFO - Epoch 12, Step 50/300 - Loss: 0.0089, Perplexity: 1.0092, LR: 6.65e-05
2025-10-21 05:07:37,554 - INFO - Epoch 12, Step 100/300 - Loss: 0.0285, Perplexity: 1.0877, LR: 6.59e-05
2025-10-21 05:07:49,874 - INFO - Epoch 12, Step 150/300 - Loss: 0.0222, Perplexity: 1.0618, LR: 6.53e-05
2025-10-21 05:08:02,331 - INFO - Epoch 12, Step 200/300 - Loss: 0.0323, Perplexity: 1.0860, LR: 6.47e-05
2025-10-21 05:08:14,690 - INFO - Epoch 12, Step 250/300 - Loss: 0.0289, Perplexity: 1.0721, LR: 6.41e-05
2025-10-21 05:08:26,963 - INFO - Epoch 12, Step 300/300 - Loss: 0.0324, Perplexity: 1.0731, LR: 6.35e-05
2025-10-21 05:08:26,964 - INFO - Epoch 12 Complete - Avg Loss: 0.0324, Avg Perplexity: 1.0731
2025-10-21 05:08:32,759 - INFO - Validation - Loss: 0.0064, Perplexity: 1.0069, Token Accuracy: 0.9992, Code Accuracy: 0.9991
2025-10-21 05:08:32,760 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:08:33,643 - INFO - TPL computed on 93 samples: 1.0134
2025-10-21 05:08:33,643 - INFO - Temporal Perplexity (TPL): 1.0134
2025-10-21 05:08:33,643 - INFO - New best model! Validation loss: 0.0064
2025-10-21 05:08:38,005 - INFO - Checkpoint saved: epoch 12
2025-10-21 05:08:50,232 - INFO - Epoch 13, Step 50/300 - Loss: 0.0043, Perplexity: 1.0043, LR: 6.29e-05
2025-10-21 05:09:02,720 - INFO - Epoch 13, Step 100/300 - Loss: 0.0386, Perplexity: 1.0926, LR: 6.24e-05
2025-10-21 05:09:15,039 - INFO - Epoch 13, Step 150/300 - Loss: 0.0364, Perplexity: 1.0746, LR: 6.18e-05
2025-10-21 05:09:27,437 - INFO - Epoch 13, Step 200/300 - Loss: 0.0351, Perplexity: 1.0699, LR: 6.12e-05
2025-10-21 05:09:40,013 - INFO - Epoch 13, Step 250/300 - Loss: 0.0335, Perplexity: 1.0624, LR: 6.06e-05
2025-10-21 05:09:52,549 - INFO - Epoch 13, Step 300/300 - Loss: 0.0289, Perplexity: 1.0531, LR: 6.00e-05
2025-10-21 05:09:52,549 - INFO - Epoch 13 Complete - Avg Loss: 0.0289, Avg Perplexity: 1.0531
2025-10-21 05:09:58,323 - INFO - Validation - Loss: 0.0038, Perplexity: 1.0039, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-21 05:09:58,324 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:09:59,212 - INFO - TPL computed on 93 samples: 1.0114
2025-10-21 05:09:59,212 - INFO - Temporal Perplexity (TPL): 1.0114
2025-10-21 05:09:59,212 - INFO - New best model! Validation loss: 0.0038
2025-10-21 05:10:03,622 - INFO - Checkpoint saved: epoch 13
2025-10-21 05:10:15,797 - INFO - Epoch 14, Step 50/300 - Loss: 0.0481, Perplexity: 1.1351, LR: 5.94e-05
2025-10-21 05:10:28,500 - INFO - Epoch 14, Step 100/300 - Loss: 0.0419, Perplexity: 1.0936, LR: 5.88e-05
2025-10-21 05:10:40,819 - INFO - Epoch 14, Step 150/300 - Loss: 0.0467, Perplexity: 1.0996, LR: 5.82e-05
2025-10-21 05:10:53,153 - INFO - Epoch 14, Step 200/300 - Loss: 0.0370, Perplexity: 1.0766, LR: 5.76e-05
2025-10-21 05:11:05,463 - INFO - Epoch 14, Step 250/300 - Loss: 0.0304, Perplexity: 1.0621, LR: 5.71e-05
2025-10-21 05:11:17,529 - INFO - Epoch 14, Step 300/300 - Loss: 0.0258, Perplexity: 1.0523, LR: 5.65e-05
2025-10-21 05:11:17,530 - INFO - Epoch 14 Complete - Avg Loss: 0.0258, Avg Perplexity: 1.0523
2025-10-21 05:11:23,415 - INFO - Validation - Loss: 0.0039, Perplexity: 1.0040, Token Accuracy: 0.9995, Code Accuracy: 0.9993
2025-10-21 05:11:23,416 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:11:24,303 - INFO - TPL computed on 93 samples: 1.0112
2025-10-21 05:11:24,304 - INFO - Temporal Perplexity (TPL): 1.0112
2025-10-21 05:11:36,802 - INFO - Epoch 15, Step 50/300 - Loss: 0.0460, Perplexity: 1.1464, LR: 5.59e-05
2025-10-21 05:11:49,076 - INFO - Epoch 15, Step 100/300 - Loss: 0.0254, Perplexity: 1.0756, LR: 5.53e-05
2025-10-21 05:12:01,466 - INFO - Epoch 15, Step 150/300 - Loss: 0.0305, Perplexity: 1.0729, LR: 5.47e-05
2025-10-21 05:12:13,468 - INFO - Epoch 15, Step 200/300 - Loss: 0.0278, Perplexity: 1.0611, LR: 5.41e-05
2025-10-21 05:12:25,930 - INFO - Epoch 15, Step 250/300 - Loss: 0.0285, Perplexity: 1.0618, LR: 5.35e-05
2025-10-21 05:12:38,621 - INFO - Epoch 15, Step 300/300 - Loss: 0.0243, Perplexity: 1.0521, LR: 5.29e-05
2025-10-21 05:12:38,622 - INFO - Epoch 15 Complete - Avg Loss: 0.0243, Avg Perplexity: 1.0521
2025-10-21 05:12:44,469 - INFO - Validation - Loss: 0.0016, Perplexity: 1.0017, Token Accuracy: 0.9997, Code Accuracy: 0.9997
2025-10-21 05:12:44,470 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:12:45,354 - INFO - TPL computed on 93 samples: 1.0064
2025-10-21 05:12:45,354 - INFO - Temporal Perplexity (TPL): 1.0064
2025-10-21 05:12:45,354 - INFO - New best model! Validation loss: 0.0016
2025-10-21 05:12:49,714 - INFO - Checkpoint saved: epoch 15
2025-10-21 05:13:02,229 - INFO - Epoch 16, Step 50/300 - Loss: 0.0187, Perplexity: 1.0266, LR: 5.24e-05
2025-10-21 05:13:14,574 - INFO - Epoch 16, Step 100/300 - Loss: 0.0203, Perplexity: 1.0309, LR: 5.18e-05
2025-10-21 05:13:26,740 - INFO - Epoch 16, Step 150/300 - Loss: 0.0361, Perplexity: 1.0781, LR: 5.12e-05
2025-10-21 05:13:39,234 - INFO - Epoch 16, Step 200/300 - Loss: 0.0284, Perplexity: 1.0598, LR: 5.06e-05
2025-10-21 05:13:51,735 - INFO - Epoch 16, Step 250/300 - Loss: 0.0231, Perplexity: 1.0483, LR: 5.00e-05
2025-10-21 05:14:04,347 - INFO - Epoch 16, Step 300/300 - Loss: 0.0212, Perplexity: 1.0426, LR: 4.94e-05
2025-10-21 05:14:04,348 - INFO - Epoch 16 Complete - Avg Loss: 0.0212, Avg Perplexity: 1.0426
2025-10-21 05:14:10,307 - INFO - Validation - Loss: 0.0012, Perplexity: 1.0012, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-21 05:14:10,308 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:14:11,193 - INFO - TPL computed on 93 samples: 1.0079
2025-10-21 05:14:11,194 - INFO - Temporal Perplexity (TPL): 1.0079
2025-10-21 05:14:11,194 - INFO - New best model! Validation loss: 0.0012
2025-10-21 05:14:15,849 - INFO - Checkpoint saved: epoch 16
2025-10-21 05:14:28,070 - INFO - Epoch 17, Step 50/300 - Loss: 0.0022, Perplexity: 1.0022, LR: 4.88e-05
2025-10-21 05:14:40,311 - INFO - Epoch 17, Step 100/300 - Loss: 0.0262, Perplexity: 1.0604, LR: 4.82e-05
2025-10-21 05:14:52,418 - INFO - Epoch 17, Step 150/300 - Loss: 0.0231, Perplexity: 1.0486, LR: 4.76e-05
2025-10-21 05:15:04,717 - INFO - Epoch 17, Step 200/300 - Loss: 0.0282, Perplexity: 1.0565, LR: 4.71e-05
2025-10-21 05:15:17,267 - INFO - Epoch 17, Step 250/300 - Loss: 0.0228, Perplexity: 1.0455, LR: 4.65e-05
2025-10-21 05:15:29,315 - INFO - Epoch 17, Step 300/300 - Loss: 0.0200, Perplexity: 1.0389, LR: 4.59e-05
2025-10-21 05:15:29,315 - INFO - Epoch 17 Complete - Avg Loss: 0.0200, Avg Perplexity: 1.0389
2025-10-21 05:15:35,118 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0006, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:15:35,119 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:15:36,009 - INFO - TPL computed on 93 samples: 1.0019
2025-10-21 05:15:36,009 - INFO - Temporal Perplexity (TPL): 1.0019
2025-10-21 05:15:36,009 - INFO - New best model! Validation loss: 0.0006
2025-10-21 05:15:40,419 - INFO - Checkpoint saved: epoch 17
2025-10-21 05:15:52,552 - INFO - Epoch 18, Step 50/300 - Loss: 0.0161, Perplexity: 1.0205, LR: 4.53e-05
2025-10-21 05:16:05,170 - INFO - Epoch 18, Step 100/300 - Loss: 0.0090, Perplexity: 1.0112, LR: 4.47e-05
2025-10-21 05:16:17,828 - INFO - Epoch 18, Step 150/300 - Loss: 0.0118, Perplexity: 1.0154, LR: 4.41e-05
2025-10-21 05:16:30,221 - INFO - Epoch 18, Step 200/300 - Loss: 0.0094, Perplexity: 1.0121, LR: 4.35e-05
2025-10-21 05:16:42,570 - INFO - Epoch 18, Step 250/300 - Loss: 0.0231, Perplexity: 1.0448, LR: 4.29e-05
2025-10-21 05:16:54,888 - INFO - Epoch 18, Step 300/300 - Loss: 0.0197, Perplexity: 1.0377, LR: 4.24e-05
2025-10-21 05:16:54,889 - INFO - Epoch 18 Complete - Avg Loss: 0.0197, Avg Perplexity: 1.0377
2025-10-21 05:17:00,819 - INFO - Validation - Loss: 0.0030, Perplexity: 1.0030, Token Accuracy: 0.9995, Code Accuracy: 0.9994
2025-10-21 05:17:00,820 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:17:01,697 - INFO - TPL computed on 93 samples: 1.0065
2025-10-21 05:17:01,697 - INFO - Temporal Perplexity (TPL): 1.0065
2025-10-21 05:17:13,963 - INFO - Epoch 19, Step 50/300 - Loss: 0.0407, Perplexity: 1.0786, LR: 4.18e-05
2025-10-21 05:17:26,361 - INFO - Epoch 19, Step 100/300 - Loss: 0.0208, Perplexity: 1.0397, LR: 4.12e-05
2025-10-21 05:17:38,813 - INFO - Epoch 19, Step 150/300 - Loss: 0.0147, Perplexity: 1.0274, LR: 4.06e-05
2025-10-21 05:17:51,109 - INFO - Epoch 19, Step 200/300 - Loss: 0.0214, Perplexity: 1.0407, LR: 4.00e-05
2025-10-21 05:18:03,600 - INFO - Epoch 19, Step 250/300 - Loss: 0.0176, Perplexity: 1.0330, LR: 3.94e-05
2025-10-21 05:18:15,935 - INFO - Epoch 19, Step 300/300 - Loss: 0.0170, Perplexity: 1.0304, LR: 3.88e-05
2025-10-21 05:18:15,936 - INFO - Epoch 19 Complete - Avg Loss: 0.0170, Avg Perplexity: 1.0304
2025-10-21 05:18:21,678 - INFO - Validation - Loss: 0.0004, Perplexity: 1.0004, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:18:21,679 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:18:22,563 - INFO - TPL computed on 93 samples: 1.0021
2025-10-21 05:18:22,564 - INFO - Temporal Perplexity (TPL): 1.0021
2025-10-21 05:18:22,564 - INFO - New best model! Validation loss: 0.0004
2025-10-21 05:18:27,195 - INFO - Checkpoint saved: epoch 19
2025-10-21 05:18:39,625 - INFO - Epoch 20, Step 50/300 - Loss: 0.0021, Perplexity: 1.0021, LR: 3.82e-05
2025-10-21 05:18:52,397 - INFO - Epoch 20, Step 100/300 - Loss: 0.0022, Perplexity: 1.0023, LR: 3.76e-05
2025-10-21 05:19:04,819 - INFO - Epoch 20, Step 150/300 - Loss: 0.0045, Perplexity: 1.0052, LR: 3.71e-05
2025-10-21 05:19:17,356 - INFO - Epoch 20, Step 200/300 - Loss: 0.0038, Perplexity: 1.0043, LR: 3.65e-05
2025-10-21 05:19:29,778 - INFO - Epoch 20, Step 250/300 - Loss: 0.0107, Perplexity: 1.0171, LR: 3.59e-05
2025-10-21 05:19:42,225 - INFO - Epoch 20, Step 300/300 - Loss: 0.0150, Perplexity: 1.0242, LR: 3.53e-05
2025-10-21 05:19:42,225 - INFO - Epoch 20 Complete - Avg Loss: 0.0150, Avg Perplexity: 1.0242
2025-10-21 05:19:48,010 - INFO - Validation - Loss: 0.0004, Perplexity: 1.0004, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:19:48,010 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:19:48,895 - INFO - TPL computed on 93 samples: 1.0018
2025-10-21 05:19:48,895 - INFO - Temporal Perplexity (TPL): 1.0018
2025-10-21 05:19:51,128 - INFO - Checkpoint saved: epoch 20
2025-10-21 05:20:03,415 - INFO - Epoch 21, Step 50/300 - Loss: 0.0027, Perplexity: 1.0028, LR: 3.47e-05
2025-10-21 05:20:15,922 - INFO - Epoch 21, Step 100/300 - Loss: 0.0296, Perplexity: 1.0635, LR: 3.41e-05
2025-10-21 05:20:28,242 - INFO - Epoch 21, Step 150/300 - Loss: 0.0234, Perplexity: 1.0469, LR: 3.35e-05
2025-10-21 05:20:40,780 - INFO - Epoch 21, Step 200/300 - Loss: 0.0181, Perplexity: 1.0357, LR: 3.29e-05
2025-10-21 05:20:53,167 - INFO - Epoch 21, Step 250/300 - Loss: 0.0166, Perplexity: 1.0311, LR: 3.24e-05
2025-10-21 05:21:05,073 - INFO - Epoch 21, Step 300/300 - Loss: 0.0159, Perplexity: 1.0287, LR: 3.18e-05
2025-10-21 05:21:05,073 - INFO - Epoch 21 Complete - Avg Loss: 0.0159, Avg Perplexity: 1.0287
2025-10-21 05:21:10,944 - INFO - Validation - Loss: 0.0003, Perplexity: 1.0003, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:21:10,945 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:21:11,835 - INFO - TPL computed on 93 samples: 1.0003
2025-10-21 05:21:11,836 - INFO - Temporal Perplexity (TPL): 1.0003
2025-10-21 05:21:11,836 - INFO - New best model! Validation loss: 0.0003
2025-10-21 05:21:16,430 - INFO - Checkpoint saved: epoch 21
2025-10-21 05:21:28,704 - INFO - Epoch 22, Step 50/300 - Loss: 0.0010, Perplexity: 1.0011, LR: 3.12e-05
2025-10-21 05:21:41,045 - INFO - Epoch 22, Step 100/300 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.06e-05
2025-10-21 05:21:53,168 - INFO - Epoch 22, Step 150/300 - Loss: 0.0013, Perplexity: 1.0013, LR: 3.00e-05
2025-10-21 05:22:05,785 - INFO - Epoch 22, Step 200/300 - Loss: 0.0141, Perplexity: 1.0244, LR: 2.94e-05
2025-10-21 05:22:17,984 - INFO - Epoch 22, Step 250/300 - Loss: 0.0172, Perplexity: 1.0324, LR: 2.88e-05
2025-10-21 05:22:30,181 - INFO - Epoch 22, Step 300/300 - Loss: 0.0144, Perplexity: 1.0271, LR: 2.82e-05
2025-10-21 05:22:30,182 - INFO - Epoch 22 Complete - Avg Loss: 0.0144, Avg Perplexity: 1.0271
2025-10-21 05:22:36,019 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:22:36,020 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:22:36,899 - INFO - TPL computed on 93 samples: 1.0002
2025-10-21 05:22:36,899 - INFO - Temporal Perplexity (TPL): 1.0002
2025-10-21 05:22:36,899 - INFO - New best model! Validation loss: 0.0002
2025-10-21 05:22:41,454 - INFO - Checkpoint saved: epoch 22
2025-10-21 05:22:53,820 - INFO - Epoch 23, Step 50/300 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.76e-05
2025-10-21 05:23:05,642 - INFO - Epoch 23, Step 100/300 - Loss: 0.0056, Perplexity: 1.0069, LR: 2.71e-05
2025-10-21 05:23:18,279 - INFO - Epoch 23, Step 150/300 - Loss: 0.0070, Perplexity: 1.0086, LR: 2.65e-05
2025-10-21 05:23:31,019 - INFO - Epoch 23, Step 200/300 - Loss: 0.0095, Perplexity: 1.0128, LR: 2.59e-05
2025-10-21 05:23:43,513 - INFO - Epoch 23, Step 250/300 - Loss: 0.0141, Perplexity: 1.0259, LR: 2.53e-05
2025-10-21 05:23:55,954 - INFO - Epoch 23, Step 300/300 - Loss: 0.0137, Perplexity: 1.0241, LR: 2.47e-05
2025-10-21 05:23:55,954 - INFO - Epoch 23 Complete - Avg Loss: 0.0137, Avg Perplexity: 1.0241
2025-10-21 05:24:01,764 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:24:01,765 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:24:02,648 - INFO - TPL computed on 93 samples: 1.0002
2025-10-21 05:24:02,648 - INFO - Temporal Perplexity (TPL): 1.0002
2025-10-21 05:24:02,648 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:24:07,252 - INFO - Checkpoint saved: epoch 23
2025-10-21 05:24:19,775 - INFO - Epoch 24, Step 50/300 - Loss: 0.0141, Perplexity: 1.0197, LR: 2.41e-05
2025-10-21 05:24:32,115 - INFO - Epoch 24, Step 100/300 - Loss: 0.0155, Perplexity: 1.0227, LR: 2.35e-05
2025-10-21 05:24:44,629 - INFO - Epoch 24, Step 150/300 - Loss: 0.0181, Perplexity: 1.0293, LR: 2.29e-05
2025-10-21 05:24:57,348 - INFO - Epoch 24, Step 200/300 - Loss: 0.0138, Perplexity: 1.0222, LR: 2.24e-05
2025-10-21 05:25:09,826 - INFO - Epoch 24, Step 250/300 - Loss: 0.0119, Perplexity: 1.0187, LR: 2.18e-05
2025-10-21 05:25:22,257 - INFO - Epoch 24, Step 300/300 - Loss: 0.0104, Perplexity: 1.0161, LR: 2.12e-05
2025-10-21 05:25:22,258 - INFO - Epoch 24 Complete - Avg Loss: 0.0104, Avg Perplexity: 1.0161
2025-10-21 05:25:28,077 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:25:28,078 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:25:28,966 - INFO - TPL computed on 93 samples: 1.0002
2025-10-21 05:25:28,966 - INFO - Temporal Perplexity (TPL): 1.0002
2025-10-21 05:25:28,966 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:25:33,574 - INFO - Checkpoint saved: epoch 24
2025-10-21 05:25:46,002 - INFO - Epoch 25, Step 50/300 - Loss: 0.0110, Perplexity: 1.0142, LR: 2.06e-05
2025-10-21 05:25:58,162 - INFO - Epoch 25, Step 100/300 - Loss: 0.0058, Perplexity: 1.0074, LR: 2.00e-05
2025-10-21 05:26:10,830 - INFO - Epoch 25, Step 150/300 - Loss: 0.0122, Perplexity: 1.0213, LR: 1.94e-05
2025-10-21 05:26:23,164 - INFO - Epoch 25, Step 200/300 - Loss: 0.0108, Perplexity: 1.0178, LR: 1.88e-05
2025-10-21 05:26:35,663 - INFO - Epoch 25, Step 250/300 - Loss: 0.0087, Perplexity: 1.0143, LR: 1.82e-05
2025-10-21 05:26:47,877 - INFO - Epoch 25, Step 300/300 - Loss: 0.0119, Perplexity: 1.0202, LR: 1.76e-05
2025-10-21 05:26:47,877 - INFO - Epoch 25 Complete - Avg Loss: 0.0119, Avg Perplexity: 1.0202
2025-10-21 05:26:53,851 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:26:53,851 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:26:54,731 - INFO - TPL computed on 93 samples: 1.0002
2025-10-21 05:26:54,731 - INFO - Temporal Perplexity (TPL): 1.0002
2025-10-21 05:26:54,731 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:26:59,348 - INFO - Checkpoint saved: epoch 25
2025-10-21 05:27:11,354 - INFO - Epoch 26, Step 50/300 - Loss: 0.0085, Perplexity: 1.0104, LR: 1.71e-05
2025-10-21 05:27:23,718 - INFO - Epoch 26, Step 100/300 - Loss: 0.0077, Perplexity: 1.0092, LR: 1.65e-05
2025-10-21 05:27:35,969 - INFO - Epoch 26, Step 150/300 - Loss: 0.0055, Perplexity: 1.0065, LR: 1.59e-05
2025-10-21 05:27:48,316 - INFO - Epoch 26, Step 200/300 - Loss: 0.0055, Perplexity: 1.0064, LR: 1.53e-05
2025-10-21 05:28:00,717 - INFO - Epoch 26, Step 250/300 - Loss: 0.0141, Perplexity: 1.0237, LR: 1.47e-05
2025-10-21 05:28:12,691 - INFO - Epoch 26, Step 300/300 - Loss: 0.0118, Perplexity: 1.0198, LR: 1.41e-05
2025-10-21 05:28:12,692 - INFO - Epoch 26 Complete - Avg Loss: 0.0118, Avg Perplexity: 1.0198
2025-10-21 05:28:18,575 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:28:18,576 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:28:19,463 - INFO - TPL computed on 93 samples: 1.0001
2025-10-21 05:28:19,463 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-21 05:28:19,463 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:28:24,076 - INFO - Checkpoint saved: epoch 26
2025-10-21 05:28:36,917 - INFO - Epoch 27, Step 50/300 - Loss: 0.0026, Perplexity: 1.0028, LR: 1.35e-05
2025-10-21 05:28:49,321 - INFO - Epoch 27, Step 100/300 - Loss: 0.0126, Perplexity: 1.0217, LR: 1.29e-05
2025-10-21 05:29:01,970 - INFO - Epoch 27, Step 150/300 - Loss: 0.0115, Perplexity: 1.0181, LR: 1.24e-05
2025-10-21 05:29:14,272 - INFO - Epoch 27, Step 200/300 - Loss: 0.0143, Perplexity: 1.0239, LR: 1.18e-05
2025-10-21 05:29:26,669 - INFO - Epoch 27, Step 250/300 - Loss: 0.0116, Perplexity: 1.0192, LR: 1.12e-05
2025-10-21 05:29:38,848 - INFO - Epoch 27, Step 300/300 - Loss: 0.0097, Perplexity: 1.0161, LR: 1.06e-05
2025-10-21 05:29:38,848 - INFO - Epoch 27 Complete - Avg Loss: 0.0097, Avg Perplexity: 1.0161
2025-10-21 05:29:44,627 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:29:44,628 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:29:45,511 - INFO - TPL computed on 93 samples: 1.0001
2025-10-21 05:29:45,511 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-21 05:29:45,511 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:29:49,899 - INFO - Checkpoint saved: epoch 27
2025-10-21 05:30:02,442 - INFO - Epoch 28, Step 50/300 - Loss: 0.0196, Perplexity: 1.0301, LR: 1.00e-05
2025-10-21 05:30:14,749 - INFO - Epoch 28, Step 100/300 - Loss: 0.0100, Perplexity: 1.0153, LR: 9.41e-06
2025-10-21 05:30:27,211 - INFO - Epoch 28, Step 150/300 - Loss: 0.0069, Perplexity: 1.0104, LR: 8.82e-06
2025-10-21 05:30:39,627 - INFO - Epoch 28, Step 200/300 - Loss: 0.0052, Perplexity: 1.0079, LR: 8.24e-06
2025-10-21 05:30:51,670 - INFO - Epoch 28, Step 250/300 - Loss: 0.0043, Perplexity: 1.0064, LR: 7.65e-06
2025-10-21 05:31:04,005 - INFO - Epoch 28, Step 300/300 - Loss: 0.0081, Perplexity: 1.0121, LR: 7.06e-06
2025-10-21 05:31:04,005 - INFO - Epoch 28 Complete - Avg Loss: 0.0081, Avg Perplexity: 1.0121
2025-10-21 05:31:09,822 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:31:09,823 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:31:10,701 - INFO - TPL computed on 93 samples: 1.0001
2025-10-21 05:31:10,701 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-21 05:31:10,701 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:31:15,323 - INFO - Checkpoint saved: epoch 28
2025-10-21 05:31:27,319 - INFO - Epoch 29, Step 50/300 - Loss: 0.0199, Perplexity: 1.0308, LR: 6.47e-06
2025-10-21 05:31:39,633 - INFO - Epoch 29, Step 100/300 - Loss: 0.0109, Perplexity: 1.0164, LR: 5.88e-06
2025-10-21 05:31:52,275 - INFO - Epoch 29, Step 150/300 - Loss: 0.0075, Perplexity: 1.0111, LR: 5.29e-06
2025-10-21 05:32:04,761 - INFO - Epoch 29, Step 200/300 - Loss: 0.0068, Perplexity: 1.0097, LR: 4.71e-06
2025-10-21 05:32:17,011 - INFO - Epoch 29, Step 250/300 - Loss: 0.0085, Perplexity: 1.0122, LR: 4.12e-06
2025-10-21 05:32:29,638 - INFO - Epoch 29, Step 300/300 - Loss: 0.0071, Perplexity: 1.0102, LR: 3.53e-06
2025-10-21 05:32:29,639 - INFO - Epoch 29 Complete - Avg Loss: 0.0071, Avg Perplexity: 1.0102
2025-10-21 05:32:35,493 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:32:35,494 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:32:36,381 - INFO - TPL computed on 93 samples: 1.0001
2025-10-21 05:32:36,381 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-21 05:32:36,381 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:32:40,313 - INFO - Checkpoint saved: epoch 29
2025-10-21 05:32:52,505 - INFO - Epoch 30, Step 50/300 - Loss: 0.0018, Perplexity: 1.0019, LR: 2.94e-06
2025-10-21 05:33:05,084 - INFO - Epoch 30, Step 100/300 - Loss: 0.0011, Perplexity: 1.0012, LR: 2.35e-06
2025-10-21 05:33:17,148 - INFO - Epoch 30, Step 150/300 - Loss: 0.0055, Perplexity: 1.0075, LR: 1.76e-06
2025-10-21 05:33:29,463 - INFO - Epoch 30, Step 200/300 - Loss: 0.0081, Perplexity: 1.0112, LR: 1.18e-06
2025-10-21 05:33:41,868 - INFO - Epoch 30, Step 250/300 - Loss: 0.0067, Perplexity: 1.0091, LR: 5.88e-07
2025-10-21 05:33:53,973 - INFO - Epoch 30, Step 300/300 - Loss: 0.0063, Perplexity: 1.0085, LR: 0.00e+00
2025-10-21 05:33:53,974 - INFO - Epoch 30 Complete - Avg Loss: 0.0063, Avg Perplexity: 1.0085
2025-10-21 05:33:59,783 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-21 05:33:59,784 - INFO - Computing TPL on 93 patients with 2+ visits
2025-10-21 05:34:00,665 - INFO - TPL computed on 93 samples: 1.0001
2025-10-21 05:34:00,665 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-21 05:34:00,665 - INFO - New best model! Validation loss: 0.0001
2025-10-21 05:34:04,800 - INFO - Checkpoint saved: epoch 30
2025-10-21 05:34:04,800 - INFO - 
================================================================================
2025-10-21 05:34:04,800 - INFO - Training Complete!
2025-10-21 05:34:04,801 - INFO - ================================================================================
2025-10-21 05:34:04,801 - INFO - Best validation loss: 0.0001
2025-10-21 05:34:04,801 - INFO - Best validation perplexity: 1.0001
2025-10-22 01:45:54,849 - INFO - ================================================================================
2025-10-22 01:45:54,849 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-22 01:45:54,849 - INFO - ================================================================================
2025-10-22 01:45:54,850 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 2
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 50
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-22 01:45:54,853 - INFO - 
Random seed: 42
2025-10-22 01:45:55,073 - INFO - Device: cuda
2025-10-22 01:45:55,073 - INFO - 
================================================================================
2025-10-22 01:45:55,073 - INFO - Loading MIMIC-III Data
2025-10-22 01:45:55,073 - INFO - ================================================================================
2025-10-22 01:45:55,074 - INFO - Loading MIMIC-III data files
2025-10-22 01:45:55,132 - INFO - Loaded 46520 patients
2025-10-22 01:45:55,279 - INFO - Loaded 58976 admissions
2025-10-22 01:45:55,452 - INFO - Loaded 651047 diagnosis records
2025-10-22 01:45:55,727 - INFO - Processing patient records
2025-10-22 01:46:04,245 - INFO - Loaded 10000 patient records
2025-10-22 01:46:04,246 - INFO - Diagnosis vocabulary size: 4253
2025-10-22 01:46:04,250 - INFO - Average visits per patient: 1.29
2025-10-22 01:46:04,250 - INFO - Average codes per visit: 9.16
2025-10-22 01:46:04,251 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-22 01:46:04,253 - INFO - Ethnicity distribution: {'WHITE': 6619, 'UNKNOWN/NOT SPECIFIED': 1351, 'BLACK': 846, 'OTHER': 461, 'ASIAN': 400, 'HISPANIC OR LATINO': 323}
2025-10-22 01:46:04,272 - INFO - Loaded 10000 patients
2025-10-22 01:46:04,272 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-22 01:46:04,272 - INFO - Tokenizer vocab size: 4260
2025-10-22 01:46:04,273 - INFO - Dataset size: 10000 patients
2025-10-22 01:46:04,273 - INFO - Train size: 8000, Validation size: 2000
2025-10-22 01:46:04,274 - INFO - Train batches: 1000, Validation batches: 250
2025-10-22 01:46:04,274 - INFO - 
================================================================================
2025-10-22 01:46:04,274 - INFO - Initializing Model
2025-10-22 01:46:04,274 - INFO - ================================================================================
2025-10-22 01:46:04,373 - INFO - BART config vocab size: 4260
2025-10-22 01:46:06,490 - INFO - Total parameters: 104,484,864
2025-10-22 01:46:06,490 - INFO - Trainable parameters: 104,484,864
2025-10-22 01:46:06,491 - INFO - Total training steps: 50000
2025-10-22 01:46:06,491 - INFO - Warmup steps: 1000
2025-10-22 01:46:06,491 - INFO - 
================================================================================
2025-10-22 01:46:06,491 - INFO - Starting Training
2025-10-22 01:46:06,491 - INFO - ================================================================================
2025-10-22 01:46:19,099 - INFO - Epoch 1, Step 50/1000 - Loss: 7.5456, Perplexity: 2158.9956, LR: 5.00e-06
2025-10-22 01:46:31,654 - INFO - Epoch 1, Step 100/1000 - Loss: 6.7606, Perplexity: 1299.2238, LR: 1.00e-05
2025-10-22 01:46:44,112 - INFO - Epoch 1, Step 150/1000 - Loss: 6.2510, Perplexity: 941.0535, LR: 1.50e-05
2025-10-22 01:46:56,369 - INFO - Epoch 1, Step 200/1000 - Loss: 5.9543, Perplexity: 750.5806, LR: 2.00e-05
2025-10-22 01:47:09,163 - INFO - Epoch 1, Step 250/1000 - Loss: 5.6993, Perplexity: 625.8390, LR: 2.50e-05
2025-10-22 01:47:21,899 - INFO - Epoch 1, Step 300/1000 - Loss: 5.4943, Perplexity: 538.8060, LR: 3.00e-05
2025-10-22 01:47:33,963 - INFO - Epoch 1, Step 350/1000 - Loss: 5.3296, Perplexity: 474.5475, LR: 3.50e-05
2025-10-22 01:47:46,339 - INFO - Epoch 1, Step 400/1000 - Loss: 5.1936, Perplexity: 425.1282, LR: 4.00e-05
2025-10-22 01:47:59,031 - INFO - Epoch 1, Step 450/1000 - Loss: 5.0617, Perplexity: 385.5398, LR: 4.50e-05
2025-10-22 01:48:11,690 - INFO - Epoch 1, Step 500/1000 - Loss: 4.8995, Perplexity: 351.0853, LR: 5.00e-05
2025-10-22 01:48:24,189 - INFO - Epoch 1, Step 550/1000 - Loss: 4.7105, Perplexity: 321.7383, LR: 5.50e-05
2025-10-22 01:48:36,497 - INFO - Epoch 1, Step 600/1000 - Loss: 4.4928, Perplexity: 296.1863, LR: 6.00e-05
2025-10-22 01:48:49,371 - INFO - Epoch 1, Step 650/1000 - Loss: 4.2651, Perplexity: 273.8513, LR: 6.50e-05
2025-10-22 01:49:02,362 - INFO - Epoch 1, Step 700/1000 - Loss: 4.0326, Perplexity: 254.5271, LR: 7.00e-05
2025-10-22 01:49:14,900 - INFO - Epoch 1, Step 750/1000 - Loss: 3.8162, Perplexity: 237.8231, LR: 7.50e-05
2025-10-22 01:49:27,445 - INFO - Epoch 1, Step 800/1000 - Loss: 3.6303, Perplexity: 223.2280, LR: 8.00e-05
2025-10-22 01:49:40,017 - INFO - Epoch 1, Step 850/1000 - Loss: 3.4577, Perplexity: 210.3740, LR: 8.50e-05
2025-10-22 01:49:52,665 - INFO - Epoch 1, Step 900/1000 - Loss: 3.2970, Perplexity: 198.8327, LR: 9.00e-05
2025-10-22 01:50:05,404 - INFO - Epoch 1, Step 950/1000 - Loss: 3.1490, Perplexity: 188.4696, LR: 9.50e-05
2025-10-22 01:50:17,684 - INFO - Epoch 1, Step 1000/1000 - Loss: 3.0070, Perplexity: 179.1167, LR: 1.00e-04
2025-10-22 01:50:17,685 - INFO - Epoch 1 Complete - Avg Loss: 3.0070, Avg Perplexity: 179.1167
2025-10-22 01:50:37,539 - INFO - Validation - Loss: 0.3467, Perplexity: 2.0953, Token Accuracy: 0.9588, Code Accuracy: 0.9515
2025-10-22 01:50:37,540 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 01:50:41,003 - INFO - TPL computed on 351 samples: 1.7695
2025-10-22 01:50:41,004 - INFO - Temporal Perplexity (TPL): 1.7695
2025-10-22 01:50:41,004 - INFO - New best model! Validation loss: 0.3467
2025-10-22 01:50:45,239 - INFO - Checkpoint saved: epoch 1
2025-10-22 01:50:57,389 - INFO - Epoch 2, Step 50/1000 - Loss: 0.3593, Perplexity: 1.9563, LR: 9.99e-05
2025-10-22 01:51:09,721 - INFO - Epoch 2, Step 100/1000 - Loss: 0.2864, Perplexity: 1.6456, LR: 9.98e-05
2025-10-22 01:51:22,214 - INFO - Epoch 2, Step 150/1000 - Loss: 0.3024, Perplexity: 1.6946, LR: 9.97e-05
2025-10-22 01:51:34,672 - INFO - Epoch 2, Step 200/1000 - Loss: 0.2935, Perplexity: 1.6257, LR: 9.96e-05
2025-10-22 01:51:47,346 - INFO - Epoch 2, Step 250/1000 - Loss: 0.2833, Perplexity: 1.5851, LR: 9.95e-05
2025-10-22 01:51:59,753 - INFO - Epoch 2, Step 300/1000 - Loss: 0.2731, Perplexity: 1.5562, LR: 9.94e-05
2025-10-22 01:52:12,240 - INFO - Epoch 2, Step 350/1000 - Loss: 0.2523, Perplexity: 1.5045, LR: 9.93e-05
2025-10-22 01:52:24,815 - INFO - Epoch 2, Step 400/1000 - Loss: 0.2496, Perplexity: 1.5031, LR: 9.92e-05
2025-10-22 01:52:36,776 - INFO - Epoch 2, Step 450/1000 - Loss: 0.2430, Perplexity: 1.4885, LR: 9.91e-05
2025-10-22 01:52:49,406 - INFO - Epoch 2, Step 500/1000 - Loss: 0.2363, Perplexity: 1.4818, LR: 9.90e-05
2025-10-22 01:53:01,691 - INFO - Epoch 2, Step 550/1000 - Loss: 0.2234, Perplexity: 1.4491, LR: 9.89e-05
2025-10-22 01:53:14,122 - INFO - Epoch 2, Step 600/1000 - Loss: 0.2166, Perplexity: 1.4342, LR: 9.88e-05
2025-10-22 01:53:26,374 - INFO - Epoch 2, Step 650/1000 - Loss: 0.2101, Perplexity: 1.4493, LR: 9.87e-05
2025-10-22 01:53:39,148 - INFO - Epoch 2, Step 700/1000 - Loss: 0.1991, Perplexity: 1.4214, LR: 9.86e-05
2025-10-22 01:53:51,538 - INFO - Epoch 2, Step 750/1000 - Loss: 0.1934, Perplexity: 1.4076, LR: 9.85e-05
2025-10-22 01:54:04,286 - INFO - Epoch 2, Step 800/1000 - Loss: 0.1844, Perplexity: 1.3854, LR: 9.84e-05
2025-10-22 01:54:16,685 - INFO - Epoch 2, Step 850/1000 - Loss: 0.1803, Perplexity: 1.3861, LR: 9.83e-05
2025-10-22 01:54:29,048 - INFO - Epoch 2, Step 900/1000 - Loss: 0.1801, Perplexity: 1.4137, LR: 9.82e-05
2025-10-22 01:54:41,850 - INFO - Epoch 2, Step 950/1000 - Loss: 0.1755, Perplexity: 1.3985, LR: 9.81e-05
2025-10-22 01:54:54,480 - INFO - Epoch 2, Step 1000/1000 - Loss: 0.1724, Perplexity: 1.3983, LR: 9.80e-05
2025-10-22 01:54:54,480 - INFO - Epoch 2 Complete - Avg Loss: 0.1724, Avg Perplexity: 1.3983
2025-10-22 01:55:14,269 - INFO - Validation - Loss: 0.0898, Perplexity: 1.3273, Token Accuracy: 0.9873, Code Accuracy: 0.9853
2025-10-22 01:55:14,271 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 01:55:17,735 - INFO - TPL computed on 351 samples: 1.1470
2025-10-22 01:55:17,735 - INFO - Temporal Perplexity (TPL): 1.1470
2025-10-22 01:55:17,735 - INFO - New best model! Validation loss: 0.0898
2025-10-22 01:55:22,138 - INFO - Checkpoint saved: epoch 2
2025-10-22 01:55:34,718 - INFO - Epoch 3, Step 50/1000 - Loss: 0.0988, Perplexity: 1.2642, LR: 9.79e-05
2025-10-22 01:55:47,175 - INFO - Epoch 3, Step 100/1000 - Loss: 0.0768, Perplexity: 1.1925, LR: 9.78e-05
2025-10-22 01:55:59,557 - INFO - Epoch 3, Step 150/1000 - Loss: 0.0783, Perplexity: 1.1758, LR: 9.77e-05
2025-10-22 01:56:12,057 - INFO - Epoch 3, Step 200/1000 - Loss: 0.0652, Perplexity: 1.1388, LR: 9.76e-05
2025-10-22 01:56:24,698 - INFO - Epoch 3, Step 250/1000 - Loss: 0.0562, Perplexity: 1.1152, LR: 9.74e-05
2025-10-22 01:56:37,228 - INFO - Epoch 3, Step 300/1000 - Loss: 0.0634, Perplexity: 1.1497, LR: 9.73e-05
2025-10-22 01:56:49,865 - INFO - Epoch 3, Step 350/1000 - Loss: 0.0576, Perplexity: 1.1318, LR: 9.72e-05
2025-10-22 01:57:02,260 - INFO - Epoch 3, Step 400/1000 - Loss: 0.0601, Perplexity: 1.1300, LR: 9.71e-05
2025-10-22 01:57:14,599 - INFO - Epoch 3, Step 450/1000 - Loss: 0.0618, Perplexity: 1.1337, LR: 9.70e-05
2025-10-22 01:57:27,063 - INFO - Epoch 3, Step 500/1000 - Loss: 0.0604, Perplexity: 1.1263, LR: 9.69e-05
2025-10-22 01:57:39,620 - INFO - Epoch 3, Step 550/1000 - Loss: 0.0581, Perplexity: 1.1184, LR: 9.68e-05
2025-10-22 01:57:52,161 - INFO - Epoch 3, Step 600/1000 - Loss: 0.0559, Perplexity: 1.1117, LR: 9.67e-05
2025-10-22 01:58:04,826 - INFO - Epoch 3, Step 650/1000 - Loss: 0.0571, Perplexity: 1.1238, LR: 9.66e-05
2025-10-22 01:58:17,487 - INFO - Epoch 3, Step 700/1000 - Loss: 0.0549, Perplexity: 1.1172, LR: 9.65e-05
2025-10-22 01:58:29,981 - INFO - Epoch 3, Step 750/1000 - Loss: 0.0539, Perplexity: 1.1123, LR: 9.64e-05
2025-10-22 01:58:42,369 - INFO - Epoch 3, Step 800/1000 - Loss: 0.0545, Perplexity: 1.1194, LR: 9.63e-05
2025-10-22 01:58:54,665 - INFO - Epoch 3, Step 850/1000 - Loss: 0.0525, Perplexity: 1.1136, LR: 9.62e-05
2025-10-22 01:59:07,483 - INFO - Epoch 3, Step 900/1000 - Loss: 0.0587, Perplexity: 1.1388, LR: 9.61e-05
2025-10-22 01:59:20,038 - INFO - Epoch 3, Step 950/1000 - Loss: 0.0563, Perplexity: 1.1321, LR: 9.60e-05
2025-10-22 01:59:32,369 - INFO - Epoch 3, Step 1000/1000 - Loss: 0.0550, Perplexity: 1.1274, LR: 9.59e-05
2025-10-22 01:59:32,370 - INFO - Epoch 3 Complete - Avg Loss: 0.0550, Avg Perplexity: 1.1274
2025-10-22 01:59:52,254 - INFO - Validation - Loss: 0.0539, Perplexity: 1.1690, Token Accuracy: 0.9925, Code Accuracy: 0.9911
2025-10-22 01:59:52,256 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 01:59:55,704 - INFO - TPL computed on 351 samples: 1.0844
2025-10-22 01:59:55,705 - INFO - Temporal Perplexity (TPL): 1.0844
2025-10-22 01:59:55,705 - INFO - New best model! Validation loss: 0.0539
2025-10-22 02:00:00,249 - INFO - Checkpoint saved: epoch 3
2025-10-22 02:00:12,268 - INFO - Epoch 4, Step 50/1000 - Loss: 0.0626, Perplexity: 1.1153, LR: 9.58e-05
2025-10-22 02:00:24,682 - INFO - Epoch 4, Step 100/1000 - Loss: 0.0594, Perplexity: 1.1513, LR: 9.57e-05
2025-10-22 02:00:37,422 - INFO - Epoch 4, Step 150/1000 - Loss: 0.0753, Perplexity: 1.2210, LR: 9.56e-05
2025-10-22 02:00:49,982 - INFO - Epoch 4, Step 200/1000 - Loss: 0.0589, Perplexity: 1.1682, LR: 9.55e-05
2025-10-22 02:01:02,126 - INFO - Epoch 4, Step 250/1000 - Loss: 0.0683, Perplexity: 1.1965, LR: 9.54e-05
2025-10-22 02:01:14,694 - INFO - Epoch 4, Step 300/1000 - Loss: 0.0591, Perplexity: 1.1660, LR: 9.53e-05
2025-10-22 02:01:27,158 - INFO - Epoch 4, Step 350/1000 - Loss: 0.0516, Perplexity: 1.1432, LR: 9.52e-05
2025-10-22 02:01:39,780 - INFO - Epoch 4, Step 400/1000 - Loss: 0.0509, Perplexity: 1.1332, LR: 9.51e-05
2025-10-22 02:01:52,267 - INFO - Epoch 4, Step 450/1000 - Loss: 0.0470, Perplexity: 1.1202, LR: 9.50e-05
2025-10-22 02:02:04,477 - INFO - Epoch 4, Step 500/1000 - Loss: 0.0435, Perplexity: 1.1095, LR: 9.49e-05
2025-10-22 02:02:17,223 - INFO - Epoch 4, Step 550/1000 - Loss: 0.0450, Perplexity: 1.1180, LR: 9.48e-05
2025-10-22 02:02:29,636 - INFO - Epoch 4, Step 600/1000 - Loss: 0.0428, Perplexity: 1.1098, LR: 9.47e-05
2025-10-22 02:02:41,742 - INFO - Epoch 4, Step 650/1000 - Loss: 0.0405, Perplexity: 1.1024, LR: 9.46e-05
2025-10-22 02:02:54,249 - INFO - Epoch 4, Step 700/1000 - Loss: 0.0410, Perplexity: 1.1037, LR: 9.45e-05
2025-10-22 02:03:06,512 - INFO - Epoch 4, Step 750/1000 - Loss: 0.0390, Perplexity: 1.0975, LR: 9.44e-05
2025-10-22 02:03:18,851 - INFO - Epoch 4, Step 800/1000 - Loss: 0.0372, Perplexity: 1.0920, LR: 9.43e-05
2025-10-22 02:03:31,029 - INFO - Epoch 4, Step 850/1000 - Loss: 0.0375, Perplexity: 1.0897, LR: 9.42e-05
2025-10-22 02:03:43,631 - INFO - Epoch 4, Step 900/1000 - Loss: 0.0375, Perplexity: 1.0872, LR: 9.41e-05
2025-10-22 02:03:56,384 - INFO - Epoch 4, Step 950/1000 - Loss: 0.0359, Perplexity: 1.0830, LR: 9.40e-05
2025-10-22 02:04:08,996 - INFO - Epoch 4, Step 1000/1000 - Loss: 0.0348, Perplexity: 1.0797, LR: 9.39e-05
2025-10-22 02:04:08,997 - INFO - Epoch 4 Complete - Avg Loss: 0.0348, Avg Perplexity: 1.0797
2025-10-22 02:04:28,801 - INFO - Validation - Loss: 0.0366, Perplexity: 1.1060, Token Accuracy: 0.9947, Code Accuracy: 0.9937
2025-10-22 02:04:28,803 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:04:32,253 - INFO - TPL computed on 351 samples: 1.0644
2025-10-22 02:04:32,254 - INFO - Temporal Perplexity (TPL): 1.0644
2025-10-22 02:04:32,254 - INFO - New best model! Validation loss: 0.0366
2025-10-22 02:04:36,915 - INFO - Checkpoint saved: epoch 4
2025-10-22 02:04:49,548 - INFO - Epoch 5, Step 50/1000 - Loss: 0.0119, Perplexity: 1.0122, LR: 9.38e-05
2025-10-22 02:05:02,040 - INFO - Epoch 5, Step 100/1000 - Loss: 0.0288, Perplexity: 1.0457, LR: 9.37e-05
2025-10-22 02:05:14,380 - INFO - Epoch 5, Step 150/1000 - Loss: 0.0296, Perplexity: 1.0446, LR: 9.36e-05
2025-10-22 02:05:26,774 - INFO - Epoch 5, Step 200/1000 - Loss: 0.0426, Perplexity: 1.1340, LR: 9.35e-05
2025-10-22 02:05:39,515 - INFO - Epoch 5, Step 250/1000 - Loss: 0.0456, Perplexity: 1.1331, LR: 9.34e-05
2025-10-22 02:05:51,647 - INFO - Epoch 5, Step 300/1000 - Loss: 0.0425, Perplexity: 1.1170, LR: 9.33e-05
2025-10-22 02:06:04,573 - INFO - Epoch 5, Step 350/1000 - Loss: 0.0450, Perplexity: 1.1221, LR: 9.32e-05
2025-10-22 02:06:17,002 - INFO - Epoch 5, Step 400/1000 - Loss: 0.0409, Perplexity: 1.1085, LR: 9.31e-05
2025-10-22 02:06:29,431 - INFO - Epoch 5, Step 450/1000 - Loss: 0.0375, Perplexity: 1.0976, LR: 9.30e-05
2025-10-22 02:06:42,270 - INFO - Epoch 5, Step 500/1000 - Loss: 0.0360, Perplexity: 1.0905, LR: 9.29e-05
2025-10-22 02:06:54,708 - INFO - Epoch 5, Step 550/1000 - Loss: 0.0335, Perplexity: 1.0831, LR: 9.28e-05
2025-10-22 02:07:07,355 - INFO - Epoch 5, Step 600/1000 - Loss: 0.0337, Perplexity: 1.0829, LR: 9.27e-05
2025-10-22 02:07:20,185 - INFO - Epoch 5, Step 650/1000 - Loss: 0.0342, Perplexity: 1.0822, LR: 9.26e-05
2025-10-22 02:07:32,733 - INFO - Epoch 5, Step 700/1000 - Loss: 0.0352, Perplexity: 1.0864, LR: 9.24e-05
2025-10-22 02:07:45,190 - INFO - Epoch 5, Step 750/1000 - Loss: 0.0338, Perplexity: 1.0816, LR: 9.23e-05
2025-10-22 02:07:57,926 - INFO - Epoch 5, Step 800/1000 - Loss: 0.0321, Perplexity: 1.0769, LR: 9.22e-05
2025-10-22 02:08:10,305 - INFO - Epoch 5, Step 850/1000 - Loss: 0.0308, Perplexity: 1.0731, LR: 9.21e-05
2025-10-22 02:08:22,740 - INFO - Epoch 5, Step 900/1000 - Loss: 0.0305, Perplexity: 1.0710, LR: 9.20e-05
2025-10-22 02:08:35,091 - INFO - Epoch 5, Step 950/1000 - Loss: 0.0292, Perplexity: 1.0676, LR: 9.19e-05
2025-10-22 02:08:47,771 - INFO - Epoch 5, Step 1000/1000 - Loss: 0.0319, Perplexity: 1.0751, LR: 9.18e-05
2025-10-22 02:08:47,772 - INFO - Epoch 5 Complete - Avg Loss: 0.0319, Avg Perplexity: 1.0751
2025-10-22 02:09:07,542 - INFO - Validation - Loss: 0.0455, Perplexity: 1.1182, Token Accuracy: 0.9937, Code Accuracy: 0.9927
2025-10-22 02:09:07,543 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:09:11,008 - INFO - TPL computed on 351 samples: 1.0808
2025-10-22 02:09:11,008 - INFO - Temporal Perplexity (TPL): 1.0808
2025-10-22 02:09:13,308 - INFO - Checkpoint saved: epoch 5
2025-10-22 02:09:25,653 - INFO - Epoch 6, Step 50/1000 - Loss: 0.0117, Perplexity: 1.0122, LR: 9.17e-05
2025-10-22 02:09:38,248 - INFO - Epoch 6, Step 100/1000 - Loss: 0.0091, Perplexity: 1.0095, LR: 9.16e-05
2025-10-22 02:09:50,743 - INFO - Epoch 6, Step 150/1000 - Loss: 0.0166, Perplexity: 1.0269, LR: 9.15e-05
2025-10-22 02:10:03,086 - INFO - Epoch 6, Step 200/1000 - Loss: 0.0142, Perplexity: 1.0220, LR: 9.14e-05
2025-10-22 02:10:15,478 - INFO - Epoch 6, Step 250/1000 - Loss: 0.0135, Perplexity: 1.0198, LR: 9.13e-05
2025-10-22 02:10:28,070 - INFO - Epoch 6, Step 300/1000 - Loss: 0.0262, Perplexity: 1.0494, LR: 9.12e-05
2025-10-22 02:10:40,601 - INFO - Epoch 6, Step 350/1000 - Loss: 0.0237, Perplexity: 1.0436, LR: 9.11e-05
2025-10-22 02:10:53,070 - INFO - Epoch 6, Step 400/1000 - Loss: 0.0219, Perplexity: 1.0393, LR: 9.10e-05
2025-10-22 02:11:05,661 - INFO - Epoch 6, Step 450/1000 - Loss: 0.0209, Perplexity: 1.0364, LR: 9.09e-05
2025-10-22 02:11:17,910 - INFO - Epoch 6, Step 500/1000 - Loss: 0.0217, Perplexity: 1.0365, LR: 9.08e-05
2025-10-22 02:11:30,413 - INFO - Epoch 6, Step 550/1000 - Loss: 0.0232, Perplexity: 1.0375, LR: 9.07e-05
2025-10-22 02:11:42,729 - INFO - Epoch 6, Step 600/1000 - Loss: 0.0260, Perplexity: 1.0431, LR: 9.06e-05
2025-10-22 02:11:55,050 - INFO - Epoch 6, Step 650/1000 - Loss: 0.0242, Perplexity: 1.0401, LR: 9.05e-05
2025-10-22 02:12:07,746 - INFO - Epoch 6, Step 700/1000 - Loss: 0.0234, Perplexity: 1.0381, LR: 9.04e-05
2025-10-22 02:12:20,173 - INFO - Epoch 6, Step 750/1000 - Loss: 0.0223, Perplexity: 1.0361, LR: 9.03e-05
2025-10-22 02:12:32,698 - INFO - Epoch 6, Step 800/1000 - Loss: 0.0219, Perplexity: 1.0349, LR: 9.02e-05
2025-10-22 02:12:44,932 - INFO - Epoch 6, Step 850/1000 - Loss: 0.0212, Perplexity: 1.0334, LR: 9.01e-05
2025-10-22 02:12:57,452 - INFO - Epoch 6, Step 900/1000 - Loss: 0.0210, Perplexity: 1.0326, LR: 9.00e-05
2025-10-22 02:13:09,686 - INFO - Epoch 6, Step 950/1000 - Loss: 0.0234, Perplexity: 1.0377, LR: 8.99e-05
2025-10-22 02:13:22,389 - INFO - Epoch 6, Step 1000/1000 - Loss: 0.0231, Perplexity: 1.0368, LR: 8.98e-05
2025-10-22 02:13:22,390 - INFO - Epoch 6 Complete - Avg Loss: 0.0231, Avg Perplexity: 1.0368
2025-10-22 02:13:42,011 - INFO - Validation - Loss: 0.0320, Perplexity: 1.1132, Token Accuracy: 0.9958, Code Accuracy: 0.9952
2025-10-22 02:13:42,013 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:13:45,466 - INFO - TPL computed on 351 samples: 1.0546
2025-10-22 02:13:45,466 - INFO - Temporal Perplexity (TPL): 1.0546
2025-10-22 02:13:45,466 - INFO - New best model! Validation loss: 0.0320
2025-10-22 02:13:49,617 - INFO - Checkpoint saved: epoch 6
2025-10-22 02:14:01,855 - INFO - Epoch 7, Step 50/1000 - Loss: 0.0549, Perplexity: 1.1245, LR: 8.97e-05
2025-10-22 02:14:14,464 - INFO - Epoch 7, Step 100/1000 - Loss: 0.0446, Perplexity: 1.0923, LR: 8.96e-05
2025-10-22 02:14:26,801 - INFO - Epoch 7, Step 150/1000 - Loss: 0.0366, Perplexity: 1.0701, LR: 8.95e-05
2025-10-22 02:14:39,308 - INFO - Epoch 7, Step 200/1000 - Loss: 0.0381, Perplexity: 1.0756, LR: 8.94e-05
2025-10-22 02:14:51,638 - INFO - Epoch 7, Step 250/1000 - Loss: 0.0336, Perplexity: 1.0640, LR: 8.93e-05
2025-10-22 02:15:04,239 - INFO - Epoch 7, Step 300/1000 - Loss: 0.0290, Perplexity: 1.0543, LR: 8.92e-05
2025-10-22 02:15:16,418 - INFO - Epoch 7, Step 350/1000 - Loss: 0.0299, Perplexity: 1.0546, LR: 8.91e-05
2025-10-22 02:15:28,959 - INFO - Epoch 7, Step 400/1000 - Loss: 0.0270, Perplexity: 1.0486, LR: 8.90e-05
2025-10-22 02:15:41,469 - INFO - Epoch 7, Step 450/1000 - Loss: 0.0298, Perplexity: 1.0545, LR: 8.89e-05
2025-10-22 02:15:54,184 - INFO - Epoch 7, Step 500/1000 - Loss: 0.0274, Perplexity: 1.0497, LR: 8.88e-05
2025-10-22 02:16:06,888 - INFO - Epoch 7, Step 550/1000 - Loss: 0.0255, Perplexity: 1.0457, LR: 8.87e-05
2025-10-22 02:16:19,587 - INFO - Epoch 7, Step 600/1000 - Loss: 0.0240, Perplexity: 1.0426, LR: 8.86e-05
2025-10-22 02:16:32,059 - INFO - Epoch 7, Step 650/1000 - Loss: 0.0225, Perplexity: 1.0396, LR: 8.85e-05
2025-10-22 02:16:44,643 - INFO - Epoch 7, Step 700/1000 - Loss: 0.0243, Perplexity: 1.0443, LR: 8.84e-05
2025-10-22 02:16:57,304 - INFO - Epoch 7, Step 750/1000 - Loss: 0.0252, Perplexity: 1.0477, LR: 8.83e-05
2025-10-22 02:17:10,127 - INFO - Epoch 7, Step 800/1000 - Loss: 0.0252, Perplexity: 1.0466, LR: 8.82e-05
2025-10-22 02:17:22,684 - INFO - Epoch 7, Step 850/1000 - Loss: 0.0241, Perplexity: 1.0442, LR: 8.81e-05
2025-10-22 02:17:34,981 - INFO - Epoch 7, Step 900/1000 - Loss: 0.0252, Perplexity: 1.0506, LR: 8.80e-05
2025-10-22 02:17:47,339 - INFO - Epoch 7, Step 950/1000 - Loss: 0.0245, Perplexity: 1.0486, LR: 8.79e-05
2025-10-22 02:17:59,963 - INFO - Epoch 7, Step 1000/1000 - Loss: 0.0236, Perplexity: 1.0465, LR: 8.78e-05
2025-10-22 02:17:59,964 - INFO - Epoch 7 Complete - Avg Loss: 0.0236, Avg Perplexity: 1.0465
2025-10-22 02:18:19,832 - INFO - Validation - Loss: 0.0384, Perplexity: 1.1510, Token Accuracy: 0.9950, Code Accuracy: 0.9943
2025-10-22 02:18:19,834 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:18:23,272 - INFO - TPL computed on 351 samples: 1.0610
2025-10-22 02:18:23,273 - INFO - Temporal Perplexity (TPL): 1.0610
2025-10-22 02:18:36,011 - INFO - Epoch 8, Step 50/1000 - Loss: 0.0040, Perplexity: 1.0040, LR: 8.77e-05
2025-10-22 02:18:48,122 - INFO - Epoch 8, Step 100/1000 - Loss: 0.0170, Perplexity: 1.0283, LR: 8.76e-05
2025-10-22 02:19:00,511 - INFO - Epoch 8, Step 150/1000 - Loss: 0.0230, Perplexity: 1.0434, LR: 8.74e-05
2025-10-22 02:19:13,143 - INFO - Epoch 8, Step 200/1000 - Loss: 0.0189, Perplexity: 1.0342, LR: 8.73e-05
2025-10-22 02:19:25,449 - INFO - Epoch 8, Step 250/1000 - Loss: 0.0241, Perplexity: 1.0509, LR: 8.72e-05
2025-10-22 02:19:37,860 - INFO - Epoch 8, Step 300/1000 - Loss: 0.0220, Perplexity: 1.0445, LR: 8.71e-05
2025-10-22 02:19:50,038 - INFO - Epoch 8, Step 350/1000 - Loss: 0.0198, Perplexity: 1.0391, LR: 8.70e-05
2025-10-22 02:20:02,605 - INFO - Epoch 8, Step 400/1000 - Loss: 0.0199, Perplexity: 1.0375, LR: 8.69e-05
2025-10-22 02:20:14,999 - INFO - Epoch 8, Step 450/1000 - Loss: 0.0213, Perplexity: 1.0411, LR: 8.68e-05
2025-10-22 02:20:27,414 - INFO - Epoch 8, Step 500/1000 - Loss: 0.0196, Perplexity: 1.0375, LR: 8.67e-05
2025-10-22 02:20:39,960 - INFO - Epoch 8, Step 550/1000 - Loss: 0.0197, Perplexity: 1.0368, LR: 8.66e-05
2025-10-22 02:20:52,303 - INFO - Epoch 8, Step 600/1000 - Loss: 0.0184, Perplexity: 1.0340, LR: 8.65e-05
2025-10-22 02:21:05,053 - INFO - Epoch 8, Step 650/1000 - Loss: 0.0206, Perplexity: 1.0385, LR: 8.64e-05
2025-10-22 02:21:17,386 - INFO - Epoch 8, Step 700/1000 - Loss: 0.0216, Perplexity: 1.0391, LR: 8.63e-05
2025-10-22 02:21:29,743 - INFO - Epoch 8, Step 750/1000 - Loss: 0.0203, Perplexity: 1.0366, LR: 8.62e-05
2025-10-22 02:21:42,056 - INFO - Epoch 8, Step 800/1000 - Loss: 0.0211, Perplexity: 1.0384, LR: 8.61e-05
2025-10-22 02:21:54,609 - INFO - Epoch 8, Step 850/1000 - Loss: 0.0201, Perplexity: 1.0363, LR: 8.60e-05
2025-10-22 02:22:07,124 - INFO - Epoch 8, Step 900/1000 - Loss: 0.0192, Perplexity: 1.0346, LR: 8.59e-05
2025-10-22 02:22:19,808 - INFO - Epoch 8, Step 950/1000 - Loss: 0.0186, Perplexity: 1.0332, LR: 8.58e-05
2025-10-22 02:22:32,287 - INFO - Epoch 8, Step 1000/1000 - Loss: 0.0199, Perplexity: 1.0348, LR: 8.57e-05
2025-10-22 02:22:32,288 - INFO - Epoch 8 Complete - Avg Loss: 0.0199, Avg Perplexity: 1.0348
2025-10-22 02:22:52,315 - INFO - Validation - Loss: 0.0300, Perplexity: 1.0785, Token Accuracy: 0.9958, Code Accuracy: 0.9952
2025-10-22 02:22:52,316 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:22:55,730 - INFO - TPL computed on 351 samples: 1.0498
2025-10-22 02:22:55,730 - INFO - Temporal Perplexity (TPL): 1.0498
2025-10-22 02:22:55,730 - INFO - New best model! Validation loss: 0.0300
2025-10-22 02:22:59,928 - INFO - Checkpoint saved: epoch 8
2025-10-22 02:23:12,556 - INFO - Epoch 9, Step 50/1000 - Loss: 0.0081, Perplexity: 1.0083, LR: 8.56e-05
2025-10-22 02:23:25,116 - INFO - Epoch 9, Step 100/1000 - Loss: 0.0194, Perplexity: 1.0345, LR: 8.55e-05
2025-10-22 02:23:37,414 - INFO - Epoch 9, Step 150/1000 - Loss: 0.0133, Perplexity: 1.0234, LR: 8.54e-05
2025-10-22 02:23:50,105 - INFO - Epoch 9, Step 200/1000 - Loss: 0.0201, Perplexity: 1.0404, LR: 8.53e-05
2025-10-22 02:24:02,563 - INFO - Epoch 9, Step 250/1000 - Loss: 0.0187, Perplexity: 1.0354, LR: 8.52e-05
2025-10-22 02:24:14,868 - INFO - Epoch 9, Step 300/1000 - Loss: 0.0169, Perplexity: 1.0308, LR: 8.51e-05
2025-10-22 02:24:27,560 - INFO - Epoch 9, Step 350/1000 - Loss: 0.0152, Perplexity: 1.0272, LR: 8.50e-05
2025-10-22 02:24:40,459 - INFO - Epoch 9, Step 400/1000 - Loss: 0.0141, Perplexity: 1.0246, LR: 8.49e-05
2025-10-22 02:24:52,886 - INFO - Epoch 9, Step 450/1000 - Loss: 0.0188, Perplexity: 1.0343, LR: 8.48e-05
2025-10-22 02:25:05,547 - INFO - Epoch 9, Step 500/1000 - Loss: 0.0174, Perplexity: 1.0314, LR: 8.47e-05
2025-10-22 02:25:18,003 - INFO - Epoch 9, Step 550/1000 - Loss: 0.0209, Perplexity: 1.0445, LR: 8.46e-05
2025-10-22 02:25:30,557 - INFO - Epoch 9, Step 600/1000 - Loss: 0.0219, Perplexity: 1.0459, LR: 8.45e-05
2025-10-22 02:25:43,419 - INFO - Epoch 9, Step 650/1000 - Loss: 0.0204, Perplexity: 1.0426, LR: 8.44e-05
2025-10-22 02:25:55,962 - INFO - Epoch 9, Step 700/1000 - Loss: 0.0194, Perplexity: 1.0400, LR: 8.43e-05
2025-10-22 02:26:08,190 - INFO - Epoch 9, Step 750/1000 - Loss: 0.0192, Perplexity: 1.0389, LR: 8.42e-05
2025-10-22 02:26:20,920 - INFO - Epoch 9, Step 800/1000 - Loss: 0.0183, Perplexity: 1.0368, LR: 8.41e-05
2025-10-22 02:26:33,489 - INFO - Epoch 9, Step 850/1000 - Loss: 0.0184, Perplexity: 1.0359, LR: 8.40e-05
2025-10-22 02:26:45,897 - INFO - Epoch 9, Step 900/1000 - Loss: 0.0201, Perplexity: 1.0378, LR: 8.39e-05
2025-10-22 02:26:58,190 - INFO - Epoch 9, Step 950/1000 - Loss: 0.0194, Perplexity: 1.0362, LR: 8.38e-05
2025-10-22 02:27:10,658 - INFO - Epoch 9, Step 1000/1000 - Loss: 0.0185, Perplexity: 1.0344, LR: 8.37e-05
2025-10-22 02:27:10,659 - INFO - Epoch 9 Complete - Avg Loss: 0.0185, Avg Perplexity: 1.0344
2025-10-22 02:27:30,505 - INFO - Validation - Loss: 0.0277, Perplexity: 1.0684, Token Accuracy: 0.9960, Code Accuracy: 0.9951
2025-10-22 02:27:30,506 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:27:33,906 - INFO - TPL computed on 351 samples: 1.0431
2025-10-22 02:27:33,906 - INFO - Temporal Perplexity (TPL): 1.0431
2025-10-22 02:27:33,906 - INFO - New best model! Validation loss: 0.0277
2025-10-22 02:27:38,555 - INFO - Checkpoint saved: epoch 9
2025-10-22 02:27:50,644 - INFO - Epoch 10, Step 50/1000 - Loss: 0.0267, Perplexity: 1.0504, LR: 8.36e-05
2025-10-22 02:28:03,355 - INFO - Epoch 10, Step 100/1000 - Loss: 0.0168, Perplexity: 1.0287, LR: 8.35e-05
2025-10-22 02:28:15,546 - INFO - Epoch 10, Step 150/1000 - Loss: 0.0330, Perplexity: 1.0706, LR: 8.34e-05
2025-10-22 02:28:27,788 - INFO - Epoch 10, Step 200/1000 - Loss: 0.0268, Perplexity: 1.0551, LR: 8.33e-05
2025-10-22 02:28:40,282 - INFO - Epoch 10, Step 250/1000 - Loss: 0.0299, Perplexity: 1.0607, LR: 8.32e-05
2025-10-22 02:28:52,825 - INFO - Epoch 10, Step 300/1000 - Loss: 0.0260, Perplexity: 1.0517, LR: 8.31e-05
2025-10-22 02:29:05,399 - INFO - Epoch 10, Step 350/1000 - Loss: 0.0227, Perplexity: 1.0447, LR: 8.30e-05
2025-10-22 02:29:17,985 - INFO - Epoch 10, Step 400/1000 - Loss: 0.0203, Perplexity: 1.0396, LR: 8.29e-05
2025-10-22 02:29:30,493 - INFO - Epoch 10, Step 450/1000 - Loss: 0.0189, Perplexity: 1.0362, LR: 8.28e-05
2025-10-22 02:29:43,031 - INFO - Epoch 10, Step 500/1000 - Loss: 0.0187, Perplexity: 1.0344, LR: 8.27e-05
2025-10-22 02:29:55,329 - INFO - Epoch 10, Step 550/1000 - Loss: 0.0176, Perplexity: 1.0319, LR: 8.26e-05
2025-10-22 02:30:07,947 - INFO - Epoch 10, Step 600/1000 - Loss: 0.0175, Perplexity: 1.0309, LR: 8.24e-05
2025-10-22 02:30:20,174 - INFO - Epoch 10, Step 650/1000 - Loss: 0.0163, Perplexity: 1.0287, LR: 8.23e-05
2025-10-22 02:30:32,446 - INFO - Epoch 10, Step 700/1000 - Loss: 0.0157, Perplexity: 1.0272, LR: 8.22e-05
2025-10-22 02:30:44,857 - INFO - Epoch 10, Step 750/1000 - Loss: 0.0149, Perplexity: 1.0256, LR: 8.21e-05
2025-10-22 02:30:57,552 - INFO - Epoch 10, Step 800/1000 - Loss: 0.0167, Perplexity: 1.0299, LR: 8.20e-05
2025-10-22 02:31:09,826 - INFO - Epoch 10, Step 850/1000 - Loss: 0.0161, Perplexity: 1.0286, LR: 8.19e-05
2025-10-22 02:31:22,405 - INFO - Epoch 10, Step 900/1000 - Loss: 0.0198, Perplexity: 1.0370, LR: 8.18e-05
2025-10-22 02:31:35,139 - INFO - Epoch 10, Step 950/1000 - Loss: 0.0190, Perplexity: 1.0354, LR: 8.17e-05
2025-10-22 02:31:47,817 - INFO - Epoch 10, Step 1000/1000 - Loss: 0.0181, Perplexity: 1.0336, LR: 8.16e-05
2025-10-22 02:31:47,818 - INFO - Epoch 10 Complete - Avg Loss: 0.0181, Avg Perplexity: 1.0336
2025-10-22 02:32:07,376 - INFO - Validation - Loss: 0.0240, Perplexity: 1.0545, Token Accuracy: 0.9967, Code Accuracy: 0.9961
2025-10-22 02:32:07,377 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:32:10,785 - INFO - TPL computed on 351 samples: 1.0431
2025-10-22 02:32:10,785 - INFO - Temporal Perplexity (TPL): 1.0431
2025-10-22 02:32:10,785 - INFO - New best model! Validation loss: 0.0240
2025-10-22 02:32:15,340 - INFO - Checkpoint saved: epoch 10
2025-10-22 02:32:28,187 - INFO - Epoch 11, Step 50/1000 - Loss: 0.0133, Perplexity: 1.0163, LR: 8.15e-05
2025-10-22 02:32:40,528 - INFO - Epoch 11, Step 100/1000 - Loss: 0.0260, Perplexity: 1.0540, LR: 8.14e-05
2025-10-22 02:32:53,102 - INFO - Epoch 11, Step 150/1000 - Loss: 0.0240, Perplexity: 1.0440, LR: 8.13e-05
2025-10-22 02:33:05,620 - INFO - Epoch 11, Step 200/1000 - Loss: 0.0186, Perplexity: 1.0336, LR: 8.12e-05
2025-10-22 02:33:17,861 - INFO - Epoch 11, Step 250/1000 - Loss: 0.0153, Perplexity: 1.0273, LR: 8.11e-05
2025-10-22 02:33:30,020 - INFO - Epoch 11, Step 300/1000 - Loss: 0.0178, Perplexity: 1.0321, LR: 8.10e-05
2025-10-22 02:33:42,191 - INFO - Epoch 11, Step 350/1000 - Loss: 0.0180, Perplexity: 1.0314, LR: 8.09e-05
2025-10-22 02:33:54,975 - INFO - Epoch 11, Step 400/1000 - Loss: 0.0163, Perplexity: 1.0280, LR: 8.08e-05
2025-10-22 02:34:07,430 - INFO - Epoch 11, Step 450/1000 - Loss: 0.0184, Perplexity: 1.0313, LR: 8.07e-05
2025-10-22 02:34:20,128 - INFO - Epoch 11, Step 500/1000 - Loss: 0.0200, Perplexity: 1.0359, LR: 8.06e-05
2025-10-22 02:34:32,746 - INFO - Epoch 11, Step 550/1000 - Loss: 0.0184, Perplexity: 1.0329, LR: 8.05e-05
2025-10-22 02:34:45,154 - INFO - Epoch 11, Step 600/1000 - Loss: 0.0175, Perplexity: 1.0308, LR: 8.04e-05
2025-10-22 02:34:57,593 - INFO - Epoch 11, Step 650/1000 - Loss: 0.0182, Perplexity: 1.0314, LR: 8.03e-05
2025-10-22 02:35:09,920 - INFO - Epoch 11, Step 700/1000 - Loss: 0.0177, Perplexity: 1.0301, LR: 8.02e-05
2025-10-22 02:35:22,204 - INFO - Epoch 11, Step 750/1000 - Loss: 0.0172, Perplexity: 1.0287, LR: 8.01e-05
2025-10-22 02:35:35,139 - INFO - Epoch 11, Step 800/1000 - Loss: 0.0180, Perplexity: 1.0308, LR: 8.00e-05
2025-10-22 02:35:47,842 - INFO - Epoch 11, Step 850/1000 - Loss: 0.0189, Perplexity: 1.0325, LR: 7.99e-05
2025-10-22 02:36:00,718 - INFO - Epoch 11, Step 900/1000 - Loss: 0.0182, Perplexity: 1.0311, LR: 7.98e-05
2025-10-22 02:36:13,494 - INFO - Epoch 11, Step 950/1000 - Loss: 0.0176, Perplexity: 1.0298, LR: 7.97e-05
2025-10-22 02:36:26,235 - INFO - Epoch 11, Step 1000/1000 - Loss: 0.0169, Perplexity: 1.0285, LR: 7.96e-05
2025-10-22 02:36:26,236 - INFO - Epoch 11 Complete - Avg Loss: 0.0169, Avg Perplexity: 1.0285
2025-10-22 02:36:46,054 - INFO - Validation - Loss: 0.0397, Perplexity: 1.0867, Token Accuracy: 0.9947, Code Accuracy: 0.9941
2025-10-22 02:36:46,055 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:36:49,456 - INFO - TPL computed on 351 samples: 1.0718
2025-10-22 02:36:49,456 - INFO - Temporal Perplexity (TPL): 1.0718
2025-10-22 02:37:02,174 - INFO - Epoch 12, Step 50/1000 - Loss: 0.0077, Perplexity: 1.0080, LR: 7.95e-05
2025-10-22 02:37:14,798 - INFO - Epoch 12, Step 100/1000 - Loss: 0.0070, Perplexity: 1.0073, LR: 7.94e-05
2025-10-22 02:37:27,346 - INFO - Epoch 12, Step 150/1000 - Loss: 0.0181, Perplexity: 1.0272, LR: 7.93e-05
2025-10-22 02:37:40,113 - INFO - Epoch 12, Step 200/1000 - Loss: 0.0161, Perplexity: 1.0233, LR: 7.92e-05
2025-10-22 02:37:52,747 - INFO - Epoch 12, Step 250/1000 - Loss: 0.0191, Perplexity: 1.0308, LR: 7.91e-05
2025-10-22 02:38:05,722 - INFO - Epoch 12, Step 300/1000 - Loss: 0.0216, Perplexity: 1.0383, LR: 7.90e-05
2025-10-22 02:38:17,480 - INFO - Epoch 12, Step 350/1000 - Loss: 0.0187, Perplexity: 1.0330, LR: 7.89e-05
2025-10-22 02:38:29,881 - INFO - Epoch 12, Step 400/1000 - Loss: 0.0211, Perplexity: 1.0397, LR: 7.88e-05
2025-10-22 02:38:42,404 - INFO - Epoch 12, Step 450/1000 - Loss: 0.0192, Perplexity: 1.0358, LR: 7.87e-05
2025-10-22 02:38:55,112 - INFO - Epoch 12, Step 500/1000 - Loss: 0.0179, Perplexity: 1.0328, LR: 7.86e-05
2025-10-22 02:39:07,647 - INFO - Epoch 12, Step 550/1000 - Loss: 0.0167, Perplexity: 1.0303, LR: 7.85e-05
2025-10-22 02:39:20,286 - INFO - Epoch 12, Step 600/1000 - Loss: 0.0157, Perplexity: 1.0282, LR: 7.84e-05
2025-10-22 02:39:32,863 - INFO - Epoch 12, Step 650/1000 - Loss: 0.0147, Perplexity: 1.0262, LR: 7.83e-05
2025-10-22 02:39:45,032 - INFO - Epoch 12, Step 700/1000 - Loss: 0.0143, Perplexity: 1.0251, LR: 7.82e-05
2025-10-22 02:39:57,157 - INFO - Epoch 12, Step 750/1000 - Loss: 0.0134, Perplexity: 1.0235, LR: 7.81e-05
2025-10-22 02:40:10,290 - INFO - Epoch 12, Step 800/1000 - Loss: 0.0134, Perplexity: 1.0231, LR: 7.80e-05
2025-10-22 02:40:23,252 - INFO - Epoch 12, Step 850/1000 - Loss: 0.0129, Perplexity: 1.0219, LR: 7.79e-05
2025-10-22 02:40:35,666 - INFO - Epoch 12, Step 900/1000 - Loss: 0.0128, Perplexity: 1.0215, LR: 7.78e-05
2025-10-22 02:40:48,010 - INFO - Epoch 12, Step 950/1000 - Loss: 0.0151, Perplexity: 1.0266, LR: 7.77e-05
2025-10-22 02:41:00,720 - INFO - Epoch 12, Step 1000/1000 - Loss: 0.0145, Perplexity: 1.0254, LR: 7.76e-05
2025-10-22 02:41:00,721 - INFO - Epoch 12 Complete - Avg Loss: 0.0145, Avg Perplexity: 1.0254
2025-10-22 02:41:20,682 - INFO - Validation - Loss: 0.0245, Perplexity: 1.0576, Token Accuracy: 0.9967, Code Accuracy: 0.9961
2025-10-22 02:41:20,684 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:41:24,098 - INFO - TPL computed on 351 samples: 1.0435
2025-10-22 02:41:24,098 - INFO - Temporal Perplexity (TPL): 1.0435
2025-10-22 02:41:36,551 - INFO - Epoch 13, Step 50/1000 - Loss: 0.0041, Perplexity: 1.0042, LR: 7.74e-05
2025-10-22 02:41:49,202 - INFO - Epoch 13, Step 100/1000 - Loss: 0.0142, Perplexity: 1.0231, LR: 7.73e-05
2025-10-22 02:42:01,406 - INFO - Epoch 13, Step 150/1000 - Loss: 0.0204, Perplexity: 1.0307, LR: 7.72e-05
2025-10-22 02:42:14,180 - INFO - Epoch 13, Step 200/1000 - Loss: 0.0155, Perplexity: 1.0231, LR: 7.71e-05
2025-10-22 02:42:26,739 - INFO - Epoch 13, Step 250/1000 - Loss: 0.0143, Perplexity: 1.0207, LR: 7.70e-05
2025-10-22 02:42:39,173 - INFO - Epoch 13, Step 300/1000 - Loss: 0.0124, Perplexity: 1.0177, LR: 7.69e-05
2025-10-22 02:42:51,616 - INFO - Epoch 13, Step 350/1000 - Loss: 0.0169, Perplexity: 1.0302, LR: 7.68e-05
2025-10-22 02:43:04,109 - INFO - Epoch 13, Step 400/1000 - Loss: 0.0174, Perplexity: 1.0305, LR: 7.67e-05
2025-10-22 02:43:16,469 - INFO - Epoch 13, Step 450/1000 - Loss: 0.0155, Perplexity: 1.0272, LR: 7.66e-05
2025-10-22 02:43:28,965 - INFO - Epoch 13, Step 500/1000 - Loss: 0.0174, Perplexity: 1.0327, LR: 7.65e-05
2025-10-22 02:43:41,576 - INFO - Epoch 13, Step 550/1000 - Loss: 0.0160, Perplexity: 1.0299, LR: 7.64e-05
2025-10-22 02:43:54,487 - INFO - Epoch 13, Step 600/1000 - Loss: 0.0170, Perplexity: 1.0315, LR: 7.63e-05
2025-10-22 02:44:06,923 - INFO - Epoch 13, Step 650/1000 - Loss: 0.0185, Perplexity: 1.0350, LR: 7.62e-05
2025-10-22 02:44:19,350 - INFO - Epoch 13, Step 700/1000 - Loss: 0.0174, Perplexity: 1.0327, LR: 7.61e-05
2025-10-22 02:44:31,672 - INFO - Epoch 13, Step 750/1000 - Loss: 0.0185, Perplexity: 1.0352, LR: 7.60e-05
2025-10-22 02:44:44,036 - INFO - Epoch 13, Step 800/1000 - Loss: 0.0174, Perplexity: 1.0330, LR: 7.59e-05
2025-10-22 02:44:56,465 - INFO - Epoch 13, Step 850/1000 - Loss: 0.0171, Perplexity: 1.0319, LR: 7.58e-05
2025-10-22 02:45:08,630 - INFO - Epoch 13, Step 900/1000 - Loss: 0.0164, Perplexity: 1.0304, LR: 7.57e-05
2025-10-22 02:45:21,447 - INFO - Epoch 13, Step 950/1000 - Loss: 0.0159, Perplexity: 1.0292, LR: 7.56e-05
2025-10-22 02:45:33,744 - INFO - Epoch 13, Step 1000/1000 - Loss: 0.0152, Perplexity: 1.0279, LR: 7.55e-05
2025-10-22 02:45:33,745 - INFO - Epoch 13 Complete - Avg Loss: 0.0152, Avg Perplexity: 1.0279
2025-10-22 02:45:53,599 - INFO - Validation - Loss: 0.0273, Perplexity: 1.0701, Token Accuracy: 0.9964, Code Accuracy: 0.9956
2025-10-22 02:45:53,600 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:45:56,995 - INFO - TPL computed on 351 samples: 1.0454
2025-10-22 02:45:56,995 - INFO - Temporal Perplexity (TPL): 1.0454
2025-10-22 02:46:09,638 - INFO - Epoch 14, Step 50/1000 - Loss: 0.0157, Perplexity: 1.0215, LR: 7.54e-05
2025-10-22 02:46:22,122 - INFO - Epoch 14, Step 100/1000 - Loss: 0.0108, Perplexity: 1.0138, LR: 7.53e-05
2025-10-22 02:46:34,820 - INFO - Epoch 14, Step 150/1000 - Loss: 0.0204, Perplexity: 1.0398, LR: 7.52e-05
2025-10-22 02:46:47,293 - INFO - Epoch 14, Step 200/1000 - Loss: 0.0161, Perplexity: 1.0307, LR: 7.51e-05
2025-10-22 02:46:59,680 - INFO - Epoch 14, Step 250/1000 - Loss: 0.0136, Perplexity: 1.0253, LR: 7.50e-05
2025-10-22 02:47:11,931 - INFO - Epoch 14, Step 300/1000 - Loss: 0.0125, Perplexity: 1.0223, LR: 7.49e-05
2025-10-22 02:47:24,499 - INFO - Epoch 14, Step 350/1000 - Loss: 0.0111, Perplexity: 1.0195, LR: 7.48e-05
2025-10-22 02:47:36,892 - INFO - Epoch 14, Step 400/1000 - Loss: 0.0099, Perplexity: 1.0172, LR: 7.47e-05
2025-10-22 02:47:49,284 - INFO - Epoch 14, Step 450/1000 - Loss: 0.0131, Perplexity: 1.0224, LR: 7.46e-05
2025-10-22 02:48:02,068 - INFO - Epoch 14, Step 500/1000 - Loss: 0.0145, Perplexity: 1.0246, LR: 7.45e-05
2025-10-22 02:48:14,429 - INFO - Epoch 14, Step 550/1000 - Loss: 0.0136, Perplexity: 1.0228, LR: 7.44e-05
2025-10-22 02:48:27,587 - INFO - Epoch 14, Step 600/1000 - Loss: 0.0125, Perplexity: 1.0209, LR: 7.43e-05
2025-10-22 02:48:40,339 - INFO - Epoch 14, Step 650/1000 - Loss: 0.0123, Perplexity: 1.0201, LR: 7.42e-05
2025-10-22 02:48:53,006 - INFO - Epoch 14, Step 700/1000 - Loss: 0.0134, Perplexity: 1.0222, LR: 7.41e-05
2025-10-22 02:49:05,574 - INFO - Epoch 14, Step 750/1000 - Loss: 0.0145, Perplexity: 1.0233, LR: 7.40e-05
2025-10-22 02:49:18,009 - INFO - Epoch 14, Step 800/1000 - Loss: 0.0136, Perplexity: 1.0219, LR: 7.39e-05
2025-10-22 02:49:30,491 - INFO - Epoch 14, Step 850/1000 - Loss: 0.0129, Perplexity: 1.0207, LR: 7.38e-05
2025-10-22 02:49:43,108 - INFO - Epoch 14, Step 900/1000 - Loss: 0.0125, Perplexity: 1.0199, LR: 7.37e-05
2025-10-22 02:49:55,432 - INFO - Epoch 14, Step 950/1000 - Loss: 0.0139, Perplexity: 1.0229, LR: 7.36e-05
2025-10-22 02:50:07,629 - INFO - Epoch 14, Step 1000/1000 - Loss: 0.0132, Perplexity: 1.0218, LR: 7.35e-05
2025-10-22 02:50:07,630 - INFO - Epoch 14 Complete - Avg Loss: 0.0132, Avg Perplexity: 1.0218
2025-10-22 02:50:27,390 - INFO - Validation - Loss: 0.0287, Perplexity: 1.0670, Token Accuracy: 0.9966, Code Accuracy: 0.9962
2025-10-22 02:50:27,391 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:50:30,795 - INFO - TPL computed on 351 samples: 1.0554
2025-10-22 02:50:30,795 - INFO - Temporal Perplexity (TPL): 1.0554
2025-10-22 02:50:43,320 - INFO - Epoch 15, Step 50/1000 - Loss: 0.0176, Perplexity: 1.0259, LR: 7.34e-05
2025-10-22 02:50:55,806 - INFO - Epoch 15, Step 100/1000 - Loss: 0.0099, Perplexity: 1.0141, LR: 7.33e-05
2025-10-22 02:51:08,126 - INFO - Epoch 15, Step 150/1000 - Loss: 0.0219, Perplexity: 1.0420, LR: 7.32e-05
2025-10-22 02:51:20,812 - INFO - Epoch 15, Step 200/1000 - Loss: 0.0171, Perplexity: 1.0322, LR: 7.31e-05
2025-10-22 02:51:33,477 - INFO - Epoch 15, Step 250/1000 - Loss: 0.0153, Perplexity: 1.0275, LR: 7.30e-05
2025-10-22 02:51:45,990 - INFO - Epoch 15, Step 300/1000 - Loss: 0.0133, Perplexity: 1.0235, LR: 7.29e-05
2025-10-22 02:51:58,072 - INFO - Epoch 15, Step 350/1000 - Loss: 0.0123, Perplexity: 1.0211, LR: 7.28e-05
2025-10-22 02:52:10,825 - INFO - Epoch 15, Step 400/1000 - Loss: 0.0152, Perplexity: 1.0286, LR: 7.27e-05
2025-10-22 02:52:23,252 - INFO - Epoch 15, Step 450/1000 - Loss: 0.0138, Perplexity: 1.0257, LR: 7.26e-05
2025-10-22 02:52:35,678 - INFO - Epoch 15, Step 500/1000 - Loss: 0.0203, Perplexity: 1.0381, LR: 7.24e-05
2025-10-22 02:52:48,356 - INFO - Epoch 15, Step 550/1000 - Loss: 0.0189, Perplexity: 1.0351, LR: 7.23e-05
2025-10-22 02:53:00,989 - INFO - Epoch 15, Step 600/1000 - Loss: 0.0193, Perplexity: 1.0352, LR: 7.22e-05
2025-10-22 02:53:13,582 - INFO - Epoch 15, Step 650/1000 - Loss: 0.0179, Perplexity: 1.0327, LR: 7.21e-05
2025-10-22 02:53:26,075 - INFO - Epoch 15, Step 700/1000 - Loss: 0.0173, Perplexity: 1.0311, LR: 7.20e-05
2025-10-22 02:53:39,039 - INFO - Epoch 15, Step 750/1000 - Loss: 0.0164, Perplexity: 1.0292, LR: 7.19e-05
2025-10-22 02:53:51,329 - INFO - Epoch 15, Step 800/1000 - Loss: 0.0154, Perplexity: 1.0274, LR: 7.18e-05
2025-10-22 02:54:03,814 - INFO - Epoch 15, Step 850/1000 - Loss: 0.0152, Perplexity: 1.0266, LR: 7.17e-05
2025-10-22 02:54:16,228 - INFO - Epoch 15, Step 900/1000 - Loss: 0.0147, Perplexity: 1.0254, LR: 7.16e-05
2025-10-22 02:54:28,872 - INFO - Epoch 15, Step 950/1000 - Loss: 0.0142, Perplexity: 1.0244, LR: 7.15e-05
2025-10-22 02:54:41,296 - INFO - Epoch 15, Step 1000/1000 - Loss: 0.0146, Perplexity: 1.0245, LR: 7.14e-05
2025-10-22 02:54:41,297 - INFO - Epoch 15 Complete - Avg Loss: 0.0146, Avg Perplexity: 1.0245
2025-10-22 02:55:01,020 - INFO - Validation - Loss: 0.0193, Perplexity: 1.0332, Token Accuracy: 0.9973, Code Accuracy: 0.9967
2025-10-22 02:55:01,021 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:55:04,422 - INFO - TPL computed on 351 samples: 1.0390
2025-10-22 02:55:04,423 - INFO - Temporal Perplexity (TPL): 1.0390
2025-10-22 02:55:04,423 - INFO - New best model! Validation loss: 0.0193
2025-10-22 02:55:08,571 - INFO - Checkpoint saved: epoch 15
2025-10-22 02:55:21,100 - INFO - Epoch 16, Step 50/1000 - Loss: 0.0175, Perplexity: 1.0223, LR: 7.13e-05
2025-10-22 02:55:33,374 - INFO - Epoch 16, Step 100/1000 - Loss: 0.0166, Perplexity: 1.0220, LR: 7.12e-05
2025-10-22 02:55:45,979 - INFO - Epoch 16, Step 150/1000 - Loss: 0.0197, Perplexity: 1.0316, LR: 7.11e-05
2025-10-22 02:55:58,405 - INFO - Epoch 16, Step 200/1000 - Loss: 0.0205, Perplexity: 1.0327, LR: 7.10e-05
2025-10-22 02:56:11,340 - INFO - Epoch 16, Step 250/1000 - Loss: 0.0167, Perplexity: 1.0265, LR: 7.09e-05
2025-10-22 02:56:24,096 - INFO - Epoch 16, Step 300/1000 - Loss: 0.0140, Perplexity: 1.0222, LR: 7.08e-05
2025-10-22 02:56:36,661 - INFO - Epoch 16, Step 350/1000 - Loss: 0.0120, Perplexity: 1.0190, LR: 7.07e-05
2025-10-22 02:56:49,180 - INFO - Epoch 16, Step 400/1000 - Loss: 0.0111, Perplexity: 1.0173, LR: 7.06e-05
2025-10-22 02:57:01,750 - INFO - Epoch 16, Step 450/1000 - Loss: 0.0099, Perplexity: 1.0154, LR: 7.05e-05
2025-10-22 02:57:13,959 - INFO - Epoch 16, Step 500/1000 - Loss: 0.0090, Perplexity: 1.0139, LR: 7.04e-05
2025-10-22 02:57:26,541 - INFO - Epoch 16, Step 550/1000 - Loss: 0.0088, Perplexity: 1.0134, LR: 7.03e-05
2025-10-22 02:57:39,104 - INFO - Epoch 16, Step 600/1000 - Loss: 0.0084, Perplexity: 1.0126, LR: 7.02e-05
2025-10-22 02:57:51,611 - INFO - Epoch 16, Step 650/1000 - Loss: 0.0080, Perplexity: 1.0119, LR: 7.01e-05
2025-10-22 02:58:04,078 - INFO - Epoch 16, Step 700/1000 - Loss: 0.0075, Perplexity: 1.0111, LR: 7.00e-05
2025-10-22 02:58:16,596 - INFO - Epoch 16, Step 750/1000 - Loss: 0.0078, Perplexity: 1.0113, LR: 6.99e-05
2025-10-22 02:58:29,142 - INFO - Epoch 16, Step 800/1000 - Loss: 0.0099, Perplexity: 1.0144, LR: 6.98e-05
2025-10-22 02:58:41,902 - INFO - Epoch 16, Step 850/1000 - Loss: 0.0106, Perplexity: 1.0155, LR: 6.97e-05
2025-10-22 02:58:54,370 - INFO - Epoch 16, Step 900/1000 - Loss: 0.0102, Perplexity: 1.0148, LR: 6.96e-05
2025-10-22 02:59:06,848 - INFO - Epoch 16, Step 950/1000 - Loss: 0.0097, Perplexity: 1.0141, LR: 6.95e-05
2025-10-22 02:59:19,122 - INFO - Epoch 16, Step 1000/1000 - Loss: 0.0101, Perplexity: 1.0146, LR: 6.94e-05
2025-10-22 02:59:19,123 - INFO - Epoch 16 Complete - Avg Loss: 0.0101, Avg Perplexity: 1.0146
2025-10-22 02:59:38,836 - INFO - Validation - Loss: 0.0243, Perplexity: 1.0579, Token Accuracy: 0.9968, Code Accuracy: 0.9962
2025-10-22 02:59:38,838 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 02:59:42,237 - INFO - TPL computed on 351 samples: 1.0417
2025-10-22 02:59:42,237 - INFO - Temporal Perplexity (TPL): 1.0417
2025-10-22 02:59:54,497 - INFO - Epoch 17, Step 50/1000 - Loss: 0.0340, Perplexity: 1.0776, LR: 6.93e-05
2025-10-22 03:00:07,221 - INFO - Epoch 17, Step 100/1000 - Loss: 0.0191, Perplexity: 1.0409, LR: 6.92e-05
2025-10-22 03:00:19,840 - INFO - Epoch 17, Step 150/1000 - Loss: 0.0131, Perplexity: 1.0277, LR: 6.91e-05
2025-10-22 03:00:32,599 - INFO - Epoch 17, Step 200/1000 - Loss: 0.0099, Perplexity: 1.0208, LR: 6.90e-05
2025-10-22 03:00:44,794 - INFO - Epoch 17, Step 250/1000 - Loss: 0.0102, Perplexity: 1.0192, LR: 6.89e-05
2025-10-22 03:00:57,132 - INFO - Epoch 17, Step 300/1000 - Loss: 0.0094, Perplexity: 1.0170, LR: 6.88e-05
2025-10-22 03:01:09,123 - INFO - Epoch 17, Step 350/1000 - Loss: 0.0111, Perplexity: 1.0197, LR: 6.87e-05
2025-10-22 03:01:21,674 - INFO - Epoch 17, Step 400/1000 - Loss: 0.0100, Perplexity: 1.0175, LR: 6.86e-05
2025-10-22 03:01:34,308 - INFO - Epoch 17, Step 450/1000 - Loss: 0.0120, Perplexity: 1.0220, LR: 6.85e-05
2025-10-22 03:01:46,824 - INFO - Epoch 17, Step 500/1000 - Loss: 0.0111, Perplexity: 1.0202, LR: 6.84e-05
2025-10-22 03:01:59,422 - INFO - Epoch 17, Step 550/1000 - Loss: 0.0136, Perplexity: 1.0256, LR: 6.83e-05
2025-10-22 03:02:11,856 - INFO - Epoch 17, Step 600/1000 - Loss: 0.0144, Perplexity: 1.0265, LR: 6.82e-05
2025-10-22 03:02:24,410 - INFO - Epoch 17, Step 650/1000 - Loss: 0.0136, Perplexity: 1.0248, LR: 6.81e-05
2025-10-22 03:02:36,868 - INFO - Epoch 17, Step 700/1000 - Loss: 0.0130, Perplexity: 1.0234, LR: 6.80e-05
2025-10-22 03:02:49,268 - INFO - Epoch 17, Step 750/1000 - Loss: 0.0122, Perplexity: 1.0219, LR: 6.79e-05
2025-10-22 03:03:01,694 - INFO - Epoch 17, Step 800/1000 - Loss: 0.0115, Perplexity: 1.0206, LR: 6.78e-05
2025-10-22 03:03:14,230 - INFO - Epoch 17, Step 850/1000 - Loss: 0.0119, Perplexity: 1.0209, LR: 6.77e-05
2025-10-22 03:03:26,855 - INFO - Epoch 17, Step 900/1000 - Loss: 0.0113, Perplexity: 1.0197, LR: 6.76e-05
2025-10-22 03:03:39,217 - INFO - Epoch 17, Step 950/1000 - Loss: 0.0112, Perplexity: 1.0194, LR: 6.74e-05
2025-10-22 03:03:51,673 - INFO - Epoch 17, Step 1000/1000 - Loss: 0.0116, Perplexity: 1.0199, LR: 6.73e-05
2025-10-22 03:03:51,674 - INFO - Epoch 17 Complete - Avg Loss: 0.0116, Avg Perplexity: 1.0199
2025-10-22 03:04:11,519 - INFO - Validation - Loss: 0.0197, Perplexity: 1.0433, Token Accuracy: 0.9974, Code Accuracy: 0.9970
2025-10-22 03:04:11,520 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:04:14,918 - INFO - TPL computed on 351 samples: 1.0362
2025-10-22 03:04:14,918 - INFO - Temporal Perplexity (TPL): 1.0362
2025-10-22 03:04:27,859 - INFO - Epoch 18, Step 50/1000 - Loss: 0.0326, Perplexity: 1.0531, LR: 6.72e-05
2025-10-22 03:04:40,400 - INFO - Epoch 18, Step 100/1000 - Loss: 0.0180, Perplexity: 1.0283, LR: 6.71e-05
2025-10-22 03:04:52,728 - INFO - Epoch 18, Step 150/1000 - Loss: 0.0123, Perplexity: 1.0191, LR: 6.70e-05
2025-10-22 03:05:05,544 - INFO - Epoch 18, Step 200/1000 - Loss: 0.0102, Perplexity: 1.0154, LR: 6.69e-05
2025-10-22 03:05:18,035 - INFO - Epoch 18, Step 250/1000 - Loss: 0.0199, Perplexity: 1.0366, LR: 6.68e-05
2025-10-22 03:05:30,776 - INFO - Epoch 18, Step 300/1000 - Loss: 0.0175, Perplexity: 1.0314, LR: 6.67e-05
2025-10-22 03:05:43,246 - INFO - Epoch 18, Step 350/1000 - Loss: 0.0193, Perplexity: 1.0359, LR: 6.66e-05
2025-10-22 03:05:55,869 - INFO - Epoch 18, Step 400/1000 - Loss: 0.0170, Perplexity: 1.0314, LR: 6.65e-05
2025-10-22 03:06:08,291 - INFO - Epoch 18, Step 450/1000 - Loss: 0.0182, Perplexity: 1.0346, LR: 6.64e-05
2025-10-22 03:06:20,975 - INFO - Epoch 18, Step 500/1000 - Loss: 0.0165, Perplexity: 1.0312, LR: 6.63e-05
2025-10-22 03:06:33,447 - INFO - Epoch 18, Step 550/1000 - Loss: 0.0150, Perplexity: 1.0284, LR: 6.62e-05
2025-10-22 03:06:45,422 - INFO - Epoch 18, Step 600/1000 - Loss: 0.0153, Perplexity: 1.0284, LR: 6.61e-05
2025-10-22 03:06:58,171 - INFO - Epoch 18, Step 650/1000 - Loss: 0.0145, Perplexity: 1.0266, LR: 6.60e-05
2025-10-22 03:07:10,614 - INFO - Epoch 18, Step 700/1000 - Loss: 0.0151, Perplexity: 1.0269, LR: 6.59e-05
2025-10-22 03:07:23,470 - INFO - Epoch 18, Step 750/1000 - Loss: 0.0145, Perplexity: 1.0255, LR: 6.58e-05
2025-10-22 03:07:36,115 - INFO - Epoch 18, Step 800/1000 - Loss: 0.0137, Perplexity: 1.0240, LR: 6.57e-05
2025-10-22 03:07:48,749 - INFO - Epoch 18, Step 850/1000 - Loss: 0.0131, Perplexity: 1.0229, LR: 6.56e-05
2025-10-22 03:08:01,212 - INFO - Epoch 18, Step 900/1000 - Loss: 0.0126, Perplexity: 1.0218, LR: 6.55e-05
2025-10-22 03:08:13,713 - INFO - Epoch 18, Step 950/1000 - Loss: 0.0120, Perplexity: 1.0207, LR: 6.54e-05
2025-10-22 03:08:26,589 - INFO - Epoch 18, Step 1000/1000 - Loss: 0.0115, Perplexity: 1.0198, LR: 6.53e-05
2025-10-22 03:08:26,590 - INFO - Epoch 18 Complete - Avg Loss: 0.0115, Avg Perplexity: 1.0198
2025-10-22 03:08:46,593 - INFO - Validation - Loss: 0.0205, Perplexity: 1.0462, Token Accuracy: 0.9971, Code Accuracy: 0.9966
2025-10-22 03:08:46,595 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:08:49,995 - INFO - TPL computed on 351 samples: 1.0373
2025-10-22 03:08:49,995 - INFO - Temporal Perplexity (TPL): 1.0373
2025-10-22 03:09:02,347 - INFO - Epoch 19, Step 50/1000 - Loss: 0.0013, Perplexity: 1.0013, LR: 6.52e-05
2025-10-22 03:09:14,563 - INFO - Epoch 19, Step 100/1000 - Loss: 0.0114, Perplexity: 1.0193, LR: 6.51e-05
2025-10-22 03:09:27,305 - INFO - Epoch 19, Step 150/1000 - Loss: 0.0168, Perplexity: 1.0296, LR: 6.50e-05
2025-10-22 03:09:39,876 - INFO - Epoch 19, Step 200/1000 - Loss: 0.0129, Perplexity: 1.0225, LR: 6.49e-05
2025-10-22 03:09:52,220 - INFO - Epoch 19, Step 250/1000 - Loss: 0.0112, Perplexity: 1.0188, LR: 6.48e-05
2025-10-22 03:10:04,667 - INFO - Epoch 19, Step 300/1000 - Loss: 0.0116, Perplexity: 1.0188, LR: 6.47e-05
2025-10-22 03:10:16,794 - INFO - Epoch 19, Step 350/1000 - Loss: 0.0117, Perplexity: 1.0184, LR: 6.46e-05
2025-10-22 03:10:29,415 - INFO - Epoch 19, Step 400/1000 - Loss: 0.0107, Perplexity: 1.0166, LR: 6.45e-05
2025-10-22 03:10:42,060 - INFO - Epoch 19, Step 450/1000 - Loss: 0.0100, Perplexity: 1.0152, LR: 6.44e-05
2025-10-22 03:10:54,294 - INFO - Epoch 19, Step 500/1000 - Loss: 0.0091, Perplexity: 1.0138, LR: 6.43e-05
2025-10-22 03:11:06,787 - INFO - Epoch 19, Step 550/1000 - Loss: 0.0088, Perplexity: 1.0131, LR: 6.42e-05
2025-10-22 03:11:19,266 - INFO - Epoch 19, Step 600/1000 - Loss: 0.0101, Perplexity: 1.0160, LR: 6.41e-05
2025-10-22 03:11:32,099 - INFO - Epoch 19, Step 650/1000 - Loss: 0.0095, Perplexity: 1.0148, LR: 6.40e-05
2025-10-22 03:11:44,790 - INFO - Epoch 19, Step 700/1000 - Loss: 0.0089, Perplexity: 1.0139, LR: 6.39e-05
2025-10-22 03:11:57,306 - INFO - Epoch 19, Step 750/1000 - Loss: 0.0093, Perplexity: 1.0144, LR: 6.38e-05
2025-10-22 03:12:09,563 - INFO - Epoch 19, Step 800/1000 - Loss: 0.0095, Perplexity: 1.0144, LR: 6.37e-05
2025-10-22 03:12:22,260 - INFO - Epoch 19, Step 850/1000 - Loss: 0.0090, Perplexity: 1.0136, LR: 6.36e-05
2025-10-22 03:12:34,690 - INFO - Epoch 19, Step 900/1000 - Loss: 0.0092, Perplexity: 1.0137, LR: 6.35e-05
2025-10-22 03:12:47,302 - INFO - Epoch 19, Step 950/1000 - Loss: 0.0090, Perplexity: 1.0133, LR: 6.34e-05
2025-10-22 03:12:59,602 - INFO - Epoch 19, Step 1000/1000 - Loss: 0.0087, Perplexity: 1.0128, LR: 6.33e-05
2025-10-22 03:12:59,603 - INFO - Epoch 19 Complete - Avg Loss: 0.0087, Avg Perplexity: 1.0128
2025-10-22 03:13:19,478 - INFO - Validation - Loss: 0.0183, Perplexity: 1.0458, Token Accuracy: 0.9973, Code Accuracy: 0.9969
2025-10-22 03:13:19,479 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:13:22,886 - INFO - TPL computed on 351 samples: 1.0343
2025-10-22 03:13:22,886 - INFO - Temporal Perplexity (TPL): 1.0343
2025-10-22 03:13:22,886 - INFO - New best model! Validation loss: 0.0183
2025-10-22 03:13:27,069 - INFO - Checkpoint saved: epoch 19
2025-10-22 03:13:39,775 - INFO - Epoch 20, Step 50/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 6.32e-05
2025-10-22 03:13:52,301 - INFO - Epoch 20, Step 100/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 6.31e-05
2025-10-22 03:14:04,802 - INFO - Epoch 20, Step 150/1000 - Loss: 0.0017, Perplexity: 1.0018, LR: 6.30e-05
2025-10-22 03:14:17,008 - INFO - Epoch 20, Step 200/1000 - Loss: 0.0028, Perplexity: 1.0028, LR: 6.29e-05
2025-10-22 03:14:29,467 - INFO - Epoch 20, Step 250/1000 - Loss: 0.0045, Perplexity: 1.0050, LR: 6.28e-05
2025-10-22 03:14:42,024 - INFO - Epoch 20, Step 300/1000 - Loss: 0.0039, Perplexity: 1.0043, LR: 6.27e-05
2025-10-22 03:14:54,378 - INFO - Epoch 20, Step 350/1000 - Loss: 0.0036, Perplexity: 1.0040, LR: 6.26e-05
2025-10-22 03:15:06,837 - INFO - Epoch 20, Step 400/1000 - Loss: 0.0067, Perplexity: 1.0087, LR: 6.24e-05
2025-10-22 03:15:19,368 - INFO - Epoch 20, Step 450/1000 - Loss: 0.0060, Perplexity: 1.0077, LR: 6.23e-05
2025-10-22 03:15:32,000 - INFO - Epoch 20, Step 500/1000 - Loss: 0.0054, Perplexity: 1.0070, LR: 6.22e-05
2025-10-22 03:15:44,585 - INFO - Epoch 20, Step 550/1000 - Loss: 0.0051, Perplexity: 1.0065, LR: 6.21e-05
2025-10-22 03:15:57,006 - INFO - Epoch 20, Step 600/1000 - Loss: 0.0050, Perplexity: 1.0063, LR: 6.20e-05
2025-10-22 03:16:09,345 - INFO - Epoch 20, Step 650/1000 - Loss: 0.0081, Perplexity: 1.0117, LR: 6.19e-05
2025-10-22 03:16:21,684 - INFO - Epoch 20, Step 700/1000 - Loss: 0.0076, Perplexity: 1.0110, LR: 6.18e-05
2025-10-22 03:16:34,099 - INFO - Epoch 20, Step 750/1000 - Loss: 0.0074, Perplexity: 1.0106, LR: 6.17e-05
2025-10-22 03:16:46,311 - INFO - Epoch 20, Step 800/1000 - Loss: 0.0080, Perplexity: 1.0113, LR: 6.16e-05
2025-10-22 03:16:58,440 - INFO - Epoch 20, Step 850/1000 - Loss: 0.0084, Perplexity: 1.0119, LR: 6.15e-05
2025-10-22 03:17:10,697 - INFO - Epoch 20, Step 900/1000 - Loss: 0.0080, Perplexity: 1.0114, LR: 6.14e-05
2025-10-22 03:17:22,902 - INFO - Epoch 20, Step 950/1000 - Loss: 0.0077, Perplexity: 1.0108, LR: 6.13e-05
2025-10-22 03:17:35,593 - INFO - Epoch 20, Step 1000/1000 - Loss: 0.0095, Perplexity: 1.0144, LR: 6.12e-05
2025-10-22 03:17:35,594 - INFO - Epoch 20 Complete - Avg Loss: 0.0095, Avg Perplexity: 1.0144
2025-10-22 03:17:55,389 - INFO - Validation - Loss: 0.0204, Perplexity: 1.0458, Token Accuracy: 0.9972, Code Accuracy: 0.9966
2025-10-22 03:17:55,391 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:17:58,785 - INFO - TPL computed on 351 samples: 1.0366
2025-10-22 03:17:58,785 - INFO - Temporal Perplexity (TPL): 1.0366
2025-10-22 03:18:00,982 - INFO - Checkpoint saved: epoch 20
2025-10-22 03:18:13,804 - INFO - Epoch 21, Step 50/1000 - Loss: 0.0196, Perplexity: 1.0309, LR: 6.11e-05
2025-10-22 03:18:26,379 - INFO - Epoch 21, Step 100/1000 - Loss: 0.0108, Perplexity: 1.0165, LR: 6.10e-05
2025-10-22 03:18:38,796 - INFO - Epoch 21, Step 150/1000 - Loss: 0.0074, Perplexity: 1.0112, LR: 6.09e-05
2025-10-22 03:18:51,605 - INFO - Epoch 21, Step 200/1000 - Loss: 0.0110, Perplexity: 1.0165, LR: 6.08e-05
2025-10-22 03:19:03,830 - INFO - Epoch 21, Step 250/1000 - Loss: 0.0187, Perplexity: 1.0505, LR: 6.07e-05
2025-10-22 03:19:16,236 - INFO - Epoch 21, Step 300/1000 - Loss: 0.0158, Perplexity: 1.0422, LR: 6.06e-05
2025-10-22 03:19:28,572 - INFO - Epoch 21, Step 350/1000 - Loss: 0.0148, Perplexity: 1.0377, LR: 6.05e-05
2025-10-22 03:19:40,836 - INFO - Epoch 21, Step 400/1000 - Loss: 0.0133, Perplexity: 1.0332, LR: 6.04e-05
2025-10-22 03:19:53,405 - INFO - Epoch 21, Step 450/1000 - Loss: 0.0121, Perplexity: 1.0299, LR: 6.03e-05
2025-10-22 03:20:05,911 - INFO - Epoch 21, Step 500/1000 - Loss: 0.0125, Perplexity: 1.0292, LR: 6.02e-05
2025-10-22 03:20:18,140 - INFO - Epoch 21, Step 550/1000 - Loss: 0.0121, Perplexity: 1.0275, LR: 6.01e-05
2025-10-22 03:20:30,560 - INFO - Epoch 21, Step 600/1000 - Loss: 0.0112, Perplexity: 1.0253, LR: 6.00e-05
2025-10-22 03:20:42,575 - INFO - Epoch 21, Step 650/1000 - Loss: 0.0106, Perplexity: 1.0237, LR: 5.99e-05
2025-10-22 03:20:54,739 - INFO - Epoch 21, Step 700/1000 - Loss: 0.0111, Perplexity: 1.0240, LR: 5.98e-05
2025-10-22 03:21:06,973 - INFO - Epoch 21, Step 750/1000 - Loss: 0.0107, Perplexity: 1.0227, LR: 5.97e-05
2025-10-22 03:21:19,333 - INFO - Epoch 21, Step 800/1000 - Loss: 0.0101, Perplexity: 1.0214, LR: 5.96e-05
2025-10-22 03:21:31,998 - INFO - Epoch 21, Step 850/1000 - Loss: 0.0097, Perplexity: 1.0203, LR: 5.95e-05
2025-10-22 03:21:44,654 - INFO - Epoch 21, Step 900/1000 - Loss: 0.0098, Perplexity: 1.0199, LR: 5.94e-05
2025-10-22 03:21:57,165 - INFO - Epoch 21, Step 950/1000 - Loss: 0.0094, Perplexity: 1.0190, LR: 5.93e-05
2025-10-22 03:22:09,910 - INFO - Epoch 21, Step 1000/1000 - Loss: 0.0090, Perplexity: 1.0181, LR: 5.92e-05
2025-10-22 03:22:09,911 - INFO - Epoch 21 Complete - Avg Loss: 0.0090, Avg Perplexity: 1.0181
2025-10-22 03:22:29,893 - INFO - Validation - Loss: 0.0145, Perplexity: 1.0269, Token Accuracy: 0.9980, Code Accuracy: 0.9976
2025-10-22 03:22:29,894 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:22:33,287 - INFO - TPL computed on 351 samples: 1.0305
2025-10-22 03:22:33,287 - INFO - Temporal Perplexity (TPL): 1.0305
2025-10-22 03:22:33,288 - INFO - New best model! Validation loss: 0.0145
2025-10-22 03:22:37,567 - INFO - Checkpoint saved: epoch 21
2025-10-22 03:22:49,958 - INFO - Epoch 22, Step 50/1000 - Loss: 0.0439, Perplexity: 1.0735, LR: 5.91e-05
2025-10-22 03:23:02,519 - INFO - Epoch 22, Step 100/1000 - Loss: 0.0228, Perplexity: 1.0376, LR: 5.90e-05
2025-10-22 03:23:15,298 - INFO - Epoch 22, Step 150/1000 - Loss: 0.0166, Perplexity: 1.0266, LR: 5.89e-05
2025-10-22 03:23:28,155 - INFO - Epoch 22, Step 200/1000 - Loss: 0.0137, Perplexity: 1.0212, LR: 5.88e-05
2025-10-22 03:23:40,483 - INFO - Epoch 22, Step 250/1000 - Loss: 0.0117, Perplexity: 1.0177, LR: 5.87e-05
2025-10-22 03:23:53,239 - INFO - Epoch 22, Step 300/1000 - Loss: 0.0098, Perplexity: 1.0148, LR: 5.86e-05
2025-10-22 03:24:05,756 - INFO - Epoch 22, Step 350/1000 - Loss: 0.0097, Perplexity: 1.0144, LR: 5.85e-05
2025-10-22 03:24:18,620 - INFO - Epoch 22, Step 400/1000 - Loss: 0.0095, Perplexity: 1.0138, LR: 5.84e-05
2025-10-22 03:24:31,044 - INFO - Epoch 22, Step 450/1000 - Loss: 0.0086, Perplexity: 1.0124, LR: 5.83e-05
2025-10-22 03:24:43,641 - INFO - Epoch 22, Step 500/1000 - Loss: 0.0095, Perplexity: 1.0139, LR: 5.82e-05
2025-10-22 03:24:56,038 - INFO - Epoch 22, Step 550/1000 - Loss: 0.0110, Perplexity: 1.0164, LR: 5.81e-05
2025-10-22 03:25:08,425 - INFO - Epoch 22, Step 600/1000 - Loss: 0.0101, Perplexity: 1.0151, LR: 5.80e-05
2025-10-22 03:25:20,710 - INFO - Epoch 22, Step 650/1000 - Loss: 0.0094, Perplexity: 1.0140, LR: 5.79e-05
2025-10-22 03:25:33,139 - INFO - Epoch 22, Step 700/1000 - Loss: 0.0099, Perplexity: 1.0146, LR: 5.78e-05
2025-10-22 03:25:45,195 - INFO - Epoch 22, Step 750/1000 - Loss: 0.0093, Perplexity: 1.0136, LR: 5.77e-05
2025-10-22 03:25:57,934 - INFO - Epoch 22, Step 800/1000 - Loss: 0.0088, Perplexity: 1.0129, LR: 5.76e-05
2025-10-22 03:26:10,604 - INFO - Epoch 22, Step 850/1000 - Loss: 0.0083, Perplexity: 1.0121, LR: 5.74e-05
2025-10-22 03:26:22,978 - INFO - Epoch 22, Step 900/1000 - Loss: 0.0079, Perplexity: 1.0115, LR: 5.73e-05
2025-10-22 03:26:35,479 - INFO - Epoch 22, Step 950/1000 - Loss: 0.0075, Perplexity: 1.0109, LR: 5.72e-05
2025-10-22 03:26:47,969 - INFO - Epoch 22, Step 1000/1000 - Loss: 0.0072, Perplexity: 1.0104, LR: 5.71e-05
2025-10-22 03:26:47,970 - INFO - Epoch 22 Complete - Avg Loss: 0.0072, Avg Perplexity: 1.0104
2025-10-22 03:27:07,940 - INFO - Validation - Loss: 0.0154, Perplexity: 1.0336, Token Accuracy: 0.9981, Code Accuracy: 0.9979
2025-10-22 03:27:07,942 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:27:11,336 - INFO - TPL computed on 351 samples: 1.0333
2025-10-22 03:27:11,336 - INFO - Temporal Perplexity (TPL): 1.0333
2025-10-22 03:27:24,161 - INFO - Epoch 23, Step 50/1000 - Loss: 0.0133, Perplexity: 1.0169, LR: 5.70e-05
2025-10-22 03:27:36,607 - INFO - Epoch 23, Step 100/1000 - Loss: 0.0086, Perplexity: 1.0104, LR: 5.69e-05
2025-10-22 03:27:49,261 - INFO - Epoch 23, Step 150/1000 - Loss: 0.0074, Perplexity: 1.0088, LR: 5.68e-05
2025-10-22 03:28:01,730 - INFO - Epoch 23, Step 200/1000 - Loss: 0.0057, Perplexity: 1.0067, LR: 5.67e-05
2025-10-22 03:28:14,265 - INFO - Epoch 23, Step 250/1000 - Loss: 0.0050, Perplexity: 1.0058, LR: 5.66e-05
2025-10-22 03:28:26,729 - INFO - Epoch 23, Step 300/1000 - Loss: 0.0045, Perplexity: 1.0052, LR: 5.65e-05
2025-10-22 03:28:39,414 - INFO - Epoch 23, Step 350/1000 - Loss: 0.0045, Perplexity: 1.0051, LR: 5.64e-05
2025-10-22 03:28:51,624 - INFO - Epoch 23, Step 400/1000 - Loss: 0.0066, Perplexity: 1.0094, LR: 5.63e-05
2025-10-22 03:29:03,706 - INFO - Epoch 23, Step 450/1000 - Loss: 0.0064, Perplexity: 1.0088, LR: 5.62e-05
2025-10-22 03:29:15,997 - INFO - Epoch 23, Step 500/1000 - Loss: 0.0072, Perplexity: 1.0099, LR: 5.61e-05
2025-10-22 03:29:28,487 - INFO - Epoch 23, Step 550/1000 - Loss: 0.0068, Perplexity: 1.0093, LR: 5.60e-05
2025-10-22 03:29:41,258 - INFO - Epoch 23, Step 600/1000 - Loss: 0.0074, Perplexity: 1.0102, LR: 5.59e-05
2025-10-22 03:29:53,884 - INFO - Epoch 23, Step 650/1000 - Loss: 0.0069, Perplexity: 1.0095, LR: 5.58e-05
2025-10-22 03:30:06,585 - INFO - Epoch 23, Step 700/1000 - Loss: 0.0067, Perplexity: 1.0091, LR: 5.57e-05
2025-10-22 03:30:19,137 - INFO - Epoch 23, Step 750/1000 - Loss: 0.0080, Perplexity: 1.0109, LR: 5.56e-05
2025-10-22 03:30:31,501 - INFO - Epoch 23, Step 800/1000 - Loss: 0.0076, Perplexity: 1.0103, LR: 5.55e-05
2025-10-22 03:30:43,668 - INFO - Epoch 23, Step 850/1000 - Loss: 0.0074, Perplexity: 1.0100, LR: 5.54e-05
2025-10-22 03:30:55,946 - INFO - Epoch 23, Step 900/1000 - Loss: 0.0082, Perplexity: 1.0115, LR: 5.53e-05
2025-10-22 03:31:08,157 - INFO - Epoch 23, Step 950/1000 - Loss: 0.0078, Perplexity: 1.0110, LR: 5.52e-05
2025-10-22 03:31:20,776 - INFO - Epoch 23, Step 1000/1000 - Loss: 0.0075, Perplexity: 1.0105, LR: 5.51e-05
2025-10-22 03:31:20,777 - INFO - Epoch 23 Complete - Avg Loss: 0.0075, Avg Perplexity: 1.0105
2025-10-22 03:31:40,612 - INFO - Validation - Loss: 0.0137, Perplexity: 1.0214, Token Accuracy: 0.9981, Code Accuracy: 0.9978
2025-10-22 03:31:40,613 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:31:43,997 - INFO - TPL computed on 351 samples: 1.0339
2025-10-22 03:31:43,997 - INFO - Temporal Perplexity (TPL): 1.0339
2025-10-22 03:31:43,997 - INFO - New best model! Validation loss: 0.0137
2025-10-22 03:31:48,127 - INFO - Checkpoint saved: epoch 23
2025-10-22 03:32:00,542 - INFO - Epoch 24, Step 50/1000 - Loss: 0.0209, Perplexity: 1.0347, LR: 5.50e-05
2025-10-22 03:32:12,965 - INFO - Epoch 24, Step 100/1000 - Loss: 0.0105, Perplexity: 1.0174, LR: 5.49e-05
2025-10-22 03:32:25,123 - INFO - Epoch 24, Step 150/1000 - Loss: 0.0070, Perplexity: 1.0116, LR: 5.48e-05
2025-10-22 03:32:37,524 - INFO - Epoch 24, Step 200/1000 - Loss: 0.0058, Perplexity: 1.0093, LR: 5.47e-05
2025-10-22 03:32:50,088 - INFO - Epoch 24, Step 250/1000 - Loss: 0.0049, Perplexity: 1.0077, LR: 5.46e-05
2025-10-22 03:33:02,364 - INFO - Epoch 24, Step 300/1000 - Loss: 0.0075, Perplexity: 1.0111, LR: 5.45e-05
2025-10-22 03:33:15,147 - INFO - Epoch 24, Step 350/1000 - Loss: 0.0081, Perplexity: 1.0116, LR: 5.44e-05
2025-10-22 03:33:27,878 - INFO - Epoch 24, Step 400/1000 - Loss: 0.0072, Perplexity: 1.0103, LR: 5.43e-05
2025-10-22 03:33:40,477 - INFO - Epoch 24, Step 450/1000 - Loss: 0.0086, Perplexity: 1.0125, LR: 5.42e-05
2025-10-22 03:33:52,729 - INFO - Epoch 24, Step 500/1000 - Loss: 0.0079, Perplexity: 1.0115, LR: 5.41e-05
2025-10-22 03:34:05,410 - INFO - Epoch 24, Step 550/1000 - Loss: 0.0074, Perplexity: 1.0107, LR: 5.40e-05
2025-10-22 03:34:17,572 - INFO - Epoch 24, Step 600/1000 - Loss: 0.0086, Perplexity: 1.0126, LR: 5.39e-05
2025-10-22 03:34:29,967 - INFO - Epoch 24, Step 650/1000 - Loss: 0.0086, Perplexity: 1.0126, LR: 5.38e-05
2025-10-22 03:34:42,705 - INFO - Epoch 24, Step 700/1000 - Loss: 0.0080, Perplexity: 1.0117, LR: 5.37e-05
2025-10-22 03:34:55,167 - INFO - Epoch 24, Step 750/1000 - Loss: 0.0077, Perplexity: 1.0111, LR: 5.36e-05
2025-10-22 03:35:07,496 - INFO - Epoch 24, Step 800/1000 - Loss: 0.0080, Perplexity: 1.0115, LR: 5.35e-05
2025-10-22 03:35:19,719 - INFO - Epoch 24, Step 850/1000 - Loss: 0.0076, Perplexity: 1.0109, LR: 5.34e-05
2025-10-22 03:35:32,249 - INFO - Epoch 24, Step 900/1000 - Loss: 0.0072, Perplexity: 1.0103, LR: 5.33e-05
2025-10-22 03:35:44,791 - INFO - Epoch 24, Step 950/1000 - Loss: 0.0069, Perplexity: 1.0099, LR: 5.32e-05
2025-10-22 03:35:57,354 - INFO - Epoch 24, Step 1000/1000 - Loss: 0.0068, Perplexity: 1.0096, LR: 5.31e-05
2025-10-22 03:35:57,355 - INFO - Epoch 24 Complete - Avg Loss: 0.0068, Avg Perplexity: 1.0096
2025-10-22 03:36:17,128 - INFO - Validation - Loss: 0.0100, Perplexity: 1.0165, Token Accuracy: 0.9985, Code Accuracy: 0.9983
2025-10-22 03:36:17,129 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:36:20,538 - INFO - TPL computed on 351 samples: 1.0253
2025-10-22 03:36:20,538 - INFO - Temporal Perplexity (TPL): 1.0253
2025-10-22 03:36:20,538 - INFO - New best model! Validation loss: 0.0100
2025-10-22 03:36:25,015 - INFO - Checkpoint saved: epoch 24
2025-10-22 03:36:37,371 - INFO - Epoch 25, Step 50/1000 - Loss: 0.0082, Perplexity: 1.0099, LR: 5.30e-05
2025-10-22 03:36:49,902 - INFO - Epoch 25, Step 100/1000 - Loss: 0.0048, Perplexity: 1.0056, LR: 5.29e-05
2025-10-22 03:37:02,259 - INFO - Epoch 25, Step 150/1000 - Loss: 0.0033, Perplexity: 1.0038, LR: 5.28e-05
2025-10-22 03:37:15,094 - INFO - Epoch 25, Step 200/1000 - Loss: 0.0058, Perplexity: 1.0075, LR: 5.27e-05
2025-10-22 03:37:27,697 - INFO - Epoch 25, Step 250/1000 - Loss: 0.0047, Perplexity: 1.0060, LR: 5.26e-05
2025-10-22 03:37:40,286 - INFO - Epoch 25, Step 300/1000 - Loss: 0.0044, Perplexity: 1.0055, LR: 5.24e-05
2025-10-22 03:37:53,077 - INFO - Epoch 25, Step 350/1000 - Loss: 0.0040, Perplexity: 1.0050, LR: 5.23e-05
2025-10-22 03:38:05,380 - INFO - Epoch 25, Step 400/1000 - Loss: 0.0045, Perplexity: 1.0055, LR: 5.22e-05
2025-10-22 03:38:17,807 - INFO - Epoch 25, Step 450/1000 - Loss: 0.0040, Perplexity: 1.0049, LR: 5.21e-05
2025-10-22 03:38:30,132 - INFO - Epoch 25, Step 500/1000 - Loss: 0.0048, Perplexity: 1.0060, LR: 5.20e-05
2025-10-22 03:38:42,879 - INFO - Epoch 25, Step 550/1000 - Loss: 0.0045, Perplexity: 1.0056, LR: 5.19e-05
2025-10-22 03:38:55,683 - INFO - Epoch 25, Step 600/1000 - Loss: 0.0042, Perplexity: 1.0053, LR: 5.18e-05
2025-10-22 03:39:08,195 - INFO - Epoch 25, Step 650/1000 - Loss: 0.0042, Perplexity: 1.0052, LR: 5.17e-05
2025-10-22 03:39:20,732 - INFO - Epoch 25, Step 700/1000 - Loss: 0.0046, Perplexity: 1.0056, LR: 5.16e-05
2025-10-22 03:39:33,407 - INFO - Epoch 25, Step 750/1000 - Loss: 0.0044, Perplexity: 1.0053, LR: 5.15e-05
2025-10-22 03:39:45,677 - INFO - Epoch 25, Step 800/1000 - Loss: 0.0042, Perplexity: 1.0051, LR: 5.14e-05
2025-10-22 03:39:58,173 - INFO - Epoch 25, Step 850/1000 - Loss: 0.0040, Perplexity: 1.0048, LR: 5.13e-05
2025-10-22 03:40:10,811 - INFO - Epoch 25, Step 900/1000 - Loss: 0.0043, Perplexity: 1.0052, LR: 5.12e-05
2025-10-22 03:40:23,096 - INFO - Epoch 25, Step 950/1000 - Loss: 0.0049, Perplexity: 1.0063, LR: 5.11e-05
2025-10-22 03:40:35,510 - INFO - Epoch 25, Step 1000/1000 - Loss: 0.0047, Perplexity: 1.0060, LR: 5.10e-05
2025-10-22 03:40:35,511 - INFO - Epoch 25 Complete - Avg Loss: 0.0047, Avg Perplexity: 1.0060
2025-10-22 03:40:55,311 - INFO - Validation - Loss: 0.0127, Perplexity: 1.0206, Token Accuracy: 0.9982, Code Accuracy: 0.9978
2025-10-22 03:40:55,313 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:40:58,710 - INFO - TPL computed on 351 samples: 1.0284
2025-10-22 03:40:58,710 - INFO - Temporal Perplexity (TPL): 1.0284
2025-10-22 03:41:00,988 - INFO - Checkpoint saved: epoch 25
2025-10-22 03:41:13,220 - INFO - Epoch 26, Step 50/1000 - Loss: 0.0011, Perplexity: 1.0011, LR: 5.09e-05
2025-10-22 03:41:25,785 - INFO - Epoch 26, Step 100/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 5.08e-05
2025-10-22 03:41:38,172 - INFO - Epoch 26, Step 150/1000 - Loss: 0.0059, Perplexity: 1.0088, LR: 5.07e-05
2025-10-22 03:41:50,603 - INFO - Epoch 26, Step 200/1000 - Loss: 0.0047, Perplexity: 1.0069, LR: 5.06e-05
2025-10-22 03:42:03,115 - INFO - Epoch 26, Step 250/1000 - Loss: 0.0041, Perplexity: 1.0058, LR: 5.05e-05
2025-10-22 03:42:16,011 - INFO - Epoch 26, Step 300/1000 - Loss: 0.0049, Perplexity: 1.0066, LR: 5.04e-05
2025-10-22 03:42:28,287 - INFO - Epoch 26, Step 350/1000 - Loss: 0.0061, Perplexity: 1.0082, LR: 5.03e-05
2025-10-22 03:42:40,636 - INFO - Epoch 26, Step 400/1000 - Loss: 0.0055, Perplexity: 1.0073, LR: 5.02e-05
2025-10-22 03:42:53,497 - INFO - Epoch 26, Step 450/1000 - Loss: 0.0049, Perplexity: 1.0066, LR: 5.01e-05
2025-10-22 03:43:05,743 - INFO - Epoch 26, Step 500/1000 - Loss: 0.0072, Perplexity: 1.0101, LR: 5.00e-05
2025-10-22 03:43:18,009 - INFO - Epoch 26, Step 550/1000 - Loss: 0.0067, Perplexity: 1.0093, LR: 4.99e-05
2025-10-22 03:43:30,303 - INFO - Epoch 26, Step 600/1000 - Loss: 0.0063, Perplexity: 1.0086, LR: 4.98e-05
2025-10-22 03:43:42,862 - INFO - Epoch 26, Step 650/1000 - Loss: 0.0061, Perplexity: 1.0083, LR: 4.97e-05
2025-10-22 03:43:55,376 - INFO - Epoch 26, Step 700/1000 - Loss: 0.0057, Perplexity: 1.0077, LR: 4.96e-05
2025-10-22 03:44:07,724 - INFO - Epoch 26, Step 750/1000 - Loss: 0.0061, Perplexity: 1.0082, LR: 4.95e-05
2025-10-22 03:44:20,516 - INFO - Epoch 26, Step 800/1000 - Loss: 0.0059, Perplexity: 1.0079, LR: 4.94e-05
2025-10-22 03:44:32,842 - INFO - Epoch 26, Step 850/1000 - Loss: 0.0064, Perplexity: 1.0086, LR: 4.93e-05
2025-10-22 03:44:45,411 - INFO - Epoch 26, Step 900/1000 - Loss: 0.0060, Perplexity: 1.0081, LR: 4.92e-05
2025-10-22 03:44:57,617 - INFO - Epoch 26, Step 950/1000 - Loss: 0.0057, Perplexity: 1.0077, LR: 4.91e-05
2025-10-22 03:45:09,785 - INFO - Epoch 26, Step 1000/1000 - Loss: 0.0054, Perplexity: 1.0073, LR: 4.90e-05
2025-10-22 03:45:09,786 - INFO - Epoch 26 Complete - Avg Loss: 0.0054, Avg Perplexity: 1.0073
2025-10-22 03:45:29,857 - INFO - Validation - Loss: 0.0109, Perplexity: 1.0162, Token Accuracy: 0.9986, Code Accuracy: 0.9983
2025-10-22 03:45:29,859 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:45:33,252 - INFO - TPL computed on 351 samples: 1.0247
2025-10-22 03:45:33,252 - INFO - Temporal Perplexity (TPL): 1.0247
2025-10-22 03:45:45,583 - INFO - Epoch 27, Step 50/1000 - Loss: 0.0020, Perplexity: 1.0020, LR: 4.89e-05
2025-10-22 03:45:57,845 - INFO - Epoch 27, Step 100/1000 - Loss: 0.0030, Perplexity: 1.0031, LR: 4.88e-05
2025-10-22 03:46:09,922 - INFO - Epoch 27, Step 150/1000 - Loss: 0.0021, Perplexity: 1.0021, LR: 4.87e-05
2025-10-22 03:46:22,371 - INFO - Epoch 27, Step 200/1000 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.86e-05
2025-10-22 03:46:34,615 - INFO - Epoch 27, Step 250/1000 - Loss: 0.0048, Perplexity: 1.0069, LR: 4.85e-05
2025-10-22 03:46:47,034 - INFO - Epoch 27, Step 300/1000 - Loss: 0.0065, Perplexity: 1.0092, LR: 4.84e-05
2025-10-22 03:46:59,786 - INFO - Epoch 27, Step 350/1000 - Loss: 0.0056, Perplexity: 1.0080, LR: 4.83e-05
2025-10-22 03:47:12,468 - INFO - Epoch 27, Step 400/1000 - Loss: 0.0051, Perplexity: 1.0072, LR: 4.82e-05
2025-10-22 03:47:25,124 - INFO - Epoch 27, Step 450/1000 - Loss: 0.0065, Perplexity: 1.0089, LR: 4.81e-05
2025-10-22 03:47:37,607 - INFO - Epoch 27, Step 500/1000 - Loss: 0.0059, Perplexity: 1.0080, LR: 4.80e-05
2025-10-22 03:47:49,921 - INFO - Epoch 27, Step 550/1000 - Loss: 0.0057, Perplexity: 1.0076, LR: 4.79e-05
2025-10-22 03:48:02,802 - INFO - Epoch 27, Step 600/1000 - Loss: 0.0061, Perplexity: 1.0082, LR: 4.78e-05
2025-10-22 03:48:15,146 - INFO - Epoch 27, Step 650/1000 - Loss: 0.0057, Perplexity: 1.0076, LR: 4.77e-05
2025-10-22 03:48:27,676 - INFO - Epoch 27, Step 700/1000 - Loss: 0.0053, Perplexity: 1.0071, LR: 4.76e-05
2025-10-22 03:48:40,328 - INFO - Epoch 27, Step 750/1000 - Loss: 0.0057, Perplexity: 1.0076, LR: 4.74e-05
2025-10-22 03:48:53,120 - INFO - Epoch 27, Step 800/1000 - Loss: 0.0056, Perplexity: 1.0073, LR: 4.73e-05
2025-10-22 03:49:05,974 - INFO - Epoch 27, Step 850/1000 - Loss: 0.0053, Perplexity: 1.0069, LR: 4.72e-05
2025-10-22 03:49:18,374 - INFO - Epoch 27, Step 900/1000 - Loss: 0.0050, Perplexity: 1.0066, LR: 4.71e-05
2025-10-22 03:49:30,857 - INFO - Epoch 27, Step 950/1000 - Loss: 0.0050, Perplexity: 1.0065, LR: 4.70e-05
2025-10-22 03:49:43,334 - INFO - Epoch 27, Step 1000/1000 - Loss: 0.0048, Perplexity: 1.0062, LR: 4.69e-05
2025-10-22 03:49:43,335 - INFO - Epoch 27 Complete - Avg Loss: 0.0048, Avg Perplexity: 1.0062
2025-10-22 03:50:03,276 - INFO - Validation - Loss: 0.0066, Perplexity: 1.0089, Token Accuracy: 0.9990, Code Accuracy: 0.9989
2025-10-22 03:50:03,277 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:50:06,676 - INFO - TPL computed on 351 samples: 1.0221
2025-10-22 03:50:06,676 - INFO - Temporal Perplexity (TPL): 1.0221
2025-10-22 03:50:06,676 - INFO - New best model! Validation loss: 0.0066
2025-10-22 03:50:11,118 - INFO - Checkpoint saved: epoch 27
2025-10-22 03:50:23,663 - INFO - Epoch 28, Step 50/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 4.68e-05
2025-10-22 03:50:36,436 - INFO - Epoch 28, Step 100/1000 - Loss: 0.0012, Perplexity: 1.0012, LR: 4.67e-05
2025-10-22 03:50:49,063 - INFO - Epoch 28, Step 150/1000 - Loss: 0.0086, Perplexity: 1.0103, LR: 4.66e-05
2025-10-22 03:51:01,608 - INFO - Epoch 28, Step 200/1000 - Loss: 0.0069, Perplexity: 1.0082, LR: 4.65e-05
2025-10-22 03:51:13,942 - INFO - Epoch 28, Step 250/1000 - Loss: 0.0080, Perplexity: 1.0099, LR: 4.64e-05
2025-10-22 03:51:26,245 - INFO - Epoch 28, Step 300/1000 - Loss: 0.0070, Perplexity: 1.0085, LR: 4.63e-05
2025-10-22 03:51:38,580 - INFO - Epoch 28, Step 350/1000 - Loss: 0.0070, Perplexity: 1.0085, LR: 4.62e-05
2025-10-22 03:51:50,783 - INFO - Epoch 28, Step 400/1000 - Loss: 0.0062, Perplexity: 1.0075, LR: 4.61e-05
2025-10-22 03:52:02,833 - INFO - Epoch 28, Step 450/1000 - Loss: 0.0056, Perplexity: 1.0068, LR: 4.60e-05
2025-10-22 03:52:15,115 - INFO - Epoch 28, Step 500/1000 - Loss: 0.0051, Perplexity: 1.0061, LR: 4.59e-05
2025-10-22 03:52:27,778 - INFO - Epoch 28, Step 550/1000 - Loss: 0.0046, Perplexity: 1.0056, LR: 4.58e-05
2025-10-22 03:52:40,500 - INFO - Epoch 28, Step 600/1000 - Loss: 0.0048, Perplexity: 1.0058, LR: 4.57e-05
2025-10-22 03:52:52,845 - INFO - Epoch 28, Step 650/1000 - Loss: 0.0045, Perplexity: 1.0054, LR: 4.56e-05
2025-10-22 03:53:05,542 - INFO - Epoch 28, Step 700/1000 - Loss: 0.0042, Perplexity: 1.0050, LR: 4.55e-05
2025-10-22 03:53:18,422 - INFO - Epoch 28, Step 750/1000 - Loss: 0.0039, Perplexity: 1.0047, LR: 4.54e-05
2025-10-22 03:53:30,982 - INFO - Epoch 28, Step 800/1000 - Loss: 0.0037, Perplexity: 1.0045, LR: 4.53e-05
2025-10-22 03:53:43,597 - INFO - Epoch 28, Step 850/1000 - Loss: 0.0035, Perplexity: 1.0042, LR: 4.52e-05
2025-10-22 03:53:56,235 - INFO - Epoch 28, Step 900/1000 - Loss: 0.0034, Perplexity: 1.0041, LR: 4.51e-05
2025-10-22 03:54:08,703 - INFO - Epoch 28, Step 950/1000 - Loss: 0.0040, Perplexity: 1.0049, LR: 4.50e-05
2025-10-22 03:54:21,207 - INFO - Epoch 28, Step 1000/1000 - Loss: 0.0038, Perplexity: 1.0047, LR: 4.49e-05
2025-10-22 03:54:21,208 - INFO - Epoch 28 Complete - Avg Loss: 0.0038, Avg Perplexity: 1.0047
2025-10-22 03:54:41,174 - INFO - Validation - Loss: 0.0071, Perplexity: 1.0104, Token Accuracy: 0.9991, Code Accuracy: 0.9990
2025-10-22 03:54:41,175 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:54:44,582 - INFO - TPL computed on 351 samples: 1.0259
2025-10-22 03:54:44,582 - INFO - Temporal Perplexity (TPL): 1.0259
2025-10-22 03:54:56,761 - INFO - Epoch 29, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 4.48e-05
2025-10-22 03:55:09,204 - INFO - Epoch 29, Step 100/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 4.47e-05
2025-10-22 03:55:21,839 - INFO - Epoch 29, Step 150/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 4.46e-05
2025-10-22 03:55:34,180 - INFO - Epoch 29, Step 200/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 4.45e-05
2025-10-22 03:55:46,506 - INFO - Epoch 29, Step 250/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 4.44e-05
2025-10-22 03:55:59,106 - INFO - Epoch 29, Step 300/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 4.43e-05
2025-10-22 03:56:11,703 - INFO - Epoch 29, Step 350/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 4.42e-05
2025-10-22 03:56:24,180 - INFO - Epoch 29, Step 400/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 4.41e-05
2025-10-22 03:56:36,717 - INFO - Epoch 29, Step 450/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 4.40e-05
2025-10-22 03:56:49,374 - INFO - Epoch 29, Step 500/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 4.39e-05
2025-10-22 03:57:01,682 - INFO - Epoch 29, Step 550/1000 - Loss: 0.0021, Perplexity: 1.0025, LR: 4.38e-05
2025-10-22 03:57:14,223 - INFO - Epoch 29, Step 600/1000 - Loss: 0.0025, Perplexity: 1.0029, LR: 4.37e-05
2025-10-22 03:57:26,317 - INFO - Epoch 29, Step 650/1000 - Loss: 0.0034, Perplexity: 1.0040, LR: 4.36e-05
2025-10-22 03:57:38,828 - INFO - Epoch 29, Step 700/1000 - Loss: 0.0032, Perplexity: 1.0038, LR: 4.35e-05
2025-10-22 03:57:51,264 - INFO - Epoch 29, Step 750/1000 - Loss: 0.0030, Perplexity: 1.0035, LR: 4.34e-05
2025-10-22 03:58:03,820 - INFO - Epoch 29, Step 800/1000 - Loss: 0.0033, Perplexity: 1.0040, LR: 4.33e-05
2025-10-22 03:58:16,621 - INFO - Epoch 29, Step 850/1000 - Loss: 0.0038, Perplexity: 1.0045, LR: 4.32e-05
2025-10-22 03:58:28,904 - INFO - Epoch 29, Step 900/1000 - Loss: 0.0036, Perplexity: 1.0044, LR: 4.31e-05
2025-10-22 03:58:41,412 - INFO - Epoch 29, Step 950/1000 - Loss: 0.0034, Perplexity: 1.0041, LR: 4.30e-05
2025-10-22 03:58:53,804 - INFO - Epoch 29, Step 1000/1000 - Loss: 0.0033, Perplexity: 1.0040, LR: 4.29e-05
2025-10-22 03:58:53,805 - INFO - Epoch 29 Complete - Avg Loss: 0.0033, Avg Perplexity: 1.0040
2025-10-22 03:59:13,566 - INFO - Validation - Loss: 0.0042, Perplexity: 1.0053, Token Accuracy: 0.9994, Code Accuracy: 0.9993
2025-10-22 03:59:13,567 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 03:59:16,977 - INFO - TPL computed on 351 samples: 1.0205
2025-10-22 03:59:16,977 - INFO - Temporal Perplexity (TPL): 1.0205
2025-10-22 03:59:16,977 - INFO - New best model! Validation loss: 0.0042
2025-10-22 03:59:20,797 - INFO - Checkpoint saved: epoch 29
2025-10-22 03:59:33,807 - INFO - Epoch 30, Step 50/1000 - Loss: 0.0085, Perplexity: 1.0105, LR: 4.28e-05
2025-10-22 03:59:46,267 - INFO - Epoch 30, Step 100/1000 - Loss: 0.0047, Perplexity: 1.0058, LR: 4.27e-05
2025-10-22 03:59:58,407 - INFO - Epoch 30, Step 150/1000 - Loss: 0.0032, Perplexity: 1.0039, LR: 4.26e-05
2025-10-22 04:00:10,878 - INFO - Epoch 30, Step 200/1000 - Loss: 0.0026, Perplexity: 1.0031, LR: 4.24e-05
2025-10-22 04:00:23,494 - INFO - Epoch 30, Step 250/1000 - Loss: 0.0023, Perplexity: 1.0028, LR: 4.23e-05
2025-10-22 04:00:35,953 - INFO - Epoch 30, Step 300/1000 - Loss: 0.0041, Perplexity: 1.0049, LR: 4.22e-05
2025-10-22 04:00:48,554 - INFO - Epoch 30, Step 350/1000 - Loss: 0.0062, Perplexity: 1.0078, LR: 4.21e-05
2025-10-22 04:01:01,214 - INFO - Epoch 30, Step 400/1000 - Loss: 0.0055, Perplexity: 1.0068, LR: 4.20e-05
2025-10-22 04:01:13,733 - INFO - Epoch 30, Step 450/1000 - Loss: 0.0049, Perplexity: 1.0061, LR: 4.19e-05
2025-10-22 04:01:26,131 - INFO - Epoch 30, Step 500/1000 - Loss: 0.0045, Perplexity: 1.0055, LR: 4.18e-05
2025-10-22 04:01:38,343 - INFO - Epoch 30, Step 550/1000 - Loss: 0.0049, Perplexity: 1.0061, LR: 4.17e-05
2025-10-22 04:01:50,526 - INFO - Epoch 30, Step 600/1000 - Loss: 0.0046, Perplexity: 1.0057, LR: 4.16e-05
2025-10-22 04:02:03,145 - INFO - Epoch 30, Step 650/1000 - Loss: 0.0043, Perplexity: 1.0053, LR: 4.15e-05
2025-10-22 04:02:15,514 - INFO - Epoch 30, Step 700/1000 - Loss: 0.0043, Perplexity: 1.0053, LR: 4.14e-05
2025-10-22 04:02:27,903 - INFO - Epoch 30, Step 750/1000 - Loss: 0.0041, Perplexity: 1.0050, LR: 4.13e-05
2025-10-22 04:02:40,603 - INFO - Epoch 30, Step 800/1000 - Loss: 0.0039, Perplexity: 1.0048, LR: 4.12e-05
2025-10-22 04:02:52,861 - INFO - Epoch 30, Step 850/1000 - Loss: 0.0037, Perplexity: 1.0046, LR: 4.11e-05
2025-10-22 04:03:05,397 - INFO - Epoch 30, Step 900/1000 - Loss: 0.0036, Perplexity: 1.0044, LR: 4.10e-05
2025-10-22 04:03:18,050 - INFO - Epoch 30, Step 950/1000 - Loss: 0.0034, Perplexity: 1.0042, LR: 4.09e-05
2025-10-22 04:03:30,482 - INFO - Epoch 30, Step 1000/1000 - Loss: 0.0033, Perplexity: 1.0040, LR: 4.08e-05
2025-10-22 04:03:30,483 - INFO - Epoch 30 Complete - Avg Loss: 0.0033, Avg Perplexity: 1.0040
2025-10-22 04:03:50,118 - INFO - Validation - Loss: 0.0041, Perplexity: 1.0054, Token Accuracy: 0.9994, Code Accuracy: 0.9994
2025-10-22 04:03:50,119 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:03:53,519 - INFO - TPL computed on 351 samples: 1.0193
2025-10-22 04:03:53,520 - INFO - Temporal Perplexity (TPL): 1.0193
2025-10-22 04:03:53,520 - INFO - New best model! Validation loss: 0.0041
2025-10-22 04:03:57,507 - INFO - Checkpoint saved: epoch 30
2025-10-22 04:04:10,241 - INFO - Epoch 31, Step 50/1000 - Loss: 0.0071, Perplexity: 1.0085, LR: 4.07e-05
2025-10-22 04:04:22,821 - INFO - Epoch 31, Step 100/1000 - Loss: 0.0064, Perplexity: 1.0074, LR: 4.06e-05
2025-10-22 04:04:35,111 - INFO - Epoch 31, Step 150/1000 - Loss: 0.0059, Perplexity: 1.0066, LR: 4.05e-05
2025-10-22 04:04:47,465 - INFO - Epoch 31, Step 200/1000 - Loss: 0.0045, Perplexity: 1.0050, LR: 4.04e-05
2025-10-22 04:04:59,926 - INFO - Epoch 31, Step 250/1000 - Loss: 0.0040, Perplexity: 1.0045, LR: 4.03e-05
2025-10-22 04:05:12,419 - INFO - Epoch 31, Step 300/1000 - Loss: 0.0034, Perplexity: 1.0037, LR: 4.02e-05
2025-10-22 04:05:24,857 - INFO - Epoch 31, Step 350/1000 - Loss: 0.0029, Perplexity: 1.0032, LR: 4.01e-05
2025-10-22 04:05:37,355 - INFO - Epoch 31, Step 400/1000 - Loss: 0.0026, Perplexity: 1.0028, LR: 4.00e-05
2025-10-22 04:05:49,912 - INFO - Epoch 31, Step 450/1000 - Loss: 0.0030, Perplexity: 1.0034, LR: 3.99e-05
2025-10-22 04:06:02,619 - INFO - Epoch 31, Step 500/1000 - Loss: 0.0027, Perplexity: 1.0031, LR: 3.98e-05
2025-10-22 04:06:14,744 - INFO - Epoch 31, Step 550/1000 - Loss: 0.0025, Perplexity: 1.0028, LR: 3.97e-05
2025-10-22 04:06:27,149 - INFO - Epoch 31, Step 600/1000 - Loss: 0.0023, Perplexity: 1.0026, LR: 3.96e-05
2025-10-22 04:06:39,465 - INFO - Epoch 31, Step 650/1000 - Loss: 0.0024, Perplexity: 1.0027, LR: 3.95e-05
2025-10-22 04:06:51,460 - INFO - Epoch 31, Step 700/1000 - Loss: 0.0030, Perplexity: 1.0034, LR: 3.94e-05
2025-10-22 04:07:03,755 - INFO - Epoch 31, Step 750/1000 - Loss: 0.0028, Perplexity: 1.0032, LR: 3.93e-05
2025-10-22 04:07:16,213 - INFO - Epoch 31, Step 800/1000 - Loss: 0.0026, Perplexity: 1.0030, LR: 3.92e-05
2025-10-22 04:07:28,960 - INFO - Epoch 31, Step 850/1000 - Loss: 0.0031, Perplexity: 1.0037, LR: 3.91e-05
2025-10-22 04:07:41,462 - INFO - Epoch 31, Step 900/1000 - Loss: 0.0029, Perplexity: 1.0035, LR: 3.90e-05
2025-10-22 04:07:54,035 - INFO - Epoch 31, Step 950/1000 - Loss: 0.0028, Perplexity: 1.0033, LR: 3.89e-05
2025-10-22 04:08:06,483 - INFO - Epoch 31, Step 1000/1000 - Loss: 0.0026, Perplexity: 1.0031, LR: 3.88e-05
2025-10-22 04:08:06,484 - INFO - Epoch 31 Complete - Avg Loss: 0.0026, Avg Perplexity: 1.0031
2025-10-22 04:08:26,190 - INFO - Validation - Loss: 0.0066, Perplexity: 1.0099, Token Accuracy: 0.9992, Code Accuracy: 0.9990
2025-10-22 04:08:26,191 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:08:29,587 - INFO - TPL computed on 351 samples: 1.0224
2025-10-22 04:08:29,587 - INFO - Temporal Perplexity (TPL): 1.0224
2025-10-22 04:08:42,015 - INFO - Epoch 32, Step 50/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 3.87e-05
2025-10-22 04:08:54,581 - INFO - Epoch 32, Step 100/1000 - Loss: 0.0064, Perplexity: 1.0086, LR: 3.86e-05
2025-10-22 04:09:07,174 - INFO - Epoch 32, Step 150/1000 - Loss: 0.0057, Perplexity: 1.0072, LR: 3.85e-05
2025-10-22 04:09:19,875 - INFO - Epoch 32, Step 200/1000 - Loss: 0.0044, Perplexity: 1.0056, LR: 3.84e-05
2025-10-22 04:09:32,301 - INFO - Epoch 32, Step 250/1000 - Loss: 0.0039, Perplexity: 1.0048, LR: 3.83e-05
2025-10-22 04:09:44,484 - INFO - Epoch 32, Step 300/1000 - Loss: 0.0035, Perplexity: 1.0043, LR: 3.82e-05
2025-10-22 04:09:56,732 - INFO - Epoch 32, Step 350/1000 - Loss: 0.0031, Perplexity: 1.0038, LR: 3.81e-05
2025-10-22 04:10:09,405 - INFO - Epoch 32, Step 400/1000 - Loss: 0.0027, Perplexity: 1.0033, LR: 3.80e-05
2025-10-22 04:10:21,598 - INFO - Epoch 32, Step 450/1000 - Loss: 0.0026, Perplexity: 1.0031, LR: 3.79e-05
2025-10-22 04:10:34,099 - INFO - Epoch 32, Step 500/1000 - Loss: 0.0025, Perplexity: 1.0030, LR: 3.78e-05
2025-10-22 04:10:47,039 - INFO - Epoch 32, Step 550/1000 - Loss: 0.0023, Perplexity: 1.0027, LR: 3.77e-05
2025-10-22 04:10:59,470 - INFO - Epoch 32, Step 600/1000 - Loss: 0.0021, Perplexity: 1.0025, LR: 3.76e-05
2025-10-22 04:11:11,657 - INFO - Epoch 32, Step 650/1000 - Loss: 0.0020, Perplexity: 1.0024, LR: 3.74e-05
2025-10-22 04:11:24,288 - INFO - Epoch 32, Step 700/1000 - Loss: 0.0024, Perplexity: 1.0028, LR: 3.73e-05
2025-10-22 04:11:36,986 - INFO - Epoch 32, Step 750/1000 - Loss: 0.0026, Perplexity: 1.0030, LR: 3.72e-05
2025-10-22 04:11:49,310 - INFO - Epoch 32, Step 800/1000 - Loss: 0.0025, Perplexity: 1.0029, LR: 3.71e-05
2025-10-22 04:12:01,740 - INFO - Epoch 32, Step 850/1000 - Loss: 0.0024, Perplexity: 1.0028, LR: 3.70e-05
2025-10-22 04:12:14,265 - INFO - Epoch 32, Step 900/1000 - Loss: 0.0027, Perplexity: 1.0031, LR: 3.69e-05
2025-10-22 04:12:26,818 - INFO - Epoch 32, Step 950/1000 - Loss: 0.0026, Perplexity: 1.0031, LR: 3.68e-05
2025-10-22 04:12:39,117 - INFO - Epoch 32, Step 1000/1000 - Loss: 0.0031, Perplexity: 1.0036, LR: 3.67e-05
2025-10-22 04:12:39,118 - INFO - Epoch 32 Complete - Avg Loss: 0.0031, Avg Perplexity: 1.0036
2025-10-22 04:12:58,830 - INFO - Validation - Loss: 0.0031, Perplexity: 1.0037, Token Accuracy: 0.9995, Code Accuracy: 0.9995
2025-10-22 04:12:58,831 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:13:02,239 - INFO - TPL computed on 351 samples: 1.0219
2025-10-22 04:13:02,240 - INFO - Temporal Perplexity (TPL): 1.0219
2025-10-22 04:13:02,240 - INFO - New best model! Validation loss: 0.0031
2025-10-22 04:13:06,516 - INFO - Checkpoint saved: epoch 32
2025-10-22 04:13:18,993 - INFO - Epoch 33, Step 50/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.66e-05
2025-10-22 04:13:31,070 - INFO - Epoch 33, Step 100/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.65e-05
2025-10-22 04:13:43,433 - INFO - Epoch 33, Step 150/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.64e-05
2025-10-22 04:13:55,717 - INFO - Epoch 33, Step 200/1000 - Loss: 0.0035, Perplexity: 1.0039, LR: 3.63e-05
2025-10-22 04:14:08,362 - INFO - Epoch 33, Step 250/1000 - Loss: 0.0028, Perplexity: 1.0032, LR: 3.62e-05
2025-10-22 04:14:20,727 - INFO - Epoch 33, Step 300/1000 - Loss: 0.0024, Perplexity: 1.0027, LR: 3.61e-05
2025-10-22 04:14:33,435 - INFO - Epoch 33, Step 350/1000 - Loss: 0.0021, Perplexity: 1.0023, LR: 3.60e-05
2025-10-22 04:14:45,554 - INFO - Epoch 33, Step 400/1000 - Loss: 0.0028, Perplexity: 1.0032, LR: 3.59e-05
2025-10-22 04:14:57,994 - INFO - Epoch 33, Step 450/1000 - Loss: 0.0025, Perplexity: 1.0029, LR: 3.58e-05
2025-10-22 04:15:10,023 - INFO - Epoch 33, Step 500/1000 - Loss: 0.0022, Perplexity: 1.0026, LR: 3.57e-05
2025-10-22 04:15:22,353 - INFO - Epoch 33, Step 550/1000 - Loss: 0.0022, Perplexity: 1.0025, LR: 3.56e-05
2025-10-22 04:15:35,006 - INFO - Epoch 33, Step 600/1000 - Loss: 0.0023, Perplexity: 1.0026, LR: 3.55e-05
2025-10-22 04:15:47,619 - INFO - Epoch 33, Step 650/1000 - Loss: 0.0022, Perplexity: 1.0025, LR: 3.54e-05
2025-10-22 04:15:59,902 - INFO - Epoch 33, Step 700/1000 - Loss: 0.0020, Perplexity: 1.0023, LR: 3.53e-05
2025-10-22 04:16:12,606 - INFO - Epoch 33, Step 750/1000 - Loss: 0.0019, Perplexity: 1.0022, LR: 3.52e-05
2025-10-22 04:16:25,258 - INFO - Epoch 33, Step 800/1000 - Loss: 0.0020, Perplexity: 1.0023, LR: 3.51e-05
2025-10-22 04:16:37,493 - INFO - Epoch 33, Step 850/1000 - Loss: 0.0020, Perplexity: 1.0022, LR: 3.50e-05
2025-10-22 04:16:49,998 - INFO - Epoch 33, Step 900/1000 - Loss: 0.0020, Perplexity: 1.0023, LR: 3.49e-05
2025-10-22 04:17:03,058 - INFO - Epoch 33, Step 950/1000 - Loss: 0.0019, Perplexity: 1.0022, LR: 3.48e-05
2025-10-22 04:17:15,600 - INFO - Epoch 33, Step 1000/1000 - Loss: 0.0019, Perplexity: 1.0022, LR: 3.47e-05
2025-10-22 04:17:15,601 - INFO - Epoch 33 Complete - Avg Loss: 0.0019, Avg Perplexity: 1.0022
2025-10-22 04:17:35,415 - INFO - Validation - Loss: 0.0043, Perplexity: 1.0049, Token Accuracy: 0.9992, Code Accuracy: 0.9990
2025-10-22 04:17:35,417 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:17:38,816 - INFO - TPL computed on 351 samples: 1.0209
2025-10-22 04:17:38,816 - INFO - Temporal Perplexity (TPL): 1.0209
2025-10-22 04:17:51,378 - INFO - Epoch 34, Step 50/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.46e-05
2025-10-22 04:18:03,717 - INFO - Epoch 34, Step 100/1000 - Loss: 0.0038, Perplexity: 1.0043, LR: 3.45e-05
2025-10-22 04:18:16,354 - INFO - Epoch 34, Step 150/1000 - Loss: 0.0053, Perplexity: 1.0060, LR: 3.44e-05
2025-10-22 04:18:28,701 - INFO - Epoch 34, Step 200/1000 - Loss: 0.0063, Perplexity: 1.0076, LR: 3.43e-05
2025-10-22 04:18:41,302 - INFO - Epoch 34, Step 250/1000 - Loss: 0.0051, Perplexity: 1.0061, LR: 3.42e-05
2025-10-22 04:18:54,090 - INFO - Epoch 34, Step 300/1000 - Loss: 0.0043, Perplexity: 1.0052, LR: 3.41e-05
2025-10-22 04:19:06,384 - INFO - Epoch 34, Step 350/1000 - Loss: 0.0038, Perplexity: 1.0045, LR: 3.40e-05
2025-10-22 04:19:19,238 - INFO - Epoch 34, Step 400/1000 - Loss: 0.0033, Perplexity: 1.0039, LR: 3.39e-05
2025-10-22 04:19:31,782 - INFO - Epoch 34, Step 450/1000 - Loss: 0.0029, Perplexity: 1.0035, LR: 3.38e-05
2025-10-22 04:19:43,900 - INFO - Epoch 34, Step 500/1000 - Loss: 0.0026, Perplexity: 1.0031, LR: 3.37e-05
2025-10-22 04:19:56,282 - INFO - Epoch 34, Step 550/1000 - Loss: 0.0024, Perplexity: 1.0028, LR: 3.36e-05
2025-10-22 04:20:08,573 - INFO - Epoch 34, Step 600/1000 - Loss: 0.0025, Perplexity: 1.0030, LR: 3.35e-05
2025-10-22 04:20:21,108 - INFO - Epoch 34, Step 650/1000 - Loss: 0.0023, Perplexity: 1.0028, LR: 3.34e-05
2025-10-22 04:20:33,592 - INFO - Epoch 34, Step 700/1000 - Loss: 0.0022, Perplexity: 1.0026, LR: 3.33e-05
2025-10-22 04:20:46,339 - INFO - Epoch 34, Step 750/1000 - Loss: 0.0020, Perplexity: 1.0024, LR: 3.32e-05
2025-10-22 04:20:58,510 - INFO - Epoch 34, Step 800/1000 - Loss: 0.0020, Perplexity: 1.0023, LR: 3.31e-05
2025-10-22 04:21:11,296 - INFO - Epoch 34, Step 850/1000 - Loss: 0.0019, Perplexity: 1.0022, LR: 3.30e-05
2025-10-22 04:21:23,334 - INFO - Epoch 34, Step 900/1000 - Loss: 0.0018, Perplexity: 1.0021, LR: 3.29e-05
2025-10-22 04:21:36,224 - INFO - Epoch 34, Step 950/1000 - Loss: 0.0018, Perplexity: 1.0021, LR: 3.28e-05
2025-10-22 04:21:48,896 - INFO - Epoch 34, Step 1000/1000 - Loss: 0.0018, Perplexity: 1.0021, LR: 3.27e-05
2025-10-22 04:21:48,897 - INFO - Epoch 34 Complete - Avg Loss: 0.0018, Avg Perplexity: 1.0021
2025-10-22 04:22:08,662 - INFO - Validation - Loss: 0.0041, Perplexity: 1.0053, Token Accuracy: 0.9995, Code Accuracy: 0.9995
2025-10-22 04:22:08,663 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:22:12,067 - INFO - TPL computed on 351 samples: 1.0218
2025-10-22 04:22:12,067 - INFO - Temporal Perplexity (TPL): 1.0218
2025-10-22 04:22:24,576 - INFO - Epoch 35, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.26e-05
2025-10-22 04:22:37,111 - INFO - Epoch 35, Step 100/1000 - Loss: 0.0030, Perplexity: 1.0035, LR: 3.24e-05
2025-10-22 04:22:49,516 - INFO - Epoch 35, Step 150/1000 - Loss: 0.0023, Perplexity: 1.0027, LR: 3.23e-05
2025-10-22 04:23:01,847 - INFO - Epoch 35, Step 200/1000 - Loss: 0.0017, Perplexity: 1.0020, LR: 3.22e-05
2025-10-22 04:23:14,505 - INFO - Epoch 35, Step 250/1000 - Loss: 0.0014, Perplexity: 1.0016, LR: 3.21e-05
2025-10-22 04:23:27,083 - INFO - Epoch 35, Step 300/1000 - Loss: 0.0020, Perplexity: 1.0023, LR: 3.20e-05
2025-10-22 04:23:39,433 - INFO - Epoch 35, Step 350/1000 - Loss: 0.0017, Perplexity: 1.0020, LR: 3.19e-05
2025-10-22 04:23:52,061 - INFO - Epoch 35, Step 400/1000 - Loss: 0.0018, Perplexity: 1.0020, LR: 3.18e-05
2025-10-22 04:24:04,720 - INFO - Epoch 35, Step 450/1000 - Loss: 0.0016, Perplexity: 1.0018, LR: 3.17e-05
2025-10-22 04:24:17,020 - INFO - Epoch 35, Step 500/1000 - Loss: 0.0015, Perplexity: 1.0016, LR: 3.16e-05
2025-10-22 04:24:29,576 - INFO - Epoch 35, Step 550/1000 - Loss: 0.0014, Perplexity: 1.0016, LR: 3.15e-05
2025-10-22 04:24:41,789 - INFO - Epoch 35, Step 600/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 3.14e-05
2025-10-22 04:24:54,362 - INFO - Epoch 35, Step 650/1000 - Loss: 0.0012, Perplexity: 1.0014, LR: 3.13e-05
2025-10-22 04:25:06,710 - INFO - Epoch 35, Step 700/1000 - Loss: 0.0014, Perplexity: 1.0016, LR: 3.12e-05
2025-10-22 04:25:19,227 - INFO - Epoch 35, Step 750/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 3.11e-05
2025-10-22 04:25:31,791 - INFO - Epoch 35, Step 800/1000 - Loss: 0.0013, Perplexity: 1.0014, LR: 3.10e-05
2025-10-22 04:25:44,275 - INFO - Epoch 35, Step 850/1000 - Loss: 0.0012, Perplexity: 1.0014, LR: 3.09e-05
2025-10-22 04:25:56,976 - INFO - Epoch 35, Step 900/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 3.08e-05
2025-10-22 04:26:09,410 - INFO - Epoch 35, Step 950/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 3.07e-05
2025-10-22 04:26:22,070 - INFO - Epoch 35, Step 1000/1000 - Loss: 0.0018, Perplexity: 1.0020, LR: 3.06e-05
2025-10-22 04:26:22,071 - INFO - Epoch 35 Complete - Avg Loss: 0.0018, Avg Perplexity: 1.0020
2025-10-22 04:26:42,082 - INFO - Validation - Loss: 0.0054, Perplexity: 1.0061, Token Accuracy: 0.9991, Code Accuracy: 0.9990
2025-10-22 04:26:42,083 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:26:45,482 - INFO - TPL computed on 351 samples: 1.0230
2025-10-22 04:26:45,482 - INFO - Temporal Perplexity (TPL): 1.0230
2025-10-22 04:26:47,675 - INFO - Checkpoint saved: epoch 35
2025-10-22 04:27:00,214 - INFO - Epoch 36, Step 50/1000 - Loss: 0.0049, Perplexity: 1.0053, LR: 3.05e-05
2025-10-22 04:27:12,834 - INFO - Epoch 36, Step 100/1000 - Loss: 0.0032, Perplexity: 1.0035, LR: 3.04e-05
2025-10-22 04:27:25,139 - INFO - Epoch 36, Step 150/1000 - Loss: 0.0026, Perplexity: 1.0028, LR: 3.03e-05
2025-10-22 04:27:37,363 - INFO - Epoch 36, Step 200/1000 - Loss: 0.0019, Perplexity: 1.0021, LR: 3.02e-05
2025-10-22 04:27:49,872 - INFO - Epoch 36, Step 250/1000 - Loss: 0.0016, Perplexity: 1.0017, LR: 3.01e-05
2025-10-22 04:28:02,275 - INFO - Epoch 36, Step 300/1000 - Loss: 0.0020, Perplexity: 1.0022, LR: 3.00e-05
2025-10-22 04:28:15,017 - INFO - Epoch 36, Step 350/1000 - Loss: 0.0017, Perplexity: 1.0019, LR: 2.99e-05
2025-10-22 04:28:27,384 - INFO - Epoch 36, Step 400/1000 - Loss: 0.0015, Perplexity: 1.0017, LR: 2.98e-05
2025-10-22 04:28:39,896 - INFO - Epoch 36, Step 450/1000 - Loss: 0.0014, Perplexity: 1.0015, LR: 2.97e-05
2025-10-22 04:28:52,170 - INFO - Epoch 36, Step 500/1000 - Loss: 0.0016, Perplexity: 1.0018, LR: 2.96e-05
2025-10-22 04:29:04,801 - INFO - Epoch 36, Step 550/1000 - Loss: 0.0017, Perplexity: 1.0018, LR: 2.95e-05
2025-10-22 04:29:17,334 - INFO - Epoch 36, Step 600/1000 - Loss: 0.0015, Perplexity: 1.0017, LR: 2.94e-05
2025-10-22 04:29:30,028 - INFO - Epoch 36, Step 650/1000 - Loss: 0.0016, Perplexity: 1.0017, LR: 2.93e-05
2025-10-22 04:29:42,540 - INFO - Epoch 36, Step 700/1000 - Loss: 0.0017, Perplexity: 1.0018, LR: 2.92e-05
2025-10-22 04:29:55,040 - INFO - Epoch 36, Step 750/1000 - Loss: 0.0017, Perplexity: 1.0019, LR: 2.91e-05
2025-10-22 04:30:07,732 - INFO - Epoch 36, Step 800/1000 - Loss: 0.0017, Perplexity: 1.0018, LR: 2.90e-05
2025-10-22 04:30:20,096 - INFO - Epoch 36, Step 850/1000 - Loss: 0.0016, Perplexity: 1.0017, LR: 2.89e-05
2025-10-22 04:30:32,675 - INFO - Epoch 36, Step 900/1000 - Loss: 0.0015, Perplexity: 1.0016, LR: 2.88e-05
2025-10-22 04:30:45,350 - INFO - Epoch 36, Step 950/1000 - Loss: 0.0014, Perplexity: 1.0015, LR: 2.87e-05
2025-10-22 04:30:57,859 - INFO - Epoch 36, Step 1000/1000 - Loss: 0.0014, Perplexity: 1.0014, LR: 2.86e-05
2025-10-22 04:30:57,860 - INFO - Epoch 36 Complete - Avg Loss: 0.0014, Avg Perplexity: 1.0014
2025-10-22 04:31:17,767 - INFO - Validation - Loss: 0.0019, Perplexity: 1.0021, Token Accuracy: 0.9997, Code Accuracy: 0.9997
2025-10-22 04:31:17,769 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:31:21,174 - INFO - TPL computed on 351 samples: 1.0185
2025-10-22 04:31:21,174 - INFO - Temporal Perplexity (TPL): 1.0185
2025-10-22 04:31:21,175 - INFO - New best model! Validation loss: 0.0019
2025-10-22 04:31:25,268 - INFO - Checkpoint saved: epoch 36
2025-10-22 04:31:37,786 - INFO - Epoch 37, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.85e-05
2025-10-22 04:31:50,668 - INFO - Epoch 37, Step 100/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.84e-05
2025-10-22 04:32:02,936 - INFO - Epoch 37, Step 150/1000 - Loss: 0.0020, Perplexity: 1.0021, LR: 2.83e-05
2025-10-22 04:32:15,220 - INFO - Epoch 37, Step 200/1000 - Loss: 0.0024, Perplexity: 1.0026, LR: 2.82e-05
2025-10-22 04:32:27,589 - INFO - Epoch 37, Step 250/1000 - Loss: 0.0019, Perplexity: 1.0021, LR: 2.81e-05
2025-10-22 04:32:39,994 - INFO - Epoch 37, Step 300/1000 - Loss: 0.0016, Perplexity: 1.0017, LR: 2.80e-05
2025-10-22 04:32:52,559 - INFO - Epoch 37, Step 350/1000 - Loss: 0.0014, Perplexity: 1.0015, LR: 2.79e-05
2025-10-22 04:33:05,070 - INFO - Epoch 37, Step 400/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.78e-05
2025-10-22 04:33:17,643 - INFO - Epoch 37, Step 450/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 2.77e-05
2025-10-22 04:33:30,617 - INFO - Epoch 37, Step 500/1000 - Loss: 0.0010, Perplexity: 1.0011, LR: 2.76e-05
2025-10-22 04:33:43,047 - INFO - Epoch 37, Step 550/1000 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.74e-05
2025-10-22 04:33:55,623 - INFO - Epoch 37, Step 600/1000 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.73e-05
2025-10-22 04:34:08,156 - INFO - Epoch 37, Step 650/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 2.72e-05
2025-10-22 04:34:20,822 - INFO - Epoch 37, Step 700/1000 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.71e-05
2025-10-22 04:34:33,472 - INFO - Epoch 37, Step 750/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.70e-05
2025-10-22 04:34:46,163 - INFO - Epoch 37, Step 800/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.69e-05
2025-10-22 04:34:58,364 - INFO - Epoch 37, Step 850/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 2.68e-05
2025-10-22 04:35:10,620 - INFO - Epoch 37, Step 900/1000 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.67e-05
2025-10-22 04:35:23,278 - INFO - Epoch 37, Step 950/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 2.66e-05
2025-10-22 04:35:35,636 - INFO - Epoch 37, Step 1000/1000 - Loss: 0.0010, Perplexity: 1.0011, LR: 2.65e-05
2025-10-22 04:35:35,637 - INFO - Epoch 37 Complete - Avg Loss: 0.0010, Avg Perplexity: 1.0011
2025-10-22 04:35:55,524 - INFO - Validation - Loss: 0.0020, Perplexity: 1.0023, Token Accuracy: 0.9997, Code Accuracy: 0.9997
2025-10-22 04:35:55,525 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:35:58,918 - INFO - TPL computed on 351 samples: 1.0203
2025-10-22 04:35:58,919 - INFO - Temporal Perplexity (TPL): 1.0203
2025-10-22 04:36:11,322 - INFO - Epoch 38, Step 50/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.64e-05
2025-10-22 04:36:23,590 - INFO - Epoch 38, Step 100/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.63e-05
2025-10-22 04:36:36,136 - INFO - Epoch 38, Step 150/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.62e-05
2025-10-22 04:36:48,586 - INFO - Epoch 38, Step 200/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.61e-05
2025-10-22 04:37:01,310 - INFO - Epoch 38, Step 250/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.60e-05
2025-10-22 04:37:13,769 - INFO - Epoch 38, Step 300/1000 - Loss: 0.0015, Perplexity: 1.0017, LR: 2.59e-05
2025-10-22 04:37:26,000 - INFO - Epoch 38, Step 350/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 2.58e-05
2025-10-22 04:37:38,930 - INFO - Epoch 38, Step 400/1000 - Loss: 0.0015, Perplexity: 1.0016, LR: 2.57e-05
2025-10-22 04:37:51,210 - INFO - Epoch 38, Step 450/1000 - Loss: 0.0013, Perplexity: 1.0015, LR: 2.56e-05
2025-10-22 04:38:03,620 - INFO - Epoch 38, Step 500/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.55e-05
2025-10-22 04:38:15,906 - INFO - Epoch 38, Step 550/1000 - Loss: 0.0014, Perplexity: 1.0015, LR: 2.54e-05
2025-10-22 04:38:28,653 - INFO - Epoch 38, Step 600/1000 - Loss: 0.0013, Perplexity: 1.0014, LR: 2.53e-05
2025-10-22 04:38:41,393 - INFO - Epoch 38, Step 650/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.52e-05
2025-10-22 04:38:53,680 - INFO - Epoch 38, Step 700/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.51e-05
2025-10-22 04:39:06,255 - INFO - Epoch 38, Step 750/1000 - Loss: 0.0014, Perplexity: 1.0015, LR: 2.50e-05
2025-10-22 04:39:18,472 - INFO - Epoch 38, Step 800/1000 - Loss: 0.0013, Perplexity: 1.0014, LR: 2.49e-05
2025-10-22 04:39:31,205 - INFO - Epoch 38, Step 850/1000 - Loss: 0.0013, Perplexity: 1.0014, LR: 2.48e-05
2025-10-22 04:39:43,777 - INFO - Epoch 38, Step 900/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.47e-05
2025-10-22 04:39:56,242 - INFO - Epoch 38, Step 950/1000 - Loss: 0.0012, Perplexity: 1.0013, LR: 2.46e-05
2025-10-22 04:40:08,730 - INFO - Epoch 38, Step 1000/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 2.45e-05
2025-10-22 04:40:08,731 - INFO - Epoch 38 Complete - Avg Loss: 0.0011, Avg Perplexity: 1.0012
2025-10-22 04:40:28,349 - INFO - Validation - Loss: 0.0011, Perplexity: 1.0011, Token Accuracy: 0.9999, Code Accuracy: 0.9998
2025-10-22 04:40:28,351 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:40:31,745 - INFO - TPL computed on 351 samples: 1.0178
2025-10-22 04:40:31,745 - INFO - Temporal Perplexity (TPL): 1.0178
2025-10-22 04:40:31,745 - INFO - New best model! Validation loss: 0.0011
2025-10-22 04:40:36,065 - INFO - Checkpoint saved: epoch 38
2025-10-22 04:40:48,412 - INFO - Epoch 39, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.44e-05
2025-10-22 04:41:00,999 - INFO - Epoch 39, Step 100/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.43e-05
2025-10-22 04:41:13,449 - INFO - Epoch 39, Step 150/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 2.42e-05
2025-10-22 04:41:26,225 - INFO - Epoch 39, Step 200/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.41e-05
2025-10-22 04:41:38,675 - INFO - Epoch 39, Step 250/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.40e-05
2025-10-22 04:41:51,123 - INFO - Epoch 39, Step 300/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.39e-05
2025-10-22 04:42:03,700 - INFO - Epoch 39, Step 350/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 2.38e-05
2025-10-22 04:42:16,384 - INFO - Epoch 39, Step 400/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 2.37e-05
2025-10-22 04:42:28,641 - INFO - Epoch 39, Step 450/1000 - Loss: 0.0007, Perplexity: 1.0008, LR: 2.36e-05
2025-10-22 04:42:40,922 - INFO - Epoch 39, Step 500/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 2.35e-05
2025-10-22 04:42:53,786 - INFO - Epoch 39, Step 550/1000 - Loss: 0.0010, Perplexity: 1.0011, LR: 2.34e-05
2025-10-22 04:43:06,234 - INFO - Epoch 39, Step 600/1000 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.33e-05
2025-10-22 04:43:18,407 - INFO - Epoch 39, Step 650/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.32e-05
2025-10-22 04:43:30,802 - INFO - Epoch 39, Step 700/1000 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.31e-05
2025-10-22 04:43:43,330 - INFO - Epoch 39, Step 750/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.30e-05
2025-10-22 04:43:55,799 - INFO - Epoch 39, Step 800/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 2.29e-05
2025-10-22 04:44:08,250 - INFO - Epoch 39, Step 850/1000 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.28e-05
2025-10-22 04:44:20,781 - INFO - Epoch 39, Step 900/1000 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.27e-05
2025-10-22 04:44:33,304 - INFO - Epoch 39, Step 950/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.26e-05
2025-10-22 04:44:45,865 - INFO - Epoch 39, Step 1000/1000 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.24e-05
2025-10-22 04:44:45,866 - INFO - Epoch 39 Complete - Avg Loss: 0.0010, Avg Perplexity: 1.0010
2025-10-22 04:45:05,785 - INFO - Validation - Loss: 0.0009, Perplexity: 1.0010, Token Accuracy: 0.9999, Code Accuracy: 0.9998
2025-10-22 04:45:05,786 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:45:09,181 - INFO - TPL computed on 351 samples: 1.0175
2025-10-22 04:45:09,181 - INFO - Temporal Perplexity (TPL): 1.0175
2025-10-22 04:45:09,181 - INFO - New best model! Validation loss: 0.0009
2025-10-22 04:45:13,657 - INFO - Checkpoint saved: epoch 39
2025-10-22 04:45:25,984 - INFO - Epoch 40, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.23e-05
2025-10-22 04:45:38,269 - INFO - Epoch 40, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.22e-05
2025-10-22 04:45:50,520 - INFO - Epoch 40, Step 150/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.21e-05
2025-10-22 04:46:02,807 - INFO - Epoch 40, Step 200/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.20e-05
2025-10-22 04:46:15,226 - INFO - Epoch 40, Step 250/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.19e-05
2025-10-22 04:46:28,012 - INFO - Epoch 40, Step 300/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.18e-05
2025-10-22 04:46:40,390 - INFO - Epoch 40, Step 350/1000 - Loss: 0.0003, Perplexity: 1.0004, LR: 2.17e-05
2025-10-22 04:46:53,060 - INFO - Epoch 40, Step 400/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.16e-05
2025-10-22 04:47:05,565 - INFO - Epoch 40, Step 450/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.15e-05
2025-10-22 04:47:18,221 - INFO - Epoch 40, Step 500/1000 - Loss: 0.0002, Perplexity: 1.0003, LR: 2.14e-05
2025-10-22 04:47:30,563 - INFO - Epoch 40, Step 550/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.13e-05
2025-10-22 04:47:43,296 - INFO - Epoch 40, Step 600/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.12e-05
2025-10-22 04:47:55,505 - INFO - Epoch 40, Step 650/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.11e-05
2025-10-22 04:48:08,050 - INFO - Epoch 40, Step 700/1000 - Loss: 0.0003, Perplexity: 1.0004, LR: 2.10e-05
2025-10-22 04:48:20,508 - INFO - Epoch 40, Step 750/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.09e-05
2025-10-22 04:48:33,175 - INFO - Epoch 40, Step 800/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.08e-05
2025-10-22 04:48:45,733 - INFO - Epoch 40, Step 850/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.07e-05
2025-10-22 04:48:58,323 - INFO - Epoch 40, Step 900/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.06e-05
2025-10-22 04:49:10,870 - INFO - Epoch 40, Step 950/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.05e-05
2025-10-22 04:49:23,411 - INFO - Epoch 40, Step 1000/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.04e-05
2025-10-22 04:49:23,412 - INFO - Epoch 40 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0006
2025-10-22 04:49:43,341 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0007, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-22 04:49:43,342 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:49:46,756 - INFO - TPL computed on 351 samples: 1.0175
2025-10-22 04:49:46,756 - INFO - Temporal Perplexity (TPL): 1.0175
2025-10-22 04:49:46,757 - INFO - New best model! Validation loss: 0.0006
2025-10-22 04:49:50,844 - INFO - Checkpoint saved: epoch 40
2025-10-22 04:50:03,467 - INFO - Epoch 41, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.03e-05
2025-10-22 04:50:16,269 - INFO - Epoch 41, Step 100/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 2.02e-05
2025-10-22 04:50:28,604 - INFO - Epoch 41, Step 150/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 2.01e-05
2025-10-22 04:50:41,493 - INFO - Epoch 41, Step 200/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 2.00e-05
2025-10-22 04:50:54,025 - INFO - Epoch 41, Step 250/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.99e-05
2025-10-22 04:51:06,764 - INFO - Epoch 41, Step 300/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.98e-05
2025-10-22 04:51:19,257 - INFO - Epoch 41, Step 350/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.97e-05
2025-10-22 04:51:31,763 - INFO - Epoch 41, Step 400/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.96e-05
2025-10-22 04:51:44,438 - INFO - Epoch 41, Step 450/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.95e-05
2025-10-22 04:51:56,903 - INFO - Epoch 41, Step 500/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 1.94e-05
2025-10-22 04:52:09,324 - INFO - Epoch 41, Step 550/1000 - Loss: 0.0009, Perplexity: 1.0009, LR: 1.93e-05
2025-10-22 04:52:21,751 - INFO - Epoch 41, Step 600/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 1.92e-05
2025-10-22 04:52:34,568 - INFO - Epoch 41, Step 650/1000 - Loss: 0.0008, Perplexity: 1.0008, LR: 1.91e-05
2025-10-22 04:52:47,096 - INFO - Epoch 41, Step 700/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 1.90e-05
2025-10-22 04:52:59,497 - INFO - Epoch 41, Step 750/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 1.89e-05
2025-10-22 04:53:11,976 - INFO - Epoch 41, Step 800/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.88e-05
2025-10-22 04:53:24,500 - INFO - Epoch 41, Step 850/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.87e-05
2025-10-22 04:53:37,057 - INFO - Epoch 41, Step 900/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.86e-05
2025-10-22 04:53:49,579 - INFO - Epoch 41, Step 950/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.85e-05
2025-10-22 04:54:02,215 - INFO - Epoch 41, Step 1000/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.84e-05
2025-10-22 04:54:02,216 - INFO - Epoch 41 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0006
2025-10-22 04:54:22,112 - INFO - Validation - Loss: 0.0004, Perplexity: 1.0004, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-22 04:54:22,114 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:54:25,525 - INFO - TPL computed on 351 samples: 1.0191
2025-10-22 04:54:25,525 - INFO - Temporal Perplexity (TPL): 1.0191
2025-10-22 04:54:25,525 - INFO - New best model! Validation loss: 0.0004
2025-10-22 04:54:29,883 - INFO - Checkpoint saved: epoch 41
2025-10-22 04:54:42,173 - INFO - Epoch 42, Step 50/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.83e-05
2025-10-22 04:54:55,108 - INFO - Epoch 42, Step 100/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 1.82e-05
2025-10-22 04:55:07,668 - INFO - Epoch 42, Step 150/1000 - Loss: 0.0004, Perplexity: 1.0005, LR: 1.81e-05
2025-10-22 04:55:20,381 - INFO - Epoch 42, Step 200/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.80e-05
2025-10-22 04:55:33,009 - INFO - Epoch 42, Step 250/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.79e-05
2025-10-22 04:55:45,759 - INFO - Epoch 42, Step 300/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.78e-05
2025-10-22 04:55:58,129 - INFO - Epoch 42, Step 350/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.77e-05
2025-10-22 04:56:11,081 - INFO - Epoch 42, Step 400/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.76e-05
2025-10-22 04:56:23,525 - INFO - Epoch 42, Step 450/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.74e-05
2025-10-22 04:56:35,833 - INFO - Epoch 42, Step 500/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.73e-05
2025-10-22 04:56:48,332 - INFO - Epoch 42, Step 550/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.72e-05
2025-10-22 04:57:00,738 - INFO - Epoch 42, Step 600/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.71e-05
2025-10-22 04:57:13,455 - INFO - Epoch 42, Step 650/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.70e-05
2025-10-22 04:57:25,992 - INFO - Epoch 42, Step 700/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.69e-05
2025-10-22 04:57:38,350 - INFO - Epoch 42, Step 750/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.68e-05
2025-10-22 04:57:50,712 - INFO - Epoch 42, Step 800/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.67e-05
2025-10-22 04:58:03,067 - INFO - Epoch 42, Step 850/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.66e-05
2025-10-22 04:58:15,853 - INFO - Epoch 42, Step 900/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.65e-05
2025-10-22 04:58:28,336 - INFO - Epoch 42, Step 950/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.64e-05
2025-10-22 04:58:40,768 - INFO - Epoch 42, Step 1000/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.63e-05
2025-10-22 04:58:40,769 - INFO - Epoch 42 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004
2025-10-22 04:59:00,662 - INFO - Validation - Loss: 0.0005, Perplexity: 1.0005, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-22 04:59:00,663 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 04:59:04,064 - INFO - TPL computed on 351 samples: 1.0181
2025-10-22 04:59:04,064 - INFO - Temporal Perplexity (TPL): 1.0181
2025-10-22 04:59:16,217 - INFO - Epoch 43, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.62e-05
2025-10-22 04:59:28,847 - INFO - Epoch 43, Step 100/1000 - Loss: 0.0011, Perplexity: 1.0012, LR: 1.61e-05
2025-10-22 04:59:41,499 - INFO - Epoch 43, Step 150/1000 - Loss: 0.0008, Perplexity: 1.0008, LR: 1.60e-05
2025-10-22 04:59:53,990 - INFO - Epoch 43, Step 200/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.59e-05
2025-10-22 05:00:06,401 - INFO - Epoch 43, Step 250/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.58e-05
2025-10-22 05:00:18,613 - INFO - Epoch 43, Step 300/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.57e-05
2025-10-22 05:00:31,398 - INFO - Epoch 43, Step 350/1000 - Loss: 0.0003, Perplexity: 1.0004, LR: 1.56e-05
2025-10-22 05:00:43,860 - INFO - Epoch 43, Step 400/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.55e-05
2025-10-22 05:00:56,236 - INFO - Epoch 43, Step 450/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.54e-05
2025-10-22 05:01:08,813 - INFO - Epoch 43, Step 500/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.53e-05
2025-10-22 05:01:21,111 - INFO - Epoch 43, Step 550/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.52e-05
2025-10-22 05:01:33,666 - INFO - Epoch 43, Step 600/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.51e-05
2025-10-22 05:01:46,167 - INFO - Epoch 43, Step 650/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.50e-05
2025-10-22 05:01:58,638 - INFO - Epoch 43, Step 700/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.49e-05
2025-10-22 05:02:11,020 - INFO - Epoch 43, Step 750/1000 - Loss: 0.0005, Perplexity: 1.0006, LR: 1.48e-05
2025-10-22 05:02:23,754 - INFO - Epoch 43, Step 800/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.47e-05
2025-10-22 05:02:36,095 - INFO - Epoch 43, Step 850/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.46e-05
2025-10-22 05:02:48,698 - INFO - Epoch 43, Step 900/1000 - Loss: 0.0004, Perplexity: 1.0005, LR: 1.45e-05
2025-10-22 05:03:00,696 - INFO - Epoch 43, Step 950/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.44e-05
2025-10-22 05:03:12,868 - INFO - Epoch 43, Step 1000/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.43e-05
2025-10-22 05:03:12,869 - INFO - Epoch 43 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004
2025-10-22 05:03:32,739 - INFO - Validation - Loss: 0.0005, Perplexity: 1.0005, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-22 05:03:32,740 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:03:36,135 - INFO - TPL computed on 351 samples: 1.0174
2025-10-22 05:03:36,136 - INFO - Temporal Perplexity (TPL): 1.0174
2025-10-22 05:03:48,328 - INFO - Epoch 44, Step 50/1000 - Loss: 0.0008, Perplexity: 1.0008, LR: 1.42e-05
2025-10-22 05:04:00,862 - INFO - Epoch 44, Step 100/1000 - Loss: 0.0008, Perplexity: 1.0009, LR: 1.41e-05
2025-10-22 05:04:13,637 - INFO - Epoch 44, Step 150/1000 - Loss: 0.0010, Perplexity: 1.0010, LR: 1.40e-05
2025-10-22 05:04:26,103 - INFO - Epoch 44, Step 200/1000 - Loss: 0.0007, Perplexity: 1.0007, LR: 1.39e-05
2025-10-22 05:04:38,476 - INFO - Epoch 44, Step 250/1000 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.38e-05
2025-10-22 05:04:50,898 - INFO - Epoch 44, Step 300/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.37e-05
2025-10-22 05:05:03,360 - INFO - Epoch 44, Step 350/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.36e-05
2025-10-22 05:05:15,627 - INFO - Epoch 44, Step 400/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.35e-05
2025-10-22 05:05:28,204 - INFO - Epoch 44, Step 450/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.34e-05
2025-10-22 05:05:40,807 - INFO - Epoch 44, Step 500/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.33e-05
2025-10-22 05:05:53,117 - INFO - Epoch 44, Step 550/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.32e-05
2025-10-22 05:06:05,626 - INFO - Epoch 44, Step 600/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.31e-05
2025-10-22 05:06:18,135 - INFO - Epoch 44, Step 650/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.30e-05
2025-10-22 05:06:30,763 - INFO - Epoch 44, Step 700/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.29e-05
2025-10-22 05:06:43,161 - INFO - Epoch 44, Step 750/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.28e-05
2025-10-22 05:06:55,762 - INFO - Epoch 44, Step 800/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.27e-05
2025-10-22 05:07:08,240 - INFO - Epoch 44, Step 850/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.26e-05
2025-10-22 05:07:20,135 - INFO - Epoch 44, Step 900/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.24e-05
2025-10-22 05:07:32,703 - INFO - Epoch 44, Step 950/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.23e-05
2025-10-22 05:07:45,445 - INFO - Epoch 44, Step 1000/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.22e-05
2025-10-22 05:07:45,446 - INFO - Epoch 44 Complete - Avg Loss: 0.0002, Avg Perplexity: 1.0002
2025-10-22 05:08:05,213 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:08:05,214 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:08:08,599 - INFO - TPL computed on 351 samples: 1.0186
2025-10-22 05:08:08,599 - INFO - Temporal Perplexity (TPL): 1.0186
2025-10-22 05:08:08,599 - INFO - New best model! Validation loss: 0.0002
2025-10-22 05:08:12,711 - INFO - Checkpoint saved: epoch 44
2025-10-22 05:08:25,792 - INFO - Epoch 45, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.21e-05
2025-10-22 05:08:38,398 - INFO - Epoch 45, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.20e-05
2025-10-22 05:08:50,778 - INFO - Epoch 45, Step 150/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.19e-05
2025-10-22 05:09:03,392 - INFO - Epoch 45, Step 200/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.18e-05
2025-10-22 05:09:15,839 - INFO - Epoch 45, Step 250/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.17e-05
2025-10-22 05:09:28,281 - INFO - Epoch 45, Step 300/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.16e-05
2025-10-22 05:09:40,205 - INFO - Epoch 45, Step 350/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.15e-05
2025-10-22 05:09:52,876 - INFO - Epoch 45, Step 400/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.14e-05
2025-10-22 05:10:05,459 - INFO - Epoch 45, Step 450/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.13e-05
2025-10-22 05:10:17,925 - INFO - Epoch 45, Step 500/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 1.12e-05
2025-10-22 05:10:30,472 - INFO - Epoch 45, Step 550/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.11e-05
2025-10-22 05:10:42,603 - INFO - Epoch 45, Step 600/1000 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.10e-05
2025-10-22 05:10:54,963 - INFO - Epoch 45, Step 650/1000 - Loss: 0.0003, Perplexity: 1.0004, LR: 1.09e-05
2025-10-22 05:11:07,368 - INFO - Epoch 45, Step 700/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.08e-05
2025-10-22 05:11:19,709 - INFO - Epoch 45, Step 750/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.07e-05
2025-10-22 05:11:32,165 - INFO - Epoch 45, Step 800/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.06e-05
2025-10-22 05:11:44,595 - INFO - Epoch 45, Step 850/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.05e-05
2025-10-22 05:11:57,169 - INFO - Epoch 45, Step 900/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.04e-05
2025-10-22 05:12:09,886 - INFO - Epoch 45, Step 950/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.03e-05
2025-10-22 05:12:22,691 - INFO - Epoch 45, Step 1000/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.02e-05
2025-10-22 05:12:22,692 - INFO - Epoch 45 Complete - Avg Loss: 0.0003, Avg Perplexity: 1.0003
2025-10-22 05:12:42,715 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:12:42,717 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:12:46,118 - INFO - TPL computed on 351 samples: 1.0178
2025-10-22 05:12:46,119 - INFO - Temporal Perplexity (TPL): 1.0178
2025-10-22 05:12:46,119 - INFO - New best model! Validation loss: 0.0001
2025-10-22 05:12:50,765 - INFO - Checkpoint saved: epoch 45
2025-10-22 05:13:03,272 - INFO - Epoch 46, Step 50/1000 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.01e-05
2025-10-22 05:13:16,110 - INFO - Epoch 46, Step 100/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.00e-05
2025-10-22 05:13:28,644 - INFO - Epoch 46, Step 150/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 9.90e-06
2025-10-22 05:13:41,346 - INFO - Epoch 46, Step 200/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.80e-06
2025-10-22 05:13:53,994 - INFO - Epoch 46, Step 250/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.69e-06
2025-10-22 05:14:06,217 - INFO - Epoch 46, Step 300/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.59e-06
2025-10-22 05:14:18,473 - INFO - Epoch 46, Step 350/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.49e-06
2025-10-22 05:14:30,849 - INFO - Epoch 46, Step 400/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.39e-06
2025-10-22 05:14:43,367 - INFO - Epoch 46, Step 450/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.29e-06
2025-10-22 05:14:55,835 - INFO - Epoch 46, Step 500/1000 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.18e-06
2025-10-22 05:15:08,299 - INFO - Epoch 46, Step 550/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 9.08e-06
2025-10-22 05:15:20,861 - INFO - Epoch 46, Step 600/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.98e-06
2025-10-22 05:15:33,422 - INFO - Epoch 46, Step 650/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.88e-06
2025-10-22 05:15:45,883 - INFO - Epoch 46, Step 700/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.78e-06
2025-10-22 05:15:58,452 - INFO - Epoch 46, Step 750/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.67e-06
2025-10-22 05:16:10,970 - INFO - Epoch 46, Step 800/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.57e-06
2025-10-22 05:16:23,385 - INFO - Epoch 46, Step 850/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.47e-06
2025-10-22 05:16:36,318 - INFO - Epoch 46, Step 900/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.37e-06
2025-10-22 05:16:48,994 - INFO - Epoch 46, Step 950/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.27e-06
2025-10-22 05:17:01,460 - INFO - Epoch 46, Step 1000/1000 - Loss: 0.0002, Perplexity: 1.0002, LR: 8.16e-06
2025-10-22 05:17:01,461 - INFO - Epoch 46 Complete - Avg Loss: 0.0002, Avg Perplexity: 1.0002
2025-10-22 05:17:21,277 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:17:21,278 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:17:24,681 - INFO - TPL computed on 351 samples: 1.0175
2025-10-22 05:17:24,681 - INFO - Temporal Perplexity (TPL): 1.0175
2025-10-22 05:17:37,138 - INFO - Epoch 47, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 8.06e-06
2025-10-22 05:17:49,620 - INFO - Epoch 47, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 7.96e-06
2025-10-22 05:18:01,994 - INFO - Epoch 47, Step 150/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.86e-06
2025-10-22 05:18:14,704 - INFO - Epoch 47, Step 200/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.76e-06
2025-10-22 05:18:27,283 - INFO - Epoch 47, Step 250/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.65e-06
2025-10-22 05:18:39,869 - INFO - Epoch 47, Step 300/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.55e-06
2025-10-22 05:18:52,173 - INFO - Epoch 47, Step 350/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.45e-06
2025-10-22 05:19:05,257 - INFO - Epoch 47, Step 400/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.35e-06
2025-10-22 05:19:17,424 - INFO - Epoch 47, Step 450/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.24e-06
2025-10-22 05:19:30,165 - INFO - Epoch 47, Step 500/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.14e-06
2025-10-22 05:19:42,724 - INFO - Epoch 47, Step 550/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 7.04e-06
2025-10-22 05:19:55,377 - INFO - Epoch 47, Step 600/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.94e-06
2025-10-22 05:20:07,828 - INFO - Epoch 47, Step 650/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.84e-06
2025-10-22 05:20:20,558 - INFO - Epoch 47, Step 700/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.73e-06
2025-10-22 05:20:33,024 - INFO - Epoch 47, Step 750/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.63e-06
2025-10-22 05:20:45,791 - INFO - Epoch 47, Step 800/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.53e-06
2025-10-22 05:20:58,493 - INFO - Epoch 47, Step 850/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.43e-06
2025-10-22 05:21:10,789 - INFO - Epoch 47, Step 900/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.33e-06
2025-10-22 05:21:23,320 - INFO - Epoch 47, Step 950/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.22e-06
2025-10-22 05:21:35,959 - INFO - Epoch 47, Step 1000/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 6.12e-06
2025-10-22 05:21:35,960 - INFO - Epoch 47 Complete - Avg Loss: 0.0001, Avg Perplexity: 1.0001
2025-10-22 05:21:55,649 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:21:55,650 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:21:59,041 - INFO - TPL computed on 351 samples: 1.0182
2025-10-22 05:21:59,041 - INFO - Temporal Perplexity (TPL): 1.0182
2025-10-22 05:21:59,041 - INFO - New best model! Validation loss: 0.0001
2025-10-22 05:22:03,152 - INFO - Checkpoint saved: epoch 47
2025-10-22 05:22:15,619 - INFO - Epoch 48, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 6.02e-06
2025-10-22 05:22:28,362 - INFO - Epoch 48, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 5.92e-06
2025-10-22 05:22:40,642 - INFO - Epoch 48, Step 150/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 5.82e-06
2025-10-22 05:22:53,299 - INFO - Epoch 48, Step 200/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 5.71e-06
2025-10-22 05:23:05,705 - INFO - Epoch 48, Step 250/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 5.61e-06
2025-10-22 05:23:18,518 - INFO - Epoch 48, Step 300/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 5.51e-06
2025-10-22 05:23:30,941 - INFO - Epoch 48, Step 350/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.41e-06
2025-10-22 05:23:43,459 - INFO - Epoch 48, Step 400/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.31e-06
2025-10-22 05:23:55,950 - INFO - Epoch 48, Step 450/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.20e-06
2025-10-22 05:24:08,504 - INFO - Epoch 48, Step 500/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.10e-06
2025-10-22 05:24:20,874 - INFO - Epoch 48, Step 550/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.00e-06
2025-10-22 05:24:33,257 - INFO - Epoch 48, Step 600/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.90e-06
2025-10-22 05:24:45,832 - INFO - Epoch 48, Step 650/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.80e-06
2025-10-22 05:24:58,459 - INFO - Epoch 48, Step 700/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.69e-06
2025-10-22 05:25:10,818 - INFO - Epoch 48, Step 750/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 4.59e-06
2025-10-22 05:25:23,338 - INFO - Epoch 48, Step 800/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 4.49e-06
2025-10-22 05:25:36,067 - INFO - Epoch 48, Step 850/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.39e-06
2025-10-22 05:25:48,541 - INFO - Epoch 48, Step 900/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.29e-06
2025-10-22 05:26:00,736 - INFO - Epoch 48, Step 950/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.18e-06
2025-10-22 05:26:13,055 - INFO - Epoch 48, Step 1000/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 4.08e-06
2025-10-22 05:26:13,056 - INFO - Epoch 48 Complete - Avg Loss: 0.0001, Avg Perplexity: 1.0001
2025-10-22 05:26:32,966 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:26:32,968 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:26:36,361 - INFO - TPL computed on 351 samples: 1.0182
2025-10-22 05:26:36,361 - INFO - Temporal Perplexity (TPL): 1.0182
2025-10-22 05:26:36,361 - INFO - New best model! Validation loss: 0.0000
2025-10-22 05:26:40,979 - INFO - Checkpoint saved: epoch 48
2025-10-22 05:26:53,346 - INFO - Epoch 49, Step 50/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.98e-06
2025-10-22 05:27:05,791 - INFO - Epoch 49, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.88e-06
2025-10-22 05:27:18,391 - INFO - Epoch 49, Step 150/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.78e-06
2025-10-22 05:27:30,711 - INFO - Epoch 49, Step 200/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.67e-06
2025-10-22 05:27:43,011 - INFO - Epoch 49, Step 250/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.57e-06
2025-10-22 05:27:55,251 - INFO - Epoch 49, Step 300/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.47e-06
2025-10-22 05:28:07,606 - INFO - Epoch 49, Step 350/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.37e-06
2025-10-22 05:28:19,625 - INFO - Epoch 49, Step 400/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.27e-06
2025-10-22 05:28:32,300 - INFO - Epoch 49, Step 450/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.16e-06
2025-10-22 05:28:44,679 - INFO - Epoch 49, Step 500/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.06e-06
2025-10-22 05:28:57,553 - INFO - Epoch 49, Step 550/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.96e-06
2025-10-22 05:29:10,330 - INFO - Epoch 49, Step 600/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.86e-06
2025-10-22 05:29:22,904 - INFO - Epoch 49, Step 650/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.76e-06
2025-10-22 05:29:35,468 - INFO - Epoch 49, Step 700/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.65e-06
2025-10-22 05:29:48,471 - INFO - Epoch 49, Step 750/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.55e-06
2025-10-22 05:30:01,003 - INFO - Epoch 49, Step 800/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.45e-06
2025-10-22 05:30:13,367 - INFO - Epoch 49, Step 850/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.35e-06
2025-10-22 05:30:25,837 - INFO - Epoch 49, Step 900/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.24e-06
2025-10-22 05:30:38,598 - INFO - Epoch 49, Step 950/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.14e-06
2025-10-22 05:30:50,990 - INFO - Epoch 49, Step 1000/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 2.04e-06
2025-10-22 05:30:50,991 - INFO - Epoch 49 Complete - Avg Loss: 0.0000, Avg Perplexity: 1.0000
2025-10-22 05:31:10,893 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:31:10,895 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:31:14,298 - INFO - TPL computed on 351 samples: 1.0184
2025-10-22 05:31:14,298 - INFO - Temporal Perplexity (TPL): 1.0184
2025-10-22 05:31:26,527 - INFO - Epoch 50, Step 50/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.94e-06
2025-10-22 05:31:38,793 - INFO - Epoch 50, Step 100/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.84e-06
2025-10-22 05:31:51,397 - INFO - Epoch 50, Step 150/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.73e-06
2025-10-22 05:32:03,966 - INFO - Epoch 50, Step 200/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.63e-06
2025-10-22 05:32:16,363 - INFO - Epoch 50, Step 250/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.53e-06
2025-10-22 05:32:28,784 - INFO - Epoch 50, Step 300/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.43e-06
2025-10-22 05:32:41,632 - INFO - Epoch 50, Step 350/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.33e-06
2025-10-22 05:32:54,166 - INFO - Epoch 50, Step 400/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.22e-06
2025-10-22 05:33:06,965 - INFO - Epoch 50, Step 450/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.12e-06
2025-10-22 05:33:19,688 - INFO - Epoch 50, Step 500/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 1.02e-06
2025-10-22 05:33:31,883 - INFO - Epoch 50, Step 550/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 9.18e-07
2025-10-22 05:33:44,374 - INFO - Epoch 50, Step 600/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 8.16e-07
2025-10-22 05:33:56,965 - INFO - Epoch 50, Step 650/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 7.14e-07
2025-10-22 05:34:09,337 - INFO - Epoch 50, Step 700/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 6.12e-07
2025-10-22 05:34:22,391 - INFO - Epoch 50, Step 750/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 5.10e-07
2025-10-22 05:34:34,894 - INFO - Epoch 50, Step 800/1000 - Loss: 0.0000, Perplexity: 1.0001, LR: 4.08e-07
2025-10-22 05:34:47,310 - INFO - Epoch 50, Step 850/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 3.06e-07
2025-10-22 05:34:59,839 - INFO - Epoch 50, Step 900/1000 - Loss: 0.0001, Perplexity: 1.0001, LR: 2.04e-07
2025-10-22 05:35:12,291 - INFO - Epoch 50, Step 950/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 1.02e-07
2025-10-22 05:35:24,802 - INFO - Epoch 50, Step 1000/1000 - Loss: 0.0000, Perplexity: 1.0000, LR: 0.00e+00
2025-10-22 05:35:24,803 - INFO - Epoch 50 Complete - Avg Loss: 0.0000, Avg Perplexity: 1.0000
2025-10-22 05:35:44,463 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-22 05:35:44,464 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-22 05:35:47,870 - INFO - TPL computed on 351 samples: 1.0186
2025-10-22 05:35:47,870 - INFO - Temporal Perplexity (TPL): 1.0186
2025-10-22 05:35:50,073 - INFO - Checkpoint saved: epoch 50
2025-10-22 05:35:50,073 - INFO - 
================================================================================
2025-10-22 05:35:50,073 - INFO - Training Complete!
2025-10-22 05:35:50,073 - INFO - ================================================================================
2025-10-22 05:35:50,073 - INFO - Best validation loss: 0.0000
2025-10-22 05:35:50,073 - INFO - Best validation perplexity: 1.0000
2025-10-23 03:20:14,560 - INFO - ================================================================================
2025-10-23 03:20:14,561 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 03:20:14,561 - INFO - ================================================================================
2025-10-23 03:20:14,561 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 50
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 03:20:14,573 - INFO - 
Random seed: 42
2025-10-23 03:20:14,726 - INFO - Device: cuda
2025-10-23 03:20:14,726 - INFO - 
================================================================================
2025-10-23 03:20:14,727 - INFO - Loading MIMIC-III Data
2025-10-23 03:20:14,727 - INFO - ================================================================================
2025-10-23 03:20:14,727 - INFO - Loading MIMIC-III data files
2025-10-23 03:20:14,804 - INFO - Loaded 46520 patients
2025-10-23 03:20:15,002 - INFO - Loaded 58976 admissions
2025-10-23 03:20:15,245 - INFO - Loaded 651047 diagnosis records
2025-10-23 03:20:15,550 - INFO - Processing patient records
2025-10-23 03:20:23,893 - INFO - Loaded 10000 patient records
2025-10-23 03:20:23,893 - INFO - Diagnosis vocabulary size: 4253
2025-10-23 03:20:23,897 - INFO - Average visits per patient: 1.29
2025-10-23 03:20:23,897 - INFO - Average codes per visit: 9.16
2025-10-23 03:20:23,899 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-23 03:20:23,918 - INFO - Loaded 10000 patients
2025-10-23 03:20:23,918 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-23 03:20:23,918 - INFO - Tokenizer vocab size: 4260
2025-10-23 03:20:23,919 - INFO - Dataset size: 10000 patients
2025-10-23 03:20:23,924 - INFO - Train size: 8000, Validation size: 2000
2025-10-23 03:20:23,924 - INFO - Train batches: 1000, Validation batches: 250
2025-10-23 03:20:23,924 - INFO - 
================================================================================
2025-10-23 03:20:23,924 - INFO - Initializing Model
2025-10-23 03:20:23,924 - INFO - ================================================================================
2025-10-23 03:20:24,029 - INFO - BART config vocab size: 4260
2025-10-23 03:20:25,903 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 03:20:25,903 - INFO -   Age loss weight: 0.3
2025-10-23 03:20:25,903 - INFO -   Sex loss weight: 0.2
2025-10-23 03:20:26,176 - INFO - Total parameters: 104,681,731
2025-10-23 03:20:26,176 - INFO - Trainable parameters: 104,681,731
2025-10-23 03:20:26,177 - INFO - Total training steps: 50000
2025-10-23 03:20:26,177 - INFO - Warmup steps: 1000
2025-10-23 03:20:26,177 - INFO - 
================================================================================
2025-10-23 03:20:26,177 - INFO - Starting Training
2025-10-23 03:20:26,177 - INFO - ================================================================================
2025-10-23 03:50:48,837 - INFO - ================================================================================
2025-10-23 03:50:48,837 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 03:50:48,837 - INFO - ================================================================================
2025-10-23 03:50:48,837 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 50
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 03:50:48,841 - INFO - 
Random seed: 42
2025-10-23 03:50:48,994 - INFO - Device: cuda
2025-10-23 03:50:48,994 - INFO - 
================================================================================
2025-10-23 03:50:48,994 - INFO - Loading MIMIC-III Data
2025-10-23 03:50:48,994 - INFO - ================================================================================
2025-10-23 03:50:48,994 - INFO - Loading MIMIC-III data files
2025-10-23 03:50:49,057 - INFO - Loaded 46520 patients
2025-10-23 03:50:49,207 - INFO - Loaded 58976 admissions
2025-10-23 03:50:49,375 - INFO - Loaded 651047 diagnosis records
2025-10-23 03:50:49,651 - INFO - Processing patient records
2025-10-23 03:50:58,034 - INFO - Loaded 10000 patient records
2025-10-23 03:50:58,034 - INFO - Diagnosis vocabulary size: 4253
2025-10-23 03:50:58,039 - INFO - Average visits per patient: 1.29
2025-10-23 03:50:58,039 - INFO - Average codes per visit: 9.16
2025-10-23 03:50:58,040 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-23 03:50:58,062 - INFO - Loaded 10000 patients
2025-10-23 03:50:58,062 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-23 03:50:58,062 - INFO - Tokenizer vocab size: 4260
2025-10-23 03:50:58,062 - INFO - Dataset size: 10000 patients
2025-10-23 03:50:58,063 - INFO - Train size: 8000, Validation size: 2000
2025-10-23 03:50:58,063 - INFO - Train batches: 1000, Validation batches: 250
2025-10-23 03:50:58,063 - INFO - 
================================================================================
2025-10-23 03:50:58,063 - INFO - Initializing Model
2025-10-23 03:50:58,063 - INFO - ================================================================================
2025-10-23 03:50:58,153 - INFO - BART config vocab size: 4260
2025-10-23 03:51:00,048 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 03:51:00,048 - INFO -   Age loss weight: 0.3
2025-10-23 03:51:00,048 - INFO -   Sex loss weight: 0.2
2025-10-23 03:51:00,590 - INFO - Total parameters: 104,681,731
2025-10-23 03:51:00,591 - INFO - Trainable parameters: 104,681,731
2025-10-23 03:51:00,592 - INFO - Total training steps: 50000
2025-10-23 03:51:00,592 - INFO - Warmup steps: 1000
2025-10-23 03:51:00,592 - INFO - 
================================================================================
2025-10-23 03:51:00,592 - INFO - Starting Training
2025-10-23 03:51:00,592 - INFO - ================================================================================
2025-10-23 03:51:13,188 - INFO - Epoch 1, Step 50/1000 - Loss: 1037.8663, Perplexity: inf, LR: 5.00e-06, LM: 8.1339, Age: 3431.91, Sex: 0.790
2025-10-23 03:51:25,528 - INFO - Epoch 1, Step 100/1000 - Loss: 980.0911, Perplexity: inf, LR: 1.00e-05, LM: 8.1493, Age: 3239.29, Sex: 0.769
2025-10-23 03:51:38,234 - INFO - Epoch 1, Step 150/1000 - Loss: 914.5560, Perplexity: inf, LR: 1.50e-05, LM: 8.1229, Age: 3020.95, Sex: 0.742
2025-10-23 03:51:50,357 - INFO - Epoch 1, Step 200/1000 - Loss: 876.8666, Perplexity: inf, LR: 2.00e-05, LM: 8.0526, Age: 2895.56, Sex: 0.727
2025-10-23 03:52:02,598 - INFO - Epoch 1, Step 250/1000 - Loss: 853.3935, Perplexity: inf, LR: 2.50e-05, LM: 7.9630, Age: 2817.62, Sex: 0.721
2025-10-23 03:52:15,237 - INFO - Epoch 1, Step 300/1000 - Loss: 831.5930, Perplexity: inf, LR: 3.00e-05, LM: 7.8615, Age: 2745.29, Sex: 0.716
2025-10-23 03:52:27,633 - INFO - Epoch 1, Step 350/1000 - Loss: 807.4081, Perplexity: inf, LR: 3.50e-05, LM: 7.7505, Age: 2665.05, Sex: 0.711
2025-10-23 03:52:40,205 - INFO - Epoch 1, Step 400/1000 - Loss: 778.9206, Perplexity: inf, LR: 4.00e-05, LM: 7.6395, Age: 2570.47, Sex: 0.706
2025-10-23 03:52:52,792 - INFO - Epoch 1, Step 450/1000 - Loss: 751.4495, Perplexity: inf, LR: 4.50e-05, LM: 7.5213, Age: 2479.29, Sex: 0.702
2025-10-23 03:53:04,970 - INFO - Epoch 1, Step 500/1000 - Loss: 712.6319, Perplexity: inf, LR: 5.00e-05, LM: 7.4664, Age: 2350.08, Sex: 0.700
2025-10-23 03:53:17,295 - INFO - Epoch 1, Step 550/1000 - Loss: 672.0628, Perplexity: inf, LR: 5.50e-05, LM: 7.4237, Age: 2215.00, Sex: 0.699
2025-10-23 03:53:29,729 - INFO - Epoch 1, Step 600/1000 - Loss: 629.3875, Perplexity: inf, LR: 6.00e-05, LM: 7.3312, Age: 2073.06, Sex: 0.699
2025-10-23 03:53:42,240 - INFO - Epoch 1, Step 650/1000 - Loss: 588.1098, Perplexity: inf, LR: 6.50e-05, LM: 7.2059, Age: 1935.88, Sex: 0.696
2025-10-23 03:53:54,750 - INFO - Epoch 1, Step 700/1000 - Loss: 552.0434, Perplexity: inf, LR: 7.00e-05, LM: 7.1040, Age: 1816.00, Sex: 0.694
2025-10-23 03:54:07,045 - INFO - Epoch 1, Step 750/1000 - Loss: 520.0971, Perplexity: inf, LR: 7.50e-05, LM: 6.9807, Age: 1709.93, Sex: 0.684
2025-10-23 03:54:19,647 - INFO - Epoch 1, Step 800/1000 - Loss: 493.0485, Perplexity: inf, LR: 8.00e-05, LM: 6.8562, Age: 1620.19, Sex: 0.675
2025-10-23 03:54:31,971 - INFO - Epoch 1, Step 850/1000 - Loss: 469.0348, Perplexity: inf, LR: 8.50e-05, LM: 6.7576, Age: 1540.48, Sex: 0.672
2025-10-23 03:54:44,512 - INFO - Epoch 1, Step 900/1000 - Loss: 447.5221, Perplexity: inf, LR: 9.00e-05, LM: 6.6755, Age: 1469.04, Sex: 0.674
2025-10-23 03:54:57,344 - INFO - Epoch 1, Step 950/1000 - Loss: 427.7342, Perplexity: inf, LR: 9.50e-05, LM: 6.5746, Age: 1403.41, Sex: 0.676
2025-10-23 03:55:09,907 - INFO - Epoch 1, Step 1000/1000 - Loss: 409.6150, Perplexity: inf, LR: 1.00e-04, LM: 6.4900, Age: 1343.30, Sex: 0.677
2025-10-23 03:55:09,908 - INFO - Epoch 1 Complete - Avg Loss: 409.6150, Avg Perplexity: inf, LM: 6.4900, Age: 1343.30, Sex: 0.677
2025-10-23 03:55:29,768 - INFO - Validation - Loss: 5.0811, Perplexity: 183.9734, Token Accuracy: 0.2083, Code Accuracy: 0.0000
2025-10-23 03:55:29,769 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 03:55:33,218 - INFO - TPL computed on 351 samples: 226.6598
2025-10-23 03:55:33,218 - INFO - Temporal Perplexity (TPL): 226.6598
2025-10-23 03:55:33,218 - INFO - New best model! Validation loss: 5.0811
2025-10-23 03:55:37,338 - INFO - Checkpoint saved: epoch 1
2025-10-23 03:55:49,961 - INFO - Epoch 2, Step 50/1000 - Loss: 73.3839, Perplexity: inf, LR: 9.99e-05, LM: 4.8663, Age: 227.92, Sex: 0.704
2025-10-23 03:56:02,255 - INFO - Epoch 2, Step 100/1000 - Loss: 74.3804, Perplexity: inf, LR: 9.98e-05, LM: 4.8436, Age: 231.33, Sex: 0.692
2025-10-23 03:56:14,857 - INFO - Epoch 2, Step 150/1000 - Loss: 74.0384, Perplexity: inf, LR: 9.97e-05, LM: 4.8468, Age: 230.17, Sex: 0.696
2025-10-23 03:56:26,924 - INFO - Epoch 2, Step 200/1000 - Loss: 77.9106, Perplexity: inf, LR: 9.96e-05, LM: 4.9098, Age: 242.87, Sex: 0.704
2025-10-23 03:56:39,499 - INFO - Epoch 2, Step 250/1000 - Loss: 77.1455, Perplexity: inf, LR: 9.95e-05, LM: 4.9989, Age: 240.02, Sex: 0.705
2025-10-23 03:56:52,007 - INFO - Epoch 2, Step 300/1000 - Loss: 76.9933, Perplexity: inf, LR: 9.94e-05, LM: 5.0245, Age: 239.43, Sex: 0.706
2025-10-23 03:57:04,649 - INFO - Epoch 2, Step 350/1000 - Loss: 76.8544, Perplexity: inf, LR: 9.93e-05, LM: 5.0622, Age: 238.84, Sex: 0.704
2025-10-23 03:57:16,953 - INFO - Epoch 2, Step 400/1000 - Loss: 77.1681, Perplexity: inf, LR: 9.92e-05, LM: 5.0879, Age: 239.80, Sex: 0.706
2025-10-23 03:57:29,391 - INFO - Epoch 2, Step 450/1000 - Loss: 77.8218, Perplexity: inf, LR: 9.91e-05, LM: 5.0937, Age: 241.96, Sex: 0.706
2025-10-23 03:57:42,122 - INFO - Epoch 2, Step 500/1000 - Loss: 78.1981, Perplexity: inf, LR: 9.90e-05, LM: 5.1203, Age: 243.12, Sex: 0.705
2025-10-23 03:57:54,456 - INFO - Epoch 2, Step 550/1000 - Loss: 78.0622, Perplexity: inf, LR: 9.89e-05, LM: 5.1344, Age: 242.62, Sex: 0.705
2025-10-23 03:58:06,677 - INFO - Epoch 2, Step 600/1000 - Loss: 78.0375, Perplexity: inf, LR: 9.88e-05, LM: 5.1431, Age: 242.51, Sex: 0.705
2025-10-23 03:58:19,035 - INFO - Epoch 2, Step 650/1000 - Loss: 77.5798, Perplexity: inf, LR: 9.87e-05, LM: 5.1451, Age: 240.98, Sex: 0.704
2025-10-23 03:58:31,318 - INFO - Epoch 2, Step 700/1000 - Loss: 77.2094, Perplexity: inf, LR: 9.86e-05, LM: 5.1464, Age: 239.74, Sex: 0.706
2025-10-23 03:58:44,102 - INFO - Epoch 2, Step 750/1000 - Loss: 77.1471, Perplexity: inf, LR: 9.85e-05, LM: 5.1473, Age: 239.53, Sex: 0.704
2025-10-23 03:58:56,953 - INFO - Epoch 2, Step 800/1000 - Loss: 77.4638, Perplexity: inf, LR: 9.84e-05, LM: 5.1484, Age: 240.58, Sex: 0.704
2025-10-23 03:59:09,496 - INFO - Epoch 2, Step 850/1000 - Loss: 77.0729, Perplexity: inf, LR: 9.83e-05, LM: 5.1386, Age: 239.31, Sex: 0.702
2025-10-23 03:59:22,013 - INFO - Epoch 2, Step 900/1000 - Loss: 77.7789, Perplexity: inf, LR: 9.82e-05, LM: 5.1257, Age: 241.71, Sex: 0.702
2025-10-23 03:59:34,433 - INFO - Epoch 2, Step 950/1000 - Loss: 77.1441, Perplexity: inf, LR: 9.81e-05, LM: 5.1002, Age: 239.68, Sex: 0.701
2025-10-23 03:59:46,610 - INFO - Epoch 2, Step 1000/1000 - Loss: 76.8218, Perplexity: inf, LR: 9.80e-05, LM: 5.0653, Age: 238.72, Sex: 0.698
2025-10-23 03:59:46,611 - INFO - Epoch 2 Complete - Avg Loss: 76.8218, Avg Perplexity: inf, LM: 5.0653, Age: 238.72, Sex: 0.698
2025-10-23 04:00:06,522 - INFO - Validation - Loss: 4.7496, Perplexity: 142.8102, Token Accuracy: 0.2644, Code Accuracy: 0.0172
2025-10-23 04:00:06,523 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:00:09,967 - INFO - TPL computed on 351 samples: 203.1585
2025-10-23 04:00:09,967 - INFO - Temporal Perplexity (TPL): 203.1585
2025-10-23 04:00:09,968 - INFO - New best model! Validation loss: 4.7496
2025-10-23 04:00:14,753 - INFO - Checkpoint saved: epoch 2
2025-10-23 04:00:27,069 - INFO - Epoch 3, Step 50/1000 - Loss: 76.1721, Perplexity: inf, LR: 9.79e-05, LM: 4.5360, Age: 238.41, Sex: 0.561
2025-10-23 04:00:39,601 - INFO - Epoch 3, Step 100/1000 - Loss: 79.0440, Perplexity: inf, LR: 9.78e-05, LM: 4.7739, Age: 247.17, Sex: 0.594
2025-10-23 04:00:52,053 - INFO - Epoch 3, Step 150/1000 - Loss: 78.8566, Perplexity: inf, LR: 9.77e-05, LM: 4.9284, Age: 246.01, Sex: 0.626
2025-10-23 04:01:04,698 - INFO - Epoch 3, Step 200/1000 - Loss: 75.7142, Perplexity: inf, LR: 9.76e-05, LM: 4.9874, Age: 235.33, Sex: 0.641
2025-10-23 04:01:17,140 - INFO - Epoch 3, Step 250/1000 - Loss: 76.5115, Perplexity: inf, LR: 9.74e-05, LM: 4.9971, Age: 237.94, Sex: 0.655
2025-10-23 04:01:29,756 - INFO - Epoch 3, Step 300/1000 - Loss: 77.0865, Perplexity: inf, LR: 9.73e-05, LM: 4.9993, Age: 239.85, Sex: 0.660
2025-10-23 04:01:42,169 - INFO - Epoch 3, Step 350/1000 - Loss: 76.4544, Perplexity: inf, LR: 9.72e-05, LM: 4.9609, Age: 237.87, Sex: 0.664
2025-10-23 04:01:54,620 - INFO - Epoch 3, Step 400/1000 - Loss: 76.9699, Perplexity: inf, LR: 9.71e-05, LM: 4.9544, Age: 239.61, Sex: 0.667
2025-10-23 04:02:07,211 - INFO - Epoch 3, Step 450/1000 - Loss: 76.7189, Perplexity: inf, LR: 9.70e-05, LM: 4.9621, Age: 238.74, Sex: 0.672
2025-10-23 04:02:19,998 - INFO - Epoch 3, Step 500/1000 - Loss: 76.6510, Perplexity: inf, LR: 9.69e-05, LM: 4.9776, Age: 238.46, Sex: 0.679
2025-10-23 04:02:32,635 - INFO - Epoch 3, Step 550/1000 - Loss: 76.5857, Perplexity: inf, LR: 9.68e-05, LM: 4.9873, Age: 238.21, Sex: 0.680
2025-10-23 04:02:44,722 - INFO - Epoch 3, Step 600/1000 - Loss: 77.0180, Perplexity: inf, LR: 9.67e-05, LM: 4.9891, Age: 239.64, Sex: 0.680
2025-10-23 04:02:57,017 - INFO - Epoch 3, Step 650/1000 - Loss: 76.7562, Perplexity: inf, LR: 9.66e-05, LM: 5.0138, Age: 238.69, Sex: 0.680
2025-10-23 04:03:09,306 - INFO - Epoch 3, Step 700/1000 - Loss: 76.5707, Perplexity: inf, LR: 9.65e-05, LM: 5.0317, Age: 238.01, Sex: 0.682
2025-10-23 04:03:21,844 - INFO - Epoch 3, Step 750/1000 - Loss: 76.2364, Perplexity: inf, LR: 9.64e-05, LM: 5.0401, Age: 236.87, Sex: 0.683
2025-10-23 04:03:34,222 - INFO - Epoch 3, Step 800/1000 - Loss: 76.3431, Perplexity: inf, LR: 9.63e-05, LM: 5.0529, Age: 237.18, Sex: 0.682
2025-10-23 04:03:46,759 - INFO - Epoch 3, Step 850/1000 - Loss: 76.8061, Perplexity: inf, LR: 9.62e-05, LM: 5.0583, Age: 238.71, Sex: 0.681
2025-10-23 04:03:59,070 - INFO - Epoch 3, Step 900/1000 - Loss: 77.2412, Perplexity: inf, LR: 9.61e-05, LM: 5.0647, Age: 240.14, Sex: 0.674
2025-10-23 04:04:11,498 - INFO - Epoch 3, Step 950/1000 - Loss: 77.2991, Perplexity: inf, LR: 9.60e-05, LM: 5.0656, Age: 240.33, Sex: 0.668
2025-10-23 04:04:23,808 - INFO - Epoch 3, Step 1000/1000 - Loss: 77.3900, Perplexity: inf, LR: 9.59e-05, LM: 5.0614, Age: 240.65, Sex: 0.661
2025-10-23 04:04:23,809 - INFO - Epoch 3 Complete - Avg Loss: 77.3900, Avg Perplexity: inf, LM: 5.0614, Age: 240.65, Sex: 0.661
2025-10-23 04:04:43,599 - INFO - Validation - Loss: 5.1631, Perplexity: 209.3913, Token Accuracy: 0.1441, Code Accuracy: 0.0054
2025-10-23 04:04:43,600 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:04:47,037 - INFO - TPL computed on 351 samples: 260.8349
2025-10-23 04:04:47,037 - INFO - Temporal Perplexity (TPL): 260.8349
2025-10-23 04:04:59,354 - INFO - Epoch 4, Step 50/1000 - Loss: 80.8565, Perplexity: inf, LR: 9.58e-05, LM: 5.0149, Age: 252.45, Sex: 0.527
2025-10-23 04:05:12,000 - INFO - Epoch 4, Step 100/1000 - Loss: 76.9036, Perplexity: inf, LR: 9.57e-05, LM: 5.0529, Age: 239.16, Sex: 0.516
2025-10-23 04:05:24,395 - INFO - Epoch 4, Step 150/1000 - Loss: 77.3218, Perplexity: inf, LR: 9.56e-05, LM: 5.0687, Age: 240.49, Sex: 0.523
2025-10-23 04:05:36,646 - INFO - Epoch 4, Step 200/1000 - Loss: 75.5036, Perplexity: inf, LR: 9.55e-05, LM: 5.0481, Age: 234.50, Sex: 0.523
2025-10-23 04:05:49,014 - INFO - Epoch 4, Step 250/1000 - Loss: 75.1710, Perplexity: inf, LR: 9.54e-05, LM: 5.0467, Age: 233.40, Sex: 0.523
2025-10-23 04:06:01,628 - INFO - Epoch 4, Step 300/1000 - Loss: 76.5794, Perplexity: inf, LR: 9.53e-05, LM: 5.0623, Age: 238.04, Sex: 0.524
2025-10-23 04:06:13,771 - INFO - Epoch 4, Step 350/1000 - Loss: 76.2814, Perplexity: inf, LR: 9.52e-05, LM: 5.0533, Age: 237.08, Sex: 0.524
2025-10-23 04:06:26,026 - INFO - Epoch 4, Step 400/1000 - Loss: 76.2617, Perplexity: inf, LR: 9.51e-05, LM: 5.0595, Age: 236.99, Sex: 0.525
2025-10-23 04:06:38,518 - INFO - Epoch 4, Step 450/1000 - Loss: 75.5790, Perplexity: inf, LR: 9.50e-05, LM: 5.0606, Age: 234.71, Sex: 0.523
2025-10-23 04:06:51,039 - INFO - Epoch 4, Step 500/1000 - Loss: 75.7230, Perplexity: inf, LR: 9.49e-05, LM: 5.0528, Age: 235.22, Sex: 0.523
2025-10-23 04:07:03,485 - INFO - Epoch 4, Step 550/1000 - Loss: 75.0588, Perplexity: inf, LR: 9.48e-05, LM: 5.0479, Age: 233.02, Sex: 0.522
2025-10-23 04:07:15,841 - INFO - Epoch 4, Step 600/1000 - Loss: 74.6618, Perplexity: inf, LR: 9.47e-05, LM: 5.0604, Age: 231.66, Sex: 0.522
2025-10-23 04:07:28,428 - INFO - Epoch 4, Step 650/1000 - Loss: 74.8616, Perplexity: inf, LR: 9.46e-05, LM: 5.0554, Age: 232.34, Sex: 0.520
2025-10-23 04:07:41,126 - INFO - Epoch 4, Step 700/1000 - Loss: 75.1407, Perplexity: inf, LR: 9.45e-05, LM: 5.0509, Age: 233.29, Sex: 0.520
2025-10-23 04:07:53,598 - INFO - Epoch 4, Step 750/1000 - Loss: 75.6879, Perplexity: inf, LR: 9.44e-05, LM: 5.0498, Age: 235.11, Sex: 0.518
2025-10-23 04:08:06,347 - INFO - Epoch 4, Step 800/1000 - Loss: 76.0632, Perplexity: inf, LR: 9.43e-05, LM: 5.0560, Age: 236.34, Sex: 0.521
2025-10-23 04:08:18,518 - INFO - Epoch 4, Step 850/1000 - Loss: 76.2102, Perplexity: inf, LR: 9.42e-05, LM: 5.0659, Age: 236.80, Sex: 0.522
2025-10-23 04:08:30,530 - INFO - Epoch 4, Step 900/1000 - Loss: 76.5237, Perplexity: inf, LR: 9.41e-05, LM: 5.0665, Age: 237.84, Sex: 0.520
2025-10-23 04:08:43,100 - INFO - Epoch 4, Step 950/1000 - Loss: 76.5147, Perplexity: inf, LR: 9.40e-05, LM: 5.0704, Age: 237.80, Sex: 0.520
2025-10-23 04:08:55,746 - INFO - Epoch 4, Step 1000/1000 - Loss: 76.0524, Perplexity: inf, LR: 9.39e-05, LM: 5.0708, Age: 236.26, Sex: 0.520
2025-10-23 04:08:55,747 - INFO - Epoch 4 Complete - Avg Loss: 76.0524, Avg Perplexity: inf, LM: 5.0708, Age: 236.26, Sex: 0.520
2025-10-23 04:09:15,832 - INFO - Validation - Loss: 5.1234, Perplexity: 201.5151, Token Accuracy: 0.1476, Code Accuracy: 0.0120
2025-10-23 04:09:15,834 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:09:19,275 - INFO - TPL computed on 351 samples: 254.4878
2025-10-23 04:09:19,275 - INFO - Temporal Perplexity (TPL): 254.4878
2025-10-23 04:09:31,774 - INFO - Epoch 5, Step 50/1000 - Loss: 82.3195, Perplexity: inf, LR: 9.38e-05, LM: 5.2005, Age: 256.71, Sex: 0.531
2025-10-23 04:09:44,671 - INFO - Epoch 5, Step 100/1000 - Loss: 76.3200, Perplexity: inf, LR: 9.37e-05, LM: 5.1039, Age: 237.04, Sex: 0.515
2025-10-23 04:09:57,152 - INFO - Epoch 5, Step 150/1000 - Loss: 75.9689, Perplexity: inf, LR: 9.36e-05, LM: 5.0614, Age: 236.02, Sex: 0.513
2025-10-23 04:10:09,732 - INFO - Epoch 5, Step 200/1000 - Loss: 76.6154, Perplexity: inf, LR: 9.35e-05, LM: 5.0610, Age: 238.17, Sex: 0.512
2025-10-23 04:10:22,155 - INFO - Epoch 5, Step 250/1000 - Loss: 76.6398, Perplexity: inf, LR: 9.34e-05, LM: 5.0425, Age: 238.32, Sex: 0.513
2025-10-23 04:10:34,755 - INFO - Epoch 5, Step 300/1000 - Loss: 78.3082, Perplexity: inf, LR: 9.33e-05, LM: 5.0445, Age: 243.87, Sex: 0.515
2025-10-23 04:10:47,233 - INFO - Epoch 5, Step 350/1000 - Loss: 78.0149, Perplexity: inf, LR: 9.32e-05, LM: 5.0486, Age: 242.88, Sex: 0.516
2025-10-23 04:10:59,803 - INFO - Epoch 5, Step 400/1000 - Loss: 77.4412, Perplexity: inf, LR: 9.31e-05, LM: 5.0518, Age: 240.95, Sex: 0.517
2025-10-23 04:11:12,323 - INFO - Epoch 5, Step 450/1000 - Loss: 77.1997, Perplexity: inf, LR: 9.30e-05, LM: 5.0480, Age: 240.16, Sex: 0.517
2025-10-23 04:11:24,543 - INFO - Epoch 5, Step 500/1000 - Loss: 77.0767, Perplexity: inf, LR: 9.29e-05, LM: 5.0402, Age: 239.78, Sex: 0.516
2025-10-23 04:11:37,001 - INFO - Epoch 5, Step 550/1000 - Loss: 77.2169, Perplexity: inf, LR: 9.28e-05, LM: 5.0522, Age: 240.20, Sex: 0.520
2025-10-23 04:11:49,125 - INFO - Epoch 5, Step 600/1000 - Loss: 77.3019, Perplexity: inf, LR: 9.27e-05, LM: 5.0567, Age: 240.47, Sex: 0.519
2025-10-23 04:12:01,365 - INFO - Epoch 5, Step 650/1000 - Loss: 76.7043, Perplexity: inf, LR: 9.26e-05, LM: 5.0575, Age: 238.48, Sex: 0.518
2025-10-23 04:12:13,897 - INFO - Epoch 5, Step 700/1000 - Loss: 76.4035, Perplexity: inf, LR: 9.24e-05, LM: 5.0705, Age: 237.43, Sex: 0.520
2025-10-23 04:12:26,652 - INFO - Epoch 5, Step 750/1000 - Loss: 75.6227, Perplexity: inf, LR: 9.23e-05, LM: 5.0657, Age: 234.84, Sex: 0.520
2025-10-23 04:12:38,900 - INFO - Epoch 5, Step 800/1000 - Loss: 75.8447, Perplexity: inf, LR: 9.22e-05, LM: 5.0632, Age: 235.59, Sex: 0.520
2025-10-23 04:12:51,531 - INFO - Epoch 5, Step 850/1000 - Loss: 75.5741, Perplexity: inf, LR: 9.21e-05, LM: 5.0600, Age: 234.70, Sex: 0.520
2025-10-23 04:13:03,701 - INFO - Epoch 5, Step 900/1000 - Loss: 76.0577, Perplexity: inf, LR: 9.20e-05, LM: 5.0596, Age: 236.31, Sex: 0.520
2025-10-23 04:13:16,377 - INFO - Epoch 5, Step 950/1000 - Loss: 76.2099, Perplexity: inf, LR: 9.19e-05, LM: 5.0573, Age: 236.83, Sex: 0.520
2025-10-23 04:13:29,322 - INFO - Epoch 5, Step 1000/1000 - Loss: 76.5016, Perplexity: inf, LR: 9.18e-05, LM: 5.0617, Age: 237.79, Sex: 0.519
2025-10-23 04:13:29,323 - INFO - Epoch 5 Complete - Avg Loss: 76.5016, Avg Perplexity: inf, LM: 5.0617, Age: 237.79, Sex: 0.519
2025-10-23 04:13:49,142 - INFO - Validation - Loss: 5.1527, Perplexity: 209.3309, Token Accuracy: 0.1474, Code Accuracy: 0.0115
2025-10-23 04:13:49,143 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:13:52,594 - INFO - TPL computed on 351 samples: 251.8690
2025-10-23 04:13:52,594 - INFO - Temporal Perplexity (TPL): 251.8690
2025-10-23 04:13:54,864 - INFO - Checkpoint saved: epoch 5
2025-10-23 04:14:07,682 - INFO - Epoch 6, Step 50/1000 - Loss: 66.4828, Perplexity: inf, LR: 9.17e-05, LM: 4.9130, Age: 204.90, Sex: 0.500
2025-10-23 04:14:20,285 - INFO - Epoch 6, Step 100/1000 - Loss: 72.3312, Perplexity: inf, LR: 9.16e-05, LM: 4.9570, Age: 224.24, Sex: 0.511
2025-10-23 04:14:32,329 - INFO - Epoch 6, Step 150/1000 - Loss: 72.9496, Perplexity: inf, LR: 9.15e-05, LM: 4.9537, Age: 226.32, Sex: 0.502
2025-10-23 04:14:44,817 - INFO - Epoch 6, Step 200/1000 - Loss: 74.4759, Perplexity: inf, LR: 9.14e-05, LM: 4.9539, Age: 231.40, Sex: 0.502
2025-10-23 04:14:57,506 - INFO - Epoch 6, Step 250/1000 - Loss: 76.7075, Perplexity: inf, LR: 9.13e-05, LM: 4.9936, Age: 238.70, Sex: 0.513
2025-10-23 04:15:09,722 - INFO - Epoch 6, Step 300/1000 - Loss: 76.9339, Perplexity: inf, LR: 9.12e-05, LM: 4.9786, Age: 239.51, Sex: 0.516
2025-10-23 04:15:22,542 - INFO - Epoch 6, Step 350/1000 - Loss: 76.8974, Perplexity: inf, LR: 9.11e-05, LM: 4.9833, Age: 239.37, Sex: 0.522
2025-10-23 04:15:34,771 - INFO - Epoch 6, Step 400/1000 - Loss: 76.3332, Perplexity: inf, LR: 9.10e-05, LM: 5.0057, Age: 237.41, Sex: 0.521
2025-10-23 04:15:47,190 - INFO - Epoch 6, Step 450/1000 - Loss: 76.9939, Perplexity: inf, LR: 9.09e-05, LM: 5.0186, Age: 239.57, Sex: 0.521
2025-10-23 04:15:59,534 - INFO - Epoch 6, Step 500/1000 - Loss: 76.9380, Perplexity: inf, LR: 9.08e-05, LM: 5.0322, Age: 239.34, Sex: 0.523
2025-10-23 04:16:11,980 - INFO - Epoch 6, Step 550/1000 - Loss: 76.9100, Perplexity: inf, LR: 9.07e-05, LM: 5.0436, Age: 239.21, Sex: 0.523
2025-10-23 04:16:24,586 - INFO - Epoch 6, Step 600/1000 - Loss: 76.9036, Perplexity: inf, LR: 9.06e-05, LM: 5.0394, Age: 239.20, Sex: 0.521
2025-10-23 04:16:36,845 - INFO - Epoch 6, Step 650/1000 - Loss: 76.9735, Perplexity: inf, LR: 9.05e-05, LM: 5.0500, Age: 239.40, Sex: 0.522
2025-10-23 04:16:49,197 - INFO - Epoch 6, Step 700/1000 - Loss: 76.3705, Perplexity: inf, LR: 9.04e-05, LM: 5.0408, Age: 237.42, Sex: 0.521
2025-10-23 04:17:02,056 - INFO - Epoch 6, Step 750/1000 - Loss: 76.5390, Perplexity: inf, LR: 9.03e-05, LM: 5.0496, Age: 237.95, Sex: 0.521
2025-10-23 04:17:14,216 - INFO - Epoch 6, Step 800/1000 - Loss: 76.6599, Perplexity: inf, LR: 9.02e-05, LM: 5.0449, Age: 238.37, Sex: 0.522
2025-10-23 04:17:26,715 - INFO - Epoch 6, Step 850/1000 - Loss: 76.4845, Perplexity: inf, LR: 9.01e-05, LM: 5.0454, Age: 237.78, Sex: 0.521
2025-10-23 04:17:39,330 - INFO - Epoch 6, Step 900/1000 - Loss: 76.3933, Perplexity: inf, LR: 9.00e-05, LM: 5.0447, Age: 237.48, Sex: 0.521
2025-10-23 04:17:51,755 - INFO - Epoch 6, Step 950/1000 - Loss: 76.3951, Perplexity: inf, LR: 8.99e-05, LM: 5.0442, Age: 237.49, Sex: 0.520
2025-10-23 04:18:04,207 - INFO - Epoch 6, Step 1000/1000 - Loss: 75.9554, Perplexity: inf, LR: 8.98e-05, LM: 5.0416, Age: 236.03, Sex: 0.520
2025-10-23 04:18:04,208 - INFO - Epoch 6 Complete - Avg Loss: 75.9554, Avg Perplexity: inf, LM: 5.0416, Age: 236.03, Sex: 0.520
2025-10-23 04:18:23,966 - INFO - Validation - Loss: 5.1329, Perplexity: 204.7846, Token Accuracy: 0.1458, Code Accuracy: 0.0089
2025-10-23 04:18:23,968 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:18:27,409 - INFO - TPL computed on 351 samples: 250.1944
2025-10-23 04:18:27,410 - INFO - Temporal Perplexity (TPL): 250.1944
2025-10-23 04:18:39,771 - INFO - Epoch 7, Step 50/1000 - Loss: 79.4551, Perplexity: inf, LR: 8.97e-05, LM: 5.0283, Age: 247.75, Sex: 0.512
2025-10-23 04:18:52,099 - INFO - Epoch 7, Step 100/1000 - Loss: 76.5041, Perplexity: inf, LR: 8.96e-05, LM: 5.0028, Age: 238.01, Sex: 0.499
2025-10-23 04:19:04,551 - INFO - Epoch 7, Step 150/1000 - Loss: 74.1227, Perplexity: inf, LR: 8.95e-05, LM: 5.0385, Age: 229.94, Sex: 0.516
2025-10-23 04:19:16,651 - INFO - Epoch 7, Step 200/1000 - Loss: 75.2989, Perplexity: inf, LR: 8.94e-05, LM: 5.1042, Age: 233.63, Sex: 0.526
2025-10-23 04:19:29,183 - INFO - Epoch 7, Step 250/1000 - Loss: 76.0553, Perplexity: inf, LR: 8.93e-05, LM: 5.0792, Age: 236.24, Sex: 0.526
2025-10-23 04:19:41,747 - INFO - Epoch 7, Step 300/1000 - Loss: 76.5330, Perplexity: inf, LR: 8.92e-05, LM: 5.0579, Age: 237.90, Sex: 0.523
2025-10-23 04:19:54,267 - INFO - Epoch 7, Step 350/1000 - Loss: 75.5342, Perplexity: inf, LR: 8.91e-05, LM: 5.0469, Age: 234.61, Sex: 0.521
2025-10-23 04:20:06,585 - INFO - Epoch 7, Step 400/1000 - Loss: 76.3715, Perplexity: inf, LR: 8.90e-05, LM: 5.0596, Age: 237.35, Sex: 0.528
2025-10-23 04:20:19,586 - INFO - Epoch 7, Step 450/1000 - Loss: 76.3835, Perplexity: inf, LR: 8.89e-05, LM: 5.0616, Age: 237.39, Sex: 0.528
2025-10-23 04:20:32,164 - INFO - Epoch 7, Step 500/1000 - Loss: 75.9393, Perplexity: inf, LR: 8.88e-05, LM: 5.0628, Age: 235.90, Sex: 0.526
2025-10-23 04:20:44,682 - INFO - Epoch 7, Step 550/1000 - Loss: 75.6349, Perplexity: inf, LR: 8.87e-05, LM: 5.0610, Age: 234.90, Sex: 0.525
2025-10-23 04:20:57,190 - INFO - Epoch 7, Step 600/1000 - Loss: 75.4990, Perplexity: inf, LR: 8.86e-05, LM: 5.0588, Age: 234.45, Sex: 0.523
2025-10-23 04:21:09,803 - INFO - Epoch 7, Step 650/1000 - Loss: 74.9562, Perplexity: inf, LR: 8.85e-05, LM: 5.0560, Age: 232.65, Sex: 0.524
2025-10-23 04:21:22,276 - INFO - Epoch 7, Step 700/1000 - Loss: 75.0452, Perplexity: inf, LR: 8.84e-05, LM: 5.0600, Age: 232.94, Sex: 0.523
2025-10-23 04:21:34,903 - INFO - Epoch 7, Step 750/1000 - Loss: 74.3844, Perplexity: inf, LR: 8.83e-05, LM: 5.0629, Age: 230.72, Sex: 0.522
2025-10-23 04:21:47,739 - INFO - Epoch 7, Step 800/1000 - Loss: 75.2681, Perplexity: inf, LR: 8.82e-05, LM: 5.0578, Age: 233.69, Sex: 0.522
2025-10-23 04:22:00,255 - INFO - Epoch 7, Step 850/1000 - Loss: 75.3789, Perplexity: inf, LR: 8.81e-05, LM: 5.0531, Age: 234.07, Sex: 0.522
2025-10-23 04:22:12,785 - INFO - Epoch 7, Step 900/1000 - Loss: 75.4278, Perplexity: inf, LR: 8.80e-05, LM: 5.0540, Age: 234.23, Sex: 0.522
2025-10-23 04:22:25,253 - INFO - Epoch 7, Step 950/1000 - Loss: 75.4776, Perplexity: inf, LR: 8.79e-05, LM: 5.0507, Age: 234.41, Sex: 0.521
2025-10-23 04:22:37,654 - INFO - Epoch 7, Step 1000/1000 - Loss: 75.7184, Perplexity: inf, LR: 8.78e-05, LM: 5.0608, Age: 235.17, Sex: 0.537
2025-10-23 04:22:37,655 - INFO - Epoch 7 Complete - Avg Loss: 75.7184, Avg Perplexity: inf, LM: 5.0608, Age: 235.17, Sex: 0.537
2025-10-23 04:22:57,339 - INFO - Validation - Loss: 5.5222, Perplexity: 274.1453, Token Accuracy: 0.0787, Code Accuracy: 0.0172
2025-10-23 04:22:57,340 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:23:00,752 - INFO - TPL computed on 351 samples: 270.1490
2025-10-23 04:23:00,753 - INFO - Temporal Perplexity (TPL): 270.1490
2025-10-23 04:23:12,866 - INFO - Epoch 8, Step 50/1000 - Loss: 91.4801, Perplexity: inf, LR: 8.77e-05, LM: 5.4391, Age: 286.29, Sex: 0.773
2025-10-23 04:23:25,300 - INFO - Epoch 8, Step 100/1000 - Loss: 86.5846, Perplexity: inf, LR: 8.76e-05, LM: 5.3397, Age: 270.32, Sex: 0.740
2025-10-23 04:23:38,104 - INFO - Epoch 8, Step 150/1000 - Loss: 84.1552, Perplexity: inf, LR: 8.74e-05, LM: 5.2367, Age: 262.58, Sex: 0.728
2025-10-23 04:23:50,670 - INFO - Epoch 8, Step 200/1000 - Loss: 79.8126, Perplexity: inf, LR: 8.73e-05, LM: 5.1698, Age: 248.33, Sex: 0.718
2025-10-23 04:24:02,973 - INFO - Epoch 8, Step 250/1000 - Loss: 79.5730, Perplexity: inf, LR: 8.72e-05, LM: 5.1212, Age: 247.69, Sex: 0.718
2025-10-23 04:24:15,561 - INFO - Epoch 8, Step 300/1000 - Loss: 78.2710, Perplexity: inf, LR: 8.71e-05, LM: 5.0869, Age: 243.47, Sex: 0.713
2025-10-23 04:24:27,829 - INFO - Epoch 8, Step 350/1000 - Loss: 78.2794, Perplexity: inf, LR: 8.70e-05, LM: 5.0626, Age: 243.58, Sex: 0.715
2025-10-23 04:24:40,008 - INFO - Epoch 8, Step 400/1000 - Loss: 79.3505, Perplexity: inf, LR: 8.69e-05, LM: 5.0146, Age: 247.31, Sex: 0.714
2025-10-23 04:24:52,528 - INFO - Epoch 8, Step 450/1000 - Loss: 78.3898, Perplexity: inf, LR: 8.68e-05, LM: 4.9923, Age: 244.18, Sex: 0.712
2025-10-23 04:25:04,986 - INFO - Epoch 8, Step 500/1000 - Loss: 77.4625, Perplexity: inf, LR: 8.67e-05, LM: 4.9694, Age: 241.17, Sex: 0.712
2025-10-23 04:25:17,345 - INFO - Epoch 8, Step 550/1000 - Loss: 77.8709, Perplexity: inf, LR: 8.66e-05, LM: 4.9455, Age: 242.61, Sex: 0.711
2025-10-23 04:25:29,931 - INFO - Epoch 8, Step 600/1000 - Loss: 77.4630, Perplexity: inf, LR: 8.65e-05, LM: 4.9379, Age: 241.28, Sex: 0.710
2025-10-23 04:25:42,229 - INFO - Epoch 8, Step 650/1000 - Loss: 77.5854, Perplexity: inf, LR: 8.64e-05, LM: 4.9213, Age: 241.74, Sex: 0.709
2025-10-23 04:25:54,358 - INFO - Epoch 8, Step 700/1000 - Loss: 76.9615, Perplexity: inf, LR: 8.63e-05, LM: 4.9055, Age: 239.71, Sex: 0.708
2025-10-23 04:26:06,984 - INFO - Epoch 8, Step 750/1000 - Loss: 76.7164, Perplexity: inf, LR: 8.62e-05, LM: 4.8848, Age: 238.97, Sex: 0.709
2025-10-23 04:26:19,689 - INFO - Epoch 8, Step 800/1000 - Loss: 76.3402, Perplexity: inf, LR: 8.61e-05, LM: 4.8719, Age: 237.76, Sex: 0.709
2025-10-23 04:26:32,208 - INFO - Epoch 8, Step 850/1000 - Loss: 76.4453, Perplexity: inf, LR: 8.60e-05, LM: 4.8597, Age: 238.15, Sex: 0.708
2025-10-23 04:26:44,965 - INFO - Epoch 8, Step 900/1000 - Loss: 76.5922, Perplexity: inf, LR: 8.59e-05, LM: 4.8570, Age: 238.65, Sex: 0.706
2025-10-23 04:26:57,701 - INFO - Epoch 8, Step 950/1000 - Loss: 77.1903, Perplexity: inf, LR: 8.58e-05, LM: 4.8512, Age: 240.66, Sex: 0.705
2025-10-23 04:27:10,286 - INFO - Epoch 8, Step 1000/1000 - Loss: 77.2927, Perplexity: inf, LR: 8.57e-05, LM: 4.8514, Age: 241.00, Sex: 0.703
2025-10-23 04:27:10,287 - INFO - Epoch 8 Complete - Avg Loss: 77.2927, Avg Perplexity: inf, LM: 4.8514, Age: 241.00, Sex: 0.703
2025-10-23 04:27:30,410 - INFO - Validation - Loss: 4.8478, Perplexity: 154.1327, Token Accuracy: 0.2004, Code Accuracy: 0.0000
2025-10-23 04:27:30,412 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:27:33,795 - INFO - TPL computed on 351 samples: 200.8051
2025-10-23 04:27:33,795 - INFO - Temporal Perplexity (TPL): 200.8051
2025-10-23 04:27:46,160 - INFO - Epoch 9, Step 50/1000 - Loss: 83.3806, Perplexity: inf, LR: 8.56e-05, LM: 4.8737, Age: 261.27, Sex: 0.627
2025-10-23 04:27:58,709 - INFO - Epoch 9, Step 100/1000 - Loss: 78.6891, Perplexity: inf, LR: 8.55e-05, LM: 4.8045, Age: 245.86, Sex: 0.629
2025-10-23 04:28:11,553 - INFO - Epoch 9, Step 150/1000 - Loss: 252.0751, Perplexity: inf, LR: 8.54e-05, LM: 5.4154, Age: 821.75, Sex: 0.673
2025-10-23 04:28:23,907 - INFO - Epoch 9, Step 200/1000 - Loss: 350.9599, Perplexity: inf, LR: 8.53e-05, LM: 5.9729, Age: 1149.51, Sex: 0.670
2025-10-23 04:28:36,200 - INFO - Epoch 9, Step 250/1000 - Loss: 341.4813, Perplexity: inf, LR: 8.52e-05, LM: 6.1877, Age: 1117.18, Sex: 0.698
2025-10-23 04:28:48,525 - INFO - Epoch 9, Step 300/1000 - Loss: 302.1365, Perplexity: inf, LR: 8.51e-05, LM: 6.2104, Age: 985.95, Sex: 0.699
2025-10-23 04:29:00,834 - INFO - Epoch 9, Step 350/1000 - Loss: 271.6194, Perplexity: inf, LR: 8.50e-05, LM: 6.1412, Age: 884.46, Sex: 0.701
2025-10-23 04:29:13,089 - INFO - Epoch 9, Step 400/1000 - Loss: 248.5307, Perplexity: inf, LR: 8.49e-05, LM: 6.0567, Age: 807.78, Sex: 0.701
2025-10-23 04:29:25,526 - INFO - Epoch 9, Step 450/1000 - Loss: 228.1108, Perplexity: inf, LR: 8.48e-05, LM: 5.9667, Age: 740.01, Sex: 0.700
2025-10-23 04:29:37,992 - INFO - Epoch 9, Step 500/1000 - Loss: 213.5072, Perplexity: inf, LR: 8.47e-05, LM: 5.8936, Age: 691.58, Sex: 0.698
2025-10-23 04:29:50,597 - INFO - Epoch 9, Step 550/1000 - Loss: 200.3607, Perplexity: inf, LR: 8.46e-05, LM: 5.8362, Age: 647.95, Sex: 0.697
2025-10-23 04:30:03,240 - INFO - Epoch 9, Step 600/1000 - Loss: 190.0197, Perplexity: inf, LR: 8.45e-05, LM: 5.7837, Age: 613.66, Sex: 0.696
2025-10-23 04:30:15,890 - INFO - Epoch 9, Step 650/1000 - Loss: 181.9342, Perplexity: inf, LR: 8.44e-05, LM: 5.7400, Age: 586.85, Sex: 0.696
2025-10-23 04:30:28,486 - INFO - Epoch 9, Step 700/1000 - Loss: 174.8565, Perplexity: inf, LR: 8.43e-05, LM: 5.7037, Age: 563.38, Sex: 0.696
2025-10-23 04:30:41,039 - INFO - Epoch 9, Step 750/1000 - Loss: 168.4729, Perplexity: inf, LR: 8.42e-05, LM: 5.6779, Age: 542.19, Sex: 0.695
2025-10-23 04:30:53,406 - INFO - Epoch 9, Step 800/1000 - Loss: 162.2443, Perplexity: inf, LR: 8.41e-05, LM: 5.6510, Age: 521.51, Sex: 0.696
2025-10-23 04:31:05,790 - INFO - Epoch 9, Step 850/1000 - Loss: 157.4275, Perplexity: inf, LR: 8.40e-05, LM: 5.6259, Age: 505.54, Sex: 0.695
2025-10-23 04:31:18,282 - INFO - Epoch 9, Step 900/1000 - Loss: 153.3543, Perplexity: inf, LR: 8.39e-05, LM: 5.6093, Age: 492.02, Sex: 0.695
2025-10-23 04:31:30,776 - INFO - Epoch 9, Step 950/1000 - Loss: 149.1256, Perplexity: inf, LR: 8.38e-05, LM: 5.5890, Age: 477.99, Sex: 0.695
2025-10-23 04:31:43,173 - INFO - Epoch 9, Step 1000/1000 - Loss: 146.3086, Perplexity: inf, LR: 8.37e-05, LM: 5.5745, Age: 468.65, Sex: 0.694
2025-10-23 04:31:43,174 - INFO - Epoch 9 Complete - Avg Loss: 146.3086, Avg Perplexity: inf, LM: 5.5745, Age: 468.65, Sex: 0.694
2025-10-23 04:32:03,004 - INFO - Validation - Loss: 5.3120, Perplexity: 231.1563, Token Accuracy: 0.0865, Code Accuracy: 0.0000
2025-10-23 04:32:03,005 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:32:06,373 - INFO - TPL computed on 351 samples: 266.8666
2025-10-23 04:32:06,373 - INFO - Temporal Perplexity (TPL): 266.8666
2025-10-23 04:32:18,505 - INFO - Epoch 10, Step 50/1000 - Loss: 78.4925, Perplexity: inf, LR: 8.36e-05, LM: 5.2230, Age: 243.78, Sex: 0.684
2025-10-23 04:32:30,950 - INFO - Epoch 10, Step 100/1000 - Loss: 78.2113, Perplexity: inf, LR: 8.35e-05, LM: 5.1833, Age: 242.96, Sex: 0.695
2025-10-23 04:32:43,331 - INFO - Epoch 10, Step 150/1000 - Loss: 78.9882, Perplexity: inf, LR: 8.34e-05, LM: 5.2194, Age: 245.44, Sex: 0.691
2025-10-23 04:32:55,748 - INFO - Epoch 10, Step 200/1000 - Loss: 78.0203, Perplexity: inf, LR: 8.33e-05, LM: 5.2280, Age: 242.18, Sex: 0.698
2025-10-23 04:33:08,636 - INFO - Epoch 10, Step 250/1000 - Loss: 79.5360, Perplexity: inf, LR: 8.32e-05, LM: 5.2360, Age: 247.20, Sex: 0.705
2025-10-23 04:33:21,349 - INFO - Epoch 10, Step 300/1000 - Loss: 78.6634, Perplexity: inf, LR: 8.31e-05, LM: 5.2425, Age: 244.27, Sex: 0.703
2025-10-23 04:33:33,949 - INFO - Epoch 10, Step 350/1000 - Loss: 80.1184, Perplexity: inf, LR: 8.30e-05, LM: 5.2414, Age: 249.12, Sex: 0.704
2025-10-23 04:33:46,474 - INFO - Epoch 10, Step 400/1000 - Loss: 79.6429, Perplexity: inf, LR: 8.29e-05, LM: 5.2447, Age: 247.53, Sex: 0.703
2025-10-23 04:33:58,847 - INFO - Epoch 10, Step 450/1000 - Loss: 78.8761, Perplexity: inf, LR: 8.28e-05, LM: 5.2271, Age: 245.03, Sex: 0.703
2025-10-23 04:34:11,517 - INFO - Epoch 10, Step 500/1000 - Loss: 78.9918, Perplexity: inf, LR: 8.27e-05, LM: 5.2308, Age: 245.40, Sex: 0.703
2025-10-23 04:34:23,982 - INFO - Epoch 10, Step 550/1000 - Loss: 79.3045, Perplexity: inf, LR: 8.26e-05, LM: 5.2316, Age: 246.44, Sex: 0.701
2025-10-23 04:34:36,514 - INFO - Epoch 10, Step 600/1000 - Loss: 80.2613, Perplexity: inf, LR: 8.24e-05, LM: 5.2369, Age: 249.61, Sex: 0.700
2025-10-23 04:34:48,860 - INFO - Epoch 10, Step 650/1000 - Loss: 80.8318, Perplexity: inf, LR: 8.23e-05, LM: 5.2309, Age: 251.54, Sex: 0.700
2025-10-23 04:35:01,373 - INFO - Epoch 10, Step 700/1000 - Loss: 80.1759, Perplexity: inf, LR: 8.22e-05, LM: 5.2401, Age: 249.32, Sex: 0.699
2025-10-23 04:35:13,929 - INFO - Epoch 10, Step 750/1000 - Loss: 80.4481, Perplexity: inf, LR: 8.21e-05, LM: 5.2407, Age: 250.23, Sex: 0.699
2025-10-23 04:35:26,517 - INFO - Epoch 10, Step 800/1000 - Loss: 80.7030, Perplexity: inf, LR: 8.20e-05, LM: 5.2465, Age: 251.06, Sex: 0.698
2025-10-23 04:35:39,082 - INFO - Epoch 10, Step 850/1000 - Loss: 80.8685, Perplexity: inf, LR: 8.19e-05, LM: 5.2510, Age: 251.59, Sex: 0.699
2025-10-23 04:35:51,429 - INFO - Epoch 10, Step 900/1000 - Loss: 81.4886, Perplexity: inf, LR: 8.18e-05, LM: 5.2504, Age: 253.66, Sex: 0.699
2025-10-23 04:36:04,082 - INFO - Epoch 10, Step 950/1000 - Loss: 81.4734, Perplexity: inf, LR: 8.17e-05, LM: 5.2516, Age: 253.61, Sex: 0.697
2025-10-23 04:36:16,506 - INFO - Epoch 10, Step 1000/1000 - Loss: 81.2140, Perplexity: inf, LR: 8.16e-05, LM: 5.2512, Age: 252.74, Sex: 0.698
2025-10-23 04:36:16,507 - INFO - Epoch 10 Complete - Avg Loss: 81.2140, Avg Perplexity: inf, LM: 5.2512, Age: 252.74, Sex: 0.698
2025-10-23 04:36:36,355 - INFO - Validation - Loss: 5.3510, Perplexity: 251.7674, Token Accuracy: 0.1039, Code Accuracy: 0.0000
2025-10-23 04:36:36,357 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:36:39,735 - INFO - TPL computed on 351 samples: 269.2150
2025-10-23 04:36:39,735 - INFO - Temporal Perplexity (TPL): 269.2150
2025-10-23 04:36:41,935 - INFO - Checkpoint saved: epoch 10
2025-10-23 04:36:54,169 - INFO - Epoch 11, Step 50/1000 - Loss: 86.8901, Perplexity: inf, LR: 8.15e-05, LM: 5.2377, Age: 271.70, Sex: 0.708
2025-10-23 04:37:06,514 - INFO - Epoch 11, Step 100/1000 - Loss: 81.9506, Perplexity: inf, LR: 8.14e-05, LM: 5.2191, Age: 255.30, Sex: 0.702
2025-10-23 04:37:19,140 - INFO - Epoch 11, Step 150/1000 - Loss: 82.4720, Perplexity: inf, LR: 8.13e-05, LM: 5.2291, Age: 257.01, Sex: 0.703
2025-10-23 04:37:31,413 - INFO - Epoch 11, Step 200/1000 - Loss: 81.5381, Perplexity: inf, LR: 8.12e-05, LM: 5.2293, Age: 253.89, Sex: 0.705
2025-10-23 04:37:43,853 - INFO - Epoch 11, Step 250/1000 - Loss: 82.4307, Perplexity: inf, LR: 8.11e-05, LM: 5.2359, Age: 256.85, Sex: 0.703
2025-10-23 04:37:56,621 - INFO - Epoch 11, Step 300/1000 - Loss: 82.4378, Perplexity: inf, LR: 8.10e-05, LM: 5.2636, Age: 256.78, Sex: 0.699
2025-10-23 04:38:09,069 - INFO - Epoch 11, Step 350/1000 - Loss: 103.9572, Perplexity: inf, LR: 8.09e-05, LM: 5.3137, Age: 328.35, Sex: 0.696
2025-10-23 04:38:21,532 - INFO - Epoch 11, Step 400/1000 - Loss: 131.4349, Perplexity: inf, LR: 8.08e-05, LM: 5.3757, Age: 419.73, Sex: 0.694
2025-10-23 04:38:33,814 - INFO - Epoch 11, Step 450/1000 - Loss: 150.6557, Perplexity: inf, LR: 8.07e-05, LM: 5.3944, Age: 483.74, Sex: 0.694
2025-10-23 04:38:46,070 - INFO - Epoch 11, Step 500/1000 - Loss: 165.4911, Perplexity: inf, LR: 8.06e-05, LM: 5.4118, Age: 533.14, Sex: 0.693
2025-10-23 04:38:58,392 - INFO - Epoch 11, Step 550/1000 - Loss: 181.1507, Perplexity: inf, LR: 8.05e-05, LM: 5.4202, Age: 585.31, Sex: 0.694
2025-10-23 04:39:10,764 - INFO - Epoch 11, Step 600/1000 - Loss: 192.4395, Perplexity: inf, LR: 8.04e-05, LM: 5.4271, Age: 622.91, Sex: 0.694
2025-10-23 04:39:22,883 - INFO - Epoch 11, Step 650/1000 - Loss: 200.9602, Perplexity: inf, LR: 8.03e-05, LM: 5.4315, Age: 651.30, Sex: 0.692
2025-10-23 04:39:35,093 - INFO - Epoch 11, Step 700/1000 - Loss: 209.4214, Perplexity: inf, LR: 8.02e-05, LM: 5.4299, Age: 679.51, Sex: 0.692
2025-10-23 04:39:47,686 - INFO - Epoch 11, Step 750/1000 - Loss: 213.7671, Perplexity: inf, LR: 8.01e-05, LM: 5.4370, Age: 693.97, Sex: 0.691
2025-10-23 04:40:00,205 - INFO - Epoch 11, Step 800/1000 - Loss: 220.1664, Perplexity: inf, LR: 8.00e-05, LM: 5.4420, Age: 715.29, Sex: 0.692
2025-10-23 04:40:12,870 - INFO - Epoch 11, Step 850/1000 - Loss: 225.0389, Perplexity: inf, LR: 7.99e-05, LM: 5.4444, Age: 731.52, Sex: 0.691
2025-10-23 04:40:25,285 - INFO - Epoch 11, Step 900/1000 - Loss: 230.2789, Perplexity: inf, LR: 7.98e-05, LM: 5.4473, Age: 748.98, Sex: 0.691
2025-10-23 04:40:38,020 - INFO - Epoch 11, Step 950/1000 - Loss: 234.1084, Perplexity: inf, LR: 7.97e-05, LM: 5.4481, Age: 761.74, Sex: 0.691
2025-10-23 04:40:50,633 - INFO - Epoch 11, Step 1000/1000 - Loss: 238.0860, Perplexity: inf, LR: 7.96e-05, LM: 5.4493, Age: 774.99, Sex: 0.691
2025-10-23 04:40:50,634 - INFO - Epoch 11 Complete - Avg Loss: 238.0860, Avg Perplexity: inf, LM: 5.4493, Age: 774.99, Sex: 0.691
2025-10-23 04:41:10,553 - INFO - Validation - Loss: 5.5381, Perplexity: 283.2989, Token Accuracy: 0.0867, Code Accuracy: 0.0000
2025-10-23 04:41:10,555 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:41:13,923 - INFO - TPL computed on 351 samples: 288.3067
2025-10-23 04:41:13,923 - INFO - Temporal Perplexity (TPL): 288.3067
2025-10-23 04:41:26,530 - INFO - Epoch 12, Step 50/1000 - Loss: 305.9368, Perplexity: inf, LR: 7.95e-05, LM: 5.3753, Age: 1001.43, Sex: 0.663
2025-10-23 04:41:39,195 - INFO - Epoch 12, Step 100/1000 - Loss: 298.2166, Perplexity: inf, LR: 7.94e-05, LM: 5.4185, Age: 975.54, Sex: 0.676
2025-10-23 04:41:51,350 - INFO - Epoch 12, Step 150/1000 - Loss: 306.2829, Perplexity: inf, LR: 7.93e-05, LM: 5.4415, Age: 1002.35, Sex: 0.677
2025-10-23 04:42:04,172 - INFO - Epoch 12, Step 200/1000 - Loss: 308.1111, Perplexity: inf, LR: 7.92e-05, LM: 5.4448, Age: 1008.43, Sex: 0.680
2025-10-23 04:42:16,993 - INFO - Epoch 12, Step 250/1000 - Loss: 303.8231, Perplexity: inf, LR: 7.91e-05, LM: 5.4428, Age: 994.15, Sex: 0.680
2025-10-23 04:42:29,497 - INFO - Epoch 12, Step 300/1000 - Loss: 304.0605, Perplexity: inf, LR: 7.90e-05, LM: 5.4564, Age: 994.89, Sex: 0.679
2025-10-23 04:42:42,074 - INFO - Epoch 12, Step 350/1000 - Loss: 304.3800, Perplexity: inf, LR: 7.89e-05, LM: 5.4663, Age: 995.93, Sex: 0.681
2025-10-23 04:42:54,550 - INFO - Epoch 12, Step 400/1000 - Loss: 302.2527, Perplexity: inf, LR: 7.88e-05, LM: 5.4710, Age: 988.82, Sex: 0.683
2025-10-23 04:43:07,060 - INFO - Epoch 12, Step 450/1000 - Loss: 303.0736, Perplexity: inf, LR: 7.87e-05, LM: 5.4742, Age: 991.54, Sex: 0.684
2025-10-23 04:43:19,623 - INFO - Epoch 12, Step 500/1000 - Loss: 304.2651, Perplexity: inf, LR: 7.86e-05, LM: 5.4665, Age: 995.54, Sex: 0.684
2025-10-23 04:43:32,032 - INFO - Epoch 12, Step 550/1000 - Loss: 305.0617, Perplexity: inf, LR: 7.85e-05, LM: 5.4665, Age: 998.19, Sex: 0.685
2025-10-23 04:43:44,616 - INFO - Epoch 12, Step 600/1000 - Loss: 304.6221, Perplexity: inf, LR: 7.84e-05, LM: 5.4649, Age: 996.73, Sex: 0.686
2025-10-23 04:43:56,836 - INFO - Epoch 12, Step 650/1000 - Loss: 303.6503, Perplexity: inf, LR: 7.83e-05, LM: 5.4705, Age: 993.48, Sex: 0.686
2025-10-23 04:44:09,447 - INFO - Epoch 12, Step 700/1000 - Loss: 305.0312, Perplexity: inf, LR: 7.82e-05, LM: 5.4702, Age: 998.08, Sex: 0.687
2025-10-23 04:44:21,816 - INFO - Epoch 12, Step 750/1000 - Loss: 305.8972, Perplexity: inf, LR: 7.81e-05, LM: 5.4891, Age: 1000.90, Sex: 0.688
2025-10-23 04:44:33,934 - INFO - Epoch 12, Step 800/1000 - Loss: 303.0917, Perplexity: inf, LR: 7.80e-05, LM: 5.5296, Age: 991.41, Sex: 0.688
2025-10-23 04:44:46,763 - INFO - Epoch 12, Step 850/1000 - Loss: 290.2737, Perplexity: inf, LR: 7.79e-05, LM: 5.5285, Age: 948.69, Sex: 0.688
2025-10-23 04:44:59,582 - INFO - Epoch 12, Step 900/1000 - Loss: 277.9106, Perplexity: inf, LR: 7.78e-05, LM: 5.5158, Age: 907.52, Sex: 0.688
2025-10-23 04:45:11,922 - INFO - Epoch 12, Step 950/1000 - Loss: 267.6911, Perplexity: inf, LR: 7.77e-05, LM: 5.5041, Age: 873.50, Sex: 0.690
2025-10-23 04:45:24,319 - INFO - Epoch 12, Step 1000/1000 - Loss: 258.3949, Perplexity: inf, LR: 7.76e-05, LM: 5.4946, Age: 842.54, Sex: 0.691
2025-10-23 04:45:24,320 - INFO - Epoch 12 Complete - Avg Loss: 258.3949, Avg Perplexity: inf, LM: 5.4946, Age: 842.54, Sex: 0.691
2025-10-23 04:45:44,068 - INFO - Validation - Loss: 5.3129, Perplexity: 230.1325, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 04:45:44,069 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:45:47,441 - INFO - TPL computed on 351 samples: 260.8901
2025-10-23 04:45:47,441 - INFO - Temporal Perplexity (TPL): 260.8901
2025-10-23 04:45:59,921 - INFO - Epoch 13, Step 50/1000 - Loss: 74.3808, Perplexity: inf, LR: 7.74e-05, LM: 5.3135, Age: 229.76, Sex: 0.692
2025-10-23 04:46:12,449 - INFO - Epoch 13, Step 100/1000 - Loss: 74.8759, Perplexity: inf, LR: 7.73e-05, LM: 5.2913, Age: 231.49, Sex: 0.690
2025-10-23 04:46:24,981 - INFO - Epoch 13, Step 150/1000 - Loss: 79.4679, Perplexity: inf, LR: 7.72e-05, LM: 5.3094, Age: 246.73, Sex: 0.693
2025-10-23 04:46:37,454 - INFO - Epoch 13, Step 200/1000 - Loss: 78.7760, Perplexity: inf, LR: 7.71e-05, LM: 5.2681, Age: 244.56, Sex: 0.697
2025-10-23 04:46:49,859 - INFO - Epoch 13, Step 250/1000 - Loss: 81.3556, Perplexity: inf, LR: 7.70e-05, LM: 5.2715, Age: 253.15, Sex: 0.698
2025-10-23 04:47:02,497 - INFO - Epoch 13, Step 300/1000 - Loss: 81.1081, Perplexity: inf, LR: 7.69e-05, LM: 5.2775, Age: 252.30, Sex: 0.700
2025-10-23 04:47:14,993 - INFO - Epoch 13, Step 350/1000 - Loss: 80.5649, Perplexity: inf, LR: 7.68e-05, LM: 5.2694, Age: 250.52, Sex: 0.703
2025-10-23 04:47:27,621 - INFO - Epoch 13, Step 400/1000 - Loss: 79.6991, Perplexity: inf, LR: 7.67e-05, LM: 5.2542, Age: 247.68, Sex: 0.705
2025-10-23 04:47:39,755 - INFO - Epoch 13, Step 450/1000 - Loss: 78.9290, Perplexity: inf, LR: 7.66e-05, LM: 5.2436, Age: 245.15, Sex: 0.703
2025-10-23 04:47:52,408 - INFO - Epoch 13, Step 500/1000 - Loss: 79.0745, Perplexity: inf, LR: 7.65e-05, LM: 5.2407, Age: 245.64, Sex: 0.702
2025-10-23 04:48:04,404 - INFO - Epoch 13, Step 550/1000 - Loss: 79.6025, Perplexity: inf, LR: 7.64e-05, LM: 5.2484, Age: 247.38, Sex: 0.701
2025-10-23 04:48:16,742 - INFO - Epoch 13, Step 600/1000 - Loss: 79.1241, Perplexity: inf, LR: 7.63e-05, LM: 5.2524, Age: 245.77, Sex: 0.701
2025-10-23 04:48:29,033 - INFO - Epoch 13, Step 650/1000 - Loss: 79.5454, Perplexity: inf, LR: 7.62e-05, LM: 5.2623, Age: 247.14, Sex: 0.700
2025-10-23 04:48:41,769 - INFO - Epoch 13, Step 700/1000 - Loss: 78.7597, Perplexity: inf, LR: 7.61e-05, LM: 5.2572, Age: 244.54, Sex: 0.697
2025-10-23 04:48:54,245 - INFO - Epoch 13, Step 750/1000 - Loss: 78.8717, Perplexity: inf, LR: 7.60e-05, LM: 5.2534, Age: 244.93, Sex: 0.698
2025-10-23 04:49:06,489 - INFO - Epoch 13, Step 800/1000 - Loss: 78.3406, Perplexity: inf, LR: 7.59e-05, LM: 5.2443, Age: 243.19, Sex: 0.698
2025-10-23 04:49:19,007 - INFO - Epoch 13, Step 850/1000 - Loss: 78.4643, Perplexity: inf, LR: 7.58e-05, LM: 5.2412, Age: 243.61, Sex: 0.697
2025-10-23 04:49:31,350 - INFO - Epoch 13, Step 900/1000 - Loss: 78.5514, Perplexity: inf, LR: 7.57e-05, LM: 5.2416, Age: 243.90, Sex: 0.697
2025-10-23 04:49:43,608 - INFO - Epoch 13, Step 950/1000 - Loss: 78.3880, Perplexity: inf, LR: 7.56e-05, LM: 5.2435, Age: 243.35, Sex: 0.696
2025-10-23 04:49:56,411 - INFO - Epoch 13, Step 1000/1000 - Loss: 78.4455, Perplexity: inf, LR: 7.55e-05, LM: 5.2439, Age: 243.54, Sex: 0.696
2025-10-23 04:49:56,412 - INFO - Epoch 13 Complete - Avg Loss: 78.4455, Avg Perplexity: inf, LM: 5.2439, Age: 243.54, Sex: 0.696
2025-10-23 04:50:16,253 - INFO - Validation - Loss: 5.3045, Perplexity: 235.8437, Token Accuracy: 0.1051, Code Accuracy: 0.0000
2025-10-23 04:50:16,254 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:50:19,630 - INFO - TPL computed on 351 samples: 266.0509
2025-10-23 04:50:19,630 - INFO - Temporal Perplexity (TPL): 266.0509
2025-10-23 04:50:32,227 - INFO - Epoch 14, Step 50/1000 - Loss: 75.8045, Perplexity: inf, LR: 7.54e-05, LM: 5.2011, Age: 234.88, Sex: 0.698
2025-10-23 04:50:44,458 - INFO - Epoch 14, Step 100/1000 - Loss: 74.6232, Perplexity: inf, LR: 7.53e-05, LM: 5.2139, Age: 230.90, Sex: 0.695
2025-10-23 04:50:57,087 - INFO - Epoch 14, Step 150/1000 - Loss: 76.3838, Perplexity: inf, LR: 7.52e-05, LM: 5.1561, Age: 236.96, Sex: 0.699
2025-10-23 04:51:09,514 - INFO - Epoch 14, Step 200/1000 - Loss: 77.2621, Perplexity: inf, LR: 7.51e-05, LM: 5.1640, Age: 239.86, Sex: 0.697
2025-10-23 04:51:21,862 - INFO - Epoch 14, Step 250/1000 - Loss: 79.5344, Perplexity: inf, LR: 7.50e-05, LM: 5.2225, Age: 247.21, Sex: 0.742
2025-10-23 04:51:34,328 - INFO - Epoch 14, Step 300/1000 - Loss: 78.8458, Perplexity: inf, LR: 7.49e-05, LM: 5.2309, Age: 244.88, Sex: 0.751
2025-10-23 04:51:46,531 - INFO - Epoch 14, Step 350/1000 - Loss: 78.5243, Perplexity: inf, LR: 7.48e-05, LM: 5.2344, Age: 243.80, Sex: 0.749
2025-10-23 04:51:59,144 - INFO - Epoch 14, Step 400/1000 - Loss: 79.8770, Perplexity: inf, LR: 7.47e-05, LM: 5.2441, Age: 248.28, Sex: 0.742
2025-10-23 04:52:11,494 - INFO - Epoch 14, Step 450/1000 - Loss: 79.4837, Perplexity: inf, LR: 7.46e-05, LM: 5.2309, Age: 247.02, Sex: 0.737
2025-10-23 04:52:24,134 - INFO - Epoch 14, Step 500/1000 - Loss: 78.5067, Perplexity: inf, LR: 7.45e-05, LM: 5.2372, Age: 243.74, Sex: 0.733
2025-10-23 04:52:36,745 - INFO - Epoch 14, Step 550/1000 - Loss: 78.1048, Perplexity: inf, LR: 7.44e-05, LM: 5.2319, Age: 242.42, Sex: 0.729
2025-10-23 04:52:49,289 - INFO - Epoch 14, Step 600/1000 - Loss: 78.7463, Perplexity: inf, LR: 7.43e-05, LM: 5.2314, Age: 244.57, Sex: 0.726
2025-10-23 04:53:01,617 - INFO - Epoch 14, Step 650/1000 - Loss: 78.1256, Perplexity: inf, LR: 7.42e-05, LM: 5.2257, Age: 242.52, Sex: 0.722
2025-10-23 04:53:13,993 - INFO - Epoch 14, Step 700/1000 - Loss: 78.5908, Perplexity: inf, LR: 7.41e-05, LM: 5.2293, Age: 244.06, Sex: 0.719
2025-10-23 04:53:26,645 - INFO - Epoch 14, Step 750/1000 - Loss: 78.5102, Perplexity: inf, LR: 7.40e-05, LM: 5.2262, Age: 243.80, Sex: 0.717
2025-10-23 04:53:39,146 - INFO - Epoch 14, Step 800/1000 - Loss: 78.8359, Perplexity: inf, LR: 7.39e-05, LM: 5.2310, Age: 244.87, Sex: 0.716
2025-10-23 04:53:51,640 - INFO - Epoch 14, Step 850/1000 - Loss: 78.6030, Perplexity: inf, LR: 7.38e-05, LM: 5.2356, Age: 244.08, Sex: 0.715
2025-10-23 04:54:04,004 - INFO - Epoch 14, Step 900/1000 - Loss: 78.9016, Perplexity: inf, LR: 7.37e-05, LM: 5.2383, Age: 245.07, Sex: 0.713
2025-10-23 04:54:16,274 - INFO - Epoch 14, Step 950/1000 - Loss: 79.3426, Perplexity: inf, LR: 7.36e-05, LM: 5.2400, Age: 246.53, Sex: 0.712
2025-10-23 04:54:29,248 - INFO - Epoch 14, Step 1000/1000 - Loss: 79.0660, Perplexity: inf, LR: 7.35e-05, LM: 5.2438, Age: 245.60, Sex: 0.711
2025-10-23 04:54:29,249 - INFO - Epoch 14 Complete - Avg Loss: 79.0660, Avg Perplexity: inf, LM: 5.2438, Age: 245.60, Sex: 0.711
2025-10-23 04:54:48,883 - INFO - Validation - Loss: 5.2708, Perplexity: 224.9284, Token Accuracy: 0.1040, Code Accuracy: 0.0000
2025-10-23 04:54:48,884 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:54:52,257 - INFO - TPL computed on 351 samples: 257.6073
2025-10-23 04:54:52,257 - INFO - Temporal Perplexity (TPL): 257.6073
2025-10-23 04:55:04,666 - INFO - Epoch 15, Step 50/1000 - Loss: 81.7086, Perplexity: inf, LR: 7.34e-05, LM: 5.0762, Age: 254.97, Sex: 0.704
2025-10-23 04:55:17,307 - INFO - Epoch 15, Step 100/1000 - Loss: 78.4610, Perplexity: inf, LR: 7.33e-05, LM: 5.0712, Age: 244.17, Sex: 0.694
2025-10-23 04:55:29,722 - INFO - Epoch 15, Step 150/1000 - Loss: 78.2675, Perplexity: inf, LR: 7.32e-05, LM: 5.1021, Age: 243.42, Sex: 0.693
2025-10-23 04:55:41,854 - INFO - Epoch 15, Step 200/1000 - Loss: 77.5344, Perplexity: inf, LR: 7.31e-05, LM: 5.1174, Age: 240.93, Sex: 0.689
2025-10-23 04:55:54,349 - INFO - Epoch 15, Step 250/1000 - Loss: 77.8923, Perplexity: inf, LR: 7.30e-05, LM: 5.1398, Age: 242.05, Sex: 0.689
2025-10-23 04:56:06,760 - INFO - Epoch 15, Step 300/1000 - Loss: 79.4670, Perplexity: inf, LR: 7.29e-05, LM: 5.1597, Age: 247.23, Sex: 0.688
2025-10-23 04:56:19,215 - INFO - Epoch 15, Step 350/1000 - Loss: 80.5579, Perplexity: inf, LR: 7.28e-05, LM: 5.1730, Age: 250.82, Sex: 0.688
2025-10-23 04:56:31,858 - INFO - Epoch 15, Step 400/1000 - Loss: 80.0911, Perplexity: inf, LR: 7.27e-05, LM: 5.1786, Age: 249.25, Sex: 0.686
2025-10-23 04:56:43,653 - INFO - Epoch 15, Step 450/1000 - Loss: 79.9039, Perplexity: inf, LR: 7.26e-05, LM: 5.1775, Age: 248.63, Sex: 0.690
2025-10-23 04:56:56,114 - INFO - Epoch 15, Step 500/1000 - Loss: 78.6514, Perplexity: inf, LR: 7.24e-05, LM: 5.1643, Age: 244.50, Sex: 0.690
2025-10-23 04:57:08,941 - INFO - Epoch 15, Step 550/1000 - Loss: 78.6938, Perplexity: inf, LR: 7.23e-05, LM: 5.1756, Age: 244.60, Sex: 0.691
2025-10-23 04:57:21,556 - INFO - Epoch 15, Step 600/1000 - Loss: 78.7450, Perplexity: inf, LR: 7.22e-05, LM: 5.1827, Age: 244.75, Sex: 0.691
2025-10-23 04:57:34,008 - INFO - Epoch 15, Step 650/1000 - Loss: 79.1533, Perplexity: inf, LR: 7.21e-05, LM: 5.1820, Age: 246.11, Sex: 0.690
2025-10-23 04:57:46,256 - INFO - Epoch 15, Step 700/1000 - Loss: 79.8195, Perplexity: inf, LR: 7.20e-05, LM: 5.1854, Age: 248.32, Sex: 0.690
2025-10-23 04:57:58,422 - INFO - Epoch 15, Step 750/1000 - Loss: 79.7606, Perplexity: inf, LR: 7.19e-05, LM: 5.1867, Age: 248.12, Sex: 0.690
2025-10-23 04:58:11,003 - INFO - Epoch 15, Step 800/1000 - Loss: 79.4803, Perplexity: inf, LR: 7.18e-05, LM: 5.1905, Age: 247.17, Sex: 0.690
2025-10-23 04:58:23,448 - INFO - Epoch 15, Step 850/1000 - Loss: 79.4848, Perplexity: inf, LR: 7.17e-05, LM: 5.1916, Age: 247.18, Sex: 0.691
2025-10-23 04:58:35,937 - INFO - Epoch 15, Step 900/1000 - Loss: 78.9495, Perplexity: inf, LR: 7.16e-05, LM: 5.1885, Age: 245.41, Sex: 0.691
2025-10-23 04:58:48,619 - INFO - Epoch 15, Step 950/1000 - Loss: 78.8529, Perplexity: inf, LR: 7.15e-05, LM: 5.1903, Age: 245.08, Sex: 0.691
2025-10-23 04:59:00,945 - INFO - Epoch 15, Step 1000/1000 - Loss: 78.6533, Perplexity: inf, LR: 7.14e-05, LM: 5.1933, Age: 244.41, Sex: 0.691
2025-10-23 04:59:00,946 - INFO - Epoch 15 Complete - Avg Loss: 78.6533, Avg Perplexity: inf, LM: 5.1933, Age: 244.41, Sex: 0.691
2025-10-23 04:59:21,034 - INFO - Validation - Loss: 5.3269, Perplexity: 237.0760, Token Accuracy: 0.0889, Code Accuracy: 0.0000
2025-10-23 04:59:21,035 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 04:59:24,407 - INFO - TPL computed on 351 samples: 261.7164
2025-10-23 04:59:24,407 - INFO - Temporal Perplexity (TPL): 261.7164
2025-10-23 04:59:26,562 - INFO - Checkpoint saved: epoch 15
2025-10-23 04:59:39,062 - INFO - Epoch 16, Step 50/1000 - Loss: 83.0692, Perplexity: inf, LR: 7.13e-05, LM: 5.1942, Age: 259.12, Sex: 0.692
2025-10-23 04:59:51,378 - INFO - Epoch 16, Step 100/1000 - Loss: 87.0759, Perplexity: inf, LR: 7.12e-05, LM: 5.1886, Age: 272.50, Sex: 0.687
2025-10-23 05:00:03,825 - INFO - Epoch 16, Step 150/1000 - Loss: 85.5001, Perplexity: inf, LR: 7.11e-05, LM: 5.1855, Age: 267.25, Sex: 0.690
2025-10-23 05:00:16,278 - INFO - Epoch 16, Step 200/1000 - Loss: 82.4692, Perplexity: inf, LR: 7.10e-05, LM: 5.2104, Age: 257.07, Sex: 0.690
2025-10-23 05:00:28,583 - INFO - Epoch 16, Step 250/1000 - Loss: 79.4940, Perplexity: inf, LR: 7.09e-05, LM: 5.2309, Age: 247.08, Sex: 0.690
2025-10-23 05:00:40,941 - INFO - Epoch 16, Step 300/1000 - Loss: 78.3158, Perplexity: inf, LR: 7.08e-05, LM: 5.2261, Age: 243.17, Sex: 0.687
2025-10-23 05:00:53,289 - INFO - Epoch 16, Step 350/1000 - Loss: 80.0506, Perplexity: inf, LR: 7.07e-05, LM: 5.2138, Age: 249.00, Sex: 0.688
2025-10-23 05:01:06,140 - INFO - Epoch 16, Step 400/1000 - Loss: 80.1073, Perplexity: inf, LR: 7.06e-05, LM: 5.2231, Age: 249.15, Sex: 0.689
2025-10-23 05:01:19,205 - INFO - Epoch 16, Step 450/1000 - Loss: 80.4907, Perplexity: inf, LR: 7.05e-05, LM: 5.2346, Age: 250.39, Sex: 0.690
2025-10-23 05:01:31,664 - INFO - Epoch 16, Step 500/1000 - Loss: 79.7370, Perplexity: inf, LR: 7.04e-05, LM: 5.2318, Age: 247.89, Sex: 0.690
2025-10-23 05:01:44,331 - INFO - Epoch 16, Step 550/1000 - Loss: 80.0004, Perplexity: inf, LR: 7.03e-05, LM: 5.2291, Age: 248.78, Sex: 0.691
2025-10-23 05:01:57,170 - INFO - Epoch 16, Step 600/1000 - Loss: 80.0493, Perplexity: inf, LR: 7.02e-05, LM: 5.2281, Age: 248.94, Sex: 0.690
2025-10-23 05:02:09,619 - INFO - Epoch 16, Step 650/1000 - Loss: 79.0398, Perplexity: inf, LR: 7.01e-05, LM: 5.2153, Age: 245.62, Sex: 0.691
2025-10-23 05:02:21,941 - INFO - Epoch 16, Step 700/1000 - Loss: 78.9530, Perplexity: inf, LR: 7.00e-05, LM: 5.2157, Age: 245.33, Sex: 0.691
2025-10-23 05:02:34,318 - INFO - Epoch 16, Step 750/1000 - Loss: 79.1726, Perplexity: inf, LR: 6.99e-05, LM: 5.2167, Age: 246.06, Sex: 0.691
2025-10-23 05:02:46,948 - INFO - Epoch 16, Step 800/1000 - Loss: 78.9683, Perplexity: inf, LR: 6.98e-05, LM: 5.2217, Age: 245.36, Sex: 0.691
2025-10-23 05:02:59,898 - INFO - Epoch 16, Step 850/1000 - Loss: 78.7910, Perplexity: inf, LR: 6.97e-05, LM: 5.2265, Age: 244.75, Sex: 0.691
2025-10-23 05:03:12,660 - INFO - Epoch 16, Step 900/1000 - Loss: 78.9012, Perplexity: inf, LR: 6.96e-05, LM: 5.2310, Age: 245.11, Sex: 0.691
2025-10-23 05:03:25,330 - INFO - Epoch 16, Step 950/1000 - Loss: 78.8075, Perplexity: inf, LR: 6.95e-05, LM: 5.2337, Age: 244.79, Sex: 0.691
2025-10-23 05:03:37,493 - INFO - Epoch 16, Step 1000/1000 - Loss: 79.4388, Perplexity: inf, LR: 6.94e-05, LM: 5.2334, Age: 246.89, Sex: 0.691
2025-10-23 05:03:37,494 - INFO - Epoch 16 Complete - Avg Loss: 79.4388, Avg Perplexity: inf, LM: 5.2334, Age: 246.89, Sex: 0.691
2025-10-23 05:03:57,188 - INFO - Validation - Loss: 5.2855, Perplexity: 229.8408, Token Accuracy: 0.0910, Code Accuracy: 0.0000
2025-10-23 05:03:57,189 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:04:00,546 - INFO - TPL computed on 351 samples: 256.3302
2025-10-23 05:04:00,546 - INFO - Temporal Perplexity (TPL): 256.3302
2025-10-23 05:04:13,238 - INFO - Epoch 17, Step 50/1000 - Loss: 79.6198, Perplexity: inf, LR: 6.93e-05, LM: 5.1912, Age: 247.65, Sex: 0.675
2025-10-23 05:04:25,960 - INFO - Epoch 17, Step 100/1000 - Loss: 79.6814, Perplexity: inf, LR: 6.92e-05, LM: 5.2473, Age: 247.66, Sex: 0.678
2025-10-23 05:04:38,795 - INFO - Epoch 17, Step 150/1000 - Loss: 79.0306, Perplexity: inf, LR: 6.91e-05, LM: 5.2998, Age: 245.31, Sex: 0.684
2025-10-23 05:04:51,160 - INFO - Epoch 17, Step 200/1000 - Loss: 80.7424, Perplexity: inf, LR: 6.90e-05, LM: 5.2624, Age: 251.14, Sex: 0.690
2025-10-23 05:05:04,004 - INFO - Epoch 17, Step 250/1000 - Loss: 79.7441, Perplexity: inf, LR: 6.89e-05, LM: 5.2508, Age: 247.85, Sex: 0.688
2025-10-23 05:05:16,575 - INFO - Epoch 17, Step 300/1000 - Loss: 78.3001, Perplexity: inf, LR: 6.88e-05, LM: 5.2297, Age: 243.11, Sex: 0.693
2025-10-23 05:05:29,080 - INFO - Epoch 17, Step 350/1000 - Loss: 80.5288, Perplexity: inf, LR: 6.87e-05, LM: 5.2463, Age: 250.48, Sex: 0.692
2025-10-23 05:05:41,422 - INFO - Epoch 17, Step 400/1000 - Loss: 80.1076, Perplexity: inf, LR: 6.86e-05, LM: 5.2462, Age: 249.08, Sex: 0.693
2025-10-23 05:05:53,801 - INFO - Epoch 17, Step 450/1000 - Loss: 79.6715, Perplexity: inf, LR: 6.85e-05, LM: 5.2463, Age: 247.62, Sex: 0.693
2025-10-23 05:06:06,339 - INFO - Epoch 17, Step 500/1000 - Loss: 79.9690, Perplexity: inf, LR: 6.84e-05, LM: 5.2359, Age: 248.65, Sex: 0.692
2025-10-23 05:06:18,799 - INFO - Epoch 17, Step 550/1000 - Loss: 79.7522, Perplexity: inf, LR: 6.83e-05, LM: 5.2314, Age: 247.94, Sex: 0.692
2025-10-23 05:06:31,221 - INFO - Epoch 17, Step 600/1000 - Loss: 79.6753, Perplexity: inf, LR: 6.82e-05, LM: 5.2309, Age: 247.69, Sex: 0.693
2025-10-23 05:06:43,659 - INFO - Epoch 17, Step 650/1000 - Loss: 79.6103, Perplexity: inf, LR: 6.81e-05, LM: 5.2348, Age: 247.46, Sex: 0.692
2025-10-23 05:06:56,243 - INFO - Epoch 17, Step 700/1000 - Loss: 79.1121, Perplexity: inf, LR: 6.80e-05, LM: 5.2357, Age: 245.79, Sex: 0.690
2025-10-23 05:07:08,710 - INFO - Epoch 17, Step 750/1000 - Loss: 79.1071, Perplexity: inf, LR: 6.79e-05, LM: 5.2357, Age: 245.78, Sex: 0.690
2025-10-23 05:07:21,309 - INFO - Epoch 17, Step 800/1000 - Loss: 78.9812, Perplexity: inf, LR: 6.78e-05, LM: 5.2313, Age: 245.37, Sex: 0.690
2025-10-23 05:07:33,827 - INFO - Epoch 17, Step 850/1000 - Loss: 79.1430, Perplexity: inf, LR: 6.77e-05, LM: 5.2316, Age: 245.91, Sex: 0.690
2025-10-23 05:07:46,085 - INFO - Epoch 17, Step 900/1000 - Loss: 79.1034, Perplexity: inf, LR: 6.76e-05, LM: 5.2322, Age: 245.78, Sex: 0.692
2025-10-23 05:07:58,567 - INFO - Epoch 17, Step 950/1000 - Loss: 78.9749, Perplexity: inf, LR: 6.74e-05, LM: 5.2348, Age: 245.34, Sex: 0.693
2025-10-23 05:08:10,925 - INFO - Epoch 17, Step 1000/1000 - Loss: 78.6905, Perplexity: inf, LR: 6.73e-05, LM: 5.2358, Age: 244.39, Sex: 0.693
2025-10-23 05:08:10,926 - INFO - Epoch 17 Complete - Avg Loss: 78.6905, Avg Perplexity: inf, LM: 5.2358, Age: 244.39, Sex: 0.693
2025-10-23 05:08:30,628 - INFO - Validation - Loss: 5.3035, Perplexity: 231.7808, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 05:08:30,630 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:08:33,990 - INFO - TPL computed on 351 samples: 257.3114
2025-10-23 05:08:33,990 - INFO - Temporal Perplexity (TPL): 257.3114
2025-10-23 05:08:46,448 - INFO - Epoch 18, Step 50/1000 - Loss: 80.1331, Perplexity: inf, LR: 6.72e-05, LM: 5.2243, Age: 249.23, Sex: 0.705
2025-10-23 05:08:58,589 - INFO - Epoch 18, Step 100/1000 - Loss: 82.2662, Perplexity: inf, LR: 6.71e-05, LM: 5.2228, Age: 256.35, Sex: 0.692
2025-10-23 05:09:10,864 - INFO - Epoch 18, Step 150/1000 - Loss: 77.5394, Perplexity: inf, LR: 6.70e-05, LM: 5.1994, Age: 240.68, Sex: 0.687
2025-10-23 05:09:23,163 - INFO - Epoch 18, Step 200/1000 - Loss: 80.1904, Perplexity: inf, LR: 6.69e-05, LM: 5.2130, Age: 249.46, Sex: 0.692
2025-10-23 05:09:35,524 - INFO - Epoch 18, Step 250/1000 - Loss: 79.7101, Perplexity: inf, LR: 6.68e-05, LM: 5.2057, Age: 247.89, Sex: 0.689
2025-10-23 05:09:48,383 - INFO - Epoch 18, Step 300/1000 - Loss: 78.9910, Perplexity: inf, LR: 6.67e-05, LM: 5.2090, Age: 245.48, Sex: 0.692
2025-10-23 05:10:00,591 - INFO - Epoch 18, Step 350/1000 - Loss: 79.4321, Perplexity: inf, LR: 6.66e-05, LM: 5.2115, Age: 246.94, Sex: 0.692
2025-10-23 05:10:13,161 - INFO - Epoch 18, Step 400/1000 - Loss: 79.7962, Perplexity: inf, LR: 6.65e-05, LM: 5.2052, Age: 248.17, Sex: 0.693
2025-10-23 05:10:25,401 - INFO - Epoch 18, Step 450/1000 - Loss: 78.9806, Perplexity: inf, LR: 6.64e-05, LM: 5.2096, Age: 245.44, Sex: 0.693
2025-10-23 05:10:37,852 - INFO - Epoch 18, Step 500/1000 - Loss: 78.7723, Perplexity: inf, LR: 6.63e-05, LM: 5.2163, Age: 244.73, Sex: 0.692
2025-10-23 05:10:50,130 - INFO - Epoch 18, Step 550/1000 - Loss: 79.8793, Perplexity: inf, LR: 6.62e-05, LM: 5.2146, Age: 248.42, Sex: 0.691
2025-10-23 05:11:02,413 - INFO - Epoch 18, Step 600/1000 - Loss: 79.7961, Perplexity: inf, LR: 6.61e-05, LM: 5.2145, Age: 248.14, Sex: 0.691
2025-10-23 05:11:15,044 - INFO - Epoch 18, Step 650/1000 - Loss: 79.0764, Perplexity: inf, LR: 6.60e-05, LM: 5.2102, Age: 245.76, Sex: 0.691
2025-10-23 05:11:27,261 - INFO - Epoch 18, Step 700/1000 - Loss: 79.0893, Perplexity: inf, LR: 6.59e-05, LM: 5.2199, Age: 245.77, Sex: 0.692
2025-10-23 05:11:40,219 - INFO - Epoch 18, Step 750/1000 - Loss: 78.8320, Perplexity: inf, LR: 6.58e-05, LM: 5.2193, Age: 244.91, Sex: 0.693
2025-10-23 05:11:52,558 - INFO - Epoch 18, Step 800/1000 - Loss: 79.0196, Perplexity: inf, LR: 6.57e-05, LM: 5.2250, Age: 245.52, Sex: 0.694
2025-10-23 05:12:05,248 - INFO - Epoch 18, Step 850/1000 - Loss: 79.2386, Perplexity: inf, LR: 6.56e-05, LM: 5.2294, Age: 246.23, Sex: 0.694
2025-10-23 05:12:17,721 - INFO - Epoch 18, Step 900/1000 - Loss: 78.9089, Perplexity: inf, LR: 6.55e-05, LM: 5.2268, Age: 245.14, Sex: 0.693
2025-10-23 05:12:30,133 - INFO - Epoch 18, Step 950/1000 - Loss: 79.2490, Perplexity: inf, LR: 6.54e-05, LM: 5.2302, Age: 246.27, Sex: 0.694
2025-10-23 05:12:42,756 - INFO - Epoch 18, Step 1000/1000 - Loss: 79.1185, Perplexity: inf, LR: 6.53e-05, LM: 5.2289, Age: 245.84, Sex: 0.694
2025-10-23 05:12:42,757 - INFO - Epoch 18 Complete - Avg Loss: 79.1185, Avg Perplexity: inf, LM: 5.2289, Age: 245.84, Sex: 0.694
2025-10-23 05:13:02,702 - INFO - Validation - Loss: 5.3280, Perplexity: 244.6883, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 05:13:02,703 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:13:06,071 - INFO - TPL computed on 351 samples: 265.1753
2025-10-23 05:13:06,071 - INFO - Temporal Perplexity (TPL): 265.1753
2025-10-23 05:13:18,607 - INFO - Epoch 19, Step 50/1000 - Loss: 75.5157, Perplexity: inf, LR: 6.52e-05, LM: 5.1686, Age: 234.03, Sex: 0.695
2025-10-23 05:13:31,259 - INFO - Epoch 19, Step 100/1000 - Loss: 76.0058, Perplexity: inf, LR: 6.51e-05, LM: 5.2188, Age: 235.50, Sex: 0.690
2025-10-23 05:13:43,607 - INFO - Epoch 19, Step 150/1000 - Loss: 75.9948, Perplexity: inf, LR: 6.50e-05, LM: 5.1999, Age: 235.53, Sex: 0.686
2025-10-23 05:13:56,667 - INFO - Epoch 19, Step 200/1000 - Loss: 77.6068, Perplexity: inf, LR: 6.49e-05, LM: 5.2171, Age: 240.84, Sex: 0.686
2025-10-23 05:14:09,254 - INFO - Epoch 19, Step 250/1000 - Loss: 78.5447, Perplexity: inf, LR: 6.48e-05, LM: 5.2235, Age: 243.95, Sex: 0.688
2025-10-23 05:14:21,722 - INFO - Epoch 19, Step 300/1000 - Loss: 77.9301, Perplexity: inf, LR: 6.47e-05, LM: 5.2149, Age: 241.93, Sex: 0.687
2025-10-23 05:14:34,317 - INFO - Epoch 19, Step 350/1000 - Loss: 80.0471, Perplexity: inf, LR: 6.46e-05, LM: 5.2299, Age: 248.93, Sex: 0.687
2025-10-23 05:14:46,780 - INFO - Epoch 19, Step 400/1000 - Loss: 78.8437, Perplexity: inf, LR: 6.45e-05, LM: 5.2131, Age: 244.98, Sex: 0.689
2025-10-23 05:14:59,405 - INFO - Epoch 19, Step 450/1000 - Loss: 78.9440, Perplexity: inf, LR: 6.44e-05, LM: 5.2246, Age: 245.27, Sex: 0.690
2025-10-23 05:15:12,253 - INFO - Epoch 19, Step 500/1000 - Loss: 79.9959, Perplexity: inf, LR: 6.43e-05, LM: 5.2358, Age: 248.74, Sex: 0.689
2025-10-23 05:15:24,577 - INFO - Epoch 19, Step 550/1000 - Loss: 79.4457, Perplexity: inf, LR: 6.42e-05, LM: 5.2360, Age: 246.91, Sex: 0.690
2025-10-23 05:15:37,090 - INFO - Epoch 19, Step 600/1000 - Loss: 79.5340, Perplexity: inf, LR: 6.41e-05, LM: 5.2361, Age: 247.20, Sex: 0.689
2025-10-23 05:15:49,551 - INFO - Epoch 19, Step 650/1000 - Loss: 79.1664, Perplexity: inf, LR: 6.40e-05, LM: 5.2351, Age: 245.98, Sex: 0.690
2025-10-23 05:16:01,901 - INFO - Epoch 19, Step 700/1000 - Loss: 78.8230, Perplexity: inf, LR: 6.39e-05, LM: 5.2372, Age: 244.83, Sex: 0.691
2025-10-23 05:16:14,454 - INFO - Epoch 19, Step 750/1000 - Loss: 79.2299, Perplexity: inf, LR: 6.38e-05, LM: 5.2376, Age: 246.18, Sex: 0.692
2025-10-23 05:16:26,948 - INFO - Epoch 19, Step 800/1000 - Loss: 78.7841, Perplexity: inf, LR: 6.37e-05, LM: 5.2314, Age: 244.71, Sex: 0.692
2025-10-23 05:16:39,495 - INFO - Epoch 19, Step 850/1000 - Loss: 78.9244, Perplexity: inf, LR: 6.36e-05, LM: 5.2288, Age: 245.19, Sex: 0.692
2025-10-23 05:16:51,820 - INFO - Epoch 19, Step 900/1000 - Loss: 78.8840, Perplexity: inf, LR: 6.35e-05, LM: 5.2374, Age: 245.03, Sex: 0.691
2025-10-23 05:17:03,975 - INFO - Epoch 19, Step 950/1000 - Loss: 79.3617, Perplexity: inf, LR: 6.34e-05, LM: 5.2342, Age: 246.63, Sex: 0.691
2025-10-23 05:17:16,546 - INFO - Epoch 19, Step 1000/1000 - Loss: 79.0227, Perplexity: inf, LR: 6.33e-05, LM: 5.2320, Age: 245.51, Sex: 0.690
2025-10-23 05:17:16,547 - INFO - Epoch 19 Complete - Avg Loss: 79.0227, Avg Perplexity: inf, LM: 5.2320, Age: 245.51, Sex: 0.690
2025-10-23 05:17:36,264 - INFO - Validation - Loss: 5.3209, Perplexity: 245.8377, Token Accuracy: 0.0949, Code Accuracy: 0.0000
2025-10-23 05:17:36,266 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:17:39,645 - INFO - TPL computed on 351 samples: 258.5122
2025-10-23 05:17:39,645 - INFO - Temporal Perplexity (TPL): 258.5122
2025-10-23 05:17:51,716 - INFO - Epoch 20, Step 50/1000 - Loss: 78.1472, Perplexity: inf, LR: 6.32e-05, LM: 5.1215, Age: 242.95, Sex: 0.702
2025-10-23 05:18:04,332 - INFO - Epoch 20, Step 100/1000 - Loss: 82.6273, Perplexity: inf, LR: 6.31e-05, LM: 5.1823, Age: 257.68, Sex: 0.702
2025-10-23 05:18:16,905 - INFO - Epoch 20, Step 150/1000 - Loss: 82.7292, Perplexity: inf, LR: 6.30e-05, LM: 5.2002, Age: 257.96, Sex: 0.697
2025-10-23 05:18:29,310 - INFO - Epoch 20, Step 200/1000 - Loss: 81.3005, Perplexity: inf, LR: 6.29e-05, LM: 5.2188, Age: 253.14, Sex: 0.695
2025-10-23 05:18:42,068 - INFO - Epoch 20, Step 250/1000 - Loss: 81.4354, Perplexity: inf, LR: 6.28e-05, LM: 5.2296, Age: 253.56, Sex: 0.694
2025-10-23 05:18:54,617 - INFO - Epoch 20, Step 300/1000 - Loss: 80.6738, Perplexity: inf, LR: 6.27e-05, LM: 5.2292, Age: 251.02, Sex: 0.692
2025-10-23 05:19:07,404 - INFO - Epoch 20, Step 350/1000 - Loss: 81.6838, Perplexity: inf, LR: 6.26e-05, LM: 5.2460, Age: 254.33, Sex: 0.692
2025-10-23 05:19:19,957 - INFO - Epoch 20, Step 400/1000 - Loss: 80.1030, Perplexity: inf, LR: 6.24e-05, LM: 5.2388, Age: 249.09, Sex: 0.692
2025-10-23 05:19:32,229 - INFO - Epoch 20, Step 450/1000 - Loss: 79.5829, Perplexity: inf, LR: 6.23e-05, LM: 5.2378, Age: 247.36, Sex: 0.691
2025-10-23 05:19:44,452 - INFO - Epoch 20, Step 500/1000 - Loss: 79.3633, Perplexity: inf, LR: 6.22e-05, LM: 5.2354, Age: 246.63, Sex: 0.690
2025-10-23 05:19:56,912 - INFO - Epoch 20, Step 550/1000 - Loss: 79.7519, Perplexity: inf, LR: 6.21e-05, LM: 5.2419, Age: 247.91, Sex: 0.690
2025-10-23 05:20:09,021 - INFO - Epoch 20, Step 600/1000 - Loss: 79.5497, Perplexity: inf, LR: 6.20e-05, LM: 5.2298, Age: 247.27, Sex: 0.690
2025-10-23 05:20:21,351 - INFO - Epoch 20, Step 650/1000 - Loss: 79.6469, Perplexity: inf, LR: 6.19e-05, LM: 5.2238, Age: 247.62, Sex: 0.690
2025-10-23 05:20:33,789 - INFO - Epoch 20, Step 700/1000 - Loss: 79.4278, Perplexity: inf, LR: 6.18e-05, LM: 5.2292, Age: 246.87, Sex: 0.692
2025-10-23 05:20:46,277 - INFO - Epoch 20, Step 750/1000 - Loss: 79.9972, Perplexity: inf, LR: 6.17e-05, LM: 5.2248, Age: 248.78, Sex: 0.692
2025-10-23 05:20:58,963 - INFO - Epoch 20, Step 800/1000 - Loss: 79.8445, Perplexity: inf, LR: 6.16e-05, LM: 5.2294, Age: 248.26, Sex: 0.691
2025-10-23 05:21:11,535 - INFO - Epoch 20, Step 850/1000 - Loss: 79.4158, Perplexity: inf, LR: 6.15e-05, LM: 5.2256, Age: 246.84, Sex: 0.691
2025-10-23 05:21:24,269 - INFO - Epoch 20, Step 900/1000 - Loss: 79.4503, Perplexity: inf, LR: 6.14e-05, LM: 5.2223, Age: 246.97, Sex: 0.690
2025-10-23 05:21:36,728 - INFO - Epoch 20, Step 950/1000 - Loss: 79.6166, Perplexity: inf, LR: 6.13e-05, LM: 5.2186, Age: 247.53, Sex: 0.691
2025-10-23 05:21:49,318 - INFO - Epoch 20, Step 1000/1000 - Loss: 79.4163, Perplexity: inf, LR: 6.12e-05, LM: 5.2218, Age: 246.85, Sex: 0.690
2025-10-23 05:21:49,319 - INFO - Epoch 20 Complete - Avg Loss: 79.4163, Avg Perplexity: inf, LM: 5.2218, Age: 246.85, Sex: 0.690
2025-10-23 05:22:09,387 - INFO - Validation - Loss: 5.3287, Perplexity: 244.3045, Token Accuracy: 0.0896, Code Accuracy: 0.0000
2025-10-23 05:22:09,388 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:22:12,757 - INFO - TPL computed on 351 samples: 258.9056
2025-10-23 05:22:12,757 - INFO - Temporal Perplexity (TPL): 258.9056
2025-10-23 05:22:14,939 - INFO - Checkpoint saved: epoch 20
2025-10-23 05:22:27,651 - INFO - Epoch 21, Step 50/1000 - Loss: 77.0487, Perplexity: inf, LR: 6.11e-05, LM: 5.2499, Age: 238.88, Sex: 0.669
2025-10-23 05:22:40,343 - INFO - Epoch 21, Step 100/1000 - Loss: 77.1141, Perplexity: inf, LR: 6.10e-05, LM: 5.2411, Age: 239.13, Sex: 0.668
2025-10-23 05:22:52,647 - INFO - Epoch 21, Step 150/1000 - Loss: 74.8141, Perplexity: inf, LR: 6.09e-05, LM: 5.2344, Age: 231.49, Sex: 0.666
2025-10-23 05:23:05,241 - INFO - Epoch 21, Step 200/1000 - Loss: 75.4957, Perplexity: inf, LR: 6.08e-05, LM: 5.2339, Age: 233.76, Sex: 0.669
2025-10-23 05:23:18,123 - INFO - Epoch 21, Step 250/1000 - Loss: 75.7917, Perplexity: inf, LR: 6.07e-05, LM: 5.2259, Age: 234.77, Sex: 0.670
2025-10-23 05:23:30,898 - INFO - Epoch 21, Step 300/1000 - Loss: 74.8553, Perplexity: inf, LR: 6.06e-05, LM: 5.2184, Age: 231.68, Sex: 0.671
2025-10-23 05:23:43,059 - INFO - Epoch 21, Step 350/1000 - Loss: 76.0843, Perplexity: inf, LR: 6.05e-05, LM: 5.2003, Age: 235.83, Sex: 0.672
2025-10-23 05:23:55,453 - INFO - Epoch 21, Step 400/1000 - Loss: 77.2807, Perplexity: inf, LR: 6.04e-05, LM: 5.2101, Age: 239.79, Sex: 0.672
2025-10-23 05:24:07,924 - INFO - Epoch 21, Step 450/1000 - Loss: 77.9371, Perplexity: inf, LR: 6.03e-05, LM: 5.2047, Age: 241.99, Sex: 0.673
2025-10-23 05:24:20,143 - INFO - Epoch 21, Step 500/1000 - Loss: 76.8689, Perplexity: inf, LR: 6.02e-05, LM: 5.1890, Age: 238.48, Sex: 0.675
2025-10-23 05:24:32,672 - INFO - Epoch 21, Step 550/1000 - Loss: 77.2178, Perplexity: inf, LR: 6.01e-05, LM: 5.1965, Age: 239.62, Sex: 0.674
2025-10-23 05:24:45,038 - INFO - Epoch 21, Step 600/1000 - Loss: 77.7099, Perplexity: inf, LR: 6.00e-05, LM: 5.2037, Age: 241.24, Sex: 0.676
2025-10-23 05:24:57,542 - INFO - Epoch 21, Step 650/1000 - Loss: 78.1251, Perplexity: inf, LR: 5.99e-05, LM: 5.2016, Age: 242.63, Sex: 0.677
2025-10-23 05:25:09,704 - INFO - Epoch 21, Step 700/1000 - Loss: 78.1562, Perplexity: inf, LR: 5.98e-05, LM: 5.2067, Age: 242.71, Sex: 0.679
2025-10-23 05:25:22,116 - INFO - Epoch 21, Step 750/1000 - Loss: 78.2906, Perplexity: inf, LR: 5.97e-05, LM: 5.2127, Age: 243.14, Sex: 0.680
2025-10-23 05:25:34,807 - INFO - Epoch 21, Step 800/1000 - Loss: 78.4150, Perplexity: inf, LR: 5.96e-05, LM: 5.2135, Age: 243.55, Sex: 0.681
2025-10-23 05:25:47,023 - INFO - Epoch 21, Step 850/1000 - Loss: 78.9256, Perplexity: inf, LR: 5.95e-05, LM: 5.2017, Age: 245.29, Sex: 0.683
2025-10-23 05:25:59,168 - INFO - Epoch 21, Step 900/1000 - Loss: 79.1466, Perplexity: inf, LR: 5.94e-05, LM: 5.1939, Age: 246.05, Sex: 0.683
2025-10-23 05:26:11,682 - INFO - Epoch 21, Step 950/1000 - Loss: 79.0438, Perplexity: inf, LR: 5.93e-05, LM: 5.1955, Age: 245.70, Sex: 0.685
2025-10-23 05:26:23,999 - INFO - Epoch 21, Step 1000/1000 - Loss: 78.6787, Perplexity: inf, LR: 5.92e-05, LM: 5.1941, Age: 244.49, Sex: 0.685
2025-10-23 05:26:24,000 - INFO - Epoch 21 Complete - Avg Loss: 78.6787, Avg Perplexity: inf, LM: 5.1941, Age: 244.49, Sex: 0.685
2025-10-23 05:26:43,829 - INFO - Validation - Loss: 5.2138, Perplexity: 217.0010, Token Accuracy: 0.1224, Code Accuracy: 0.0000
2025-10-23 05:26:43,830 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:26:47,202 - INFO - TPL computed on 351 samples: 252.4166
2025-10-23 05:26:47,202 - INFO - Temporal Perplexity (TPL): 252.4166
2025-10-23 05:26:59,640 - INFO - Epoch 22, Step 50/1000 - Loss: 84.8545, Perplexity: inf, LR: 5.91e-05, LM: 5.1287, Age: 265.28, Sex: 0.703
2025-10-23 05:27:12,072 - INFO - Epoch 22, Step 100/1000 - Loss: 79.1547, Perplexity: inf, LR: 5.90e-05, LM: 5.1265, Age: 246.29, Sex: 0.699
2025-10-23 05:27:24,768 - INFO - Epoch 22, Step 150/1000 - Loss: 77.7750, Perplexity: inf, LR: 5.89e-05, LM: 5.2040, Age: 241.44, Sex: 0.690
2025-10-23 05:27:37,156 - INFO - Epoch 22, Step 200/1000 - Loss: 79.6476, Perplexity: inf, LR: 5.88e-05, LM: 5.2064, Age: 247.69, Sex: 0.677
2025-10-23 05:27:49,894 - INFO - Epoch 22, Step 250/1000 - Loss: 77.2956, Perplexity: inf, LR: 5.87e-05, LM: 5.1968, Age: 239.88, Sex: 0.670
2025-10-23 05:28:02,239 - INFO - Epoch 22, Step 300/1000 - Loss: 79.2266, Perplexity: inf, LR: 5.86e-05, LM: 5.1911, Age: 246.34, Sex: 0.664
2025-10-23 05:28:14,810 - INFO - Epoch 22, Step 350/1000 - Loss: 79.0533, Perplexity: inf, LR: 5.85e-05, LM: 5.2024, Age: 245.73, Sex: 0.658
2025-10-23 05:28:27,346 - INFO - Epoch 22, Step 400/1000 - Loss: 79.9042, Perplexity: inf, LR: 5.84e-05, LM: 5.2031, Age: 248.57, Sex: 0.653
2025-10-23 05:28:39,943 - INFO - Epoch 22, Step 450/1000 - Loss: 79.0262, Perplexity: inf, LR: 5.83e-05, LM: 5.1964, Age: 245.67, Sex: 0.649
2025-10-23 05:28:52,518 - INFO - Epoch 22, Step 500/1000 - Loss: 79.7084, Perplexity: inf, LR: 5.82e-05, LM: 5.1993, Age: 247.93, Sex: 0.645
2025-10-23 05:29:05,028 - INFO - Epoch 22, Step 550/1000 - Loss: 80.0439, Perplexity: inf, LR: 5.81e-05, LM: 5.1988, Age: 249.06, Sex: 0.642
2025-10-23 05:29:17,296 - INFO - Epoch 22, Step 600/1000 - Loss: 80.3700, Perplexity: inf, LR: 5.80e-05, LM: 5.2049, Age: 250.12, Sex: 0.639
2025-10-23 05:29:29,541 - INFO - Epoch 22, Step 650/1000 - Loss: 80.4071, Perplexity: inf, LR: 5.79e-05, LM: 5.2127, Age: 250.22, Sex: 0.637
2025-10-23 05:29:42,035 - INFO - Epoch 22, Step 700/1000 - Loss: 79.4495, Perplexity: inf, LR: 5.78e-05, LM: 5.2073, Age: 247.05, Sex: 0.633
2025-10-23 05:29:54,629 - INFO - Epoch 22, Step 750/1000 - Loss: 79.0065, Perplexity: inf, LR: 5.77e-05, LM: 5.2124, Age: 245.56, Sex: 0.631
2025-10-23 05:30:06,992 - INFO - Epoch 22, Step 800/1000 - Loss: 78.7359, Perplexity: inf, LR: 5.76e-05, LM: 5.2186, Age: 244.64, Sex: 0.629
2025-10-23 05:30:19,496 - INFO - Epoch 22, Step 850/1000 - Loss: 78.1735, Perplexity: inf, LR: 5.74e-05, LM: 5.2198, Age: 242.76, Sex: 0.628
2025-10-23 05:30:32,041 - INFO - Epoch 22, Step 900/1000 - Loss: 77.9696, Perplexity: inf, LR: 5.73e-05, LM: 5.2179, Age: 242.09, Sex: 0.626
2025-10-23 05:30:44,509 - INFO - Epoch 22, Step 950/1000 - Loss: 77.9001, Perplexity: inf, LR: 5.72e-05, LM: 5.2188, Age: 241.85, Sex: 0.625
2025-10-23 05:30:56,814 - INFO - Epoch 22, Step 1000/1000 - Loss: 77.9734, Perplexity: inf, LR: 5.71e-05, LM: 5.2265, Age: 242.07, Sex: 0.623
2025-10-23 05:30:56,815 - INFO - Epoch 22 Complete - Avg Loss: 77.9734, Avg Perplexity: inf, LM: 5.2265, Age: 242.07, Sex: 0.623
2025-10-23 05:31:16,559 - INFO - Validation - Loss: 5.3132, Perplexity: 234.9365, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 05:31:16,561 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:31:19,935 - INFO - TPL computed on 351 samples: 256.1116
2025-10-23 05:31:19,935 - INFO - Temporal Perplexity (TPL): 256.1116
2025-10-23 05:31:32,405 - INFO - Epoch 23, Step 50/1000 - Loss: 78.0362, Perplexity: inf, LR: 5.70e-05, LM: 5.1678, Age: 242.50, Sex: 0.594
2025-10-23 05:31:45,158 - INFO - Epoch 23, Step 100/1000 - Loss: 79.8931, Perplexity: inf, LR: 5.69e-05, LM: 5.2221, Age: 248.51, Sex: 0.589
2025-10-23 05:31:57,917 - INFO - Epoch 23, Step 150/1000 - Loss: 78.7946, Perplexity: inf, LR: 5.68e-05, LM: 5.2396, Age: 244.79, Sex: 0.591
2025-10-23 05:32:10,090 - INFO - Epoch 23, Step 200/1000 - Loss: 81.2728, Perplexity: inf, LR: 5.67e-05, LM: 5.2302, Age: 253.09, Sex: 0.583
2025-10-23 05:32:22,971 - INFO - Epoch 23, Step 250/1000 - Loss: 80.2481, Perplexity: inf, LR: 5.66e-05, LM: 5.2233, Age: 249.69, Sex: 0.584
2025-10-23 05:32:35,765 - INFO - Epoch 23, Step 300/1000 - Loss: 81.0759, Perplexity: inf, LR: 5.65e-05, LM: 5.2315, Age: 252.42, Sex: 0.585
2025-10-23 05:32:48,189 - INFO - Epoch 23, Step 350/1000 - Loss: 80.6344, Perplexity: inf, LR: 5.64e-05, LM: 5.2242, Age: 250.98, Sex: 0.584
2025-10-23 05:33:00,657 - INFO - Epoch 23, Step 400/1000 - Loss: 79.2900, Perplexity: inf, LR: 5.63e-05, LM: 5.2119, Age: 246.54, Sex: 0.584
2025-10-23 05:33:13,073 - INFO - Epoch 23, Step 450/1000 - Loss: 78.4957, Perplexity: inf, LR: 5.62e-05, LM: 5.1998, Age: 243.93, Sex: 0.584
2025-10-23 05:33:25,861 - INFO - Epoch 23, Step 500/1000 - Loss: 77.6733, Perplexity: inf, LR: 5.61e-05, LM: 5.2029, Age: 241.18, Sex: 0.584
2025-10-23 05:33:38,540 - INFO - Epoch 23, Step 550/1000 - Loss: 78.3886, Perplexity: inf, LR: 5.60e-05, LM: 5.2065, Age: 243.55, Sex: 0.584
2025-10-23 05:33:51,152 - INFO - Epoch 23, Step 600/1000 - Loss: 78.4307, Perplexity: inf, LR: 5.59e-05, LM: 5.2072, Age: 243.69, Sex: 0.583
2025-10-23 05:34:03,590 - INFO - Epoch 23, Step 650/1000 - Loss: 78.3732, Perplexity: inf, LR: 5.58e-05, LM: 5.2093, Age: 243.49, Sex: 0.582
2025-10-23 05:34:16,197 - INFO - Epoch 23, Step 700/1000 - Loss: 78.2939, Perplexity: inf, LR: 5.57e-05, LM: 5.2069, Age: 243.24, Sex: 0.582
2025-10-23 05:34:28,446 - INFO - Epoch 23, Step 750/1000 - Loss: 78.0321, Perplexity: inf, LR: 5.56e-05, LM: 5.2144, Age: 242.34, Sex: 0.583
2025-10-23 05:34:40,877 - INFO - Epoch 23, Step 800/1000 - Loss: 77.9113, Perplexity: inf, LR: 5.55e-05, LM: 5.2118, Age: 241.94, Sex: 0.581
2025-10-23 05:34:52,878 - INFO - Epoch 23, Step 850/1000 - Loss: 78.0857, Perplexity: inf, LR: 5.54e-05, LM: 5.2113, Age: 242.53, Sex: 0.582
2025-10-23 05:35:05,189 - INFO - Epoch 23, Step 900/1000 - Loss: 78.4068, Perplexity: inf, LR: 5.53e-05, LM: 5.2073, Age: 243.61, Sex: 0.580
2025-10-23 05:35:17,548 - INFO - Epoch 23, Step 950/1000 - Loss: 78.2747, Perplexity: inf, LR: 5.52e-05, LM: 5.2104, Age: 243.16, Sex: 0.580
2025-10-23 05:35:29,977 - INFO - Epoch 23, Step 1000/1000 - Loss: 78.5727, Perplexity: inf, LR: 5.51e-05, LM: 5.2172, Age: 244.13, Sex: 0.580
2025-10-23 05:35:29,978 - INFO - Epoch 23 Complete - Avg Loss: 78.5727, Avg Perplexity: inf, LM: 5.2172, Age: 244.13, Sex: 0.580
2025-10-23 05:35:49,874 - INFO - Validation - Loss: 5.2853, Perplexity: 227.4648, Token Accuracy: 0.0869, Code Accuracy: 0.0000
2025-10-23 05:35:49,875 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:35:53,249 - INFO - TPL computed on 351 samples: 252.9997
2025-10-23 05:35:53,249 - INFO - Temporal Perplexity (TPL): 252.9997
2025-10-23 05:36:05,702 - INFO - Epoch 24, Step 50/1000 - Loss: 74.5812, Perplexity: inf, LR: 5.50e-05, LM: 5.2288, Age: 230.79, Sex: 0.579
2025-10-23 05:36:18,524 - INFO - Epoch 24, Step 100/1000 - Loss: 74.9569, Perplexity: inf, LR: 5.49e-05, LM: 5.2513, Age: 231.97, Sex: 0.577
2025-10-23 05:36:31,071 - INFO - Epoch 24, Step 150/1000 - Loss: 74.1263, Perplexity: inf, LR: 5.48e-05, LM: 5.2685, Age: 229.14, Sex: 0.583
2025-10-23 05:36:43,525 - INFO - Epoch 24, Step 200/1000 - Loss: 75.9612, Perplexity: inf, LR: 5.47e-05, LM: 5.2454, Age: 235.34, Sex: 0.574
2025-10-23 05:36:55,919 - INFO - Epoch 24, Step 250/1000 - Loss: 76.4129, Perplexity: inf, LR: 5.46e-05, LM: 5.2268, Age: 236.91, Sex: 0.572
2025-10-23 05:37:08,305 - INFO - Epoch 24, Step 300/1000 - Loss: 75.8874, Perplexity: inf, LR: 5.45e-05, LM: 5.2355, Age: 235.13, Sex: 0.572
2025-10-23 05:37:20,761 - INFO - Epoch 24, Step 350/1000 - Loss: 76.3119, Perplexity: inf, LR: 5.44e-05, LM: 5.2416, Age: 236.52, Sex: 0.575
2025-10-23 05:37:33,379 - INFO - Epoch 24, Step 400/1000 - Loss: 76.0477, Perplexity: inf, LR: 5.43e-05, LM: 5.2241, Age: 235.70, Sex: 0.575
2025-10-23 05:37:45,869 - INFO - Epoch 24, Step 450/1000 - Loss: 77.3642, Perplexity: inf, LR: 5.42e-05, LM: 5.2244, Age: 240.08, Sex: 0.579
2025-10-23 05:37:58,222 - INFO - Epoch 24, Step 500/1000 - Loss: 78.2302, Perplexity: inf, LR: 5.41e-05, LM: 5.2309, Age: 242.94, Sex: 0.582
2025-10-23 05:38:10,522 - INFO - Epoch 24, Step 550/1000 - Loss: 78.3426, Perplexity: inf, LR: 5.40e-05, LM: 5.2346, Age: 243.31, Sex: 0.580
2025-10-23 05:38:23,407 - INFO - Epoch 24, Step 600/1000 - Loss: 77.6880, Perplexity: inf, LR: 5.39e-05, LM: 5.2347, Age: 241.12, Sex: 0.581
2025-10-23 05:38:35,884 - INFO - Epoch 24, Step 650/1000 - Loss: 77.5740, Perplexity: inf, LR: 5.38e-05, LM: 5.2398, Age: 240.73, Sex: 0.580
2025-10-23 05:38:48,287 - INFO - Epoch 24, Step 700/1000 - Loss: 77.4228, Perplexity: inf, LR: 5.37e-05, LM: 5.2345, Age: 240.24, Sex: 0.579
2025-10-23 05:39:00,673 - INFO - Epoch 24, Step 750/1000 - Loss: 78.7141, Perplexity: inf, LR: 5.36e-05, LM: 5.2401, Age: 244.53, Sex: 0.578
2025-10-23 05:39:13,202 - INFO - Epoch 24, Step 800/1000 - Loss: 78.9704, Perplexity: inf, LR: 5.35e-05, LM: 5.2388, Age: 245.39, Sex: 0.578
2025-10-23 05:39:25,326 - INFO - Epoch 24, Step 850/1000 - Loss: 79.0902, Perplexity: inf, LR: 5.34e-05, LM: 5.2364, Age: 245.79, Sex: 0.577
2025-10-23 05:39:38,046 - INFO - Epoch 24, Step 900/1000 - Loss: 79.0864, Perplexity: inf, LR: 5.33e-05, LM: 5.2382, Age: 245.78, Sex: 0.576
2025-10-23 05:39:50,227 - INFO - Epoch 24, Step 950/1000 - Loss: 79.2314, Perplexity: inf, LR: 5.32e-05, LM: 5.2328, Age: 246.28, Sex: 0.575
2025-10-23 05:40:02,587 - INFO - Epoch 24, Step 1000/1000 - Loss: 79.1362, Perplexity: inf, LR: 5.31e-05, LM: 5.2310, Age: 245.97, Sex: 0.574
2025-10-23 05:40:02,588 - INFO - Epoch 24 Complete - Avg Loss: 79.1362, Avg Perplexity: inf, LM: 5.2310, Age: 245.97, Sex: 0.574
2025-10-23 05:40:22,353 - INFO - Validation - Loss: 5.2912, Perplexity: 229.2070, Token Accuracy: 0.0865, Code Accuracy: 0.0000
2025-10-23 05:40:22,354 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:40:25,730 - INFO - TPL computed on 351 samples: 253.8503
2025-10-23 05:40:25,730 - INFO - Temporal Perplexity (TPL): 253.8503
2025-10-23 05:40:38,272 - INFO - Epoch 25, Step 50/1000 - Loss: 71.5283, Perplexity: inf, LR: 5.30e-05, LM: 5.2057, Age: 220.69, Sex: 0.573
2025-10-23 05:40:50,772 - INFO - Epoch 25, Step 100/1000 - Loss: 70.9053, Perplexity: inf, LR: 5.29e-05, LM: 5.2246, Age: 218.57, Sex: 0.542
2025-10-23 05:41:03,572 - INFO - Epoch 25, Step 150/1000 - Loss: 73.1495, Perplexity: inf, LR: 5.28e-05, LM: 5.1940, Age: 226.16, Sex: 0.537
2025-10-23 05:41:16,136 - INFO - Epoch 25, Step 200/1000 - Loss: 75.4994, Perplexity: inf, LR: 5.27e-05, LM: 5.2359, Age: 233.85, Sex: 0.541
2025-10-23 05:41:28,447 - INFO - Epoch 25, Step 250/1000 - Loss: 75.9629, Perplexity: inf, LR: 5.26e-05, LM: 5.2367, Age: 235.39, Sex: 0.543
2025-10-23 05:41:40,998 - INFO - Epoch 25, Step 300/1000 - Loss: 75.7775, Perplexity: inf, LR: 5.24e-05, LM: 5.2280, Age: 234.80, Sex: 0.542
2025-10-23 05:41:53,504 - INFO - Epoch 25, Step 350/1000 - Loss: 76.9104, Perplexity: inf, LR: 5.23e-05, LM: 5.2154, Age: 238.62, Sex: 0.548
2025-10-23 05:42:05,914 - INFO - Epoch 25, Step 400/1000 - Loss: 76.4495, Perplexity: inf, LR: 5.22e-05, LM: 5.2118, Age: 237.09, Sex: 0.548
2025-10-23 05:42:18,470 - INFO - Epoch 25, Step 450/1000 - Loss: 78.1965, Perplexity: inf, LR: 5.21e-05, LM: 5.2196, Age: 242.89, Sex: 0.551
2025-10-23 05:42:30,641 - INFO - Epoch 25, Step 500/1000 - Loss: 78.1164, Perplexity: inf, LR: 5.20e-05, LM: 5.2190, Age: 242.62, Sex: 0.556
2025-10-23 05:42:43,237 - INFO - Epoch 25, Step 550/1000 - Loss: 78.3099, Perplexity: inf, LR: 5.19e-05, LM: 5.2157, Age: 243.28, Sex: 0.556
2025-10-23 05:42:55,607 - INFO - Epoch 25, Step 600/1000 - Loss: 78.4606, Perplexity: inf, LR: 5.18e-05, LM: 5.2166, Age: 243.77, Sex: 0.558
2025-10-23 05:43:08,275 - INFO - Epoch 25, Step 650/1000 - Loss: 78.6650, Perplexity: inf, LR: 5.17e-05, LM: 5.2195, Age: 244.45, Sex: 0.560
2025-10-23 05:43:20,622 - INFO - Epoch 25, Step 700/1000 - Loss: 79.4579, Perplexity: inf, LR: 5.16e-05, LM: 5.2202, Age: 247.09, Sex: 0.560
2025-10-23 05:43:33,038 - INFO - Epoch 25, Step 750/1000 - Loss: 79.2262, Perplexity: inf, LR: 5.15e-05, LM: 5.2167, Age: 246.33, Sex: 0.560
2025-10-23 05:43:45,226 - INFO - Epoch 25, Step 800/1000 - Loss: 79.6396, Perplexity: inf, LR: 5.14e-05, LM: 5.2206, Age: 247.69, Sex: 0.561
2025-10-23 05:43:58,069 - INFO - Epoch 25, Step 850/1000 - Loss: 79.2872, Perplexity: inf, LR: 5.13e-05, LM: 5.2212, Age: 246.51, Sex: 0.560
2025-10-23 05:44:10,512 - INFO - Epoch 25, Step 900/1000 - Loss: 79.4769, Perplexity: inf, LR: 5.12e-05, LM: 5.2158, Age: 247.16, Sex: 0.562
2025-10-23 05:44:22,771 - INFO - Epoch 25, Step 950/1000 - Loss: 79.5688, Perplexity: inf, LR: 5.11e-05, LM: 5.2130, Age: 247.48, Sex: 0.563
2025-10-23 05:44:35,565 - INFO - Epoch 25, Step 1000/1000 - Loss: 79.2382, Perplexity: inf, LR: 5.10e-05, LM: 5.2182, Age: 246.36, Sex: 0.564
2025-10-23 05:44:35,566 - INFO - Epoch 25 Complete - Avg Loss: 79.2382, Avg Perplexity: inf, LM: 5.2182, Age: 246.36, Sex: 0.564
2025-10-23 05:44:55,035 - INFO - Validation - Loss: 5.2785, Perplexity: 225.8308, Token Accuracy: 0.0868, Code Accuracy: 0.0000
2025-10-23 05:44:55,036 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:44:58,401 - INFO - TPL computed on 351 samples: 252.9701
2025-10-23 05:44:58,401 - INFO - Temporal Perplexity (TPL): 252.9701
2025-10-23 05:45:00,671 - INFO - Checkpoint saved: epoch 25
2025-10-23 05:45:12,962 - INFO - Epoch 26, Step 50/1000 - Loss: 82.3902, Perplexity: inf, LR: 5.09e-05, LM: 5.2484, Age: 256.77, Sex: 0.556
2025-10-23 05:45:25,690 - INFO - Epoch 26, Step 100/1000 - Loss: 85.8154, Perplexity: inf, LR: 5.08e-05, LM: 5.2775, Age: 268.09, Sex: 0.562
2025-10-23 05:45:38,413 - INFO - Epoch 26, Step 150/1000 - Loss: 83.4857, Perplexity: inf, LR: 5.07e-05, LM: 5.2446, Age: 260.43, Sex: 0.562
2025-10-23 05:45:50,681 - INFO - Epoch 26, Step 200/1000 - Loss: 84.5202, Perplexity: inf, LR: 5.06e-05, LM: 5.2534, Age: 263.85, Sex: 0.565
2025-10-23 05:46:02,929 - INFO - Epoch 26, Step 250/1000 - Loss: 83.6299, Perplexity: inf, LR: 5.05e-05, LM: 5.2387, Age: 260.93, Sex: 0.563
2025-10-23 05:46:15,106 - INFO - Epoch 26, Step 300/1000 - Loss: 81.6860, Perplexity: inf, LR: 5.04e-05, LM: 5.2165, Age: 254.52, Sex: 0.561
2025-10-23 05:46:27,641 - INFO - Epoch 26, Step 350/1000 - Loss: 81.3711, Perplexity: inf, LR: 5.03e-05, LM: 5.2203, Age: 253.46, Sex: 0.559
2025-10-23 05:46:39,853 - INFO - Epoch 26, Step 400/1000 - Loss: 80.9044, Perplexity: inf, LR: 5.02e-05, LM: 5.2177, Age: 251.92, Sex: 0.560
2025-10-23 05:46:52,059 - INFO - Epoch 26, Step 450/1000 - Loss: 80.6458, Perplexity: inf, LR: 5.01e-05, LM: 5.2073, Age: 251.09, Sex: 0.560
2025-10-23 05:47:04,372 - INFO - Epoch 26, Step 500/1000 - Loss: 80.8141, Perplexity: inf, LR: 5.00e-05, LM: 5.2055, Age: 251.65, Sex: 0.562
2025-10-23 05:47:16,733 - INFO - Epoch 26, Step 550/1000 - Loss: 79.3783, Perplexity: inf, LR: 4.99e-05, LM: 5.2021, Age: 246.88, Sex: 0.561
2025-10-23 05:47:29,363 - INFO - Epoch 26, Step 600/1000 - Loss: 80.4040, Perplexity: inf, LR: 4.98e-05, LM: 5.2043, Age: 250.29, Sex: 0.563
2025-10-23 05:47:41,571 - INFO - Epoch 26, Step 650/1000 - Loss: 80.3734, Perplexity: inf, LR: 4.97e-05, LM: 5.2019, Age: 250.20, Sex: 0.564
2025-10-23 05:47:53,763 - INFO - Epoch 26, Step 700/1000 - Loss: 80.0827, Perplexity: inf, LR: 4.96e-05, LM: 5.2023, Age: 249.23, Sex: 0.564
2025-10-23 05:48:06,275 - INFO - Epoch 26, Step 750/1000 - Loss: 79.8158, Perplexity: inf, LR: 4.95e-05, LM: 5.2071, Age: 248.32, Sex: 0.565
2025-10-23 05:48:18,713 - INFO - Epoch 26, Step 800/1000 - Loss: 79.8406, Perplexity: inf, LR: 4.94e-05, LM: 5.2055, Age: 248.41, Sex: 0.565
2025-10-23 05:48:30,932 - INFO - Epoch 26, Step 850/1000 - Loss: 79.5666, Perplexity: inf, LR: 4.93e-05, LM: 5.2049, Age: 247.50, Sex: 0.566
2025-10-23 05:48:43,374 - INFO - Epoch 26, Step 900/1000 - Loss: 79.6363, Perplexity: inf, LR: 4.92e-05, LM: 5.2090, Age: 247.71, Sex: 0.574
2025-10-23 05:48:55,747 - INFO - Epoch 26, Step 950/1000 - Loss: 79.2484, Perplexity: inf, LR: 4.91e-05, LM: 5.2100, Age: 246.41, Sex: 0.575
2025-10-23 05:49:08,254 - INFO - Epoch 26, Step 1000/1000 - Loss: 78.8982, Perplexity: inf, LR: 4.90e-05, LM: 5.2112, Age: 245.24, Sex: 0.575
2025-10-23 05:49:08,255 - INFO - Epoch 26 Complete - Avg Loss: 78.8982, Avg Perplexity: inf, LM: 5.2112, Age: 245.24, Sex: 0.575
2025-10-23 05:49:28,013 - INFO - Validation - Loss: 5.3009, Perplexity: 230.9974, Token Accuracy: 0.0863, Code Accuracy: 0.0000
2025-10-23 05:49:28,014 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:49:31,391 - INFO - TPL computed on 351 samples: 254.7658
2025-10-23 05:49:31,391 - INFO - Temporal Perplexity (TPL): 254.7658
2025-10-23 05:49:43,933 - INFO - Epoch 27, Step 50/1000 - Loss: 72.1070, Perplexity: inf, LR: 4.89e-05, LM: 5.2278, Age: 222.56, Sex: 0.556
2025-10-23 05:49:56,279 - INFO - Epoch 27, Step 100/1000 - Loss: 79.2424, Perplexity: inf, LR: 4.88e-05, LM: 5.2287, Age: 246.32, Sex: 0.585
2025-10-23 05:50:08,530 - INFO - Epoch 27, Step 150/1000 - Loss: 76.0902, Perplexity: inf, LR: 4.87e-05, LM: 5.1905, Age: 235.95, Sex: 0.580
2025-10-23 05:50:21,006 - INFO - Epoch 27, Step 200/1000 - Loss: 75.7661, Perplexity: inf, LR: 4.86e-05, LM: 5.1878, Age: 234.87, Sex: 0.583
2025-10-23 05:50:33,618 - INFO - Epoch 27, Step 250/1000 - Loss: 79.2228, Perplexity: inf, LR: 4.85e-05, LM: 5.2162, Age: 246.30, Sex: 0.584
2025-10-23 05:50:46,140 - INFO - Epoch 27, Step 300/1000 - Loss: 78.3726, Perplexity: inf, LR: 4.84e-05, LM: 5.2300, Age: 243.42, Sex: 0.586
2025-10-23 05:50:58,471 - INFO - Epoch 27, Step 350/1000 - Loss: 77.4024, Perplexity: inf, LR: 4.83e-05, LM: 5.2303, Age: 240.18, Sex: 0.584
2025-10-23 05:51:10,934 - INFO - Epoch 27, Step 400/1000 - Loss: 77.0900, Perplexity: inf, LR: 4.82e-05, LM: 5.2291, Age: 239.15, Sex: 0.582
2025-10-23 05:51:23,411 - INFO - Epoch 27, Step 450/1000 - Loss: 76.1560, Perplexity: inf, LR: 4.81e-05, LM: 5.2260, Age: 236.04, Sex: 0.583
2025-10-23 05:51:36,041 - INFO - Epoch 27, Step 500/1000 - Loss: 75.3570, Perplexity: inf, LR: 4.80e-05, LM: 5.2201, Age: 233.40, Sex: 0.583
2025-10-23 05:51:48,785 - INFO - Epoch 27, Step 550/1000 - Loss: 76.2836, Perplexity: inf, LR: 4.79e-05, LM: 5.2252, Age: 236.47, Sex: 0.584
2025-10-23 05:52:01,529 - INFO - Epoch 27, Step 600/1000 - Loss: 76.4126, Perplexity: inf, LR: 4.78e-05, LM: 5.2226, Age: 236.91, Sex: 0.582
2025-10-23 05:52:14,118 - INFO - Epoch 27, Step 650/1000 - Loss: 76.2391, Perplexity: inf, LR: 4.77e-05, LM: 5.2212, Age: 236.34, Sex: 0.580
2025-10-23 05:52:26,963 - INFO - Epoch 27, Step 700/1000 - Loss: 76.4114, Perplexity: inf, LR: 4.76e-05, LM: 5.2235, Age: 236.91, Sex: 0.582
2025-10-23 05:52:39,191 - INFO - Epoch 27, Step 750/1000 - Loss: 76.6177, Perplexity: inf, LR: 4.74e-05, LM: 5.2235, Age: 237.59, Sex: 0.583
2025-10-23 05:52:51,833 - INFO - Epoch 27, Step 800/1000 - Loss: 76.9173, Perplexity: inf, LR: 4.73e-05, LM: 5.2266, Age: 238.58, Sex: 0.584
2025-10-23 05:53:04,281 - INFO - Epoch 27, Step 850/1000 - Loss: 77.3000, Perplexity: inf, LR: 4.72e-05, LM: 5.2254, Age: 239.86, Sex: 0.584
2025-10-23 05:53:16,863 - INFO - Epoch 27, Step 900/1000 - Loss: 77.4633, Perplexity: inf, LR: 4.71e-05, LM: 5.2267, Age: 240.40, Sex: 0.585
2025-10-23 05:53:29,410 - INFO - Epoch 27, Step 950/1000 - Loss: 77.6946, Perplexity: inf, LR: 4.70e-05, LM: 5.2282, Age: 241.16, Sex: 0.587
2025-10-23 05:53:42,022 - INFO - Epoch 27, Step 1000/1000 - Loss: 78.0574, Perplexity: inf, LR: 4.69e-05, LM: 5.2255, Age: 242.38, Sex: 0.587
2025-10-23 05:53:42,023 - INFO - Epoch 27 Complete - Avg Loss: 78.0574, Avg Perplexity: inf, LM: 5.2255, Age: 242.38, Sex: 0.587
2025-10-23 05:54:02,109 - INFO - Validation - Loss: 5.2796, Perplexity: 221.8285, Token Accuracy: 0.0865, Code Accuracy: 0.0000
2025-10-23 05:54:02,110 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:54:05,477 - INFO - TPL computed on 351 samples: 250.2138
2025-10-23 05:54:05,478 - INFO - Temporal Perplexity (TPL): 250.2138
2025-10-23 05:54:17,697 - INFO - Epoch 28, Step 50/1000 - Loss: 75.1125, Perplexity: inf, LR: 4.68e-05, LM: 5.2267, Age: 232.55, Sex: 0.609
2025-10-23 05:54:30,268 - INFO - Epoch 28, Step 100/1000 - Loss: 81.0967, Perplexity: inf, LR: 4.67e-05, LM: 5.3184, Age: 252.18, Sex: 0.617
2025-10-23 05:54:42,898 - INFO - Epoch 28, Step 150/1000 - Loss: 78.7677, Perplexity: inf, LR: 4.66e-05, LM: 5.2160, Age: 244.77, Sex: 0.608
2025-10-23 05:54:55,240 - INFO - Epoch 28, Step 200/1000 - Loss: 77.1688, Perplexity: inf, LR: 4.65e-05, LM: 5.1983, Age: 239.50, Sex: 0.606
2025-10-23 05:55:07,787 - INFO - Epoch 28, Step 250/1000 - Loss: 77.8889, Perplexity: inf, LR: 4.64e-05, LM: 5.2109, Age: 241.85, Sex: 0.611
2025-10-23 05:55:20,448 - INFO - Epoch 28, Step 300/1000 - Loss: 76.6366, Perplexity: inf, LR: 4.63e-05, LM: 5.1996, Age: 237.72, Sex: 0.609
2025-10-23 05:55:32,715 - INFO - Epoch 28, Step 350/1000 - Loss: 76.9679, Perplexity: inf, LR: 4.62e-05, LM: 5.2029, Age: 238.81, Sex: 0.606
2025-10-23 05:55:44,627 - INFO - Epoch 28, Step 400/1000 - Loss: 76.3008, Perplexity: inf, LR: 4.61e-05, LM: 5.2016, Age: 236.60, Sex: 0.600
2025-10-23 05:55:56,874 - INFO - Epoch 28, Step 450/1000 - Loss: 77.5955, Perplexity: inf, LR: 4.60e-05, LM: 5.2043, Age: 240.90, Sex: 0.602
2025-10-23 05:56:09,564 - INFO - Epoch 28, Step 500/1000 - Loss: 77.7970, Perplexity: inf, LR: 4.59e-05, LM: 5.2129, Age: 241.55, Sex: 0.602
2025-10-23 05:56:21,797 - INFO - Epoch 28, Step 550/1000 - Loss: 78.2118, Perplexity: inf, LR: 4.58e-05, LM: 5.2156, Age: 242.92, Sex: 0.604
2025-10-23 05:56:34,367 - INFO - Epoch 28, Step 600/1000 - Loss: 77.9806, Perplexity: inf, LR: 4.57e-05, LM: 5.2099, Age: 242.17, Sex: 0.603
2025-10-23 05:56:47,203 - INFO - Epoch 28, Step 650/1000 - Loss: 77.4905, Perplexity: inf, LR: 4.56e-05, LM: 5.2040, Age: 240.55, Sex: 0.601
2025-10-23 05:57:00,122 - INFO - Epoch 28, Step 700/1000 - Loss: 78.0607, Perplexity: inf, LR: 4.55e-05, LM: 5.2145, Age: 242.42, Sex: 0.602
2025-10-23 05:57:13,125 - INFO - Epoch 28, Step 750/1000 - Loss: 78.1943, Perplexity: inf, LR: 4.54e-05, LM: 5.2168, Age: 242.86, Sex: 0.601
2025-10-23 05:57:25,367 - INFO - Epoch 28, Step 800/1000 - Loss: 78.6202, Perplexity: inf, LR: 4.53e-05, LM: 5.2212, Age: 244.26, Sex: 0.603
2025-10-23 05:57:37,848 - INFO - Epoch 28, Step 850/1000 - Loss: 78.0029, Perplexity: inf, LR: 4.52e-05, LM: 5.2136, Age: 242.23, Sex: 0.602
2025-10-23 05:57:50,110 - INFO - Epoch 28, Step 900/1000 - Loss: 78.4885, Perplexity: inf, LR: 4.51e-05, LM: 5.2110, Age: 243.86, Sex: 0.601
2025-10-23 05:58:02,504 - INFO - Epoch 28, Step 950/1000 - Loss: 78.8489, Perplexity: inf, LR: 4.50e-05, LM: 5.2144, Age: 245.05, Sex: 0.602
2025-10-23 05:58:14,620 - INFO - Epoch 28, Step 1000/1000 - Loss: 78.5977, Perplexity: inf, LR: 4.49e-05, LM: 5.2137, Age: 244.21, Sex: 0.601
2025-10-23 05:58:14,621 - INFO - Epoch 28 Complete - Avg Loss: 78.5977, Avg Perplexity: inf, LM: 5.2137, Age: 244.21, Sex: 0.601
2025-10-23 05:58:34,443 - INFO - Validation - Loss: 5.2901, Perplexity: 228.2000, Token Accuracy: 0.0868, Code Accuracy: 0.0000
2025-10-23 05:58:34,445 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 05:58:37,809 - INFO - TPL computed on 351 samples: 255.0265
2025-10-23 05:58:37,809 - INFO - Temporal Perplexity (TPL): 255.0265
2025-10-23 05:58:50,332 - INFO - Epoch 29, Step 50/1000 - Loss: 81.2652, Perplexity: inf, LR: 4.48e-05, LM: 5.2021, Age: 253.14, Sex: 0.613
2025-10-23 05:59:02,398 - INFO - Epoch 29, Step 100/1000 - Loss: 77.2322, Perplexity: inf, LR: 4.47e-05, LM: 5.1889, Age: 239.73, Sex: 0.614
2025-10-23 05:59:15,199 - INFO - Epoch 29, Step 150/1000 - Loss: 77.1714, Perplexity: inf, LR: 4.46e-05, LM: 5.2358, Age: 239.37, Sex: 0.618
2025-10-23 05:59:27,483 - INFO - Epoch 29, Step 200/1000 - Loss: 75.9140, Perplexity: inf, LR: 4.45e-05, LM: 5.2376, Age: 235.17, Sex: 0.622
2025-10-23 05:59:40,050 - INFO - Epoch 29, Step 250/1000 - Loss: 76.2248, Perplexity: inf, LR: 4.44e-05, LM: 5.2499, Age: 236.17, Sex: 0.621
2025-10-23 05:59:52,737 - INFO - Epoch 29, Step 300/1000 - Loss: 76.5761, Perplexity: inf, LR: 4.43e-05, LM: 5.2396, Age: 237.37, Sex: 0.624
2025-10-23 06:00:05,270 - INFO - Epoch 29, Step 350/1000 - Loss: 77.2073, Perplexity: inf, LR: 4.42e-05, LM: 5.2439, Age: 239.46, Sex: 0.625
2025-10-23 06:00:17,921 - INFO - Epoch 29, Step 400/1000 - Loss: 77.6032, Perplexity: inf, LR: 4.41e-05, LM: 5.2332, Age: 240.82, Sex: 0.627
2025-10-23 06:00:30,125 - INFO - Epoch 29, Step 450/1000 - Loss: 76.9841, Perplexity: inf, LR: 4.40e-05, LM: 5.2202, Age: 238.80, Sex: 0.625
2025-10-23 06:00:42,772 - INFO - Epoch 29, Step 500/1000 - Loss: 77.6526, Perplexity: inf, LR: 4.39e-05, LM: 5.2255, Age: 241.01, Sex: 0.625
2025-10-23 06:00:55,397 - INFO - Epoch 29, Step 550/1000 - Loss: 77.1913, Perplexity: inf, LR: 4.38e-05, LM: 5.2296, Age: 239.46, Sex: 0.623
2025-10-23 06:01:07,558 - INFO - Epoch 29, Step 600/1000 - Loss: 77.7202, Perplexity: inf, LR: 4.37e-05, LM: 5.2387, Age: 241.19, Sex: 0.625
2025-10-23 06:01:20,030 - INFO - Epoch 29, Step 650/1000 - Loss: 77.5439, Perplexity: inf, LR: 4.36e-05, LM: 5.2302, Age: 240.63, Sex: 0.626
2025-10-23 06:01:32,307 - INFO - Epoch 29, Step 700/1000 - Loss: 77.8419, Perplexity: inf, LR: 4.35e-05, LM: 5.2283, Age: 241.63, Sex: 0.626
2025-10-23 06:01:44,975 - INFO - Epoch 29, Step 750/1000 - Loss: 78.4596, Perplexity: inf, LR: 4.34e-05, LM: 5.2316, Age: 243.68, Sex: 0.626
2025-10-23 06:01:57,411 - INFO - Epoch 29, Step 800/1000 - Loss: 77.9124, Perplexity: inf, LR: 4.33e-05, LM: 5.2254, Age: 241.87, Sex: 0.627
2025-10-23 06:02:10,024 - INFO - Epoch 29, Step 850/1000 - Loss: 78.1295, Perplexity: inf, LR: 4.32e-05, LM: 5.2200, Age: 242.61, Sex: 0.626
2025-10-23 06:02:22,385 - INFO - Epoch 29, Step 900/1000 - Loss: 77.9421, Perplexity: inf, LR: 4.31e-05, LM: 5.2165, Age: 242.00, Sex: 0.626
2025-10-23 06:02:34,759 - INFO - Epoch 29, Step 950/1000 - Loss: 78.4428, Perplexity: inf, LR: 4.30e-05, LM: 5.2159, Age: 243.67, Sex: 0.626
2025-10-23 06:02:47,375 - INFO - Epoch 29, Step 1000/1000 - Loss: 78.3866, Perplexity: inf, LR: 4.29e-05, LM: 5.2163, Age: 243.48, Sex: 0.627
2025-10-23 06:02:47,376 - INFO - Epoch 29 Complete - Avg Loss: 78.3866, Avg Perplexity: inf, LM: 5.2163, Age: 243.48, Sex: 0.627
2025-10-23 06:03:07,025 - INFO - Validation - Loss: 5.2890, Perplexity: 226.9405, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 06:03:07,026 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:03:10,393 - INFO - TPL computed on 351 samples: 253.8385
2025-10-23 06:03:10,393 - INFO - Temporal Perplexity (TPL): 253.8385
2025-10-23 06:03:22,863 - INFO - Epoch 30, Step 50/1000 - Loss: 84.6824, Perplexity: inf, LR: 4.28e-05, LM: 5.2111, Age: 264.50, Sex: 0.608
2025-10-23 06:03:35,445 - INFO - Epoch 30, Step 100/1000 - Loss: 80.6057, Perplexity: inf, LR: 4.27e-05, LM: 5.1779, Age: 251.02, Sex: 0.616
2025-10-23 06:03:47,825 - INFO - Epoch 30, Step 150/1000 - Loss: 77.4953, Perplexity: inf, LR: 4.26e-05, LM: 5.1889, Age: 240.61, Sex: 0.615
2025-10-23 06:04:00,082 - INFO - Epoch 30, Step 200/1000 - Loss: 77.8779, Perplexity: inf, LR: 4.24e-05, LM: 5.1924, Age: 241.87, Sex: 0.618
2025-10-23 06:04:12,568 - INFO - Epoch 30, Step 250/1000 - Loss: 79.8309, Perplexity: inf, LR: 4.23e-05, LM: 5.2009, Age: 248.35, Sex: 0.627
2025-10-23 06:04:24,932 - INFO - Epoch 30, Step 300/1000 - Loss: 80.9876, Perplexity: inf, LR: 4.22e-05, LM: 5.2113, Age: 252.17, Sex: 0.630
2025-10-23 06:04:37,587 - INFO - Epoch 30, Step 350/1000 - Loss: 80.6966, Perplexity: inf, LR: 4.21e-05, LM: 5.2091, Age: 251.20, Sex: 0.643
2025-10-23 06:04:50,164 - INFO - Epoch 30, Step 400/1000 - Loss: 78.7612, Perplexity: inf, LR: 4.20e-05, LM: 5.1980, Age: 244.78, Sex: 0.647
2025-10-23 06:05:02,993 - INFO - Epoch 30, Step 450/1000 - Loss: 78.8315, Perplexity: inf, LR: 4.19e-05, LM: 5.2052, Age: 244.99, Sex: 0.649
2025-10-23 06:05:15,723 - INFO - Epoch 30, Step 500/1000 - Loss: 78.3766, Perplexity: inf, LR: 4.18e-05, LM: 5.2101, Age: 243.45, Sex: 0.653
2025-10-23 06:05:28,208 - INFO - Epoch 30, Step 550/1000 - Loss: 78.0848, Perplexity: inf, LR: 4.17e-05, LM: 5.2125, Age: 242.47, Sex: 0.654
2025-10-23 06:05:40,708 - INFO - Epoch 30, Step 600/1000 - Loss: 78.1045, Perplexity: inf, LR: 4.16e-05, LM: 5.2194, Age: 242.51, Sex: 0.658
2025-10-23 06:05:53,036 - INFO - Epoch 30, Step 650/1000 - Loss: 77.9400, Perplexity: inf, LR: 4.15e-05, LM: 5.2147, Age: 241.98, Sex: 0.658
2025-10-23 06:06:05,949 - INFO - Epoch 30, Step 700/1000 - Loss: 78.4040, Perplexity: inf, LR: 4.14e-05, LM: 5.2135, Age: 243.53, Sex: 0.660
2025-10-23 06:06:18,727 - INFO - Epoch 30, Step 750/1000 - Loss: 78.2338, Perplexity: inf, LR: 4.13e-05, LM: 5.2087, Age: 242.98, Sex: 0.661
2025-10-23 06:06:31,064 - INFO - Epoch 30, Step 800/1000 - Loss: 77.9757, Perplexity: inf, LR: 4.12e-05, LM: 5.2120, Age: 242.10, Sex: 0.661
2025-10-23 06:06:43,526 - INFO - Epoch 30, Step 850/1000 - Loss: 78.5731, Perplexity: inf, LR: 4.11e-05, LM: 5.2142, Age: 244.09, Sex: 0.662
2025-10-23 06:06:55,840 - INFO - Epoch 30, Step 900/1000 - Loss: 78.8542, Perplexity: inf, LR: 4.10e-05, LM: 5.2132, Age: 245.03, Sex: 0.663
2025-10-23 06:07:08,347 - INFO - Epoch 30, Step 950/1000 - Loss: 79.2082, Perplexity: inf, LR: 4.09e-05, LM: 5.2170, Age: 246.19, Sex: 0.664
2025-10-23 06:07:20,754 - INFO - Epoch 30, Step 1000/1000 - Loss: 78.8079, Perplexity: inf, LR: 4.08e-05, LM: 5.2176, Age: 244.86, Sex: 0.665
2025-10-23 06:07:20,755 - INFO - Epoch 30 Complete - Avg Loss: 78.8079, Avg Perplexity: inf, LM: 5.2176, Age: 244.86, Sex: 0.665
2025-10-23 06:07:40,646 - INFO - Validation - Loss: 5.3005, Perplexity: 228.8664, Token Accuracy: 0.0857, Code Accuracy: 0.0000
2025-10-23 06:07:40,647 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:07:44,011 - INFO - TPL computed on 351 samples: 252.9751
2025-10-23 06:07:44,011 - INFO - Temporal Perplexity (TPL): 252.9751
2025-10-23 06:07:46,277 - INFO - Checkpoint saved: epoch 30
2025-10-23 06:07:58,997 - INFO - Epoch 31, Step 50/1000 - Loss: 72.3559, Perplexity: inf, LR: 4.07e-05, LM: 5.1538, Age: 223.54, Sex: 0.693
2025-10-23 06:08:11,537 - INFO - Epoch 31, Step 100/1000 - Loss: 77.1081, Perplexity: inf, LR: 4.06e-05, LM: 5.1701, Age: 239.33, Sex: 0.692
2025-10-23 06:08:23,970 - INFO - Epoch 31, Step 150/1000 - Loss: 77.0236, Perplexity: inf, LR: 4.05e-05, LM: 5.1251, Age: 239.21, Sex: 0.684
2025-10-23 06:08:36,805 - INFO - Epoch 31, Step 200/1000 - Loss: 80.1548, Perplexity: inf, LR: 4.04e-05, LM: 5.1466, Age: 249.57, Sex: 0.686
2025-10-23 06:08:49,276 - INFO - Epoch 31, Step 250/1000 - Loss: 82.3786, Perplexity: inf, LR: 4.03e-05, LM: 5.1629, Age: 256.93, Sex: 0.687
2025-10-23 06:09:01,816 - INFO - Epoch 31, Step 300/1000 - Loss: 81.3948, Perplexity: inf, LR: 4.02e-05, LM: 5.1799, Age: 253.59, Sex: 0.685
2025-10-23 06:09:14,232 - INFO - Epoch 31, Step 350/1000 - Loss: 79.1144, Perplexity: inf, LR: 4.01e-05, LM: 5.1585, Age: 246.07, Sex: 0.681
2025-10-23 06:09:26,802 - INFO - Epoch 31, Step 400/1000 - Loss: 79.2131, Perplexity: inf, LR: 4.00e-05, LM: 5.1585, Age: 246.40, Sex: 0.680
2025-10-23 06:09:39,097 - INFO - Epoch 31, Step 450/1000 - Loss: 79.8366, Perplexity: inf, LR: 3.99e-05, LM: 5.1664, Age: 248.45, Sex: 0.680
2025-10-23 06:09:51,671 - INFO - Epoch 31, Step 500/1000 - Loss: 80.2735, Perplexity: inf, LR: 3.98e-05, LM: 5.1781, Age: 249.87, Sex: 0.679
2025-10-23 06:10:04,195 - INFO - Epoch 31, Step 550/1000 - Loss: 79.3241, Perplexity: inf, LR: 3.97e-05, LM: 5.1798, Age: 246.69, Sex: 0.680
2025-10-23 06:10:16,810 - INFO - Epoch 31, Step 600/1000 - Loss: 78.1876, Perplexity: inf, LR: 3.96e-05, LM: 5.1756, Age: 242.92, Sex: 0.678
2025-10-23 06:10:29,277 - INFO - Epoch 31, Step 650/1000 - Loss: 78.5538, Perplexity: inf, LR: 3.95e-05, LM: 5.1770, Age: 244.14, Sex: 0.679
2025-10-23 06:10:41,975 - INFO - Epoch 31, Step 700/1000 - Loss: 78.0684, Perplexity: inf, LR: 3.94e-05, LM: 5.1871, Age: 242.49, Sex: 0.678
2025-10-23 06:10:54,422 - INFO - Epoch 31, Step 750/1000 - Loss: 78.1769, Perplexity: inf, LR: 3.93e-05, LM: 5.1921, Age: 242.83, Sex: 0.678
2025-10-23 06:11:06,728 - INFO - Epoch 31, Step 800/1000 - Loss: 78.3002, Perplexity: inf, LR: 3.92e-05, LM: 5.1860, Age: 243.26, Sex: 0.678
2025-10-23 06:11:18,995 - INFO - Epoch 31, Step 850/1000 - Loss: 78.3845, Perplexity: inf, LR: 3.91e-05, LM: 5.1949, Age: 243.51, Sex: 0.677
2025-10-23 06:11:32,144 - INFO - Epoch 31, Step 900/1000 - Loss: 78.0661, Perplexity: inf, LR: 3.90e-05, LM: 5.1992, Age: 242.44, Sex: 0.678
2025-10-23 06:11:44,478 - INFO - Epoch 31, Step 950/1000 - Loss: 78.5289, Perplexity: inf, LR: 3.89e-05, LM: 5.2004, Age: 243.98, Sex: 0.678
2025-10-23 06:11:56,678 - INFO - Epoch 31, Step 1000/1000 - Loss: 78.7166, Perplexity: inf, LR: 3.88e-05, LM: 5.2042, Age: 244.59, Sex: 0.678
2025-10-23 06:11:56,679 - INFO - Epoch 31 Complete - Avg Loss: 78.7166, Avg Perplexity: inf, LM: 5.2042, Age: 244.59, Sex: 0.678
2025-10-23 06:12:16,626 - INFO - Validation - Loss: 5.2922, Perplexity: 228.7844, Token Accuracy: 0.0863, Code Accuracy: 0.0000
2025-10-23 06:12:16,627 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:12:19,992 - INFO - TPL computed on 351 samples: 250.2078
2025-10-23 06:12:19,992 - INFO - Temporal Perplexity (TPL): 250.2078
2025-10-23 06:12:32,696 - INFO - Epoch 32, Step 50/1000 - Loss: 83.9403, Perplexity: inf, LR: 3.87e-05, LM: 5.2613, Age: 261.81, Sex: 0.684
2025-10-23 06:12:45,160 - INFO - Epoch 32, Step 100/1000 - Loss: 81.7261, Perplexity: inf, LR: 3.86e-05, LM: 5.2359, Age: 254.51, Sex: 0.691
2025-10-23 06:12:57,539 - INFO - Epoch 32, Step 150/1000 - Loss: 81.8173, Perplexity: inf, LR: 3.85e-05, LM: 5.2145, Age: 254.88, Sex: 0.689
2025-10-23 06:13:10,076 - INFO - Epoch 32, Step 200/1000 - Loss: 80.9659, Perplexity: inf, LR: 3.84e-05, LM: 5.2194, Age: 252.03, Sex: 0.687
2025-10-23 06:13:22,462 - INFO - Epoch 32, Step 250/1000 - Loss: 78.7345, Perplexity: inf, LR: 3.83e-05, LM: 5.2220, Age: 244.59, Sex: 0.682
2025-10-23 06:13:34,731 - INFO - Epoch 32, Step 300/1000 - Loss: 77.8083, Perplexity: inf, LR: 3.82e-05, LM: 5.2156, Age: 241.52, Sex: 0.680
2025-10-23 06:13:47,520 - INFO - Epoch 32, Step 350/1000 - Loss: 78.0091, Perplexity: inf, LR: 3.81e-05, LM: 5.2278, Age: 242.15, Sex: 0.680
2025-10-23 06:13:59,935 - INFO - Epoch 32, Step 400/1000 - Loss: 78.6833, Perplexity: inf, LR: 3.80e-05, LM: 5.2269, Age: 244.40, Sex: 0.679
2025-10-23 06:14:12,566 - INFO - Epoch 32, Step 450/1000 - Loss: 77.7911, Perplexity: inf, LR: 3.79e-05, LM: 5.2111, Age: 241.48, Sex: 0.679
2025-10-23 06:14:25,146 - INFO - Epoch 32, Step 500/1000 - Loss: 79.1131, Perplexity: inf, LR: 3.78e-05, LM: 5.2129, Age: 245.88, Sex: 0.678
2025-10-23 06:14:37,661 - INFO - Epoch 32, Step 550/1000 - Loss: 78.8857, Perplexity: inf, LR: 3.77e-05, LM: 5.2169, Age: 245.11, Sex: 0.677
2025-10-23 06:14:50,097 - INFO - Epoch 32, Step 600/1000 - Loss: 79.1137, Perplexity: inf, LR: 3.76e-05, LM: 5.2209, Age: 245.86, Sex: 0.678
2025-10-23 06:15:02,198 - INFO - Epoch 32, Step 650/1000 - Loss: 78.0501, Perplexity: inf, LR: 3.74e-05, LM: 5.2146, Age: 242.33, Sex: 0.676
2025-10-23 06:15:14,955 - INFO - Epoch 32, Step 700/1000 - Loss: 78.3476, Perplexity: inf, LR: 3.73e-05, LM: 5.2186, Age: 243.31, Sex: 0.676
2025-10-23 06:15:27,284 - INFO - Epoch 32, Step 750/1000 - Loss: 78.3118, Perplexity: inf, LR: 3.72e-05, LM: 5.2196, Age: 243.19, Sex: 0.677
2025-10-23 06:15:39,656 - INFO - Epoch 32, Step 800/1000 - Loss: 78.8037, Perplexity: inf, LR: 3.71e-05, LM: 5.2183, Age: 244.83, Sex: 0.676
2025-10-23 06:15:51,795 - INFO - Epoch 32, Step 850/1000 - Loss: 79.0469, Perplexity: inf, LR: 3.70e-05, LM: 5.2175, Age: 245.65, Sex: 0.676
2025-10-23 06:16:04,240 - INFO - Epoch 32, Step 900/1000 - Loss: 79.1917, Perplexity: inf, LR: 3.69e-05, LM: 5.2186, Age: 246.13, Sex: 0.676
2025-10-23 06:16:16,470 - INFO - Epoch 32, Step 950/1000 - Loss: 79.2601, Perplexity: inf, LR: 3.68e-05, LM: 5.2179, Age: 246.36, Sex: 0.676
2025-10-23 06:16:28,681 - INFO - Epoch 32, Step 1000/1000 - Loss: 79.2893, Perplexity: inf, LR: 3.67e-05, LM: 5.2119, Age: 246.47, Sex: 0.676
2025-10-23 06:16:28,682 - INFO - Epoch 32 Complete - Avg Loss: 79.2893, Avg Perplexity: inf, LM: 5.2119, Age: 246.47, Sex: 0.676
2025-10-23 06:16:48,291 - INFO - Validation - Loss: 5.3118, Perplexity: 232.6403, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 06:16:48,292 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:16:51,668 - INFO - TPL computed on 351 samples: 258.8975
2025-10-23 06:16:51,668 - INFO - Temporal Perplexity (TPL): 258.8975
2025-10-23 06:17:04,075 - INFO - Epoch 33, Step 50/1000 - Loss: 78.9460, Perplexity: inf, LR: 3.66e-05, LM: 5.1186, Age: 245.63, Sex: 0.694
2025-10-23 06:17:16,554 - INFO - Epoch 33, Step 100/1000 - Loss: 76.6978, Perplexity: inf, LR: 3.65e-05, LM: 5.1393, Age: 238.07, Sex: 0.682
2025-10-23 06:17:29,261 - INFO - Epoch 33, Step 150/1000 - Loss: 78.4427, Perplexity: inf, LR: 3.64e-05, LM: 5.1608, Age: 243.82, Sex: 0.685
2025-10-23 06:17:41,618 - INFO - Epoch 33, Step 200/1000 - Loss: 77.2078, Perplexity: inf, LR: 3.63e-05, LM: 5.1748, Age: 239.65, Sex: 0.683
2025-10-23 06:17:54,104 - INFO - Epoch 33, Step 250/1000 - Loss: 78.7286, Perplexity: inf, LR: 3.62e-05, LM: 5.1999, Age: 244.64, Sex: 0.683
2025-10-23 06:18:06,919 - INFO - Epoch 33, Step 300/1000 - Loss: 79.6363, Perplexity: inf, LR: 3.61e-05, LM: 5.2230, Age: 247.59, Sex: 0.681
2025-10-23 06:18:19,430 - INFO - Epoch 33, Step 350/1000 - Loss: 79.6811, Perplexity: inf, LR: 3.60e-05, LM: 5.2277, Age: 247.72, Sex: 0.683
2025-10-23 06:18:31,899 - INFO - Epoch 33, Step 400/1000 - Loss: 80.1179, Perplexity: inf, LR: 3.59e-05, LM: 5.2346, Age: 249.16, Sex: 0.682
2025-10-23 06:18:44,529 - INFO - Epoch 33, Step 450/1000 - Loss: 80.4202, Perplexity: inf, LR: 3.58e-05, LM: 5.2362, Age: 250.16, Sex: 0.681
2025-10-23 06:18:57,254 - INFO - Epoch 33, Step 500/1000 - Loss: 79.7450, Perplexity: inf, LR: 3.57e-05, LM: 5.2369, Age: 247.91, Sex: 0.681
2025-10-23 06:19:09,625 - INFO - Epoch 33, Step 550/1000 - Loss: 79.9979, Perplexity: inf, LR: 3.56e-05, LM: 5.2367, Age: 248.75, Sex: 0.680
2025-10-23 06:19:22,281 - INFO - Epoch 33, Step 600/1000 - Loss: 80.4818, Perplexity: inf, LR: 3.55e-05, LM: 5.2320, Age: 250.38, Sex: 0.680
2025-10-23 06:19:34,715 - INFO - Epoch 33, Step 650/1000 - Loss: 80.0111, Perplexity: inf, LR: 3.54e-05, LM: 5.2348, Age: 248.80, Sex: 0.679
2025-10-23 06:19:47,027 - INFO - Epoch 33, Step 700/1000 - Loss: 79.6559, Perplexity: inf, LR: 3.53e-05, LM: 5.2242, Age: 247.65, Sex: 0.679
2025-10-23 06:19:59,653 - INFO - Epoch 33, Step 750/1000 - Loss: 78.9914, Perplexity: inf, LR: 3.52e-05, LM: 5.2220, Age: 245.45, Sex: 0.679
2025-10-23 06:20:12,066 - INFO - Epoch 33, Step 800/1000 - Loss: 78.5832, Perplexity: inf, LR: 3.51e-05, LM: 5.2172, Age: 244.10, Sex: 0.679
2025-10-23 06:20:24,575 - INFO - Epoch 33, Step 850/1000 - Loss: 77.6333, Perplexity: inf, LR: 3.50e-05, LM: 5.2128, Age: 240.95, Sex: 0.678
2025-10-23 06:20:36,678 - INFO - Epoch 33, Step 900/1000 - Loss: 77.9092, Perplexity: inf, LR: 3.49e-05, LM: 5.2160, Age: 241.86, Sex: 0.678
2025-10-23 06:20:49,419 - INFO - Epoch 33, Step 950/1000 - Loss: 78.0968, Perplexity: inf, LR: 3.48e-05, LM: 5.2167, Age: 242.48, Sex: 0.678
2025-10-23 06:21:01,592 - INFO - Epoch 33, Step 1000/1000 - Loss: 78.3872, Perplexity: inf, LR: 3.47e-05, LM: 5.2127, Age: 243.46, Sex: 0.679
2025-10-23 06:21:01,593 - INFO - Epoch 33 Complete - Avg Loss: 78.3872, Avg Perplexity: inf, LM: 5.2127, Age: 243.46, Sex: 0.679
2025-10-23 06:21:21,477 - INFO - Validation - Loss: 5.3169, Perplexity: 234.5215, Token Accuracy: 0.0860, Code Accuracy: 0.0000
2025-10-23 06:21:21,479 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:21:24,845 - INFO - TPL computed on 351 samples: 257.9062
2025-10-23 06:21:24,845 - INFO - Temporal Perplexity (TPL): 257.9062
2025-10-23 06:21:37,433 - INFO - Epoch 34, Step 50/1000 - Loss: 81.8831, Perplexity: inf, LR: 3.46e-05, LM: 5.1983, Age: 255.17, Sex: 0.673
2025-10-23 06:21:49,938 - INFO - Epoch 34, Step 100/1000 - Loss: 81.1581, Perplexity: inf, LR: 3.45e-05, LM: 5.1779, Age: 252.81, Sex: 0.681
2025-10-23 06:22:02,660 - INFO - Epoch 34, Step 150/1000 - Loss: 77.8348, Perplexity: inf, LR: 3.44e-05, LM: 5.1711, Age: 241.76, Sex: 0.679
2025-10-23 06:22:15,128 - INFO - Epoch 34, Step 200/1000 - Loss: 79.8983, Perplexity: inf, LR: 3.43e-05, LM: 5.1919, Age: 248.57, Sex: 0.681
2025-10-23 06:22:27,735 - INFO - Epoch 34, Step 250/1000 - Loss: 79.9261, Perplexity: inf, LR: 3.42e-05, LM: 5.2062, Age: 248.61, Sex: 0.680
2025-10-23 06:22:40,092 - INFO - Epoch 34, Step 300/1000 - Loss: 80.5713, Perplexity: inf, LR: 3.41e-05, LM: 5.2127, Age: 250.74, Sex: 0.677
2025-10-23 06:22:52,585 - INFO - Epoch 34, Step 350/1000 - Loss: 79.5393, Perplexity: inf, LR: 3.40e-05, LM: 5.2144, Age: 247.30, Sex: 0.677
2025-10-23 06:23:05,342 - INFO - Epoch 34, Step 400/1000 - Loss: 78.0650, Perplexity: inf, LR: 3.39e-05, LM: 5.1999, Age: 242.43, Sex: 0.677
2025-10-23 06:23:18,090 - INFO - Epoch 34, Step 450/1000 - Loss: 77.9514, Perplexity: inf, LR: 3.38e-05, LM: 5.2070, Age: 242.03, Sex: 0.675
2025-10-23 06:23:30,191 - INFO - Epoch 34, Step 500/1000 - Loss: 78.4447, Perplexity: inf, LR: 3.37e-05, LM: 5.2132, Age: 243.66, Sex: 0.674
2025-10-23 06:23:42,449 - INFO - Epoch 34, Step 550/1000 - Loss: 78.0472, Perplexity: inf, LR: 3.36e-05, LM: 5.2064, Age: 242.35, Sex: 0.674
2025-10-23 06:23:54,863 - INFO - Epoch 34, Step 600/1000 - Loss: 77.8800, Perplexity: inf, LR: 3.35e-05, LM: 5.2029, Age: 241.81, Sex: 0.675
2025-10-23 06:24:07,528 - INFO - Epoch 34, Step 650/1000 - Loss: 77.8856, Perplexity: inf, LR: 3.34e-05, LM: 5.2051, Age: 241.82, Sex: 0.675
2025-10-23 06:24:19,636 - INFO - Epoch 34, Step 700/1000 - Loss: 78.8159, Perplexity: inf, LR: 3.33e-05, LM: 5.2116, Age: 244.90, Sex: 0.677
2025-10-23 06:24:32,225 - INFO - Epoch 34, Step 750/1000 - Loss: 78.9492, Perplexity: inf, LR: 3.32e-05, LM: 5.2133, Age: 245.34, Sex: 0.676
2025-10-23 06:24:44,770 - INFO - Epoch 34, Step 800/1000 - Loss: 78.8213, Perplexity: inf, LR: 3.31e-05, LM: 5.2088, Age: 244.92, Sex: 0.676
2025-10-23 06:24:57,110 - INFO - Epoch 34, Step 850/1000 - Loss: 78.3178, Perplexity: inf, LR: 3.30e-05, LM: 5.2084, Age: 243.25, Sex: 0.676
2025-10-23 06:25:09,813 - INFO - Epoch 34, Step 900/1000 - Loss: 78.7914, Perplexity: inf, LR: 3.29e-05, LM: 5.2063, Age: 244.83, Sex: 0.677
2025-10-23 06:25:22,376 - INFO - Epoch 34, Step 950/1000 - Loss: 78.5881, Perplexity: inf, LR: 3.28e-05, LM: 5.2048, Age: 244.16, Sex: 0.677
2025-10-23 06:25:34,326 - INFO - Epoch 34, Step 1000/1000 - Loss: 78.5044, Perplexity: inf, LR: 3.27e-05, LM: 5.2015, Age: 243.89, Sex: 0.678
2025-10-23 06:25:34,327 - INFO - Epoch 34 Complete - Avg Loss: 78.5044, Avg Perplexity: inf, LM: 5.2015, Age: 243.89, Sex: 0.678
2025-10-23 06:25:54,363 - INFO - Validation - Loss: 5.2890, Perplexity: 227.5643, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 06:25:54,364 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:25:57,725 - INFO - TPL computed on 351 samples: 254.4765
2025-10-23 06:25:57,725 - INFO - Temporal Perplexity (TPL): 254.4765
2025-10-23 06:26:09,921 - INFO - Epoch 35, Step 50/1000 - Loss: 70.7415, Perplexity: inf, LR: 3.26e-05, LM: 5.1510, Age: 218.16, Sex: 0.711
2025-10-23 06:26:22,664 - INFO - Epoch 35, Step 100/1000 - Loss: 74.0628, Perplexity: inf, LR: 3.24e-05, LM: 5.1725, Age: 229.17, Sex: 0.698
2025-10-23 06:26:34,859 - INFO - Epoch 35, Step 150/1000 - Loss: 76.9240, Perplexity: inf, LR: 3.23e-05, LM: 5.1661, Age: 238.73, Sex: 0.689
2025-10-23 06:26:47,341 - INFO - Epoch 35, Step 200/1000 - Loss: 79.0209, Perplexity: inf, LR: 3.22e-05, LM: 5.1844, Age: 245.66, Sex: 0.688
2025-10-23 06:26:59,794 - INFO - Epoch 35, Step 250/1000 - Loss: 76.9195, Perplexity: inf, LR: 3.21e-05, LM: 5.1783, Age: 238.68, Sex: 0.686
2025-10-23 06:27:12,576 - INFO - Epoch 35, Step 300/1000 - Loss: 76.5792, Perplexity: inf, LR: 3.20e-05, LM: 5.1771, Age: 237.55, Sex: 0.685
2025-10-23 06:27:24,962 - INFO - Epoch 35, Step 350/1000 - Loss: 75.6174, Perplexity: inf, LR: 3.19e-05, LM: 5.1596, Age: 234.40, Sex: 0.686
2025-10-23 06:27:37,472 - INFO - Epoch 35, Step 400/1000 - Loss: 76.6568, Perplexity: inf, LR: 3.18e-05, LM: 5.1689, Age: 237.84, Sex: 0.687
2025-10-23 06:27:50,323 - INFO - Epoch 35, Step 450/1000 - Loss: 77.3197, Perplexity: inf, LR: 3.17e-05, LM: 5.1746, Age: 240.03, Sex: 0.686
2025-10-23 06:28:02,162 - INFO - Epoch 35, Step 500/1000 - Loss: 76.8600, Perplexity: inf, LR: 3.16e-05, LM: 5.1763, Age: 238.49, Sex: 0.685
2025-10-23 06:28:14,972 - INFO - Epoch 35, Step 550/1000 - Loss: 77.0388, Perplexity: inf, LR: 3.15e-05, LM: 5.1823, Age: 239.07, Sex: 0.682
2025-10-23 06:28:27,625 - INFO - Epoch 35, Step 600/1000 - Loss: 77.0358, Perplexity: inf, LR: 3.14e-05, LM: 5.1884, Age: 239.04, Sex: 0.682
2025-10-23 06:28:40,011 - INFO - Epoch 35, Step 650/1000 - Loss: 77.6446, Perplexity: inf, LR: 3.13e-05, LM: 5.1922, Age: 241.05, Sex: 0.682
2025-10-23 06:28:52,211 - INFO - Epoch 35, Step 700/1000 - Loss: 77.3545, Perplexity: inf, LR: 3.12e-05, LM: 5.1905, Age: 240.09, Sex: 0.682
2025-10-23 06:29:04,540 - INFO - Epoch 35, Step 750/1000 - Loss: 77.4921, Perplexity: inf, LR: 3.11e-05, LM: 5.1860, Age: 240.56, Sex: 0.684
2025-10-23 06:29:17,336 - INFO - Epoch 35, Step 800/1000 - Loss: 77.7213, Perplexity: inf, LR: 3.10e-05, LM: 5.1918, Age: 241.31, Sex: 0.683
2025-10-23 06:29:29,710 - INFO - Epoch 35, Step 850/1000 - Loss: 78.1512, Perplexity: inf, LR: 3.09e-05, LM: 5.1904, Age: 242.75, Sex: 0.683
2025-10-23 06:29:42,419 - INFO - Epoch 35, Step 900/1000 - Loss: 78.0598, Perplexity: inf, LR: 3.08e-05, LM: 5.1960, Age: 242.42, Sex: 0.683
2025-10-23 06:29:54,901 - INFO - Epoch 35, Step 950/1000 - Loss: 78.2289, Perplexity: inf, LR: 3.07e-05, LM: 5.2010, Age: 242.97, Sex: 0.684
2025-10-23 06:30:07,643 - INFO - Epoch 35, Step 1000/1000 - Loss: 78.4745, Perplexity: inf, LR: 3.06e-05, LM: 5.2035, Age: 243.78, Sex: 0.684
2025-10-23 06:30:07,644 - INFO - Epoch 35 Complete - Avg Loss: 78.4745, Avg Perplexity: inf, LM: 5.2035, Age: 243.78, Sex: 0.684
2025-10-23 06:30:27,412 - INFO - Validation - Loss: 5.2869, Perplexity: 226.0093, Token Accuracy: 0.0863, Code Accuracy: 0.0000
2025-10-23 06:30:27,413 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:30:30,787 - INFO - TPL computed on 351 samples: 249.4910
2025-10-23 06:30:30,787 - INFO - Temporal Perplexity (TPL): 249.4910
2025-10-23 06:30:33,063 - INFO - Checkpoint saved: epoch 35
2025-10-23 06:30:45,479 - INFO - Epoch 36, Step 50/1000 - Loss: 86.4941, Perplexity: inf, LR: 3.05e-05, LM: 5.1337, Age: 270.75, Sex: 0.679
2025-10-23 06:30:58,169 - INFO - Epoch 36, Step 100/1000 - Loss: 83.6347, Perplexity: inf, LR: 3.04e-05, LM: 5.1454, Age: 261.18, Sex: 0.675
2025-10-23 06:31:10,594 - INFO - Epoch 36, Step 150/1000 - Loss: 81.6831, Perplexity: inf, LR: 3.03e-05, LM: 5.1505, Age: 254.66, Sex: 0.675
2025-10-23 06:31:23,130 - INFO - Epoch 36, Step 200/1000 - Loss: 80.3522, Perplexity: inf, LR: 3.02e-05, LM: 5.1710, Age: 250.15, Sex: 0.679
2025-10-23 06:31:35,230 - INFO - Epoch 36, Step 250/1000 - Loss: 80.2343, Perplexity: inf, LR: 3.01e-05, LM: 5.1762, Age: 249.74, Sex: 0.678
2025-10-23 06:31:47,521 - INFO - Epoch 36, Step 300/1000 - Loss: 79.0634, Perplexity: inf, LR: 3.00e-05, LM: 5.1780, Age: 245.84, Sex: 0.673
2025-10-23 06:32:00,027 - INFO - Epoch 36, Step 350/1000 - Loss: 77.9510, Perplexity: inf, LR: 2.99e-05, LM: 5.1834, Age: 242.11, Sex: 0.676
2025-10-23 06:32:12,648 - INFO - Epoch 36, Step 400/1000 - Loss: 76.8887, Perplexity: inf, LR: 2.98e-05, LM: 5.1710, Age: 238.61, Sex: 0.677
2025-10-23 06:32:25,018 - INFO - Epoch 36, Step 450/1000 - Loss: 76.4411, Perplexity: inf, LR: 2.97e-05, LM: 5.1743, Age: 237.11, Sex: 0.676
2025-10-23 06:32:37,151 - INFO - Epoch 36, Step 500/1000 - Loss: 75.8443, Perplexity: inf, LR: 2.96e-05, LM: 5.1689, Age: 235.13, Sex: 0.675
2025-10-23 06:32:49,364 - INFO - Epoch 36, Step 550/1000 - Loss: 75.6662, Perplexity: inf, LR: 2.95e-05, LM: 5.1802, Age: 234.50, Sex: 0.676
2025-10-23 06:33:02,366 - INFO - Epoch 36, Step 600/1000 - Loss: 76.0078, Perplexity: inf, LR: 2.94e-05, LM: 5.1860, Age: 235.62, Sex: 0.675
2025-10-23 06:33:14,983 - INFO - Epoch 36, Step 650/1000 - Loss: 75.8545, Perplexity: inf, LR: 2.93e-05, LM: 5.1821, Age: 235.13, Sex: 0.674
2025-10-23 06:33:27,614 - INFO - Epoch 36, Step 700/1000 - Loss: 76.5299, Perplexity: inf, LR: 2.92e-05, LM: 5.1897, Age: 237.35, Sex: 0.675
2025-10-23 06:33:39,940 - INFO - Epoch 36, Step 750/1000 - Loss: 76.6835, Perplexity: inf, LR: 2.91e-05, LM: 5.1999, Age: 237.83, Sex: 0.675
2025-10-23 06:33:52,534 - INFO - Epoch 36, Step 800/1000 - Loss: 76.6047, Perplexity: inf, LR: 2.90e-05, LM: 5.1919, Age: 237.59, Sex: 0.674
2025-10-23 06:34:04,977 - INFO - Epoch 36, Step 850/1000 - Loss: 76.9671, Perplexity: inf, LR: 2.89e-05, LM: 5.1943, Age: 238.79, Sex: 0.674
2025-10-23 06:34:17,039 - INFO - Epoch 36, Step 900/1000 - Loss: 76.7050, Perplexity: inf, LR: 2.88e-05, LM: 5.1960, Age: 237.91, Sex: 0.674
2025-10-23 06:34:29,352 - INFO - Epoch 36, Step 950/1000 - Loss: 76.7018, Perplexity: inf, LR: 2.87e-05, LM: 5.2007, Age: 237.89, Sex: 0.674
2025-10-23 06:34:42,143 - INFO - Epoch 36, Step 1000/1000 - Loss: 76.7870, Perplexity: inf, LR: 2.86e-05, LM: 5.1993, Age: 238.18, Sex: 0.673
2025-10-23 06:34:42,144 - INFO - Epoch 36 Complete - Avg Loss: 76.7870, Avg Perplexity: inf, LM: 5.1993, Age: 238.18, Sex: 0.673
2025-10-23 06:35:02,077 - INFO - Validation - Loss: 5.3086, Perplexity: 228.9231, Token Accuracy: 0.0860, Code Accuracy: 0.0000
2025-10-23 06:35:02,079 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:35:05,444 - INFO - TPL computed on 351 samples: 249.2654
2025-10-23 06:35:05,444 - INFO - Temporal Perplexity (TPL): 249.2654
2025-10-23 06:35:17,680 - INFO - Epoch 37, Step 50/1000 - Loss: 83.8295, Perplexity: inf, LR: 2.85e-05, LM: 5.2205, Age: 261.59, Sex: 0.664
2025-10-23 06:35:30,215 - INFO - Epoch 37, Step 100/1000 - Loss: 82.2814, Perplexity: inf, LR: 2.84e-05, LM: 5.1656, Age: 256.61, Sex: 0.657
2025-10-23 06:35:42,666 - INFO - Epoch 37, Step 150/1000 - Loss: 78.6460, Perplexity: inf, LR: 2.83e-05, LM: 5.1746, Age: 244.47, Sex: 0.657
2025-10-23 06:35:55,116 - INFO - Epoch 37, Step 200/1000 - Loss: 79.8120, Perplexity: inf, LR: 2.82e-05, LM: 5.2036, Age: 248.25, Sex: 0.667
2025-10-23 06:36:07,669 - INFO - Epoch 37, Step 250/1000 - Loss: 78.2378, Perplexity: inf, LR: 2.81e-05, LM: 5.2019, Age: 243.01, Sex: 0.669
2025-10-23 06:36:19,866 - INFO - Epoch 37, Step 300/1000 - Loss: 80.6081, Perplexity: inf, LR: 2.80e-05, LM: 5.2084, Age: 250.88, Sex: 0.673
2025-10-23 06:36:32,651 - INFO - Epoch 37, Step 350/1000 - Loss: 80.3508, Perplexity: inf, LR: 2.79e-05, LM: 5.2056, Age: 250.03, Sex: 0.674
2025-10-23 06:36:45,062 - INFO - Epoch 37, Step 400/1000 - Loss: 79.9221, Perplexity: inf, LR: 2.78e-05, LM: 5.2117, Age: 248.58, Sex: 0.676
2025-10-23 06:36:57,581 - INFO - Epoch 37, Step 450/1000 - Loss: 80.7909, Perplexity: inf, LR: 2.77e-05, LM: 5.2111, Age: 251.48, Sex: 0.676
2025-10-23 06:37:10,158 - INFO - Epoch 37, Step 500/1000 - Loss: 80.2790, Perplexity: inf, LR: 2.76e-05, LM: 5.2192, Age: 249.75, Sex: 0.676
2025-10-23 06:37:22,888 - INFO - Epoch 37, Step 550/1000 - Loss: 79.3596, Perplexity: inf, LR: 2.74e-05, LM: 5.2141, Age: 246.70, Sex: 0.675
2025-10-23 06:37:35,274 - INFO - Epoch 37, Step 600/1000 - Loss: 78.7270, Perplexity: inf, LR: 2.73e-05, LM: 5.2103, Age: 244.60, Sex: 0.676
2025-10-23 06:37:47,668 - INFO - Epoch 37, Step 650/1000 - Loss: 78.2824, Perplexity: inf, LR: 2.72e-05, LM: 5.2019, Age: 243.15, Sex: 0.675
2025-10-23 06:38:00,122 - INFO - Epoch 37, Step 700/1000 - Loss: 77.6172, Perplexity: inf, LR: 2.71e-05, LM: 5.1953, Age: 240.96, Sex: 0.675
2025-10-23 06:38:12,453 - INFO - Epoch 37, Step 750/1000 - Loss: 77.8631, Perplexity: inf, LR: 2.70e-05, LM: 5.1967, Age: 241.77, Sex: 0.674
2025-10-23 06:38:24,984 - INFO - Epoch 37, Step 800/1000 - Loss: 77.0920, Perplexity: inf, LR: 2.69e-05, LM: 5.1952, Age: 239.21, Sex: 0.674
2025-10-23 06:38:37,645 - INFO - Epoch 37, Step 850/1000 - Loss: 77.6907, Perplexity: inf, LR: 2.68e-05, LM: 5.2062, Age: 241.17, Sex: 0.674
2025-10-23 06:38:50,388 - INFO - Epoch 37, Step 900/1000 - Loss: 78.1070, Perplexity: inf, LR: 2.67e-05, LM: 5.2065, Age: 242.55, Sex: 0.675
2025-10-23 06:39:02,998 - INFO - Epoch 37, Step 950/1000 - Loss: 78.0172, Perplexity: inf, LR: 2.66e-05, LM: 5.2044, Age: 242.26, Sex: 0.674
2025-10-23 06:39:15,374 - INFO - Epoch 37, Step 1000/1000 - Loss: 78.1521, Perplexity: inf, LR: 2.65e-05, LM: 5.2040, Age: 242.71, Sex: 0.674
2025-10-23 06:39:15,375 - INFO - Epoch 37 Complete - Avg Loss: 78.1521, Avg Perplexity: inf, LM: 5.2040, Age: 242.71, Sex: 0.674
2025-10-23 06:39:35,069 - INFO - Validation - Loss: 5.2873, Perplexity: 224.9023, Token Accuracy: 0.0860, Code Accuracy: 0.0000
2025-10-23 06:39:35,071 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:39:38,437 - INFO - TPL computed on 351 samples: 249.4905
2025-10-23 06:39:38,437 - INFO - Temporal Perplexity (TPL): 249.4905
2025-10-23 06:39:51,104 - INFO - Epoch 38, Step 50/1000 - Loss: 81.4588, Perplexity: inf, LR: 2.64e-05, LM: 5.2400, Age: 253.62, Sex: 0.664
2025-10-23 06:40:03,462 - INFO - Epoch 38, Step 100/1000 - Loss: 80.8032, Perplexity: inf, LR: 2.63e-05, LM: 5.2357, Age: 251.44, Sex: 0.670
2025-10-23 06:40:15,883 - INFO - Epoch 38, Step 150/1000 - Loss: 77.8996, Perplexity: inf, LR: 2.62e-05, LM: 5.2075, Age: 241.86, Sex: 0.673
2025-10-23 06:40:28,072 - INFO - Epoch 38, Step 200/1000 - Loss: 79.0043, Perplexity: inf, LR: 2.61e-05, LM: 5.2102, Age: 245.53, Sex: 0.674
2025-10-23 06:40:40,436 - INFO - Epoch 38, Step 250/1000 - Loss: 80.0387, Perplexity: inf, LR: 2.60e-05, LM: 5.2191, Age: 248.95, Sex: 0.673
2025-10-23 06:40:52,584 - INFO - Epoch 38, Step 300/1000 - Loss: 80.6010, Perplexity: inf, LR: 2.59e-05, LM: 5.2267, Age: 250.80, Sex: 0.675
2025-10-23 06:41:05,132 - INFO - Epoch 38, Step 350/1000 - Loss: 79.9631, Perplexity: inf, LR: 2.58e-05, LM: 5.2248, Age: 248.68, Sex: 0.676
2025-10-23 06:41:17,767 - INFO - Epoch 38, Step 400/1000 - Loss: 80.0613, Perplexity: inf, LR: 2.57e-05, LM: 5.2345, Age: 248.97, Sex: 0.676
2025-10-23 06:41:30,280 - INFO - Epoch 38, Step 450/1000 - Loss: 79.4357, Perplexity: inf, LR: 2.56e-05, LM: 5.2327, Age: 246.89, Sex: 0.674
2025-10-23 06:41:42,770 - INFO - Epoch 38, Step 500/1000 - Loss: 79.8427, Perplexity: inf, LR: 2.55e-05, LM: 5.2373, Age: 248.24, Sex: 0.674
2025-10-23 06:41:55,058 - INFO - Epoch 38, Step 550/1000 - Loss: 79.5103, Perplexity: inf, LR: 2.54e-05, LM: 5.2192, Age: 247.19, Sex: 0.674
2025-10-23 06:42:07,592 - INFO - Epoch 38, Step 600/1000 - Loss: 79.5254, Perplexity: inf, LR: 2.53e-05, LM: 5.2141, Age: 247.26, Sex: 0.674
2025-10-23 06:42:20,243 - INFO - Epoch 38, Step 650/1000 - Loss: 79.1545, Perplexity: inf, LR: 2.52e-05, LM: 5.2168, Age: 246.01, Sex: 0.674
2025-10-23 06:42:32,738 - INFO - Epoch 38, Step 700/1000 - Loss: 78.8644, Perplexity: inf, LR: 2.51e-05, LM: 5.2184, Age: 245.04, Sex: 0.673
2025-10-23 06:42:45,148 - INFO - Epoch 38, Step 750/1000 - Loss: 78.5636, Perplexity: inf, LR: 2.50e-05, LM: 5.2238, Age: 244.02, Sex: 0.674
2025-10-23 06:42:57,795 - INFO - Epoch 38, Step 800/1000 - Loss: 78.2188, Perplexity: inf, LR: 2.49e-05, LM: 5.2233, Age: 242.87, Sex: 0.673
2025-10-23 06:43:10,486 - INFO - Epoch 38, Step 850/1000 - Loss: 78.2532, Perplexity: inf, LR: 2.48e-05, LM: 5.2249, Age: 242.98, Sex: 0.673
2025-10-23 06:43:23,040 - INFO - Epoch 38, Step 900/1000 - Loss: 78.2279, Perplexity: inf, LR: 2.47e-05, LM: 5.2174, Age: 242.92, Sex: 0.673
2025-10-23 06:43:35,704 - INFO - Epoch 38, Step 950/1000 - Loss: 77.9377, Perplexity: inf, LR: 2.46e-05, LM: 5.2220, Age: 241.94, Sex: 0.672
2025-10-23 06:43:48,205 - INFO - Epoch 38, Step 1000/1000 - Loss: 77.6115, Perplexity: inf, LR: 2.45e-05, LM: 5.2209, Age: 240.85, Sex: 0.671
2025-10-23 06:43:48,206 - INFO - Epoch 38 Complete - Avg Loss: 77.6115, Avg Perplexity: inf, LM: 5.2209, Age: 240.85, Sex: 0.671
2025-10-23 06:44:08,132 - INFO - Validation - Loss: 5.2731, Perplexity: 224.2059, Token Accuracy: 0.0869, Code Accuracy: 0.0000
2025-10-23 06:44:08,134 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:44:11,509 - INFO - TPL computed on 351 samples: 246.4295
2025-10-23 06:44:11,509 - INFO - Temporal Perplexity (TPL): 246.4295
2025-10-23 06:44:24,290 - INFO - Epoch 39, Step 50/1000 - Loss: 79.8278, Perplexity: inf, LR: 2.44e-05, LM: 5.1500, Age: 248.48, Sex: 0.675
2025-10-23 06:44:36,807 - INFO - Epoch 39, Step 100/1000 - Loss: 79.4172, Perplexity: inf, LR: 2.43e-05, LM: 5.2331, Age: 246.83, Sex: 0.680
2025-10-23 06:44:49,507 - INFO - Epoch 39, Step 150/1000 - Loss: 79.7769, Perplexity: inf, LR: 2.42e-05, LM: 5.2317, Age: 248.04, Sex: 0.672
2025-10-23 06:45:01,970 - INFO - Epoch 39, Step 200/1000 - Loss: 77.2649, Perplexity: inf, LR: 2.41e-05, LM: 5.2264, Age: 239.68, Sex: 0.674
2025-10-23 06:45:14,334 - INFO - Epoch 39, Step 250/1000 - Loss: 77.8173, Perplexity: inf, LR: 2.40e-05, LM: 5.2186, Age: 241.55, Sex: 0.675
2025-10-23 06:45:26,823 - INFO - Epoch 39, Step 300/1000 - Loss: 78.0442, Perplexity: inf, LR: 2.39e-05, LM: 5.2061, Age: 242.34, Sex: 0.674
2025-10-23 06:45:39,553 - INFO - Epoch 39, Step 350/1000 - Loss: 77.4851, Perplexity: inf, LR: 2.38e-05, LM: 5.2229, Age: 240.42, Sex: 0.675
2025-10-23 06:45:52,155 - INFO - Epoch 39, Step 400/1000 - Loss: 77.0598, Perplexity: inf, LR: 2.37e-05, LM: 5.2359, Age: 238.96, Sex: 0.675
2025-10-23 06:46:04,520 - INFO - Epoch 39, Step 450/1000 - Loss: 76.3774, Perplexity: inf, LR: 2.36e-05, LM: 5.2274, Age: 236.72, Sex: 0.673
2025-10-23 06:46:17,057 - INFO - Epoch 39, Step 500/1000 - Loss: 76.8161, Perplexity: inf, LR: 2.35e-05, LM: 5.2145, Age: 238.22, Sex: 0.672
2025-10-23 06:46:29,484 - INFO - Epoch 39, Step 550/1000 - Loss: 75.7741, Perplexity: inf, LR: 2.34e-05, LM: 5.2120, Age: 234.76, Sex: 0.672
2025-10-23 06:46:41,860 - INFO - Epoch 39, Step 600/1000 - Loss: 76.0533, Perplexity: inf, LR: 2.33e-05, LM: 5.2103, Age: 235.70, Sex: 0.671
2025-10-23 06:46:54,688 - INFO - Epoch 39, Step 650/1000 - Loss: 76.3783, Perplexity: inf, LR: 2.32e-05, LM: 5.2151, Age: 236.76, Sex: 0.671
2025-10-23 06:47:07,195 - INFO - Epoch 39, Step 700/1000 - Loss: 75.9240, Perplexity: inf, LR: 2.31e-05, LM: 5.2148, Age: 235.25, Sex: 0.671
2025-10-23 06:47:19,799 - INFO - Epoch 39, Step 750/1000 - Loss: 76.1542, Perplexity: inf, LR: 2.30e-05, LM: 5.2176, Age: 236.01, Sex: 0.671
2025-10-23 06:47:32,307 - INFO - Epoch 39, Step 800/1000 - Loss: 76.5442, Perplexity: inf, LR: 2.29e-05, LM: 5.2246, Age: 237.28, Sex: 0.672
2025-10-23 06:47:44,563 - INFO - Epoch 39, Step 850/1000 - Loss: 76.3980, Perplexity: inf, LR: 2.28e-05, LM: 5.2154, Age: 236.83, Sex: 0.671
2025-10-23 06:47:57,034 - INFO - Epoch 39, Step 900/1000 - Loss: 76.0766, Perplexity: inf, LR: 2.27e-05, LM: 5.2154, Age: 235.76, Sex: 0.671
2025-10-23 06:48:09,323 - INFO - Epoch 39, Step 950/1000 - Loss: 75.9244, Perplexity: inf, LR: 2.26e-05, LM: 5.2153, Age: 235.25, Sex: 0.671
2025-10-23 06:48:21,895 - INFO - Epoch 39, Step 1000/1000 - Loss: 76.2347, Perplexity: inf, LR: 2.24e-05, LM: 5.2186, Age: 236.27, Sex: 0.672
2025-10-23 06:48:21,896 - INFO - Epoch 39 Complete - Avg Loss: 76.2347, Avg Perplexity: inf, LM: 5.2186, Age: 236.27, Sex: 0.672
2025-10-23 06:48:41,834 - INFO - Validation - Loss: 5.2857, Perplexity: 224.3548, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 06:48:41,835 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:48:45,204 - INFO - TPL computed on 351 samples: 247.0616
2025-10-23 06:48:45,204 - INFO - Temporal Perplexity (TPL): 247.0616
2025-10-23 06:48:57,852 - INFO - Epoch 40, Step 50/1000 - Loss: 75.9631, Perplexity: inf, LR: 2.23e-05, LM: 5.1957, Age: 235.44, Sex: 0.673
2025-10-23 06:49:10,197 - INFO - Epoch 40, Step 100/1000 - Loss: 78.0714, Perplexity: inf, LR: 2.22e-05, LM: 5.2062, Age: 242.44, Sex: 0.670
2025-10-23 06:49:22,810 - INFO - Epoch 40, Step 150/1000 - Loss: 79.2160, Perplexity: inf, LR: 2.21e-05, LM: 5.2156, Age: 246.22, Sex: 0.670
2025-10-23 06:49:34,924 - INFO - Epoch 40, Step 200/1000 - Loss: 80.6241, Perplexity: inf, LR: 2.20e-05, LM: 5.2334, Age: 250.86, Sex: 0.670
2025-10-23 06:49:47,264 - INFO - Epoch 40, Step 250/1000 - Loss: 78.8511, Perplexity: inf, LR: 2.19e-05, LM: 5.2344, Age: 244.94, Sex: 0.671
2025-10-23 06:49:59,717 - INFO - Epoch 40, Step 300/1000 - Loss: 77.7171, Perplexity: inf, LR: 2.18e-05, LM: 5.2342, Age: 241.16, Sex: 0.669
2025-10-23 06:50:12,204 - INFO - Epoch 40, Step 350/1000 - Loss: 77.9203, Perplexity: inf, LR: 2.17e-05, LM: 5.2412, Age: 241.82, Sex: 0.671
2025-10-23 06:50:24,807 - INFO - Epoch 40, Step 400/1000 - Loss: 77.6775, Perplexity: inf, LR: 2.16e-05, LM: 5.2408, Age: 241.01, Sex: 0.673
2025-10-23 06:50:37,086 - INFO - Epoch 40, Step 450/1000 - Loss: 77.7881, Perplexity: inf, LR: 2.15e-05, LM: 5.2358, Age: 241.39, Sex: 0.676
2025-10-23 06:50:49,488 - INFO - Epoch 40, Step 500/1000 - Loss: 77.8771, Perplexity: inf, LR: 2.14e-05, LM: 5.2365, Age: 241.68, Sex: 0.676
2025-10-23 06:51:01,983 - INFO - Epoch 40, Step 550/1000 - Loss: 77.4050, Perplexity: inf, LR: 2.13e-05, LM: 5.2351, Age: 240.12, Sex: 0.676
2025-10-23 06:51:14,596 - INFO - Epoch 40, Step 600/1000 - Loss: 76.8199, Perplexity: inf, LR: 2.12e-05, LM: 5.2316, Age: 238.18, Sex: 0.674
2025-10-23 06:51:27,072 - INFO - Epoch 40, Step 650/1000 - Loss: 77.8438, Perplexity: inf, LR: 2.11e-05, LM: 5.2305, Age: 241.59, Sex: 0.674
2025-10-23 06:51:39,458 - INFO - Epoch 40, Step 700/1000 - Loss: 78.0573, Perplexity: inf, LR: 2.10e-05, LM: 5.2316, Age: 242.30, Sex: 0.672
2025-10-23 06:51:52,084 - INFO - Epoch 40, Step 750/1000 - Loss: 77.7563, Perplexity: inf, LR: 2.09e-05, LM: 5.2309, Age: 241.30, Sex: 0.672
2025-10-23 06:52:04,333 - INFO - Epoch 40, Step 800/1000 - Loss: 77.5076, Perplexity: inf, LR: 2.08e-05, LM: 5.2273, Age: 240.48, Sex: 0.675
2025-10-23 06:52:16,780 - INFO - Epoch 40, Step 850/1000 - Loss: 77.1842, Perplexity: inf, LR: 2.07e-05, LM: 5.2211, Age: 239.43, Sex: 0.677
2025-10-23 06:52:29,531 - INFO - Epoch 40, Step 900/1000 - Loss: 76.8041, Perplexity: inf, LR: 2.06e-05, LM: 5.2242, Age: 238.15, Sex: 0.677
2025-10-23 06:52:41,769 - INFO - Epoch 40, Step 950/1000 - Loss: 76.5621, Perplexity: inf, LR: 2.05e-05, LM: 5.2146, Age: 237.37, Sex: 0.676
2025-10-23 06:52:54,173 - INFO - Epoch 40, Step 1000/1000 - Loss: 76.7490, Perplexity: inf, LR: 2.04e-05, LM: 5.2193, Age: 237.98, Sex: 0.676
2025-10-23 06:52:54,174 - INFO - Epoch 40 Complete - Avg Loss: 76.7490, Avg Perplexity: inf, LM: 5.2193, Age: 237.98, Sex: 0.676
2025-10-23 06:53:13,988 - INFO - Validation - Loss: 5.2725, Perplexity: 221.6650, Token Accuracy: 0.0870, Code Accuracy: 0.0000
2025-10-23 06:53:13,990 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:53:17,357 - INFO - TPL computed on 351 samples: 248.9542
2025-10-23 06:53:17,357 - INFO - Temporal Perplexity (TPL): 248.9542
2025-10-23 06:53:19,558 - INFO - Checkpoint saved: epoch 40
2025-10-23 06:53:31,989 - INFO - Epoch 41, Step 50/1000 - Loss: 82.9558, Perplexity: inf, LR: 2.03e-05, LM: 5.1874, Age: 258.78, Sex: 0.675
2025-10-23 06:53:44,353 - INFO - Epoch 41, Step 100/1000 - Loss: 76.8255, Perplexity: inf, LR: 2.02e-05, LM: 5.1905, Age: 238.33, Sex: 0.676
2025-10-23 06:53:56,616 - INFO - Epoch 41, Step 150/1000 - Loss: 76.6587, Perplexity: inf, LR: 2.01e-05, LM: 5.1956, Age: 237.76, Sex: 0.680
2025-10-23 06:54:09,040 - INFO - Epoch 41, Step 200/1000 - Loss: 79.1377, Perplexity: inf, LR: 2.00e-05, LM: 5.1919, Age: 246.03, Sex: 0.682
2025-10-23 06:54:21,918 - INFO - Epoch 41, Step 250/1000 - Loss: 79.5901, Perplexity: inf, LR: 1.99e-05, LM: 5.1968, Age: 247.52, Sex: 0.683
2025-10-23 06:54:34,232 - INFO - Epoch 41, Step 300/1000 - Loss: 79.6981, Perplexity: inf, LR: 1.98e-05, LM: 5.2189, Age: 247.81, Sex: 0.682
2025-10-23 06:54:46,626 - INFO - Epoch 41, Step 350/1000 - Loss: 78.3288, Perplexity: inf, LR: 1.97e-05, LM: 5.2156, Age: 243.26, Sex: 0.682
2025-10-23 06:54:58,727 - INFO - Epoch 41, Step 400/1000 - Loss: 77.4366, Perplexity: inf, LR: 1.96e-05, LM: 5.2192, Age: 240.27, Sex: 0.681
2025-10-23 06:55:11,234 - INFO - Epoch 41, Step 450/1000 - Loss: 75.8132, Perplexity: inf, LR: 1.95e-05, LM: 5.2147, Age: 234.88, Sex: 0.679
2025-10-23 06:55:23,509 - INFO - Epoch 41, Step 500/1000 - Loss: 75.5900, Perplexity: inf, LR: 1.94e-05, LM: 5.2203, Age: 234.11, Sex: 0.679
2025-10-23 06:55:35,915 - INFO - Epoch 41, Step 550/1000 - Loss: 75.7221, Perplexity: inf, LR: 1.93e-05, LM: 5.2189, Age: 234.56, Sex: 0.677
2025-10-23 06:55:48,403 - INFO - Epoch 41, Step 600/1000 - Loss: 75.3771, Perplexity: inf, LR: 1.92e-05, LM: 5.2080, Age: 233.45, Sex: 0.678
2025-10-23 06:56:00,496 - INFO - Epoch 41, Step 650/1000 - Loss: 75.8965, Perplexity: inf, LR: 1.91e-05, LM: 5.2111, Age: 235.17, Sex: 0.677
2025-10-23 06:56:13,267 - INFO - Epoch 41, Step 700/1000 - Loss: 75.8640, Perplexity: inf, LR: 1.90e-05, LM: 5.2103, Age: 235.06, Sex: 0.677
2025-10-23 06:56:25,514 - INFO - Epoch 41, Step 750/1000 - Loss: 75.4692, Perplexity: inf, LR: 1.89e-05, LM: 5.2125, Age: 233.74, Sex: 0.676
2025-10-23 06:56:37,913 - INFO - Epoch 41, Step 800/1000 - Loss: 75.4913, Perplexity: inf, LR: 1.88e-05, LM: 5.2114, Age: 233.82, Sex: 0.676
2025-10-23 06:56:50,558 - INFO - Epoch 41, Step 850/1000 - Loss: 75.6774, Perplexity: inf, LR: 1.87e-05, LM: 5.2131, Age: 234.43, Sex: 0.675
2025-10-23 06:57:02,910 - INFO - Epoch 41, Step 900/1000 - Loss: 76.0475, Perplexity: inf, LR: 1.86e-05, LM: 5.2177, Age: 235.65, Sex: 0.676
2025-10-23 06:57:15,464 - INFO - Epoch 41, Step 950/1000 - Loss: 76.3419, Perplexity: inf, LR: 1.85e-05, LM: 5.2207, Age: 236.62, Sex: 0.675
2025-10-23 06:57:28,153 - INFO - Epoch 41, Step 1000/1000 - Loss: 76.1360, Perplexity: inf, LR: 1.84e-05, LM: 5.2173, Age: 235.95, Sex: 0.675
2025-10-23 06:57:28,154 - INFO - Epoch 41 Complete - Avg Loss: 76.1360, Avg Perplexity: inf, LM: 5.2173, Age: 235.95, Sex: 0.675
2025-10-23 06:57:47,910 - INFO - Validation - Loss: 5.2827, Perplexity: 223.6254, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 06:57:47,912 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 06:57:51,279 - INFO - TPL computed on 351 samples: 247.1216
2025-10-23 06:57:51,279 - INFO - Temporal Perplexity (TPL): 247.1216
2025-10-23 06:58:03,935 - INFO - Epoch 42, Step 50/1000 - Loss: 79.6729, Perplexity: inf, LR: 1.83e-05, LM: 5.2969, Age: 247.47, Sex: 0.677
2025-10-23 06:58:16,317 - INFO - Epoch 42, Step 100/1000 - Loss: 83.6635, Perplexity: inf, LR: 1.82e-05, LM: 5.2517, Age: 260.92, Sex: 0.676
2025-10-23 06:58:28,764 - INFO - Epoch 42, Step 150/1000 - Loss: 81.6642, Perplexity: inf, LR: 1.81e-05, LM: 5.2362, Age: 254.31, Sex: 0.676
2025-10-23 06:58:41,210 - INFO - Epoch 42, Step 200/1000 - Loss: 81.3791, Perplexity: inf, LR: 1.80e-05, LM: 5.2273, Age: 253.39, Sex: 0.678
2025-10-23 06:58:53,864 - INFO - Epoch 42, Step 250/1000 - Loss: 79.2190, Perplexity: inf, LR: 1.79e-05, LM: 5.2150, Age: 246.23, Sex: 0.676
2025-10-23 06:59:06,909 - INFO - Epoch 42, Step 300/1000 - Loss: 79.3059, Perplexity: inf, LR: 1.78e-05, LM: 5.2176, Age: 246.51, Sex: 0.678
2025-10-23 06:59:19,327 - INFO - Epoch 42, Step 350/1000 - Loss: 78.7552, Perplexity: inf, LR: 1.77e-05, LM: 5.2141, Age: 244.69, Sex: 0.678
2025-10-23 06:59:31,909 - INFO - Epoch 42, Step 400/1000 - Loss: 78.5340, Perplexity: inf, LR: 1.76e-05, LM: 5.2066, Age: 243.97, Sex: 0.677
2025-10-23 06:59:44,304 - INFO - Epoch 42, Step 450/1000 - Loss: 78.3756, Perplexity: inf, LR: 1.74e-05, LM: 5.2012, Age: 243.46, Sex: 0.678
2025-10-23 06:59:56,861 - INFO - Epoch 42, Step 500/1000 - Loss: 78.8826, Perplexity: inf, LR: 1.73e-05, LM: 5.1961, Age: 245.17, Sex: 0.677
2025-10-23 07:00:09,287 - INFO - Epoch 42, Step 550/1000 - Loss: 77.7382, Perplexity: inf, LR: 1.72e-05, LM: 5.1859, Age: 241.39, Sex: 0.677
2025-10-23 07:00:21,941 - INFO - Epoch 42, Step 600/1000 - Loss: 77.6487, Perplexity: inf, LR: 1.71e-05, LM: 5.1881, Age: 241.08, Sex: 0.677
2025-10-23 07:00:34,281 - INFO - Epoch 42, Step 650/1000 - Loss: 77.0215, Perplexity: inf, LR: 1.70e-05, LM: 5.1903, Age: 238.99, Sex: 0.678
2025-10-23 07:00:46,721 - INFO - Epoch 42, Step 700/1000 - Loss: 76.9780, Perplexity: inf, LR: 1.69e-05, LM: 5.1938, Age: 238.83, Sex: 0.677
2025-10-23 07:00:59,601 - INFO - Epoch 42, Step 750/1000 - Loss: 77.0062, Perplexity: inf, LR: 1.68e-05, LM: 5.1992, Age: 238.90, Sex: 0.677
2025-10-23 07:01:11,891 - INFO - Epoch 42, Step 800/1000 - Loss: 76.5795, Perplexity: inf, LR: 1.67e-05, LM: 5.2011, Age: 237.48, Sex: 0.676
2025-10-23 07:01:24,343 - INFO - Epoch 42, Step 850/1000 - Loss: 76.5059, Perplexity: inf, LR: 1.66e-05, LM: 5.2050, Age: 237.22, Sex: 0.676
2025-10-23 07:01:36,556 - INFO - Epoch 42, Step 900/1000 - Loss: 76.8466, Perplexity: inf, LR: 1.65e-05, LM: 5.2040, Age: 238.36, Sex: 0.677
2025-10-23 07:01:48,791 - INFO - Epoch 42, Step 950/1000 - Loss: 76.7087, Perplexity: inf, LR: 1.64e-05, LM: 5.2025, Age: 237.90, Sex: 0.677
2025-10-23 07:02:01,216 - INFO - Epoch 42, Step 1000/1000 - Loss: 76.4735, Perplexity: inf, LR: 1.63e-05, LM: 5.2009, Age: 237.12, Sex: 0.677
2025-10-23 07:02:01,217 - INFO - Epoch 42 Complete - Avg Loss: 76.4735, Avg Perplexity: inf, LM: 5.2009, Age: 237.12, Sex: 0.677
2025-10-23 07:02:20,962 - INFO - Validation - Loss: 5.2671, Perplexity: 221.4694, Token Accuracy: 0.0867, Code Accuracy: 0.0000
2025-10-23 07:02:20,963 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:02:24,332 - INFO - TPL computed on 351 samples: 248.1912
2025-10-23 07:02:24,332 - INFO - Temporal Perplexity (TPL): 248.1912
2025-10-23 07:02:36,776 - INFO - Epoch 43, Step 50/1000 - Loss: 73.8615, Perplexity: inf, LR: 1.62e-05, LM: 5.1619, Age: 228.55, Sex: 0.675
2025-10-23 07:02:49,391 - INFO - Epoch 43, Step 100/1000 - Loss: 75.9684, Perplexity: inf, LR: 1.61e-05, LM: 5.1742, Age: 235.53, Sex: 0.670
2025-10-23 07:03:01,839 - INFO - Epoch 43, Step 150/1000 - Loss: 77.9441, Perplexity: inf, LR: 1.60e-05, LM: 5.2034, Age: 242.02, Sex: 0.675
2025-10-23 07:03:14,326 - INFO - Epoch 43, Step 200/1000 - Loss: 77.5614, Perplexity: inf, LR: 1.59e-05, LM: 5.2036, Age: 240.74, Sex: 0.676
2025-10-23 07:03:26,730 - INFO - Epoch 43, Step 250/1000 - Loss: 77.6961, Perplexity: inf, LR: 1.58e-05, LM: 5.1897, Age: 241.24, Sex: 0.674
2025-10-23 07:03:39,084 - INFO - Epoch 43, Step 300/1000 - Loss: 78.4449, Perplexity: inf, LR: 1.57e-05, LM: 5.1696, Age: 243.80, Sex: 0.675
2025-10-23 07:03:51,132 - INFO - Epoch 43, Step 350/1000 - Loss: 78.0623, Perplexity: inf, LR: 1.56e-05, LM: 5.1749, Age: 242.51, Sex: 0.675
2025-10-23 07:04:03,785 - INFO - Epoch 43, Step 400/1000 - Loss: 77.8141, Perplexity: inf, LR: 1.55e-05, LM: 5.1650, Age: 241.71, Sex: 0.675
2025-10-23 07:04:16,090 - INFO - Epoch 43, Step 450/1000 - Loss: 76.9403, Perplexity: inf, LR: 1.54e-05, LM: 5.1601, Age: 238.82, Sex: 0.674
2025-10-23 07:04:28,714 - INFO - Epoch 43, Step 500/1000 - Loss: 76.9816, Perplexity: inf, LR: 1.53e-05, LM: 5.1663, Age: 238.93, Sex: 0.674
2025-10-23 07:04:41,257 - INFO - Epoch 43, Step 550/1000 - Loss: 77.0793, Perplexity: inf, LR: 1.52e-05, LM: 5.1656, Age: 239.26, Sex: 0.674
2025-10-23 07:04:53,427 - INFO - Epoch 43, Step 600/1000 - Loss: 76.8848, Perplexity: inf, LR: 1.51e-05, LM: 5.1686, Age: 238.60, Sex: 0.673
2025-10-23 07:05:05,775 - INFO - Epoch 43, Step 650/1000 - Loss: 76.3221, Perplexity: inf, LR: 1.50e-05, LM: 5.1768, Age: 236.70, Sex: 0.675
2025-10-23 07:05:17,996 - INFO - Epoch 43, Step 700/1000 - Loss: 76.1570, Perplexity: inf, LR: 1.49e-05, LM: 5.1813, Age: 236.14, Sex: 0.675
2025-10-23 07:05:30,136 - INFO - Epoch 43, Step 750/1000 - Loss: 76.3891, Perplexity: inf, LR: 1.48e-05, LM: 5.1822, Age: 236.91, Sex: 0.675
2025-10-23 07:05:42,470 - INFO - Epoch 43, Step 800/1000 - Loss: 76.1049, Perplexity: inf, LR: 1.47e-05, LM: 5.1889, Age: 235.94, Sex: 0.675
2025-10-23 07:05:54,868 - INFO - Epoch 43, Step 850/1000 - Loss: 75.8396, Perplexity: inf, LR: 1.46e-05, LM: 5.1903, Age: 235.05, Sex: 0.675
2025-10-23 07:06:07,230 - INFO - Epoch 43, Step 900/1000 - Loss: 75.9127, Perplexity: inf, LR: 1.45e-05, LM: 5.1966, Age: 235.27, Sex: 0.675
2025-10-23 07:06:19,818 - INFO - Epoch 43, Step 950/1000 - Loss: 76.0783, Perplexity: inf, LR: 1.44e-05, LM: 5.2011, Age: 235.81, Sex: 0.676
2025-10-23 07:06:32,290 - INFO - Epoch 43, Step 1000/1000 - Loss: 76.2990, Perplexity: inf, LR: 1.43e-05, LM: 5.2063, Age: 236.52, Sex: 0.676
2025-10-23 07:06:32,291 - INFO - Epoch 43 Complete - Avg Loss: 76.2990, Avg Perplexity: inf, LM: 5.2063, Age: 236.52, Sex: 0.676
2025-10-23 07:06:52,026 - INFO - Validation - Loss: 5.2736, Perplexity: 220.0560, Token Accuracy: 0.0864, Code Accuracy: 0.0000
2025-10-23 07:06:52,028 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:06:55,397 - INFO - TPL computed on 351 samples: 245.9841
2025-10-23 07:06:55,397 - INFO - Temporal Perplexity (TPL): 245.9841
2025-10-23 07:07:07,968 - INFO - Epoch 44, Step 50/1000 - Loss: 94.2082, Perplexity: inf, LR: 1.42e-05, LM: 5.2615, Age: 296.04, Sex: 0.667
2025-10-23 07:07:20,373 - INFO - Epoch 44, Step 100/1000 - Loss: 85.5806, Perplexity: inf, LR: 1.41e-05, LM: 5.2811, Age: 267.21, Sex: 0.676
2025-10-23 07:07:32,935 - INFO - Epoch 44, Step 150/1000 - Loss: 83.7455, Perplexity: inf, LR: 1.40e-05, LM: 5.2914, Age: 261.06, Sex: 0.673
2025-10-23 07:07:45,528 - INFO - Epoch 44, Step 200/1000 - Loss: 82.2026, Perplexity: inf, LR: 1.39e-05, LM: 5.2800, Age: 255.96, Sex: 0.673
2025-10-23 07:07:57,880 - INFO - Epoch 44, Step 250/1000 - Loss: 83.1590, Perplexity: inf, LR: 1.38e-05, LM: 5.2733, Age: 259.17, Sex: 0.671
2025-10-23 07:08:10,434 - INFO - Epoch 44, Step 300/1000 - Loss: 83.5214, Perplexity: inf, LR: 1.37e-05, LM: 5.2693, Age: 260.39, Sex: 0.670
2025-10-23 07:08:23,080 - INFO - Epoch 44, Step 350/1000 - Loss: 81.3201, Perplexity: inf, LR: 1.36e-05, LM: 5.2630, Age: 253.08, Sex: 0.673
2025-10-23 07:08:35,518 - INFO - Epoch 44, Step 400/1000 - Loss: 79.6463, Perplexity: inf, LR: 1.35e-05, LM: 5.2526, Age: 247.53, Sex: 0.674
2025-10-23 07:08:47,983 - INFO - Epoch 44, Step 450/1000 - Loss: 78.8094, Perplexity: inf, LR: 1.34e-05, LM: 5.2470, Age: 244.76, Sex: 0.674
2025-10-23 07:09:00,322 - INFO - Epoch 44, Step 500/1000 - Loss: 77.6931, Perplexity: inf, LR: 1.33e-05, LM: 5.2301, Age: 241.09, Sex: 0.674
2025-10-23 07:09:12,801 - INFO - Epoch 44, Step 550/1000 - Loss: 77.8939, Perplexity: inf, LR: 1.32e-05, LM: 5.2190, Age: 241.80, Sex: 0.674
2025-10-23 07:09:25,388 - INFO - Epoch 44, Step 600/1000 - Loss: 77.7735, Perplexity: inf, LR: 1.31e-05, LM: 5.2200, Age: 241.40, Sex: 0.674
2025-10-23 07:09:38,085 - INFO - Epoch 44, Step 650/1000 - Loss: 77.9802, Perplexity: inf, LR: 1.30e-05, LM: 5.2187, Age: 242.09, Sex: 0.675
2025-10-23 07:09:50,305 - INFO - Epoch 44, Step 700/1000 - Loss: 78.1028, Perplexity: inf, LR: 1.29e-05, LM: 5.2184, Age: 242.50, Sex: 0.675
2025-10-23 07:10:02,596 - INFO - Epoch 44, Step 750/1000 - Loss: 78.2466, Perplexity: inf, LR: 1.28e-05, LM: 5.2256, Age: 242.95, Sex: 0.675
2025-10-23 07:10:14,812 - INFO - Epoch 44, Step 800/1000 - Loss: 78.2779, Perplexity: inf, LR: 1.27e-05, LM: 5.2220, Age: 243.07, Sex: 0.675
2025-10-23 07:10:27,492 - INFO - Epoch 44, Step 850/1000 - Loss: 77.4996, Perplexity: inf, LR: 1.26e-05, LM: 5.2245, Age: 240.47, Sex: 0.675
2025-10-23 07:10:39,574 - INFO - Epoch 44, Step 900/1000 - Loss: 77.6206, Perplexity: inf, LR: 1.24e-05, LM: 5.2293, Age: 240.85, Sex: 0.675
2025-10-23 07:10:52,209 - INFO - Epoch 44, Step 950/1000 - Loss: 77.5500, Perplexity: inf, LR: 1.23e-05, LM: 5.2214, Age: 240.65, Sex: 0.675
2025-10-23 07:11:04,420 - INFO - Epoch 44, Step 1000/1000 - Loss: 77.2352, Perplexity: inf, LR: 1.22e-05, LM: 5.2243, Age: 239.59, Sex: 0.675
2025-10-23 07:11:04,421 - INFO - Epoch 44 Complete - Avg Loss: 77.2352, Avg Perplexity: inf, LM: 5.2243, Age: 239.59, Sex: 0.675
2025-10-23 07:11:24,159 - INFO - Validation - Loss: 5.2786, Perplexity: 225.2189, Token Accuracy: 0.0863, Code Accuracy: 0.0000
2025-10-23 07:11:24,160 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:11:27,522 - INFO - TPL computed on 351 samples: 244.9560
2025-10-23 07:11:27,522 - INFO - Temporal Perplexity (TPL): 244.9560
2025-10-23 07:11:39,942 - INFO - Epoch 45, Step 50/1000 - Loss: 69.8072, Perplexity: inf, LR: 1.21e-05, LM: 5.1555, Age: 215.05, Sex: 0.682
2025-10-23 07:11:52,184 - INFO - Epoch 45, Step 100/1000 - Loss: 71.6206, Perplexity: inf, LR: 1.20e-05, LM: 5.1564, Age: 221.10, Sex: 0.671
2025-10-23 07:12:04,923 - INFO - Epoch 45, Step 150/1000 - Loss: 75.8837, Perplexity: inf, LR: 1.19e-05, LM: 5.1814, Age: 235.23, Sex: 0.669
2025-10-23 07:12:17,231 - INFO - Epoch 45, Step 200/1000 - Loss: 77.5697, Perplexity: inf, LR: 1.18e-05, LM: 5.1942, Age: 240.80, Sex: 0.673
2025-10-23 07:12:29,810 - INFO - Epoch 45, Step 250/1000 - Loss: 77.9032, Perplexity: inf, LR: 1.17e-05, LM: 5.2012, Age: 241.89, Sex: 0.674
2025-10-23 07:12:42,333 - INFO - Epoch 45, Step 300/1000 - Loss: 76.9516, Perplexity: inf, LR: 1.16e-05, LM: 5.2036, Age: 238.71, Sex: 0.675
2025-10-23 07:12:54,556 - INFO - Epoch 45, Step 350/1000 - Loss: 75.2523, Perplexity: inf, LR: 1.15e-05, LM: 5.1911, Age: 233.09, Sex: 0.674
2025-10-23 07:13:06,901 - INFO - Epoch 45, Step 400/1000 - Loss: 76.0721, Perplexity: inf, LR: 1.14e-05, LM: 5.2020, Age: 235.78, Sex: 0.675
2025-10-23 07:13:19,526 - INFO - Epoch 45, Step 450/1000 - Loss: 76.2925, Perplexity: inf, LR: 1.13e-05, LM: 5.1980, Age: 236.53, Sex: 0.676
2025-10-23 07:13:32,254 - INFO - Epoch 45, Step 500/1000 - Loss: 76.2483, Perplexity: inf, LR: 1.12e-05, LM: 5.1963, Age: 236.39, Sex: 0.676
2025-10-23 07:13:44,920 - INFO - Epoch 45, Step 550/1000 - Loss: 76.0478, Perplexity: inf, LR: 1.11e-05, LM: 5.1981, Age: 235.71, Sex: 0.677
2025-10-23 07:13:57,364 - INFO - Epoch 45, Step 600/1000 - Loss: 76.5742, Perplexity: inf, LR: 1.10e-05, LM: 5.1960, Age: 237.47, Sex: 0.679
2025-10-23 07:14:09,853 - INFO - Epoch 45, Step 650/1000 - Loss: 76.7765, Perplexity: inf, LR: 1.09e-05, LM: 5.1929, Age: 238.16, Sex: 0.679
2025-10-23 07:14:22,679 - INFO - Epoch 45, Step 700/1000 - Loss: 77.9738, Perplexity: inf, LR: 1.08e-05, LM: 5.2030, Age: 242.12, Sex: 0.680
2025-10-23 07:14:34,969 - INFO - Epoch 45, Step 750/1000 - Loss: 77.4853, Perplexity: inf, LR: 1.07e-05, LM: 5.1999, Age: 240.50, Sex: 0.679
2025-10-23 07:14:47,497 - INFO - Epoch 45, Step 800/1000 - Loss: 76.6314, Perplexity: inf, LR: 1.06e-05, LM: 5.1987, Age: 237.66, Sex: 0.679
2025-10-23 07:14:59,951 - INFO - Epoch 45, Step 850/1000 - Loss: 76.3084, Perplexity: inf, LR: 1.05e-05, LM: 5.2019, Age: 236.57, Sex: 0.680
2025-10-23 07:15:12,300 - INFO - Epoch 45, Step 900/1000 - Loss: 76.2487, Perplexity: inf, LR: 1.04e-05, LM: 5.2019, Age: 236.37, Sex: 0.679
2025-10-23 07:15:24,441 - INFO - Epoch 45, Step 950/1000 - Loss: 76.3927, Perplexity: inf, LR: 1.03e-05, LM: 5.2087, Age: 236.83, Sex: 0.678
2025-10-23 07:15:37,224 - INFO - Epoch 45, Step 1000/1000 - Loss: 76.2253, Perplexity: inf, LR: 1.02e-05, LM: 5.2045, Age: 236.28, Sex: 0.678
2025-10-23 07:15:37,225 - INFO - Epoch 45 Complete - Avg Loss: 76.2253, Avg Perplexity: inf, LM: 5.2045, Age: 236.28, Sex: 0.678
2025-10-23 07:15:56,998 - INFO - Validation - Loss: 5.2958, Perplexity: 227.3914, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 07:15:56,999 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:16:00,372 - INFO - TPL computed on 351 samples: 246.3331
2025-10-23 07:16:00,372 - INFO - Temporal Perplexity (TPL): 246.3331
2025-10-23 07:16:02,656 - INFO - Checkpoint saved: epoch 45
2025-10-23 07:16:15,249 - INFO - Epoch 46, Step 50/1000 - Loss: 77.4845, Perplexity: inf, LR: 1.01e-05, LM: 5.3117, Age: 240.12, Sex: 0.677
2025-10-23 07:16:28,008 - INFO - Epoch 46, Step 100/1000 - Loss: 77.4663, Perplexity: inf, LR: 1.00e-05, LM: 5.2640, Age: 240.22, Sex: 0.679
2025-10-23 07:16:40,304 - INFO - Epoch 46, Step 150/1000 - Loss: 77.4021, Perplexity: inf, LR: 9.90e-06, LM: 5.2585, Age: 240.03, Sex: 0.674
2025-10-23 07:16:52,695 - INFO - Epoch 46, Step 200/1000 - Loss: 78.0594, Perplexity: inf, LR: 9.80e-06, LM: 5.2565, Age: 242.22, Sex: 0.679
2025-10-23 07:17:05,221 - INFO - Epoch 46, Step 250/1000 - Loss: 76.2710, Perplexity: inf, LR: 9.69e-06, LM: 5.2234, Age: 236.37, Sex: 0.678
2025-10-23 07:17:17,547 - INFO - Epoch 46, Step 300/1000 - Loss: 75.5006, Perplexity: inf, LR: 9.59e-06, LM: 5.2246, Age: 233.80, Sex: 0.679
2025-10-23 07:17:29,858 - INFO - Epoch 46, Step 350/1000 - Loss: 74.9246, Perplexity: inf, LR: 9.49e-06, LM: 5.2192, Age: 231.90, Sex: 0.681
2025-10-23 07:17:42,361 - INFO - Epoch 46, Step 400/1000 - Loss: 75.2730, Perplexity: inf, LR: 9.39e-06, LM: 5.2191, Age: 233.06, Sex: 0.679
2025-10-23 07:17:54,542 - INFO - Epoch 46, Step 450/1000 - Loss: 75.8624, Perplexity: inf, LR: 9.29e-06, LM: 5.2190, Age: 235.03, Sex: 0.678
2025-10-23 07:18:07,130 - INFO - Epoch 46, Step 500/1000 - Loss: 76.9253, Perplexity: inf, LR: 9.18e-06, LM: 5.2149, Age: 238.58, Sex: 0.677
2025-10-23 07:18:19,889 - INFO - Epoch 46, Step 550/1000 - Loss: 76.2684, Perplexity: inf, LR: 9.08e-06, LM: 5.2160, Age: 236.39, Sex: 0.678
2025-10-23 07:18:32,934 - INFO - Epoch 46, Step 600/1000 - Loss: 76.7275, Perplexity: inf, LR: 8.98e-06, LM: 5.2122, Age: 237.93, Sex: 0.678
2025-10-23 07:18:45,103 - INFO - Epoch 46, Step 650/1000 - Loss: 76.4534, Perplexity: inf, LR: 8.88e-06, LM: 5.2149, Age: 237.01, Sex: 0.678
2025-10-23 07:18:57,829 - INFO - Epoch 46, Step 700/1000 - Loss: 76.4817, Perplexity: inf, LR: 8.78e-06, LM: 5.2114, Age: 237.12, Sex: 0.678
2025-10-23 07:19:10,344 - INFO - Epoch 46, Step 750/1000 - Loss: 76.3182, Perplexity: inf, LR: 8.67e-06, LM: 5.2146, Age: 236.56, Sex: 0.679
2025-10-23 07:19:22,662 - INFO - Epoch 46, Step 800/1000 - Loss: 76.5981, Perplexity: inf, LR: 8.57e-06, LM: 5.2106, Age: 237.51, Sex: 0.679
2025-10-23 07:19:35,123 - INFO - Epoch 46, Step 850/1000 - Loss: 76.8092, Perplexity: inf, LR: 8.47e-06, LM: 5.2144, Age: 238.20, Sex: 0.679
2025-10-23 07:19:47,420 - INFO - Epoch 46, Step 900/1000 - Loss: 77.0797, Perplexity: inf, LR: 8.37e-06, LM: 5.2152, Age: 239.10, Sex: 0.678
2025-10-23 07:19:59,980 - INFO - Epoch 46, Step 950/1000 - Loss: 76.8015, Perplexity: inf, LR: 8.27e-06, LM: 5.2169, Age: 238.16, Sex: 0.678
2025-10-23 07:20:12,939 - INFO - Epoch 46, Step 1000/1000 - Loss: 77.0522, Perplexity: inf, LR: 8.16e-06, LM: 5.2198, Age: 238.99, Sex: 0.678
2025-10-23 07:20:12,940 - INFO - Epoch 46 Complete - Avg Loss: 77.0522, Avg Perplexity: inf, LM: 5.2198, Age: 238.99, Sex: 0.678
2025-10-23 07:20:32,735 - INFO - Validation - Loss: 5.2693, Perplexity: 219.5928, Token Accuracy: 0.0860, Code Accuracy: 0.0000
2025-10-23 07:20:32,736 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:20:36,108 - INFO - TPL computed on 351 samples: 245.6056
2025-10-23 07:20:36,108 - INFO - Temporal Perplexity (TPL): 245.6056
2025-10-23 07:20:48,457 - INFO - Epoch 47, Step 50/1000 - Loss: 74.7806, Perplexity: inf, LR: 8.06e-06, LM: 5.1948, Age: 231.50, Sex: 0.682
2025-10-23 07:21:00,645 - INFO - Epoch 47, Step 100/1000 - Loss: 73.5030, Perplexity: inf, LR: 7.96e-06, LM: 5.1680, Age: 227.33, Sex: 0.676
2025-10-23 07:21:13,069 - INFO - Epoch 47, Step 150/1000 - Loss: 72.7810, Perplexity: inf, LR: 7.86e-06, LM: 5.1817, Age: 224.88, Sex: 0.678
2025-10-23 07:21:25,896 - INFO - Epoch 47, Step 200/1000 - Loss: 73.6451, Perplexity: inf, LR: 7.76e-06, LM: 5.1677, Age: 227.81, Sex: 0.677
2025-10-23 07:21:38,608 - INFO - Epoch 47, Step 250/1000 - Loss: 75.0088, Perplexity: inf, LR: 7.65e-06, LM: 5.1723, Age: 232.34, Sex: 0.677
2025-10-23 07:21:51,183 - INFO - Epoch 47, Step 300/1000 - Loss: 76.2736, Perplexity: inf, LR: 7.55e-06, LM: 5.1838, Age: 236.52, Sex: 0.676
2025-10-23 07:22:03,685 - INFO - Epoch 47, Step 350/1000 - Loss: 77.0846, Perplexity: inf, LR: 7.45e-06, LM: 5.1839, Age: 239.22, Sex: 0.676
2025-10-23 07:22:16,306 - INFO - Epoch 47, Step 400/1000 - Loss: 77.2831, Perplexity: inf, LR: 7.35e-06, LM: 5.1929, Age: 239.85, Sex: 0.675
2025-10-23 07:22:28,671 - INFO - Epoch 47, Step 450/1000 - Loss: 77.7688, Perplexity: inf, LR: 7.24e-06, LM: 5.1869, Age: 241.49, Sex: 0.675
2025-10-23 07:22:41,087 - INFO - Epoch 47, Step 500/1000 - Loss: 77.8373, Perplexity: inf, LR: 7.14e-06, LM: 5.1875, Age: 241.72, Sex: 0.676
2025-10-23 07:22:53,696 - INFO - Epoch 47, Step 550/1000 - Loss: 77.5962, Perplexity: inf, LR: 7.04e-06, LM: 5.1884, Age: 240.91, Sex: 0.676
2025-10-23 07:23:06,333 - INFO - Epoch 47, Step 600/1000 - Loss: 77.9690, Perplexity: inf, LR: 6.94e-06, LM: 5.1965, Age: 242.12, Sex: 0.676
2025-10-23 07:23:18,787 - INFO - Epoch 47, Step 650/1000 - Loss: 78.0292, Perplexity: inf, LR: 6.84e-06, LM: 5.2029, Age: 242.30, Sex: 0.676
2025-10-23 07:23:31,349 - INFO - Epoch 47, Step 700/1000 - Loss: 77.1610, Perplexity: inf, LR: 6.73e-06, LM: 5.1971, Age: 239.43, Sex: 0.676
2025-10-23 07:23:44,242 - INFO - Epoch 47, Step 750/1000 - Loss: 76.5521, Perplexity: inf, LR: 6.63e-06, LM: 5.1993, Age: 237.39, Sex: 0.676
2025-10-23 07:23:56,726 - INFO - Epoch 47, Step 800/1000 - Loss: 76.7532, Perplexity: inf, LR: 6.53e-06, LM: 5.2016, Age: 238.05, Sex: 0.677
2025-10-23 07:24:08,886 - INFO - Epoch 47, Step 850/1000 - Loss: 76.6810, Perplexity: inf, LR: 6.43e-06, LM: 5.2128, Age: 237.78, Sex: 0.677
2025-10-23 07:24:21,523 - INFO - Epoch 47, Step 900/1000 - Loss: 76.8592, Perplexity: inf, LR: 6.33e-06, LM: 5.2125, Age: 238.37, Sex: 0.678
2025-10-23 07:24:34,071 - INFO - Epoch 47, Step 950/1000 - Loss: 76.5192, Perplexity: inf, LR: 6.22e-06, LM: 5.2151, Age: 237.23, Sex: 0.678
2025-10-23 07:24:46,557 - INFO - Epoch 47, Step 1000/1000 - Loss: 76.4363, Perplexity: inf, LR: 6.12e-06, LM: 5.2091, Age: 236.97, Sex: 0.678
2025-10-23 07:24:46,558 - INFO - Epoch 47 Complete - Avg Loss: 76.4363, Avg Perplexity: inf, LM: 5.2091, Age: 236.97, Sex: 0.678
2025-10-23 07:25:06,477 - INFO - Validation - Loss: 5.2759, Perplexity: 222.6106, Token Accuracy: 0.0863, Code Accuracy: 0.0000
2025-10-23 07:25:06,478 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:25:09,846 - INFO - TPL computed on 351 samples: 245.4558
2025-10-23 07:25:09,846 - INFO - Temporal Perplexity (TPL): 245.4558
2025-10-23 07:25:22,130 - INFO - Epoch 48, Step 50/1000 - Loss: 66.1563, Perplexity: inf, LR: 6.02e-06, LM: 5.1399, Age: 202.94, Sex: 0.669
2025-10-23 07:25:34,369 - INFO - Epoch 48, Step 100/1000 - Loss: 69.0657, Perplexity: inf, LR: 5.92e-06, LM: 5.1769, Age: 212.51, Sex: 0.677
2025-10-23 07:25:46,929 - INFO - Epoch 48, Step 150/1000 - Loss: 73.1438, Perplexity: inf, LR: 5.82e-06, LM: 5.1887, Age: 226.06, Sex: 0.681
2025-10-23 07:25:59,643 - INFO - Epoch 48, Step 200/1000 - Loss: 72.9752, Perplexity: inf, LR: 5.71e-06, LM: 5.1903, Age: 225.50, Sex: 0.681
2025-10-23 07:26:11,871 - INFO - Epoch 48, Step 250/1000 - Loss: 73.3238, Perplexity: inf, LR: 5.61e-06, LM: 5.2050, Age: 226.61, Sex: 0.681
2025-10-23 07:26:24,327 - INFO - Epoch 48, Step 300/1000 - Loss: 74.8424, Perplexity: inf, LR: 5.51e-06, LM: 5.2123, Age: 231.65, Sex: 0.681
2025-10-23 07:26:36,844 - INFO - Epoch 48, Step 350/1000 - Loss: 75.1785, Perplexity: inf, LR: 5.41e-06, LM: 5.2265, Age: 232.72, Sex: 0.680
2025-10-23 07:26:49,154 - INFO - Epoch 48, Step 400/1000 - Loss: 75.7120, Perplexity: inf, LR: 5.31e-06, LM: 5.2222, Age: 234.51, Sex: 0.681
2025-10-23 07:27:01,653 - INFO - Epoch 48, Step 450/1000 - Loss: 74.9638, Perplexity: inf, LR: 5.20e-06, LM: 5.2178, Age: 232.03, Sex: 0.681
2025-10-23 07:27:14,267 - INFO - Epoch 48, Step 500/1000 - Loss: 75.5782, Perplexity: inf, LR: 5.10e-06, LM: 5.2250, Age: 234.06, Sex: 0.681
2025-10-23 07:27:26,808 - INFO - Epoch 48, Step 550/1000 - Loss: 75.7753, Perplexity: inf, LR: 5.00e-06, LM: 5.2257, Age: 234.71, Sex: 0.680
2025-10-23 07:27:39,574 - INFO - Epoch 48, Step 600/1000 - Loss: 75.3128, Perplexity: inf, LR: 4.90e-06, LM: 5.2252, Age: 233.17, Sex: 0.680
2025-10-23 07:27:52,258 - INFO - Epoch 48, Step 650/1000 - Loss: 74.8159, Perplexity: inf, LR: 4.80e-06, LM: 5.2175, Age: 231.54, Sex: 0.679
2025-10-23 07:28:04,657 - INFO - Epoch 48, Step 700/1000 - Loss: 75.4115, Perplexity: inf, LR: 4.69e-06, LM: 5.2234, Age: 233.51, Sex: 0.678
2025-10-23 07:28:16,683 - INFO - Epoch 48, Step 750/1000 - Loss: 75.8283, Perplexity: inf, LR: 4.59e-06, LM: 5.2192, Age: 234.91, Sex: 0.678
2025-10-23 07:28:29,011 - INFO - Epoch 48, Step 800/1000 - Loss: 75.5659, Perplexity: inf, LR: 4.49e-06, LM: 5.2198, Age: 234.04, Sex: 0.677
2025-10-23 07:28:41,728 - INFO - Epoch 48, Step 850/1000 - Loss: 75.3545, Perplexity: inf, LR: 4.39e-06, LM: 5.2193, Age: 233.33, Sex: 0.678
2025-10-23 07:28:54,389 - INFO - Epoch 48, Step 900/1000 - Loss: 74.9799, Perplexity: inf, LR: 4.29e-06, LM: 5.2140, Age: 232.10, Sex: 0.677
2025-10-23 07:29:06,838 - INFO - Epoch 48, Step 950/1000 - Loss: 75.4371, Perplexity: inf, LR: 4.18e-06, LM: 5.2154, Age: 233.62, Sex: 0.677
2025-10-23 07:29:18,845 - INFO - Epoch 48, Step 1000/1000 - Loss: 75.2639, Perplexity: inf, LR: 4.08e-06, LM: 5.2129, Age: 233.05, Sex: 0.677
2025-10-23 07:29:18,846 - INFO - Epoch 48 Complete - Avg Loss: 75.2639, Avg Perplexity: inf, LM: 5.2129, Age: 233.05, Sex: 0.677
2025-10-23 07:29:38,724 - INFO - Validation - Loss: 5.2690, Perplexity: 221.4626, Token Accuracy: 0.0865, Code Accuracy: 0.0000
2025-10-23 07:29:38,726 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:29:42,103 - INFO - TPL computed on 351 samples: 244.4567
2025-10-23 07:29:42,103 - INFO - Temporal Perplexity (TPL): 244.4567
2025-10-23 07:29:54,379 - INFO - Epoch 49, Step 50/1000 - Loss: 73.1145, Perplexity: inf, LR: 3.98e-06, LM: 5.0762, Age: 226.34, Sex: 0.682
2025-10-23 07:30:07,126 - INFO - Epoch 49, Step 100/1000 - Loss: 76.0812, Perplexity: inf, LR: 3.88e-06, LM: 5.1835, Age: 235.87, Sex: 0.681
2025-10-23 07:30:19,642 - INFO - Epoch 49, Step 150/1000 - Loss: 76.9846, Perplexity: inf, LR: 3.78e-06, LM: 5.1922, Age: 238.85, Sex: 0.680
2025-10-23 07:30:32,514 - INFO - Epoch 49, Step 200/1000 - Loss: 79.5793, Perplexity: inf, LR: 3.67e-06, LM: 5.2474, Age: 247.32, Sex: 0.679
2025-10-23 07:30:44,788 - INFO - Epoch 49, Step 250/1000 - Loss: 78.3201, Perplexity: inf, LR: 3.57e-06, LM: 5.2252, Age: 243.20, Sex: 0.679
2025-10-23 07:30:56,892 - INFO - Epoch 49, Step 300/1000 - Loss: 77.9902, Perplexity: inf, LR: 3.47e-06, LM: 5.2164, Age: 242.13, Sex: 0.678
2025-10-23 07:31:09,074 - INFO - Epoch 49, Step 350/1000 - Loss: 77.0109, Perplexity: inf, LR: 3.37e-06, LM: 5.2077, Age: 238.89, Sex: 0.680
2025-10-23 07:31:21,472 - INFO - Epoch 49, Step 400/1000 - Loss: 77.1163, Perplexity: inf, LR: 3.27e-06, LM: 5.2137, Age: 239.22, Sex: 0.678
2025-10-23 07:31:33,738 - INFO - Epoch 49, Step 450/1000 - Loss: 76.6606, Perplexity: inf, LR: 3.16e-06, LM: 5.2201, Age: 237.68, Sex: 0.677
2025-10-23 07:31:46,207 - INFO - Epoch 49, Step 500/1000 - Loss: 76.7179, Perplexity: inf, LR: 3.06e-06, LM: 5.2236, Age: 237.86, Sex: 0.678
2025-10-23 07:31:58,347 - INFO - Epoch 49, Step 550/1000 - Loss: 77.0130, Perplexity: inf, LR: 2.96e-06, LM: 5.2278, Age: 238.83, Sex: 0.678
2025-10-23 07:32:10,929 - INFO - Epoch 49, Step 600/1000 - Loss: 76.3902, Perplexity: inf, LR: 2.86e-06, LM: 5.2225, Age: 236.77, Sex: 0.679
2025-10-23 07:32:23,118 - INFO - Epoch 49, Step 650/1000 - Loss: 76.3582, Perplexity: inf, LR: 2.76e-06, LM: 5.2115, Age: 236.70, Sex: 0.679
2025-10-23 07:32:35,682 - INFO - Epoch 49, Step 700/1000 - Loss: 76.3929, Perplexity: inf, LR: 2.65e-06, LM: 5.2101, Age: 236.82, Sex: 0.678
2025-10-23 07:32:48,350 - INFO - Epoch 49, Step 750/1000 - Loss: 76.0528, Perplexity: inf, LR: 2.55e-06, LM: 5.2143, Age: 235.68, Sex: 0.677
2025-10-23 07:33:00,764 - INFO - Epoch 49, Step 800/1000 - Loss: 76.5066, Perplexity: inf, LR: 2.45e-06, LM: 5.2165, Age: 237.18, Sex: 0.677
2025-10-23 07:33:13,070 - INFO - Epoch 49, Step 850/1000 - Loss: 77.0622, Perplexity: inf, LR: 2.35e-06, LM: 5.2180, Age: 239.03, Sex: 0.677
2025-10-23 07:33:25,457 - INFO - Epoch 49, Step 900/1000 - Loss: 76.8199, Perplexity: inf, LR: 2.24e-06, LM: 5.2120, Age: 238.24, Sex: 0.677
2025-10-23 07:33:38,100 - INFO - Epoch 49, Step 950/1000 - Loss: 76.8839, Perplexity: inf, LR: 2.14e-06, LM: 5.2135, Age: 238.45, Sex: 0.677
2025-10-23 07:33:50,666 - INFO - Epoch 49, Step 1000/1000 - Loss: 77.1735, Perplexity: inf, LR: 2.04e-06, LM: 5.2141, Age: 239.41, Sex: 0.678
2025-10-23 07:33:50,667 - INFO - Epoch 49 Complete - Avg Loss: 77.1735, Avg Perplexity: inf, LM: 5.2141, Age: 239.41, Sex: 0.678
2025-10-23 07:34:10,619 - INFO - Validation - Loss: 5.2591, Perplexity: 219.4393, Token Accuracy: 0.0868, Code Accuracy: 0.0000
2025-10-23 07:34:10,620 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:34:13,992 - INFO - TPL computed on 351 samples: 244.5156
2025-10-23 07:34:13,992 - INFO - Temporal Perplexity (TPL): 244.5156
2025-10-23 07:34:26,455 - INFO - Epoch 50, Step 50/1000 - Loss: 75.4455, Perplexity: inf, LR: 1.94e-06, LM: 5.2515, Age: 233.53, Sex: 0.676
2025-10-23 07:34:39,166 - INFO - Epoch 50, Step 100/1000 - Loss: 77.4622, Perplexity: inf, LR: 1.84e-06, LM: 5.2213, Age: 240.35, Sex: 0.679
2025-10-23 07:34:51,515 - INFO - Epoch 50, Step 150/1000 - Loss: 71.9468, Perplexity: inf, LR: 1.73e-06, LM: 5.1643, Age: 222.16, Sex: 0.675
2025-10-23 07:35:03,819 - INFO - Epoch 50, Step 200/1000 - Loss: 70.5380, Perplexity: inf, LR: 1.63e-06, LM: 5.1732, Age: 217.43, Sex: 0.680
2025-10-23 07:35:16,233 - INFO - Epoch 50, Step 250/1000 - Loss: 70.0962, Perplexity: inf, LR: 1.53e-06, LM: 5.1670, Age: 215.98, Sex: 0.680
2025-10-23 07:35:28,439 - INFO - Epoch 50, Step 300/1000 - Loss: 72.7608, Perplexity: inf, LR: 1.43e-06, LM: 5.1755, Age: 224.83, Sex: 0.682
2025-10-23 07:35:41,081 - INFO - Epoch 50, Step 350/1000 - Loss: 72.3867, Perplexity: inf, LR: 1.33e-06, LM: 5.1698, Age: 223.60, Sex: 0.679
2025-10-23 07:35:53,754 - INFO - Epoch 50, Step 400/1000 - Loss: 73.3429, Perplexity: inf, LR: 1.22e-06, LM: 5.1758, Age: 226.77, Sex: 0.678
2025-10-23 07:36:06,515 - INFO - Epoch 50, Step 450/1000 - Loss: 73.0467, Perplexity: inf, LR: 1.12e-06, LM: 5.1948, Age: 225.72, Sex: 0.679
2025-10-23 07:36:19,137 - INFO - Epoch 50, Step 500/1000 - Loss: 74.8173, Perplexity: inf, LR: 1.02e-06, LM: 5.1976, Age: 231.61, Sex: 0.679
2025-10-23 07:36:31,711 - INFO - Epoch 50, Step 550/1000 - Loss: 74.4170, Perplexity: inf, LR: 9.18e-07, LM: 5.1896, Age: 230.31, Sex: 0.679
2025-10-23 07:36:44,223 - INFO - Epoch 50, Step 600/1000 - Loss: 74.5232, Perplexity: inf, LR: 8.16e-07, LM: 5.1941, Age: 230.65, Sex: 0.678
2025-10-23 07:36:56,945 - INFO - Epoch 50, Step 650/1000 - Loss: 74.3772, Perplexity: inf, LR: 7.14e-07, LM: 5.1998, Age: 230.14, Sex: 0.677
2025-10-23 07:37:09,601 - INFO - Epoch 50, Step 700/1000 - Loss: 74.4451, Perplexity: inf, LR: 6.12e-07, LM: 5.2072, Age: 230.34, Sex: 0.677
2025-10-23 07:37:21,959 - INFO - Epoch 50, Step 750/1000 - Loss: 74.5177, Perplexity: inf, LR: 5.10e-07, LM: 5.2138, Age: 230.56, Sex: 0.676
2025-10-23 07:37:34,579 - INFO - Epoch 50, Step 800/1000 - Loss: 75.0326, Perplexity: inf, LR: 4.08e-07, LM: 5.2160, Age: 232.27, Sex: 0.677
2025-10-23 07:37:47,103 - INFO - Epoch 50, Step 850/1000 - Loss: 75.4645, Perplexity: inf, LR: 3.06e-07, LM: 5.2141, Age: 233.72, Sex: 0.676
2025-10-23 07:37:59,678 - INFO - Epoch 50, Step 900/1000 - Loss: 75.2962, Perplexity: inf, LR: 2.04e-07, LM: 5.2138, Age: 233.16, Sex: 0.677
2025-10-23 07:38:12,111 - INFO - Epoch 50, Step 950/1000 - Loss: 75.3058, Perplexity: inf, LR: 1.02e-07, LM: 5.2128, Age: 233.19, Sex: 0.677
2025-10-23 07:38:24,226 - INFO - Epoch 50, Step 1000/1000 - Loss: 75.5620, Perplexity: inf, LR: 0.00e+00, LM: 5.2120, Age: 234.05, Sex: 0.677
2025-10-23 07:38:24,227 - INFO - Epoch 50 Complete - Avg Loss: 75.5620, Avg Perplexity: inf, LM: 5.2120, Age: 234.05, Sex: 0.677
2025-10-23 07:38:44,046 - INFO - Validation - Loss: 5.2745, Perplexity: 223.0654, Token Accuracy: 0.0862, Code Accuracy: 0.0000
2025-10-23 07:38:44,047 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 07:38:47,422 - INFO - TPL computed on 351 samples: 244.2983
2025-10-23 07:38:47,422 - INFO - Temporal Perplexity (TPL): 244.2983
2025-10-23 07:38:49,355 - INFO - Checkpoint saved: epoch 50
2025-10-23 07:38:49,356 - INFO - 
================================================================================
2025-10-23 07:38:49,356 - INFO - Training Complete!
2025-10-23 07:38:49,356 - INFO - ================================================================================
2025-10-23 07:38:49,356 - INFO - Best validation loss: 4.7496
2025-10-23 07:38:49,356 - INFO - Best validation perplexity: 115.5384
2025-10-23 16:36:34,842 - INFO - ================================================================================
2025-10-23 16:36:34,843 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 16:36:34,843 - INFO - ================================================================================
2025-10-23 16:36:34,843 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 16:36:34,847 - INFO - 
Random seed: 42
2025-10-23 16:36:35,105 - INFO - Device: cuda
2025-10-23 16:36:35,105 - INFO - 
================================================================================
2025-10-23 16:36:35,105 - INFO - Loading MIMIC-III Data
2025-10-23 16:36:35,105 - INFO - ================================================================================
2025-10-23 16:36:35,105 - INFO - Loading MIMIC-III data files
2025-10-23 16:36:35,166 - INFO - Loaded 46520 patients
2025-10-23 16:36:35,317 - INFO - Loaded 58976 admissions
2025-10-23 16:36:35,490 - INFO - Loaded 651047 diagnosis records
2025-10-23 16:36:35,773 - INFO - Processing patient records
2025-10-23 16:36:44,277 - INFO - Loaded 10000 patient records
2025-10-23 16:36:44,277 - INFO - Diagnosis vocabulary size: 4253
2025-10-23 16:36:44,286 - INFO - Average visits per patient: 1.29
2025-10-23 16:36:44,286 - INFO - Average codes per visit: 9.16
2025-10-23 16:36:44,290 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-23 16:36:44,317 - INFO - Loaded 10000 patients
2025-10-23 16:36:44,317 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-23 16:36:44,317 - INFO - Tokenizer vocab size: 4260
2025-10-23 16:36:44,317 - INFO - Dataset size: 10000 patients
2025-10-23 16:36:44,318 - INFO - Train size: 8000, Validation size: 2000
2025-10-23 16:36:44,319 - INFO - Train batches: 1000, Validation batches: 250
2025-10-23 16:36:44,319 - INFO - 
================================================================================
2025-10-23 16:36:44,319 - INFO - Initializing Model
2025-10-23 16:36:44,319 - INFO - ================================================================================
2025-10-23 16:36:44,459 - INFO - BART config vocab size: 4260
2025-10-23 16:36:46,508 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 16:36:46,509 - INFO -   Age loss weight: 0.05
2025-10-23 16:36:46,509 - INFO -   Sex loss weight: 0.2
2025-10-23 16:36:46,803 - INFO - Total parameters: 104,683,016
2025-10-23 16:36:46,803 - INFO - Trainable parameters: 104,683,016
2025-10-23 16:36:46,804 - INFO - Total training steps: 30000
2025-10-23 16:36:46,804 - INFO - Warmup steps: 1000
2025-10-23 16:36:46,804 - INFO - 
================================================================================
2025-10-23 16:36:46,804 - INFO - Starting Training
2025-10-23 16:36:46,804 - INFO - ================================================================================
2025-10-23 16:43:07,207 - INFO - ================================================================================
2025-10-23 16:43:07,207 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 16:43:07,207 - INFO - ================================================================================
2025-10-23 16:43:07,208 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 16:43:07,211 - INFO - 
Random seed: 42
2025-10-23 16:43:07,480 - INFO - Device: cuda
2025-10-23 16:43:07,480 - INFO - 
================================================================================
2025-10-23 16:43:07,480 - INFO - Loading MIMIC-III Data
2025-10-23 16:43:07,480 - INFO - ================================================================================
2025-10-23 16:43:07,481 - INFO - Loading MIMIC-III data files
2025-10-23 16:43:07,544 - INFO - Loaded 46520 patients
2025-10-23 16:43:07,687 - INFO - Loaded 58976 admissions
2025-10-23 16:43:07,852 - INFO - Loaded 651047 diagnosis records
2025-10-23 16:43:08,128 - INFO - Processing patient records
2025-10-23 16:43:16,766 - INFO - Loaded 10000 patient records
2025-10-23 16:43:16,766 - INFO - Diagnosis vocabulary size: 4253
2025-10-23 16:43:16,772 - INFO - Average visits per patient: 1.29
2025-10-23 16:43:16,773 - INFO - Average codes per visit: 9.16
2025-10-23 16:43:16,774 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-23 16:43:16,829 - INFO - Loaded 10000 patients
2025-10-23 16:43:16,829 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-23 16:43:16,829 - INFO - Tokenizer vocab size: 4260
2025-10-23 16:43:16,829 - INFO - Dataset size: 10000 patients
2025-10-23 16:43:16,830 - INFO - Train size: 8000, Validation size: 2000
2025-10-23 16:43:16,831 - INFO - Train batches: 1000, Validation batches: 250
2025-10-23 16:43:16,831 - INFO - 
================================================================================
2025-10-23 16:43:16,831 - INFO - Initializing Model
2025-10-23 16:43:16,831 - INFO - ================================================================================
2025-10-23 16:43:16,922 - INFO - BART config vocab size: 4260
2025-10-23 16:43:18,869 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 16:43:18,869 - INFO -   Age loss weight: 0.05
2025-10-23 16:43:18,869 - INFO -   Sex loss weight: 0.2
2025-10-23 16:43:19,145 - INFO - Total parameters: 104,683,016
2025-10-23 16:43:19,146 - INFO - Trainable parameters: 104,683,016
2025-10-23 16:43:19,147 - INFO - Total training steps: 30000
2025-10-23 16:43:19,147 - INFO - Warmup steps: 1000
2025-10-23 16:43:19,147 - INFO - 
================================================================================
2025-10-23 16:43:19,147 - INFO - Starting Training
2025-10-23 16:43:19,147 - INFO - ================================================================================
2025-10-23 16:43:32,449 - INFO - Epoch 1, Step 50/1000 - Loss: 7.8228, Perplexity: 2877.0353, LR: 5.00e-06, LM: 7.6007, Age: 1.76, Sex: 0.669
2025-10-23 16:43:45,368 - INFO - Epoch 1, Step 100/1000 - Loss: 7.0280, Perplexity: 1739.7464, LR: 1.00e-05, LM: 6.8313, Age: 1.69, Sex: 0.560
2025-10-23 16:43:58,194 - INFO - Epoch 1, Step 150/1000 - Loss: 6.5256, Perplexity: 1253.2064, LR: 1.50e-05, LM: 6.3613, Age: 1.62, Sex: 0.416
2025-10-23 16:44:10,904 - INFO - Epoch 1, Step 200/1000 - Loss: 6.1608, Perplexity: 987.8524, LR: 2.00e-05, LM: 6.0173, Age: 1.54, Sex: 0.333
2025-10-23 16:44:23,811 - INFO - Epoch 1, Step 250/1000 - Loss: 5.8817, Perplexity: 817.7355, LR: 2.50e-05, LM: 5.7543, Age: 1.44, Sex: 0.278
2025-10-23 16:44:36,822 - INFO - Epoch 1, Step 300/1000 - Loss: 5.6644, Perplexity: 700.5180, LR: 3.00e-05, LM: 5.5492, Age: 1.35, Sex: 0.238
2025-10-23 16:44:49,355 - INFO - Epoch 1, Step 350/1000 - Loss: 5.5006, Perplexity: 614.9938, LR: 3.50e-05, LM: 5.3949, Age: 1.28, Sex: 0.207
2025-10-23 16:45:01,890 - INFO - Epoch 1, Step 400/1000 - Loss: 5.3382, Perplexity: 547.5230, LR: 4.00e-05, LM: 5.2405, Age: 1.22, Sex: 0.183
2025-10-23 16:45:14,439 - INFO - Epoch 1, Step 450/1000 - Loss: 5.2003, Perplexity: 495.0689, LR: 4.50e-05, LM: 5.1088, Age: 1.17, Sex: 0.164
2025-10-23 16:45:27,199 - INFO - Epoch 1, Step 500/1000 - Loss: 5.0418, Perplexity: 450.6905, LR: 5.00e-05, LM: 4.9554, Age: 1.13, Sex: 0.148
2025-10-23 16:45:40,123 - INFO - Epoch 1, Step 550/1000 - Loss: 4.8562, Perplexity: 411.9441, LR: 5.50e-05, LM: 4.7740, Age: 1.10, Sex: 0.135
2025-10-23 16:45:52,587 - INFO - Epoch 1, Step 600/1000 - Loss: 4.6438, Perplexity: 379.0207, LR: 6.00e-05, LM: 4.5647, Age: 1.08, Sex: 0.125
2025-10-23 16:46:05,445 - INFO - Epoch 1, Step 650/1000 - Loss: 4.4223, Perplexity: 350.5887, LR: 6.50e-05, LM: 4.3459, Age: 1.07, Sex: 0.115
2025-10-23 16:46:17,898 - INFO - Epoch 1, Step 700/1000 - Loss: 4.1930, Perplexity: 325.9782, LR: 7.00e-05, LM: 4.1189, Age: 1.05, Sex: 0.107
2025-10-23 16:46:30,679 - INFO - Epoch 1, Step 750/1000 - Loss: 3.9778, Perplexity: 304.4926, LR: 7.50e-05, LM: 3.9059, Age: 1.03, Sex: 0.100
2025-10-23 16:46:43,377 - INFO - Epoch 1, Step 800/1000 - Loss: 3.7851, Perplexity: 285.7541, LR: 8.00e-05, LM: 3.7152, Age: 1.02, Sex: 0.094
2025-10-23 16:46:55,716 - INFO - Epoch 1, Step 850/1000 - Loss: 3.6071, Perplexity: 269.1207, LR: 8.50e-05, LM: 3.5390, Age: 1.01, Sex: 0.089
2025-10-23 16:47:08,177 - INFO - Epoch 1, Step 900/1000 - Loss: 3.4349, Perplexity: 254.2904, LR: 9.00e-05, LM: 3.3683, Age: 1.00, Sex: 0.084
2025-10-23 16:47:20,971 - INFO - Epoch 1, Step 950/1000 - Loss: 3.2842, Perplexity: 241.0346, LR: 9.50e-05, LM: 3.2191, Age: 0.98, Sex: 0.080
2025-10-23 16:47:33,679 - INFO - Epoch 1, Step 1000/1000 - Loss: 3.1380, Perplexity: 229.0600, LR: 1.00e-04, LM: 3.0742, Age: 0.97, Sex: 0.076
2025-10-23 16:47:33,680 - INFO - Epoch 1 Complete - Avg Loss: 3.1380, Avg Perplexity: 229.0600, LM: 3.0742, Age: 0.97, Sex: 0.076
2025-10-23 16:47:53,710 - INFO - Validation - Loss: 0.3384, Perplexity: 2.2116, Token Accuracy: 0.9637, Code Accuracy: 0.9568
2025-10-23 16:47:53,711 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 16:47:57,147 - INFO - TPL computed on 351 samples: 1.6449
2025-10-23 16:47:57,148 - INFO - Temporal Perplexity (TPL): 1.6449
2025-10-23 16:47:57,148 - INFO - New best model! Validation loss: 0.3384
2025-10-23 16:48:01,708 - INFO - Checkpoint saved: epoch 1
2025-10-23 16:48:14,463 - INFO - Epoch 2, Step 50/1000 - Loss: 0.3993, Perplexity: 2.1757, LR: 9.98e-05, LM: 0.3551, Age: 0.88, Sex: 0.002
2025-10-23 16:48:27,021 - INFO - Epoch 2, Step 100/1000 - Loss: 0.3416, Perplexity: 1.8437, LR: 9.97e-05, LM: 0.3014, Age: 0.80, Sex: 0.001
2025-10-23 16:48:39,541 - INFO - Epoch 2, Step 150/1000 - Loss: 0.3062, Perplexity: 1.6634, LR: 9.95e-05, LM: 0.2671, Age: 0.78, Sex: 0.001
2025-10-23 16:48:52,222 - INFO - Epoch 2, Step 200/1000 - Loss: 0.3250, Perplexity: 1.7944, LR: 9.93e-05, LM: 0.2867, Age: 0.76, Sex: 0.001
2025-10-23 16:49:04,725 - INFO - Epoch 2, Step 250/1000 - Loss: 0.3107, Perplexity: 1.7111, LR: 9.91e-05, LM: 0.2731, Age: 0.75, Sex: 0.001
2025-10-23 16:49:17,457 - INFO - Epoch 2, Step 300/1000 - Loss: 0.2890, Perplexity: 1.6311, LR: 9.90e-05, LM: 0.2512, Age: 0.75, Sex: 0.001
2025-10-23 16:49:29,538 - INFO - Epoch 2, Step 350/1000 - Loss: 0.3016, Perplexity: 1.7813, LR: 9.88e-05, LM: 0.2640, Age: 0.75, Sex: 0.001
2025-10-23 16:49:41,966 - INFO - Epoch 2, Step 400/1000 - Loss: 0.2813, Perplexity: 1.7059, LR: 9.86e-05, LM: 0.2441, Age: 0.74, Sex: 0.001
2025-10-23 16:49:54,325 - INFO - Epoch 2, Step 450/1000 - Loss: 0.2673, Perplexity: 1.6511, LR: 9.84e-05, LM: 0.2304, Age: 0.73, Sex: 0.001
2025-10-23 16:50:07,253 - INFO - Epoch 2, Step 500/1000 - Loss: 0.2556, Perplexity: 1.6057, LR: 9.83e-05, LM: 0.2188, Age: 0.73, Sex: 0.001
2025-10-23 16:50:19,731 - INFO - Epoch 2, Step 550/1000 - Loss: 0.2550, Perplexity: 1.5936, LR: 9.81e-05, LM: 0.2182, Age: 0.73, Sex: 0.001
2025-10-23 16:50:32,363 - INFO - Epoch 2, Step 600/1000 - Loss: 0.2507, Perplexity: 1.6240, LR: 9.79e-05, LM: 0.2141, Age: 0.73, Sex: 0.001
2025-10-23 16:50:45,218 - INFO - Epoch 2, Step 650/1000 - Loss: 0.2510, Perplexity: 1.6573, LR: 9.78e-05, LM: 0.2146, Age: 0.72, Sex: 0.001
2025-10-23 16:50:57,584 - INFO - Epoch 2, Step 700/1000 - Loss: 0.2414, Perplexity: 1.6230, LR: 9.76e-05, LM: 0.2052, Age: 0.72, Sex: 0.001
2025-10-23 16:51:10,157 - INFO - Epoch 2, Step 750/1000 - Loss: 0.2331, Perplexity: 1.5914, LR: 9.74e-05, LM: 0.1972, Age: 0.71, Sex: 0.001
2025-10-23 16:51:22,757 - INFO - Epoch 2, Step 800/1000 - Loss: 0.2254, Perplexity: 1.5633, LR: 9.72e-05, LM: 0.1896, Age: 0.71, Sex: 0.001
2025-10-23 16:51:35,582 - INFO - Epoch 2, Step 850/1000 - Loss: 0.2192, Perplexity: 1.5407, LR: 9.71e-05, LM: 0.1835, Age: 0.71, Sex: 0.001
2025-10-23 16:51:48,225 - INFO - Epoch 2, Step 900/1000 - Loss: 0.2149, Perplexity: 1.5280, LR: 9.69e-05, LM: 0.1794, Age: 0.70, Sex: 0.001
2025-10-23 16:52:00,862 - INFO - Epoch 2, Step 950/1000 - Loss: 0.2101, Perplexity: 1.5087, LR: 9.67e-05, LM: 0.1746, Age: 0.70, Sex: 0.001
2025-10-23 16:52:13,623 - INFO - Epoch 2, Step 1000/1000 - Loss: 0.2082, Perplexity: 1.5051, LR: 9.66e-05, LM: 0.1729, Age: 0.70, Sex: 0.001
2025-10-23 16:52:13,625 - INFO - Epoch 2 Complete - Avg Loss: 0.2082, Avg Perplexity: 1.5051, LM: 0.1729, Age: 0.70, Sex: 0.001
2025-10-23 16:52:33,439 - INFO - Validation - Loss: 0.1233, Perplexity: 1.4171, Token Accuracy: 0.9833, Code Accuracy: 0.9807
2025-10-23 16:52:33,441 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 16:52:36,909 - INFO - TPL computed on 351 samples: 1.2147
2025-10-23 16:52:36,909 - INFO - Temporal Perplexity (TPL): 1.2147
2025-10-23 16:52:36,909 - INFO - New best model! Validation loss: 0.1233
2025-10-23 16:52:41,404 - INFO - Checkpoint saved: epoch 2
2025-10-23 16:52:53,902 - INFO - Epoch 3, Step 50/1000 - Loss: 0.0689, Perplexity: 1.0739, LR: 9.64e-05, LM: 0.0363, Age: 0.65, Sex: 0.000
2025-10-23 16:53:06,596 - INFO - Epoch 3, Step 100/1000 - Loss: 0.0789, Perplexity: 1.0976, LR: 9.62e-05, LM: 0.0471, Age: 0.63, Sex: 0.000
2025-10-23 16:53:19,170 - INFO - Epoch 3, Step 150/1000 - Loss: 0.0760, Perplexity: 1.0922, LR: 9.60e-05, LM: 0.0444, Age: 0.63, Sex: 0.000
2025-10-23 16:53:31,749 - INFO - Epoch 3, Step 200/1000 - Loss: 0.0860, Perplexity: 1.1921, LR: 9.59e-05, LM: 0.0539, Age: 0.64, Sex: 0.001
2025-10-23 16:53:44,152 - INFO - Epoch 3, Step 250/1000 - Loss: 0.0902, Perplexity: 1.1971, LR: 9.57e-05, LM: 0.0577, Age: 0.65, Sex: 0.001
2025-10-23 16:53:56,848 - INFO - Epoch 3, Step 300/1000 - Loss: 0.0979, Perplexity: 1.2006, LR: 9.55e-05, LM: 0.0656, Age: 0.64, Sex: 0.001
2025-10-23 16:54:09,869 - INFO - Epoch 3, Step 350/1000 - Loss: 0.0991, Perplexity: 1.2065, LR: 9.53e-05, LM: 0.0667, Age: 0.65, Sex: 0.001
2025-10-23 16:54:22,509 - INFO - Epoch 3, Step 400/1000 - Loss: 0.0950, Perplexity: 1.1894, LR: 9.52e-05, LM: 0.0625, Age: 0.65, Sex: 0.001
2025-10-23 16:54:34,937 - INFO - Epoch 3, Step 450/1000 - Loss: 0.0915, Perplexity: 1.1765, LR: 9.50e-05, LM: 0.0586, Age: 0.66, Sex: 0.000
2025-10-23 16:54:47,770 - INFO - Epoch 3, Step 500/1000 - Loss: 0.0887, Perplexity: 1.1658, LR: 9.48e-05, LM: 0.0556, Age: 0.66, Sex: 0.000
2025-10-23 16:55:00,314 - INFO - Epoch 3, Step 550/1000 - Loss: 0.0927, Perplexity: 1.1802, LR: 9.47e-05, LM: 0.0598, Age: 0.66, Sex: 0.001
2025-10-23 16:55:13,323 - INFO - Epoch 3, Step 600/1000 - Loss: 0.0905, Perplexity: 1.1715, LR: 9.45e-05, LM: 0.0578, Age: 0.65, Sex: 0.001
2025-10-23 16:55:25,581 - INFO - Epoch 3, Step 650/1000 - Loss: 0.0882, Perplexity: 1.1647, LR: 9.43e-05, LM: 0.0558, Age: 0.65, Sex: 0.000
2025-10-23 16:55:37,819 - INFO - Epoch 3, Step 700/1000 - Loss: 0.0856, Perplexity: 1.1568, LR: 9.41e-05, LM: 0.0533, Age: 0.64, Sex: 0.000
2025-10-23 16:55:50,538 - INFO - Epoch 3, Step 750/1000 - Loss: 0.0942, Perplexity: 1.1848, LR: 9.40e-05, LM: 0.0620, Age: 0.64, Sex: 0.001
2025-10-23 16:56:02,995 - INFO - Epoch 3, Step 800/1000 - Loss: 0.0915, Perplexity: 1.1769, LR: 9.38e-05, LM: 0.0597, Age: 0.63, Sex: 0.001
2025-10-23 16:56:15,893 - INFO - Epoch 3, Step 850/1000 - Loss: 0.0917, Perplexity: 1.1854, LR: 9.36e-05, LM: 0.0600, Age: 0.63, Sex: 0.001
2025-10-23 16:56:28,883 - INFO - Epoch 3, Step 900/1000 - Loss: 0.0916, Perplexity: 1.1815, LR: 9.34e-05, LM: 0.0598, Age: 0.63, Sex: 0.001
2025-10-23 16:56:41,567 - INFO - Epoch 3, Step 950/1000 - Loss: 0.0902, Perplexity: 1.1757, LR: 9.33e-05, LM: 0.0586, Age: 0.63, Sex: 0.001
2025-10-23 16:56:54,022 - INFO - Epoch 3, Step 1000/1000 - Loss: 0.0911, Perplexity: 1.1750, LR: 9.31e-05, LM: 0.0595, Age: 0.63, Sex: 0.001
2025-10-23 16:56:54,023 - INFO - Epoch 3 Complete - Avg Loss: 0.0911, Avg Perplexity: 1.1750, LM: 0.0595, Age: 0.63, Sex: 0.001
2025-10-23 16:57:14,067 - INFO - Validation - Loss: 0.0679, Perplexity: 1.2067, Token Accuracy: 0.9903, Code Accuracy: 0.9885
2025-10-23 16:57:14,069 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 16:57:17,536 - INFO - TPL computed on 351 samples: 1.1169
2025-10-23 16:57:17,536 - INFO - Temporal Perplexity (TPL): 1.1169
2025-10-23 16:57:17,536 - INFO - New best model! Validation loss: 0.0679
2025-10-23 16:57:22,233 - INFO - Checkpoint saved: epoch 3
2025-10-23 16:57:35,189 - INFO - Epoch 4, Step 50/1000 - Loss: 0.0872, Perplexity: 1.2428, LR: 9.29e-05, LM: 0.0571, Age: 0.60, Sex: 0.000
2025-10-23 16:57:48,088 - INFO - Epoch 4, Step 100/1000 - Loss: 0.0657, Perplexity: 1.1443, LR: 9.28e-05, LM: 0.0368, Age: 0.58, Sex: 0.000
2025-10-23 16:58:00,722 - INFO - Epoch 4, Step 150/1000 - Loss: 0.0569, Perplexity: 1.1097, LR: 9.26e-05, LM: 0.0279, Age: 0.58, Sex: 0.000
2025-10-23 16:58:13,366 - INFO - Epoch 4, Step 200/1000 - Loss: 0.0683, Perplexity: 1.1554, LR: 9.24e-05, LM: 0.0404, Age: 0.56, Sex: 0.000
2025-10-23 16:58:26,061 - INFO - Epoch 4, Step 250/1000 - Loss: 0.0804, Perplexity: 1.1843, LR: 9.22e-05, LM: 0.0524, Age: 0.56, Sex: 0.000
2025-10-23 16:58:38,832 - INFO - Epoch 4, Step 300/1000 - Loss: 0.0767, Perplexity: 1.1644, LR: 9.21e-05, LM: 0.0483, Age: 0.57, Sex: 0.000
2025-10-23 16:58:51,837 - INFO - Epoch 4, Step 350/1000 - Loss: 0.0787, Perplexity: 1.1591, LR: 9.19e-05, LM: 0.0501, Age: 0.57, Sex: 0.000
2025-10-23 16:59:04,593 - INFO - Epoch 4, Step 400/1000 - Loss: 0.0754, Perplexity: 1.1463, LR: 9.17e-05, LM: 0.0468, Age: 0.57, Sex: 0.000
2025-10-23 16:59:17,161 - INFO - Epoch 4, Step 450/1000 - Loss: 0.0859, Perplexity: 1.1897, LR: 9.16e-05, LM: 0.0572, Age: 0.57, Sex: 0.000
2025-10-23 16:59:29,867 - INFO - Epoch 4, Step 500/1000 - Loss: 0.0812, Perplexity: 1.1747, LR: 9.14e-05, LM: 0.0525, Age: 0.57, Sex: 0.000
2025-10-23 16:59:42,501 - INFO - Epoch 4, Step 550/1000 - Loss: 0.0782, Perplexity: 1.1634, LR: 9.12e-05, LM: 0.0493, Age: 0.58, Sex: 0.000
2025-10-23 16:59:54,955 - INFO - Epoch 4, Step 600/1000 - Loss: 0.0785, Perplexity: 1.1592, LR: 9.10e-05, LM: 0.0494, Age: 0.58, Sex: 0.000
2025-10-23 17:00:07,560 - INFO - Epoch 4, Step 650/1000 - Loss: 0.0760, Perplexity: 1.1508, LR: 9.09e-05, LM: 0.0470, Age: 0.58, Sex: 0.000
2025-10-23 17:00:19,991 - INFO - Epoch 4, Step 700/1000 - Loss: 0.0750, Perplexity: 1.1451, LR: 9.07e-05, LM: 0.0460, Age: 0.58, Sex: 0.000
2025-10-23 17:00:32,697 - INFO - Epoch 4, Step 750/1000 - Loss: 0.0768, Perplexity: 1.1537, LR: 9.05e-05, LM: 0.0476, Age: 0.58, Sex: 0.001
2025-10-23 17:00:45,005 - INFO - Epoch 4, Step 800/1000 - Loss: 0.0747, Perplexity: 1.1469, LR: 9.03e-05, LM: 0.0455, Age: 0.58, Sex: 0.001
2025-10-23 17:00:57,338 - INFO - Epoch 4, Step 850/1000 - Loss: 0.0725, Perplexity: 1.1405, LR: 9.02e-05, LM: 0.0432, Age: 0.58, Sex: 0.001
2025-10-23 17:01:09,735 - INFO - Epoch 4, Step 900/1000 - Loss: 0.0727, Perplexity: 1.1418, LR: 9.00e-05, LM: 0.0436, Age: 0.58, Sex: 0.000
2025-10-23 17:01:22,255 - INFO - Epoch 4, Step 950/1000 - Loss: 0.0718, Perplexity: 1.1374, LR: 8.98e-05, LM: 0.0425, Age: 0.58, Sex: 0.000
2025-10-23 17:01:35,073 - INFO - Epoch 4, Step 1000/1000 - Loss: 0.0712, Perplexity: 1.1339, LR: 8.97e-05, LM: 0.0420, Age: 0.58, Sex: 0.000
2025-10-23 17:01:35,075 - INFO - Epoch 4 Complete - Avg Loss: 0.0712, Avg Perplexity: 1.1339, LM: 0.0420, Age: 0.58, Sex: 0.000
2025-10-23 17:01:55,197 - INFO - Validation - Loss: 0.0516, Perplexity: 1.1815, Token Accuracy: 0.9925, Code Accuracy: 0.9911
2025-10-23 17:01:55,199 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 17:01:58,686 - INFO - TPL computed on 351 samples: 1.0971
2025-10-23 17:01:58,687 - INFO - Temporal Perplexity (TPL): 1.0971
2025-10-23 17:01:58,687 - INFO - New best model! Validation loss: 0.0516
2025-10-23 17:02:03,227 - INFO - Checkpoint saved: epoch 4
2025-10-23 17:02:15,710 - INFO - Epoch 5, Step 50/1000 - Loss: 0.0473, Perplexity: 1.0510, LR: 8.95e-05, LM: 0.0228, Age: 0.49, Sex: 0.000
2025-10-23 17:02:28,569 - INFO - Epoch 5, Step 100/1000 - Loss: 0.0618, Perplexity: 1.0785, LR: 8.93e-05, LM: 0.0353, Age: 0.53, Sex: 0.000
2025-10-23 17:02:41,368 - INFO - Epoch 5, Step 150/1000 - Loss: 0.0830, Perplexity: 1.1663, LR: 8.91e-05, LM: 0.0564, Age: 0.53, Sex: 0.000
2025-10-23 17:02:53,930 - INFO - Epoch 5, Step 200/1000 - Loss: 0.0717, Perplexity: 1.1345, LR: 8.90e-05, LM: 0.0443, Age: 0.55, Sex: 0.000
2025-10-23 17:03:06,344 - INFO - Epoch 5, Step 250/1000 - Loss: 0.0720, Perplexity: 1.1360, LR: 8.88e-05, LM: 0.0447, Age: 0.55, Sex: 0.000
2025-10-23 17:03:18,991 - INFO - Epoch 5, Step 300/1000 - Loss: 0.0748, Perplexity: 1.1542, LR: 8.86e-05, LM: 0.0476, Age: 0.54, Sex: 0.000
2025-10-23 17:03:31,265 - INFO - Epoch 5, Step 350/1000 - Loss: 0.0752, Perplexity: 1.1570, LR: 8.84e-05, LM: 0.0482, Age: 0.54, Sex: 0.000
2025-10-23 17:03:43,829 - INFO - Epoch 5, Step 400/1000 - Loss: 0.0718, Perplexity: 1.1438, LR: 8.83e-05, LM: 0.0445, Age: 0.54, Sex: 0.000
2025-10-23 17:03:56,568 - INFO - Epoch 5, Step 450/1000 - Loss: 0.0743, Perplexity: 1.1503, LR: 8.81e-05, LM: 0.0470, Age: 0.55, Sex: 0.000
2025-10-23 17:04:09,398 - INFO - Epoch 5, Step 500/1000 - Loss: 0.0716, Perplexity: 1.1405, LR: 8.79e-05, LM: 0.0443, Age: 0.54, Sex: 0.000
2025-10-23 17:04:21,973 - INFO - Epoch 5, Step 550/1000 - Loss: 0.0711, Perplexity: 1.1356, LR: 8.78e-05, LM: 0.0438, Age: 0.54, Sex: 0.000
2025-10-23 17:04:34,514 - INFO - Epoch 5, Step 600/1000 - Loss: 0.0696, Perplexity: 1.1298, LR: 8.76e-05, LM: 0.0425, Age: 0.54, Sex: 0.000
2025-10-23 17:04:46,942 - INFO - Epoch 5, Step 650/1000 - Loss: 0.0685, Perplexity: 1.1247, LR: 8.74e-05, LM: 0.0410, Age: 0.55, Sex: 0.000
2025-10-23 17:04:59,486 - INFO - Epoch 5, Step 700/1000 - Loss: 0.0669, Perplexity: 1.1194, LR: 8.72e-05, LM: 0.0394, Age: 0.55, Sex: 0.000
2025-10-23 17:05:12,147 - INFO - Epoch 5, Step 750/1000 - Loss: 0.0650, Perplexity: 1.1141, LR: 8.71e-05, LM: 0.0375, Age: 0.55, Sex: 0.000
2025-10-23 17:05:24,698 - INFO - Epoch 5, Step 800/1000 - Loss: 0.0643, Perplexity: 1.1116, LR: 8.69e-05, LM: 0.0370, Age: 0.54, Sex: 0.000
2025-10-23 17:05:37,220 - INFO - Epoch 5, Step 850/1000 - Loss: 0.0625, Perplexity: 1.1071, LR: 8.67e-05, LM: 0.0353, Age: 0.54, Sex: 0.000
2025-10-23 17:05:49,896 - INFO - Epoch 5, Step 900/1000 - Loss: 0.0624, Perplexity: 1.1054, LR: 8.66e-05, LM: 0.0356, Age: 0.54, Sex: 0.000
2025-10-23 17:06:02,636 - INFO - Epoch 5, Step 950/1000 - Loss: 0.0613, Perplexity: 1.1022, LR: 8.64e-05, LM: 0.0344, Age: 0.54, Sex: 0.000
2025-10-23 17:06:15,167 - INFO - Epoch 5, Step 1000/1000 - Loss: 0.0598, Perplexity: 1.0987, LR: 8.62e-05, LM: 0.0331, Age: 0.53, Sex: 0.000
2025-10-23 17:06:15,168 - INFO - Epoch 5 Complete - Avg Loss: 0.0598, Avg Perplexity: 1.0987, LM: 0.0331, Age: 0.53, Sex: 0.000
2025-10-23 17:06:34,962 - INFO - Validation - Loss: 0.0491, Perplexity: 1.1673, Token Accuracy: 0.9926, Code Accuracy: 0.9914
2025-10-23 17:06:34,964 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 17:06:38,432 - INFO - TPL computed on 351 samples: 1.0814
2025-10-23 17:06:38,432 - INFO - Temporal Perplexity (TPL): 1.0814
2025-10-23 17:06:38,432 - INFO - New best model! Validation loss: 0.0491
2025-10-23 17:06:43,258 - INFO - Checkpoint saved: epoch 5
2025-10-23 17:06:55,863 - INFO - Epoch 6, Step 50/1000 - Loss: 0.0794, Perplexity: 1.1562, LR: 8.60e-05, LM: 0.0572, Age: 0.44, Sex: 0.000
2025-10-23 17:07:08,557 - INFO - Epoch 6, Step 100/1000 - Loss: 0.0560, Perplexity: 1.0947, LR: 8.59e-05, LM: 0.0335, Age: 0.45, Sex: 0.000
2025-10-23 17:07:21,213 - INFO - Epoch 6, Step 150/1000 - Loss: 0.0596, Perplexity: 1.0981, LR: 8.57e-05, LM: 0.0366, Age: 0.46, Sex: 0.000
2025-10-23 17:07:33,896 - INFO - Epoch 6, Step 200/1000 - Loss: 0.0546, Perplexity: 1.0837, LR: 8.55e-05, LM: 0.0301, Age: 0.49, Sex: 0.000
2025-10-23 17:07:46,430 - INFO - Epoch 6, Step 250/1000 - Loss: 0.0492, Perplexity: 1.0726, LR: 8.53e-05, LM: 0.0250, Age: 0.48, Sex: 0.000
2025-10-23 17:07:59,118 - INFO - Epoch 6, Step 300/1000 - Loss: 0.0455, Perplexity: 1.0651, LR: 8.52e-05, LM: 0.0217, Age: 0.48, Sex: 0.000
2025-10-23 17:08:12,239 - INFO - Epoch 6, Step 350/1000 - Loss: 0.0463, Perplexity: 1.0644, LR: 8.50e-05, LM: 0.0226, Age: 0.47, Sex: 0.000
2025-10-23 17:08:24,969 - INFO - Epoch 6, Step 400/1000 - Loss: 0.0459, Perplexity: 1.0620, LR: 8.48e-05, LM: 0.0219, Age: 0.48, Sex: 0.000
2025-10-23 17:08:37,704 - INFO - Epoch 6, Step 450/1000 - Loss: 0.0492, Perplexity: 1.0744, LR: 8.47e-05, LM: 0.0252, Age: 0.48, Sex: 0.000
2025-10-23 17:08:50,542 - INFO - Epoch 6, Step 500/1000 - Loss: 0.0473, Perplexity: 1.0700, LR: 8.45e-05, LM: 0.0234, Age: 0.48, Sex: 0.000
2025-10-23 17:42:31,621 - INFO - ================================================================================
2025-10-23 17:42:31,622 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 17:42:31,622 - INFO - ================================================================================
2025-10-23 17:42:31,622 - INFO - 
Configuration:

[Data]
  Patients: 10000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 5
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 17:42:31,625 - INFO - 
Random seed: 42
2025-10-23 17:42:31,883 - INFO - Device: cuda
2025-10-23 17:42:31,884 - INFO - 
================================================================================
2025-10-23 17:42:31,884 - INFO - Loading MIMIC-III Data
2025-10-23 17:42:31,884 - INFO - ================================================================================
2025-10-23 17:42:31,884 - INFO - Loading MIMIC-III data files
2025-10-23 17:42:31,943 - INFO - Loaded 46520 patients
2025-10-23 17:42:32,091 - INFO - Loaded 58976 admissions
2025-10-23 17:42:32,265 - INFO - Loaded 651047 diagnosis records
2025-10-23 17:42:32,545 - INFO - Processing patient records
2025-10-23 17:42:40,845 - INFO - Loaded 10000 patient records
2025-10-23 17:42:40,845 - INFO - Diagnosis vocabulary size: 4253
2025-10-23 17:42:40,848 - INFO - Average visits per patient: 1.29
2025-10-23 17:42:40,849 - INFO - Average codes per visit: 9.16
2025-10-23 17:42:40,850 - INFO - Gender distribution: {'M': 5615, 'F': 4385}
2025-10-23 17:42:40,871 - INFO - Loaded 10000 patients
2025-10-23 17:42:40,871 - INFO - Vocabulary size: 4253 diagnosis codes
2025-10-23 17:42:40,872 - INFO - Tokenizer vocab size: 4260
2025-10-23 17:42:40,872 - INFO - Dataset size: 10000 patients
2025-10-23 17:42:40,872 - INFO - Train size: 8000, Validation size: 2000
2025-10-23 17:42:40,873 - INFO - Train batches: 1000, Validation batches: 250
2025-10-23 17:42:40,873 - INFO - 
================================================================================
2025-10-23 17:42:40,873 - INFO - Initializing Model
2025-10-23 17:42:40,873 - INFO - ================================================================================
2025-10-23 17:42:40,964 - INFO - BART config vocab size: 4260
2025-10-23 17:42:42,831 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 17:42:42,832 - INFO -   Age loss weight: 0.01
2025-10-23 17:42:42,832 - INFO -   Sex loss weight: 0.2
2025-10-23 17:42:43,085 - INFO - Total parameters: 104,683,016
2025-10-23 17:42:43,085 - INFO - Trainable parameters: 104,683,016
2025-10-23 17:42:43,086 - INFO - Total training steps: 5000
2025-10-23 17:42:43,086 - INFO - Warmup steps: 1000
2025-10-23 17:42:43,086 - INFO - 
================================================================================
2025-10-23 17:42:43,086 - INFO - Starting Training
2025-10-23 17:42:43,086 - INFO - ================================================================================
2025-10-23 17:42:55,619 - INFO - Epoch 1, Step 50/1000 - Loss: 7.7692, Perplexity: 2712.7138, LR: 5.00e-06, LM: 7.6176, Age: 1.77, Sex: 0.669
2025-10-23 17:43:08,344 - INFO - Epoch 1, Step 100/1000 - Loss: 6.9724, Perplexity: 1643.5478, LR: 1.00e-05, LM: 6.8427, Age: 1.71, Sex: 0.563
2025-10-23 17:43:20,777 - INFO - Epoch 1, Step 150/1000 - Loss: 6.4593, Perplexity: 1182.9563, LR: 1.50e-05, LM: 6.3591, Age: 1.64, Sex: 0.419
2025-10-23 17:43:33,335 - INFO - Epoch 1, Step 200/1000 - Loss: 6.0919, Perplexity: 930.9104, LR: 2.00e-05, LM: 6.0094, Age: 1.56, Sex: 0.335
2025-10-23 17:43:45,788 - INFO - Epoch 1, Step 250/1000 - Loss: 5.8251, Perplexity: 772.4373, LR: 2.50e-05, LM: 5.7546, Age: 1.46, Sex: 0.280
2025-10-23 17:43:58,360 - INFO - Epoch 1, Step 300/1000 - Loss: 5.6106, Perplexity: 661.9261, LR: 3.00e-05, LM: 5.5489, Age: 1.38, Sex: 0.240
2025-10-23 17:44:11,021 - INFO - Epoch 1, Step 350/1000 - Loss: 5.4504, Perplexity: 581.3924, LR: 3.50e-05, LM: 5.3955, Age: 1.31, Sex: 0.209
2025-10-23 17:44:23,398 - INFO - Epoch 1, Step 400/1000 - Loss: 5.2884, Perplexity: 517.7275, LR: 4.00e-05, LM: 5.2390, Age: 1.25, Sex: 0.185
2025-10-23 17:44:35,692 - INFO - Epoch 1, Step 450/1000 - Loss: 5.1483, Perplexity: 468.2788, LR: 4.50e-05, LM: 5.1032, Age: 1.20, Sex: 0.165
2025-10-23 17:44:48,167 - INFO - Epoch 1, Step 500/1000 - Loss: 4.9903, Perplexity: 426.4752, LR: 5.00e-05, LM: 4.9488, Age: 1.16, Sex: 0.150
2025-10-23 17:45:00,618 - INFO - Epoch 1, Step 550/1000 - Loss: 4.7982, Perplexity: 389.7352, LR: 5.50e-05, LM: 4.7596, Age: 1.13, Sex: 0.136
2025-10-23 17:45:13,548 - INFO - Epoch 1, Step 600/1000 - Loss: 4.5872, Perplexity: 358.5658, LR: 6.00e-05, LM: 4.5510, Age: 1.11, Sex: 0.125
2025-10-23 17:45:26,065 - INFO - Epoch 1, Step 650/1000 - Loss: 4.3603, Perplexity: 331.5881, LR: 6.50e-05, LM: 4.3261, Age: 1.10, Sex: 0.116
2025-10-23 17:45:38,500 - INFO - Epoch 1, Step 700/1000 - Loss: 4.1397, Perplexity: 308.3665, LR: 7.00e-05, LM: 4.1072, Age: 1.09, Sex: 0.108
2025-10-23 17:45:51,269 - INFO - Epoch 1, Step 750/1000 - Loss: 3.9245, Perplexity: 288.0435, LR: 7.50e-05, LM: 3.8937, Age: 1.07, Sex: 0.101
2025-10-23 17:46:03,926 - INFO - Epoch 1, Step 800/1000 - Loss: 3.7331, Perplexity: 270.2961, LR: 8.00e-05, LM: 3.7036, Age: 1.06, Sex: 0.095
2025-10-23 17:46:16,341 - INFO - Epoch 1, Step 850/1000 - Loss: 3.5568, Perplexity: 254.5697, LR: 8.50e-05, LM: 3.5286, Age: 1.04, Sex: 0.089
2025-10-23 17:46:28,795 - INFO - Epoch 1, Step 900/1000 - Loss: 3.3869, Perplexity: 240.5400, LR: 9.00e-05, LM: 3.3597, Age: 1.03, Sex: 0.084
2025-10-23 17:46:41,471 - INFO - Epoch 1, Step 950/1000 - Loss: 3.2381, Perplexity: 228.0018, LR: 9.50e-05, LM: 3.2119, Age: 1.02, Sex: 0.080
2025-10-23 17:46:54,454 - INFO - Epoch 1, Step 1000/1000 - Loss: 3.0939, Perplexity: 216.6811, LR: 1.00e-04, LM: 3.0686, Age: 1.01, Sex: 0.076
2025-10-23 17:46:54,455 - INFO - Epoch 1 Complete - Avg Loss: 3.0939, Avg Perplexity: 216.6811, LM: 3.0686, Age: 1.01, Sex: 0.076
2025-10-23 17:47:14,571 - INFO - Validation - Loss: 0.3497, Perplexity: 2.2870, Token Accuracy: 0.9615, Code Accuracy: 0.9541
2025-10-23 17:47:14,573 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 17:47:18,026 - INFO - TPL computed on 351 samples: 1.7293
2025-10-23 17:47:18,026 - INFO - Temporal Perplexity (TPL): 1.7293
2025-10-23 17:47:18,026 - INFO - New best model! Validation loss: 0.3497
2025-10-23 17:47:23,038 - INFO - Checkpoint saved: epoch 1
2025-10-23 17:47:35,807 - INFO - Epoch 2, Step 50/1000 - Loss: 0.3671, Perplexity: 1.8508, LR: 9.88e-05, LM: 0.3578, Age: 0.90, Sex: 0.002
2025-10-23 17:47:48,371 - INFO - Epoch 2, Step 100/1000 - Loss: 0.3284, Perplexity: 1.7429, LR: 9.75e-05, LM: 0.3198, Age: 0.84, Sex: 0.001
2025-10-23 17:48:01,189 - INFO - Epoch 2, Step 150/1000 - Loss: 0.2978, Perplexity: 1.6202, LR: 9.63e-05, LM: 0.2894, Age: 0.82, Sex: 0.001
2025-10-23 17:48:13,835 - INFO - Epoch 2, Step 200/1000 - Loss: 0.3212, Perplexity: 1.8171, LR: 9.50e-05, LM: 0.3128, Age: 0.80, Sex: 0.001
2025-10-23 17:48:26,352 - INFO - Epoch 2, Step 250/1000 - Loss: 0.3052, Perplexity: 1.7322, LR: 9.38e-05, LM: 0.2971, Age: 0.79, Sex: 0.001
2025-10-23 17:48:38,775 - INFO - Epoch 2, Step 300/1000 - Loss: 0.2830, Perplexity: 1.6511, LR: 9.25e-05, LM: 0.2748, Age: 0.79, Sex: 0.001
2025-10-23 17:48:51,589 - INFO - Epoch 2, Step 350/1000 - Loss: 0.2909, Perplexity: 1.7303, LR: 9.12e-05, LM: 0.2827, Age: 0.79, Sex: 0.001
2025-10-23 17:49:04,271 - INFO - Epoch 2, Step 400/1000 - Loss: 0.2706, Perplexity: 1.6628, LR: 9.00e-05, LM: 0.2625, Age: 0.78, Sex: 0.001
2025-10-23 17:49:16,741 - INFO - Epoch 2, Step 450/1000 - Loss: 0.2561, Perplexity: 1.6108, LR: 8.88e-05, LM: 0.2481, Age: 0.78, Sex: 0.001
2025-10-23 17:49:29,392 - INFO - Epoch 2, Step 500/1000 - Loss: 0.2421, Perplexity: 1.5638, LR: 8.75e-05, LM: 0.2341, Age: 0.78, Sex: 0.001
2025-10-23 17:49:42,048 - INFO - Epoch 2, Step 550/1000 - Loss: 0.2387, Perplexity: 1.5448, LR: 8.63e-05, LM: 0.2307, Age: 0.78, Sex: 0.001
2025-10-23 17:49:54,609 - INFO - Epoch 2, Step 600/1000 - Loss: 0.2333, Perplexity: 1.5898, LR: 8.50e-05, LM: 0.2253, Age: 0.77, Sex: 0.001
2025-10-23 17:50:07,308 - INFO - Epoch 2, Step 650/1000 - Loss: 0.2337, Perplexity: 1.6196, LR: 8.38e-05, LM: 0.2258, Age: 0.77, Sex: 0.001
2025-10-23 17:50:20,017 - INFO - Epoch 2, Step 700/1000 - Loss: 0.2235, Perplexity: 1.5860, LR: 8.25e-05, LM: 0.2156, Age: 0.76, Sex: 0.001
2025-10-23 17:50:32,470 - INFO - Epoch 2, Step 750/1000 - Loss: 0.2141, Perplexity: 1.5542, LR: 8.13e-05, LM: 0.2063, Age: 0.76, Sex: 0.001
2025-10-23 17:50:45,275 - INFO - Epoch 2, Step 800/1000 - Loss: 0.2064, Perplexity: 1.5280, LR: 8.00e-05, LM: 0.1985, Age: 0.76, Sex: 0.001
2025-10-23 17:50:57,588 - INFO - Epoch 2, Step 850/1000 - Loss: 0.1991, Perplexity: 1.5038, LR: 7.88e-05, LM: 0.1913, Age: 0.76, Sex: 0.001
2025-10-23 17:51:09,775 - INFO - Epoch 2, Step 900/1000 - Loss: 0.1947, Perplexity: 1.4892, LR: 7.75e-05, LM: 0.1870, Age: 0.75, Sex: 0.001
2025-10-23 17:51:22,243 - INFO - Epoch 2, Step 950/1000 - Loss: 0.1897, Perplexity: 1.4704, LR: 7.62e-05, LM: 0.1820, Age: 0.75, Sex: 0.001
2025-10-23 17:51:34,897 - INFO - Epoch 2, Step 1000/1000 - Loss: 0.1870, Perplexity: 1.4632, LR: 7.50e-05, LM: 0.1794, Age: 0.75, Sex: 0.001
2025-10-23 17:51:34,898 - INFO - Epoch 2 Complete - Avg Loss: 0.1870, Avg Perplexity: 1.4632, LM: 0.1794, Age: 0.75, Sex: 0.001
2025-10-23 17:51:54,738 - INFO - Validation - Loss: 0.1124, Perplexity: 1.3079, Token Accuracy: 0.9844, Code Accuracy: 0.9817
2025-10-23 17:51:54,739 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 17:51:58,151 - INFO - TPL computed on 351 samples: 1.1957
2025-10-23 17:51:58,151 - INFO - Temporal Perplexity (TPL): 1.1957
2025-10-23 17:51:58,151 - INFO - New best model! Validation loss: 0.1124
2025-10-23 17:52:02,740 - INFO - Checkpoint saved: epoch 2
2025-10-23 17:52:15,397 - INFO - Epoch 3, Step 50/1000 - Loss: 0.0515, Perplexity: 1.0568, LR: 7.38e-05, LM: 0.0444, Age: 0.70, Sex: 0.000
2025-10-23 17:52:28,300 - INFO - Epoch 3, Step 100/1000 - Loss: 0.0600, Perplexity: 1.0780, LR: 7.25e-05, LM: 0.0530, Age: 0.70, Sex: 0.000
2025-10-23 17:52:40,643 - INFO - Epoch 3, Step 150/1000 - Loss: 0.0575, Perplexity: 1.0737, LR: 7.13e-05, LM: 0.0506, Age: 0.69, Sex: 0.000
2025-10-23 17:52:52,977 - INFO - Epoch 3, Step 200/1000 - Loss: 0.0676, Perplexity: 1.1802, LR: 7.00e-05, LM: 0.0605, Age: 0.69, Sex: 0.001
2025-10-23 17:53:05,525 - INFO - Epoch 3, Step 250/1000 - Loss: 0.0710, Perplexity: 1.1887, LR: 6.88e-05, LM: 0.0638, Age: 0.70, Sex: 0.001
2025-10-23 17:53:18,152 - INFO - Epoch 3, Step 300/1000 - Loss: 0.0745, Perplexity: 1.1790, LR: 6.75e-05, LM: 0.0675, Age: 0.69, Sex: 0.001
2025-10-23 17:53:30,954 - INFO - Epoch 3, Step 350/1000 - Loss: 0.0761, Perplexity: 1.1890, LR: 6.62e-05, LM: 0.0691, Age: 0.69, Sex: 0.001
2025-10-23 17:53:43,721 - INFO - Epoch 3, Step 400/1000 - Loss: 0.0716, Perplexity: 1.1708, LR: 6.50e-05, LM: 0.0647, Age: 0.68, Sex: 0.000
2025-10-23 17:53:55,911 - INFO - Epoch 3, Step 450/1000 - Loss: 0.0678, Perplexity: 1.1569, LR: 6.38e-05, LM: 0.0608, Age: 0.69, Sex: 0.000
2025-10-23 17:54:08,746 - INFO - Epoch 3, Step 500/1000 - Loss: 0.0640, Perplexity: 1.1446, LR: 6.25e-05, LM: 0.0570, Age: 0.69, Sex: 0.000
2025-10-23 17:54:21,364 - INFO - Epoch 3, Step 550/1000 - Loss: 0.0679, Perplexity: 1.1589, LR: 6.13e-05, LM: 0.0609, Age: 0.69, Sex: 0.001
2025-10-23 17:54:33,932 - INFO - Epoch 3, Step 600/1000 - Loss: 0.0653, Perplexity: 1.1492, LR: 6.00e-05, LM: 0.0583, Age: 0.69, Sex: 0.001
2025-10-23 17:54:46,500 - INFO - Epoch 3, Step 650/1000 - Loss: 0.0638, Perplexity: 1.1446, LR: 5.88e-05, LM: 0.0569, Age: 0.68, Sex: 0.001
2025-10-23 17:54:59,175 - INFO - Epoch 3, Step 700/1000 - Loss: 0.0611, Perplexity: 1.1362, LR: 5.75e-05, LM: 0.0542, Age: 0.68, Sex: 0.001
2025-10-23 17:55:11,770 - INFO - Epoch 3, Step 750/1000 - Loss: 0.0676, Perplexity: 1.1512, LR: 5.63e-05, LM: 0.0607, Age: 0.68, Sex: 0.001
2025-10-23 17:55:24,345 - INFO - Epoch 3, Step 800/1000 - Loss: 0.0653, Perplexity: 1.1441, LR: 5.50e-05, LM: 0.0584, Age: 0.67, Sex: 0.001
2025-10-23 17:55:37,073 - INFO - Epoch 3, Step 850/1000 - Loss: 0.0649, Perplexity: 1.1470, LR: 5.37e-05, LM: 0.0581, Age: 0.67, Sex: 0.001
2025-10-23 17:55:49,838 - INFO - Epoch 3, Step 900/1000 - Loss: 0.0636, Perplexity: 1.1415, LR: 5.25e-05, LM: 0.0567, Age: 0.67, Sex: 0.001
2025-10-23 17:56:02,242 - INFO - Epoch 3, Step 950/1000 - Loss: 0.0615, Perplexity: 1.1353, LR: 5.12e-05, LM: 0.0546, Age: 0.67, Sex: 0.001
2025-10-23 17:56:15,006 - INFO - Epoch 3, Step 1000/1000 - Loss: 0.0616, Perplexity: 1.1333, LR: 5.00e-05, LM: 0.0549, Age: 0.67, Sex: 0.001
2025-10-23 17:56:15,007 - INFO - Epoch 3 Complete - Avg Loss: 0.0616, Avg Perplexity: 1.1333, LM: 0.0549, Age: 0.67, Sex: 0.001
2025-10-23 17:56:34,760 - INFO - Validation - Loss: 0.0611, Perplexity: 1.1908, Token Accuracy: 0.9912, Code Accuracy: 0.9895
2025-10-23 17:56:34,761 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 17:56:38,175 - INFO - TPL computed on 351 samples: 1.0965
2025-10-23 17:56:38,176 - INFO - Temporal Perplexity (TPL): 1.0965
2025-10-23 17:56:38,176 - INFO - New best model! Validation loss: 0.0611
2025-10-23 17:56:42,870 - INFO - Checkpoint saved: epoch 3
2025-10-23 17:56:55,521 - INFO - Epoch 4, Step 50/1000 - Loss: 0.0554, Perplexity: 1.1733, LR: 4.87e-05, LM: 0.0487, Age: 0.66, Sex: 0.000
2025-10-23 17:57:08,174 - INFO - Epoch 4, Step 100/1000 - Loss: 0.0343, Perplexity: 1.0934, LR: 4.75e-05, LM: 0.0279, Age: 0.64, Sex: 0.000
2025-10-23 17:57:20,684 - INFO - Epoch 4, Step 150/1000 - Loss: 0.0268, Perplexity: 1.0662, LR: 4.63e-05, LM: 0.0205, Age: 0.63, Sex: 0.000
2025-10-23 17:57:33,054 - INFO - Epoch 4, Step 200/1000 - Loss: 0.0349, Perplexity: 1.0785, LR: 4.50e-05, LM: 0.0287, Age: 0.62, Sex: 0.000
2025-10-23 17:57:45,703 - INFO - Epoch 4, Step 250/1000 - Loss: 0.0450, Perplexity: 1.0977, LR: 4.37e-05, LM: 0.0388, Age: 0.62, Sex: 0.000
2025-10-23 17:57:58,191 - INFO - Epoch 4, Step 300/1000 - Loss: 0.0414, Perplexity: 1.0857, LR: 4.25e-05, LM: 0.0351, Age: 0.63, Sex: 0.000
2025-10-23 17:58:10,999 - INFO - Epoch 4, Step 350/1000 - Loss: 0.0439, Perplexity: 1.0865, LR: 4.12e-05, LM: 0.0376, Age: 0.63, Sex: 0.000
2025-10-23 17:58:23,168 - INFO - Epoch 4, Step 400/1000 - Loss: 0.0405, Perplexity: 1.0779, LR: 4.00e-05, LM: 0.0343, Age: 0.62, Sex: 0.000
2025-10-23 17:58:35,247 - INFO - Epoch 4, Step 450/1000 - Loss: 0.0501, Perplexity: 1.1160, LR: 3.87e-05, LM: 0.0438, Age: 0.62, Sex: 0.000
2025-10-23 17:58:47,764 - INFO - Epoch 4, Step 500/1000 - Loss: 0.0462, Perplexity: 1.1055, LR: 3.75e-05, LM: 0.0399, Age: 0.62, Sex: 0.000
2025-10-23 17:59:00,145 - INFO - Epoch 4, Step 550/1000 - Loss: 0.0432, Perplexity: 1.0971, LR: 3.63e-05, LM: 0.0369, Age: 0.62, Sex: 0.000
2025-10-23 17:59:12,808 - INFO - Epoch 4, Step 600/1000 - Loss: 0.0429, Perplexity: 1.0939, LR: 3.50e-05, LM: 0.0366, Age: 0.62, Sex: 0.000
2025-10-23 17:59:25,131 - INFO - Epoch 4, Step 650/1000 - Loss: 0.0408, Perplexity: 1.0880, LR: 3.38e-05, LM: 0.0346, Age: 0.62, Sex: 0.000
2025-10-23 17:59:37,739 - INFO - Epoch 4, Step 700/1000 - Loss: 0.0395, Perplexity: 1.0834, LR: 3.25e-05, LM: 0.0332, Age: 0.62, Sex: 0.000
2025-10-23 17:59:50,112 - INFO - Epoch 4, Step 750/1000 - Loss: 0.0409, Perplexity: 1.0874, LR: 3.13e-05, LM: 0.0347, Age: 0.62, Sex: 0.000
2025-10-23 18:00:02,879 - INFO - Epoch 4, Step 800/1000 - Loss: 0.0397, Perplexity: 1.0835, LR: 3.00e-05, LM: 0.0335, Age: 0.62, Sex: 0.000
2025-10-23 18:00:15,062 - INFO - Epoch 4, Step 850/1000 - Loss: 0.0380, Perplexity: 1.0792, LR: 2.87e-05, LM: 0.0317, Age: 0.62, Sex: 0.000
2025-10-23 18:00:27,813 - INFO - Epoch 4, Step 900/1000 - Loss: 0.0382, Perplexity: 1.0797, LR: 2.75e-05, LM: 0.0320, Age: 0.62, Sex: 0.000
2025-10-23 18:00:40,079 - INFO - Epoch 4, Step 950/1000 - Loss: 0.0370, Perplexity: 1.0763, LR: 2.63e-05, LM: 0.0307, Age: 0.62, Sex: 0.000
2025-10-23 18:00:53,061 - INFO - Epoch 4, Step 1000/1000 - Loss: 0.0361, Perplexity: 1.0736, LR: 2.50e-05, LM: 0.0299, Age: 0.62, Sex: 0.000
2025-10-23 18:00:53,062 - INFO - Epoch 4 Complete - Avg Loss: 0.0361, Avg Perplexity: 1.0736, LM: 0.0299, Age: 0.62, Sex: 0.000
2025-10-23 18:01:13,074 - INFO - Validation - Loss: 0.0393, Perplexity: 1.1243, Token Accuracy: 0.9941, Code Accuracy: 0.9932
2025-10-23 18:01:13,076 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 18:01:16,492 - INFO - TPL computed on 351 samples: 1.0701
2025-10-23 18:01:16,492 - INFO - Temporal Perplexity (TPL): 1.0701
2025-10-23 18:01:16,492 - INFO - New best model! Validation loss: 0.0393
2025-10-23 18:01:21,204 - INFO - Checkpoint saved: epoch 4
2025-10-23 18:01:33,672 - INFO - Epoch 5, Step 50/1000 - Loss: 0.0143, Perplexity: 1.0151, LR: 2.38e-05, LM: 0.0084, Age: 0.59, Sex: 0.000
2025-10-23 18:01:46,220 - INFO - Epoch 5, Step 100/1000 - Loss: 0.0263, Perplexity: 1.0340, LR: 2.25e-05, LM: 0.0202, Age: 0.61, Sex: 0.000
2025-10-23 18:01:59,135 - INFO - Epoch 5, Step 150/1000 - Loss: 0.0492, Perplexity: 1.1193, LR: 2.13e-05, LM: 0.0431, Age: 0.61, Sex: 0.000
2025-10-23 18:02:11,855 - INFO - Epoch 5, Step 200/1000 - Loss: 0.0394, Perplexity: 1.0920, LR: 2.00e-05, LM: 0.0332, Age: 0.61, Sex: 0.000
2025-10-23 18:02:24,025 - INFO - Epoch 5, Step 250/1000 - Loss: 0.0392, Perplexity: 1.0893, LR: 1.88e-05, LM: 0.0332, Age: 0.60, Sex: 0.000
2025-10-23 18:02:36,633 - INFO - Epoch 5, Step 300/1000 - Loss: 0.0421, Perplexity: 1.1025, LR: 1.75e-05, LM: 0.0362, Age: 0.59, Sex: 0.000
2025-10-23 18:02:49,249 - INFO - Epoch 5, Step 350/1000 - Loss: 0.0422, Perplexity: 1.1020, LR: 1.63e-05, LM: 0.0363, Age: 0.59, Sex: 0.000
2025-10-23 18:03:02,079 - INFO - Epoch 5, Step 400/1000 - Loss: 0.0382, Perplexity: 1.0906, LR: 1.50e-05, LM: 0.0323, Age: 0.59, Sex: 0.000
2025-10-23 18:03:14,461 - INFO - Epoch 5, Step 450/1000 - Loss: 0.0403, Perplexity: 1.0966, LR: 1.38e-05, LM: 0.0343, Age: 0.59, Sex: 0.000
2025-10-23 18:03:26,903 - INFO - Epoch 5, Step 500/1000 - Loss: 0.0376, Perplexity: 1.0884, LR: 1.25e-05, LM: 0.0317, Age: 0.59, Sex: 0.000
2025-10-23 18:03:39,469 - INFO - Epoch 5, Step 550/1000 - Loss: 0.0362, Perplexity: 1.0828, LR: 1.13e-05, LM: 0.0303, Age: 0.59, Sex: 0.000
2025-10-23 18:03:51,942 - INFO - Epoch 5, Step 600/1000 - Loss: 0.0356, Perplexity: 1.0796, LR: 1.00e-05, LM: 0.0297, Age: 0.59, Sex: 0.000
2025-10-23 18:04:04,645 - INFO - Epoch 5, Step 650/1000 - Loss: 0.0343, Perplexity: 1.0750, LR: 8.75e-06, LM: 0.0283, Age: 0.59, Sex: 0.000
2025-10-23 18:04:17,489 - INFO - Epoch 5, Step 700/1000 - Loss: 0.0324, Perplexity: 1.0703, LR: 7.50e-06, LM: 0.0265, Age: 0.59, Sex: 0.000
2025-10-23 18:04:30,115 - INFO - Epoch 5, Step 750/1000 - Loss: 0.0309, Perplexity: 1.0662, LR: 6.25e-06, LM: 0.0249, Age: 0.59, Sex: 0.000
2025-10-23 18:04:42,683 - INFO - Epoch 5, Step 800/1000 - Loss: 0.0303, Perplexity: 1.0639, LR: 5.00e-06, LM: 0.0245, Age: 0.59, Sex: 0.000
2025-10-23 18:04:54,853 - INFO - Epoch 5, Step 850/1000 - Loss: 0.0290, Perplexity: 1.0606, LR: 3.75e-06, LM: 0.0232, Age: 0.58, Sex: 0.000
2025-10-23 18:05:07,401 - INFO - Epoch 5, Step 900/1000 - Loss: 0.0294, Perplexity: 1.0599, LR: 2.50e-06, LM: 0.0236, Age: 0.58, Sex: 0.000
2025-10-23 18:05:20,068 - INFO - Epoch 5, Step 950/1000 - Loss: 0.0285, Perplexity: 1.0574, LR: 1.25e-06, LM: 0.0227, Age: 0.57, Sex: 0.000
2025-10-23 18:05:32,518 - INFO - Epoch 5, Step 1000/1000 - Loss: 0.0274, Perplexity: 1.0549, LR: 0.00e+00, LM: 0.0217, Age: 0.57, Sex: 0.000
2025-10-23 18:05:32,519 - INFO - Epoch 5 Complete - Avg Loss: 0.0274, Avg Perplexity: 1.0549, LM: 0.0217, Age: 0.57, Sex: 0.000
2025-10-23 18:05:52,305 - INFO - Validation - Loss: 0.0338, Perplexity: 1.0844, Token Accuracy: 0.9948, Code Accuracy: 0.9939
2025-10-23 18:05:52,306 - INFO - Computing TPL on 351 patients with 2+ visits
2025-10-23 18:05:55,729 - INFO - TPL computed on 351 samples: 1.0531
2025-10-23 18:05:55,730 - INFO - Temporal Perplexity (TPL): 1.0531
2025-10-23 18:05:55,730 - INFO - New best model! Validation loss: 0.0338
2025-10-23 18:06:00,381 - INFO - Checkpoint saved: epoch 5
2025-10-23 18:06:00,381 - INFO - 
================================================================================
2025-10-23 18:06:00,381 - INFO - Training Complete!
2025-10-23 18:06:00,381 - INFO - ================================================================================
2025-10-23 18:06:00,381 - INFO - Best validation loss: 0.0338
2025-10-23 18:06:00,381 - INFO - Best validation perplexity: 1.0343
2025-10-23 18:44:08,300 - INFO - ================================================================================
2025-10-23 18:44:08,300 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-23 18:44:08,300 - INFO - ================================================================================
2025-10-23 18:44:08,300 - INFO - 
Configuration:

[Data]
  Patients: 25000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 10
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-23 18:44:08,311 - INFO - 
Random seed: 42
2025-10-23 18:44:08,512 - INFO - Device: cuda
2025-10-23 18:44:08,512 - INFO - 
================================================================================
2025-10-23 18:44:08,512 - INFO - Loading MIMIC-III Data
2025-10-23 18:44:08,512 - INFO - ================================================================================
2025-10-23 18:44:08,512 - INFO - Loading MIMIC-III data files
2025-10-23 18:44:08,576 - INFO - Loaded 46520 patients
2025-10-23 18:44:08,739 - INFO - Loaded 58976 admissions
2025-10-23 18:44:08,934 - INFO - Loaded 651047 diagnosis records
2025-10-23 18:44:09,201 - INFO - Processing patient records
2025-10-23 18:44:22,950 - INFO - Loaded 25000 patient records
2025-10-23 18:44:22,951 - INFO - Diagnosis vocabulary size: 5562
2025-10-23 18:44:22,955 - INFO - Average visits per patient: 1.30
2025-10-23 18:44:22,955 - INFO - Average codes per visit: 9.15
2025-10-23 18:44:22,959 - INFO - Gender distribution: {'M': 14038, 'F': 10962}
2025-10-23 18:44:22,978 - INFO - Loaded 25000 patients
2025-10-23 18:44:22,978 - INFO - Vocabulary size: 5562 diagnosis codes
2025-10-23 18:44:22,978 - INFO - Tokenizer vocab size: 5569
2025-10-23 18:44:22,978 - INFO - Dataset size: 25000 patients
2025-10-23 18:44:22,983 - INFO - Train size: 20000, Validation size: 5000
2025-10-23 18:44:22,983 - INFO - Train batches: 2500, Validation batches: 625
2025-10-23 18:44:22,983 - INFO - 
================================================================================
2025-10-23 18:44:22,983 - INFO - Initializing Model
2025-10-23 18:44:22,983 - INFO - ================================================================================
2025-10-23 18:44:23,091 - INFO - BART config vocab size: 5569
2025-10-23 18:44:24,618 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-23 18:44:24,618 - INFO -   Age loss weight: 0.01
2025-10-23 18:44:24,618 - INFO -   Sex loss weight: 0.2
2025-10-23 18:44:24,869 - INFO - Total parameters: 105,688,328
2025-10-23 18:44:24,869 - INFO - Trainable parameters: 105,688,328
2025-10-23 18:44:24,870 - INFO - Total training steps: 25000
2025-10-23 18:44:24,870 - INFO - Warmup steps: 1000
2025-10-23 18:44:24,870 - INFO - 
================================================================================
2025-10-23 18:44:24,870 - INFO - Starting Training
2025-10-23 18:44:24,870 - INFO - ================================================================================
2025-10-23 18:44:31,459 - INFO - Epoch 1, Step 50/2500 - Loss: 8.0147, Perplexity: 3439.2597, LR: 5.00e-06, LM: 7.8656, Age: 1.79, Sex: 0.656
2025-10-23 18:44:37,116 - INFO - Epoch 1, Step 100/2500 - Loss: 7.2187, Perplexity: 2067.7119, LR: 1.00e-05, LM: 7.0891, Age: 1.72, Sex: 0.562
2025-10-23 18:44:42,765 - INFO - Epoch 1, Step 150/2500 - Loss: 6.6989, Perplexity: 1497.2227, LR: 1.50e-05, LM: 6.5975, Age: 1.64, Sex: 0.425
2025-10-23 18:44:48,304 - INFO - Epoch 1, Step 200/2500 - Loss: 6.2792, Perplexity: 1167.9727, LR: 2.00e-05, LM: 6.1958, Age: 1.56, Sex: 0.339
2025-10-23 18:44:53,774 - INFO - Epoch 1, Step 250/2500 - Loss: 5.9786, Perplexity: 963.3880, LR: 2.50e-05, LM: 5.9073, Age: 1.47, Sex: 0.283
2025-10-23 18:44:59,469 - INFO - Epoch 1, Step 300/2500 - Loss: 5.7722, Perplexity: 826.3155, LR: 3.00e-05, LM: 5.7100, Age: 1.39, Sex: 0.242
2025-10-23 18:45:04,996 - INFO - Epoch 1, Step 350/2500 - Loss: 5.5720, Perplexity: 721.3602, LR: 3.50e-05, LM: 5.5167, Age: 1.32, Sex: 0.210
2025-10-23 18:45:10,581 - INFO - Epoch 1, Step 400/2500 - Loss: 5.4019, Perplexity: 641.9711, LR: 4.00e-05, LM: 5.3522, Age: 1.25, Sex: 0.185
2025-10-23 18:45:16,095 - INFO - Epoch 1, Step 450/2500 - Loss: 5.2452, Perplexity: 578.3549, LR: 4.50e-05, LM: 5.2000, Age: 1.20, Sex: 0.166
2025-10-23 18:45:21,548 - INFO - Epoch 1, Step 500/2500 - Loss: 5.0885, Perplexity: 525.8004, LR: 5.00e-05, LM: 5.0469, Age: 1.16, Sex: 0.150
2025-10-23 18:45:26,950 - INFO - Epoch 1, Step 550/2500 - Loss: 4.9006, Perplexity: 480.6522, LR: 5.50e-05, LM: 4.8619, Age: 1.13, Sex: 0.137
2025-10-23 18:45:32,546 - INFO - Epoch 1, Step 600/2500 - Loss: 4.6924, Perplexity: 441.8574, LR: 6.00e-05, LM: 4.6561, Age: 1.11, Sex: 0.126
2025-10-23 18:45:38,117 - INFO - Epoch 1, Step 650/2500 - Loss: 4.4579, Perplexity: 408.5034, LR: 6.50e-05, LM: 4.4237, Age: 1.09, Sex: 0.116
2025-10-23 18:45:43,582 - INFO - Epoch 1, Step 700/2500 - Loss: 4.2432, Perplexity: 379.7863, LR: 7.00e-05, LM: 4.2108, Age: 1.08, Sex: 0.108
2025-10-23 18:45:49,166 - INFO - Epoch 1, Step 750/2500 - Loss: 4.0332, Perplexity: 354.7287, LR: 7.50e-05, LM: 4.0023, Age: 1.07, Sex: 0.101
2025-10-23 18:45:54,831 - INFO - Epoch 1, Step 800/2500 - Loss: 3.8338, Perplexity: 332.7956, LR: 8.00e-05, LM: 3.8043, Age: 1.06, Sex: 0.095
2025-10-23 18:46:00,449 - INFO - Epoch 1, Step 850/2500 - Loss: 3.6535, Perplexity: 313.4378, LR: 8.50e-05, LM: 3.6251, Age: 1.04, Sex: 0.090
2025-10-23 18:46:05,953 - INFO - Epoch 1, Step 900/2500 - Loss: 3.4892, Perplexity: 296.2978, LR: 9.00e-05, LM: 3.4619, Age: 1.03, Sex: 0.085
2025-10-23 18:46:11,606 - INFO - Epoch 1, Step 950/2500 - Loss: 3.3358, Perplexity: 280.8628, LR: 9.50e-05, LM: 3.3094, Age: 1.02, Sex: 0.081
2025-10-23 18:46:17,171 - INFO - Epoch 1, Step 1000/2500 - Loss: 3.1915, Perplexity: 266.9086, LR: 1.00e-04, LM: 3.1660, Age: 1.01, Sex: 0.077
2025-10-23 18:46:22,847 - INFO - Epoch 1, Step 1050/2500 - Loss: 3.0595, Perplexity: 254.2891, LR: 9.98e-05, LM: 3.0349, Age: 1.00, Sex: 0.073
2025-10-23 18:46:28,311 - INFO - Epoch 1, Step 1100/2500 - Loss: 2.9362, Perplexity: 242.8001, LR: 9.96e-05, LM: 2.9123, Age: 0.99, Sex: 0.070
2025-10-23 18:46:33,718 - INFO - Epoch 1, Step 1150/2500 - Loss: 2.8236, Perplexity: 232.3277, LR: 9.94e-05, LM: 2.8004, Age: 0.98, Sex: 0.067
2025-10-23 18:46:39,215 - INFO - Epoch 1, Step 1200/2500 - Loss: 2.7184, Perplexity: 222.7206, LR: 9.92e-05, LM: 2.6958, Age: 0.97, Sex: 0.064
2025-10-23 18:46:44,913 - INFO - Epoch 1, Step 1250/2500 - Loss: 2.6247, Perplexity: 213.8978, LR: 9.90e-05, LM: 2.6027, Age: 0.97, Sex: 0.062
2025-10-23 18:46:50,431 - INFO - Epoch 1, Step 1300/2500 - Loss: 2.5319, Perplexity: 205.7211, LR: 9.88e-05, LM: 2.5104, Age: 0.96, Sex: 0.059
2025-10-23 18:46:56,047 - INFO - Epoch 1, Step 1350/2500 - Loss: 2.4437, Perplexity: 198.1453, LR: 9.85e-05, LM: 2.4227, Age: 0.95, Sex: 0.057
2025-10-23 18:47:01,639 - INFO - Epoch 1, Step 1400/2500 - Loss: 2.3651, Perplexity: 191.1500, LR: 9.83e-05, LM: 2.3446, Age: 0.94, Sex: 0.055
2025-10-23 18:47:07,298 - INFO - Epoch 1, Step 1450/2500 - Loss: 2.2963, Perplexity: 184.6372, LR: 9.81e-05, LM: 2.2762, Age: 0.94, Sex: 0.054
2025-10-23 18:47:12,663 - INFO - Epoch 1, Step 1500/2500 - Loss: 2.2251, Perplexity: 178.5268, LR: 9.79e-05, LM: 2.2054, Age: 0.93, Sex: 0.052
2025-10-23 18:47:18,364 - INFO - Epoch 1, Step 1550/2500 - Loss: 2.1578, Perplexity: 172.8100, LR: 9.77e-05, LM: 2.1385, Age: 0.93, Sex: 0.050
2025-10-23 18:47:23,831 - INFO - Epoch 1, Step 1600/2500 - Loss: 2.0938, Perplexity: 167.4452, LR: 9.75e-05, LM: 2.0749, Age: 0.92, Sex: 0.049
2025-10-23 18:47:29,391 - INFO - Epoch 1, Step 1650/2500 - Loss: 2.0347, Perplexity: 162.4075, LR: 9.73e-05, LM: 2.0161, Age: 0.92, Sex: 0.047
2025-10-23 18:47:34,842 - INFO - Epoch 1, Step 1700/2500 - Loss: 1.9784, Perplexity: 157.6666, LR: 9.71e-05, LM: 1.9602, Age: 0.91, Sex: 0.046
2025-10-23 18:47:40,295 - INFO - Epoch 1, Step 1750/2500 - Loss: 1.9253, Perplexity: 153.1962, LR: 9.69e-05, LM: 1.9073, Age: 0.90, Sex: 0.045
2025-10-23 18:47:45,874 - INFO - Epoch 1, Step 1800/2500 - Loss: 1.8742, Perplexity: 148.9715, LR: 9.67e-05, LM: 1.8565, Age: 0.90, Sex: 0.043
2025-10-23 18:47:51,389 - INFO - Epoch 1, Step 1850/2500 - Loss: 1.8252, Perplexity: 144.9740, LR: 9.65e-05, LM: 1.8078, Age: 0.89, Sex: 0.042
2025-10-23 18:47:56,850 - INFO - Epoch 1, Step 1900/2500 - Loss: 1.7798, Perplexity: 141.1912, LR: 9.63e-05, LM: 1.7627, Age: 0.89, Sex: 0.041
2025-10-23 18:48:02,384 - INFO - Epoch 1, Step 1950/2500 - Loss: 1.7371, Perplexity: 137.6069, LR: 9.60e-05, LM: 1.7202, Age: 0.88, Sex: 0.040
2025-10-23 18:48:07,964 - INFO - Epoch 1, Step 2000/2500 - Loss: 1.6972, Perplexity: 134.2001, LR: 9.58e-05, LM: 1.6806, Age: 0.88, Sex: 0.039
2025-10-23 18:48:13,632 - INFO - Epoch 1, Step 2050/2500 - Loss: 1.6580, Perplexity: 130.9558, LR: 9.56e-05, LM: 1.6416, Age: 0.88, Sex: 0.038
2025-10-23 18:48:19,376 - INFO - Epoch 1, Step 2100/2500 - Loss: 1.6212, Perplexity: 127.8654, LR: 9.54e-05, LM: 1.6050, Age: 0.87, Sex: 0.037
2025-10-23 18:48:24,792 - INFO - Epoch 1, Step 2150/2500 - Loss: 1.5854, Perplexity: 124.9193, LR: 9.52e-05, LM: 1.5694, Age: 0.87, Sex: 0.036
2025-10-23 18:48:30,358 - INFO - Epoch 1, Step 2200/2500 - Loss: 1.5513, Perplexity: 122.1070, LR: 9.50e-05, LM: 1.5355, Age: 0.86, Sex: 0.036
2025-10-23 18:48:35,773 - INFO - Epoch 1, Step 2250/2500 - Loss: 1.5208, Perplexity: 119.4269, LR: 9.48e-05, LM: 1.5052, Age: 0.86, Sex: 0.035
2025-10-23 18:48:41,378 - INFO - Epoch 1, Step 2300/2500 - Loss: 1.4898, Perplexity: 116.8570, LR: 9.46e-05, LM: 1.4744, Age: 0.86, Sex: 0.034
2025-10-23 18:48:46,785 - INFO - Epoch 1, Step 2350/2500 - Loss: 1.4595, Perplexity: 114.3938, LR: 9.44e-05, LM: 1.4443, Age: 0.86, Sex: 0.033
2025-10-23 18:48:52,254 - INFO - Epoch 1, Step 2400/2500 - Loss: 1.4306, Perplexity: 112.0354, LR: 9.42e-05, LM: 1.4156, Age: 0.85, Sex: 0.033
2025-10-23 18:48:57,940 - INFO - Epoch 1, Step 2450/2500 - Loss: 1.4024, Perplexity: 109.7704, LR: 9.40e-05, LM: 1.3875, Age: 0.85, Sex: 0.032
2025-10-23 18:49:03,345 - INFO - Epoch 1, Step 2500/2500 - Loss: 1.3752, Perplexity: 107.5961, LR: 9.38e-05, LM: 1.3605, Age: 0.84, Sex: 0.031
2025-10-23 18:49:03,346 - INFO - Epoch 1 Complete - Avg Loss: 1.3752, Avg Perplexity: 107.5961, LM: 1.3605, Age: 0.84, Sex: 0.031
2025-10-23 18:49:25,822 - INFO - Validation - Loss: 0.0363, Perplexity: 1.0714, Token Accuracy: 0.9951, Code Accuracy: 0.9942
2025-10-23 18:49:25,824 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 18:49:28,242 - INFO - TPL computed on 500 samples: 1.0635
2025-10-23 18:49:28,242 - INFO - Temporal Perplexity (TPL): 1.0635
2025-10-23 18:49:28,242 - INFO - New best model! Validation loss: 0.0363
2025-10-23 18:49:30,711 - INFO - Checkpoint saved: epoch 1
2025-10-23 18:49:36,426 - INFO - Epoch 2, Step 50/2500 - Loss: 0.0877, Perplexity: 1.3520, LR: 9.35e-05, LM: 0.0810, Age: 0.64, Sex: 0.001
2025-10-23 18:49:41,853 - INFO - Epoch 2, Step 100/2500 - Loss: 0.0708, Perplexity: 1.2181, LR: 9.33e-05, LM: 0.0640, Age: 0.66, Sex: 0.001
2025-10-23 18:49:47,268 - INFO - Epoch 2, Step 150/2500 - Loss: 0.0604, Perplexity: 1.1600, LR: 9.31e-05, LM: 0.0537, Age: 0.66, Sex: 0.001
2025-10-23 18:49:52,824 - INFO - Epoch 2, Step 200/2500 - Loss: 0.0624, Perplexity: 1.1699, LR: 9.29e-05, LM: 0.0557, Age: 0.66, Sex: 0.001
2025-10-23 18:49:58,294 - INFO - Epoch 2, Step 250/2500 - Loss: 0.0747, Perplexity: 1.1884, LR: 9.27e-05, LM: 0.0678, Age: 0.68, Sex: 0.001
2025-10-23 18:50:03,652 - INFO - Epoch 2, Step 300/2500 - Loss: 0.0666, Perplexity: 1.1617, LR: 9.25e-05, LM: 0.0597, Age: 0.68, Sex: 0.001
2025-10-23 18:50:09,247 - INFO - Epoch 2, Step 350/2500 - Loss: 0.0607, Perplexity: 1.1425, LR: 9.23e-05, LM: 0.0539, Age: 0.67, Sex: 0.001
2025-10-23 18:50:15,023 - INFO - Epoch 2, Step 400/2500 - Loss: 0.0780, Perplexity: 1.1990, LR: 9.21e-05, LM: 0.0710, Age: 0.68, Sex: 0.001
2025-10-23 18:50:20,411 - INFO - Epoch 2, Step 450/2500 - Loss: 0.0720, Perplexity: 1.1796, LR: 9.19e-05, LM: 0.0650, Age: 0.68, Sex: 0.001
2025-10-23 18:50:25,964 - INFO - Epoch 2, Step 500/2500 - Loss: 0.0729, Perplexity: 1.1798, LR: 9.17e-05, LM: 0.0659, Age: 0.68, Sex: 0.001
2025-10-23 18:50:31,577 - INFO - Epoch 2, Step 550/2500 - Loss: 0.0735, Perplexity: 1.1781, LR: 9.15e-05, LM: 0.0664, Age: 0.69, Sex: 0.001
2025-10-23 18:50:37,240 - INFO - Epoch 2, Step 600/2500 - Loss: 0.0696, Perplexity: 1.1656, LR: 9.12e-05, LM: 0.0626, Age: 0.69, Sex: 0.001
2025-10-23 18:50:42,684 - INFO - Epoch 2, Step 650/2500 - Loss: 0.0677, Perplexity: 1.1574, LR: 9.10e-05, LM: 0.0607, Age: 0.69, Sex: 0.001
2025-10-23 18:50:48,175 - INFO - Epoch 2, Step 700/2500 - Loss: 0.0667, Perplexity: 1.1520, LR: 9.08e-05, LM: 0.0598, Age: 0.68, Sex: 0.001
2025-10-23 18:50:53,649 - INFO - Epoch 2, Step 750/2500 - Loss: 0.0638, Perplexity: 1.1435, LR: 9.06e-05, LM: 0.0569, Age: 0.68, Sex: 0.001
2025-10-23 18:50:59,278 - INFO - Epoch 2, Step 800/2500 - Loss: 0.0615, Perplexity: 1.1363, LR: 9.04e-05, LM: 0.0546, Age: 0.68, Sex: 0.001
2025-10-23 18:51:04,740 - INFO - Epoch 2, Step 850/2500 - Loss: 0.0607, Perplexity: 1.1342, LR: 9.02e-05, LM: 0.0538, Age: 0.67, Sex: 0.001
2025-10-23 18:51:10,269 - INFO - Epoch 2, Step 900/2500 - Loss: 0.0585, Perplexity: 1.1279, LR: 9.00e-05, LM: 0.0516, Age: 0.67, Sex: 0.001
2025-10-23 18:51:15,803 - INFO - Epoch 2, Step 950/2500 - Loss: 0.0594, Perplexity: 1.1303, LR: 8.98e-05, LM: 0.0527, Age: 0.66, Sex: 0.001
2025-10-23 18:51:21,356 - INFO - Epoch 2, Step 1000/2500 - Loss: 0.0589, Perplexity: 1.1288, LR: 8.96e-05, LM: 0.0522, Age: 0.66, Sex: 0.001
2025-10-23 18:51:27,001 - INFO - Epoch 2, Step 1050/2500 - Loss: 0.0578, Perplexity: 1.1245, LR: 8.94e-05, LM: 0.0511, Age: 0.66, Sex: 0.001
2025-10-23 18:51:32,599 - INFO - Epoch 2, Step 1100/2500 - Loss: 0.0613, Perplexity: 1.1364, LR: 8.92e-05, LM: 0.0546, Age: 0.66, Sex: 0.000
2025-10-23 18:51:38,157 - INFO - Epoch 2, Step 1150/2500 - Loss: 0.0598, Perplexity: 1.1318, LR: 8.90e-05, LM: 0.0531, Age: 0.66, Sex: 0.000
2025-10-23 18:51:43,597 - INFO - Epoch 2, Step 1200/2500 - Loss: 0.0594, Perplexity: 1.1293, LR: 8.88e-05, LM: 0.0527, Age: 0.66, Sex: 0.000
2025-10-23 18:51:49,226 - INFO - Epoch 2, Step 1250/2500 - Loss: 0.0577, Perplexity: 1.1248, LR: 8.85e-05, LM: 0.0510, Age: 0.66, Sex: 0.000
2025-10-23 18:51:54,828 - INFO - Epoch 2, Step 1300/2500 - Loss: 0.0586, Perplexity: 1.1254, LR: 8.83e-05, LM: 0.0519, Age: 0.65, Sex: 0.000
2025-10-23 18:52:00,341 - INFO - Epoch 2, Step 1350/2500 - Loss: 0.0627, Perplexity: 1.1414, LR: 8.81e-05, LM: 0.0560, Age: 0.65, Sex: 0.001
2025-10-23 18:52:05,944 - INFO - Epoch 2, Step 1400/2500 - Loss: 0.0617, Perplexity: 1.1379, LR: 8.79e-05, LM: 0.0551, Age: 0.65, Sex: 0.001
2025-10-23 18:52:11,350 - INFO - Epoch 2, Step 1450/2500 - Loss: 0.0630, Perplexity: 1.1415, LR: 8.77e-05, LM: 0.0564, Age: 0.65, Sex: 0.001
2025-10-23 18:52:16,665 - INFO - Epoch 2, Step 1500/2500 - Loss: 0.0631, Perplexity: 1.1432, LR: 8.75e-05, LM: 0.0565, Age: 0.65, Sex: 0.001
2025-10-23 18:52:22,294 - INFO - Epoch 2, Step 1550/2500 - Loss: 0.0639, Perplexity: 1.1467, LR: 8.73e-05, LM: 0.0573, Age: 0.65, Sex: 0.001
2025-10-23 18:52:27,796 - INFO - Epoch 2, Step 1600/2500 - Loss: 0.0647, Perplexity: 1.1477, LR: 8.71e-05, LM: 0.0581, Age: 0.65, Sex: 0.001
2025-10-23 18:52:33,477 - INFO - Epoch 2, Step 1650/2500 - Loss: 0.0645, Perplexity: 1.1472, LR: 8.69e-05, LM: 0.0578, Age: 0.65, Sex: 0.001
2025-10-23 18:52:39,131 - INFO - Epoch 2, Step 1700/2500 - Loss: 0.0640, Perplexity: 1.1457, LR: 8.67e-05, LM: 0.0574, Age: 0.65, Sex: 0.001
2025-10-23 18:52:44,652 - INFO - Epoch 2, Step 1750/2500 - Loss: 0.0627, Perplexity: 1.1421, LR: 8.65e-05, LM: 0.0561, Age: 0.65, Sex: 0.001
2025-10-23 18:52:49,973 - INFO - Epoch 2, Step 1800/2500 - Loss: 0.0623, Perplexity: 1.1407, LR: 8.63e-05, LM: 0.0557, Age: 0.65, Sex: 0.001
2025-10-23 18:52:55,532 - INFO - Epoch 2, Step 1850/2500 - Loss: 0.0628, Perplexity: 1.1427, LR: 8.60e-05, LM: 0.0562, Age: 0.65, Sex: 0.001
2025-10-23 18:53:00,976 - INFO - Epoch 2, Step 1900/2500 - Loss: 0.0621, Perplexity: 1.1401, LR: 8.58e-05, LM: 0.0554, Age: 0.65, Sex: 0.001
2025-10-23 18:53:06,488 - INFO - Epoch 2, Step 1950/2500 - Loss: 0.0609, Perplexity: 1.1370, LR: 8.56e-05, LM: 0.0544, Age: 0.65, Sex: 0.001
2025-10-23 18:53:12,014 - INFO - Epoch 2, Step 2000/2500 - Loss: 0.0612, Perplexity: 1.1361, LR: 8.54e-05, LM: 0.0546, Age: 0.65, Sex: 0.000
2025-10-23 18:53:17,588 - INFO - Epoch 2, Step 2050/2500 - Loss: 0.0604, Perplexity: 1.1335, LR: 8.52e-05, LM: 0.0538, Age: 0.65, Sex: 0.000
2025-10-23 18:53:23,137 - INFO - Epoch 2, Step 2100/2500 - Loss: 0.0599, Perplexity: 1.1319, LR: 8.50e-05, LM: 0.0533, Age: 0.65, Sex: 0.000
2025-10-23 18:53:28,653 - INFO - Epoch 2, Step 2150/2500 - Loss: 0.0608, Perplexity: 1.1328, LR: 8.48e-05, LM: 0.0541, Age: 0.65, Sex: 0.000
2025-10-23 18:53:34,239 - INFO - Epoch 2, Step 2200/2500 - Loss: 0.0597, Perplexity: 1.1301, LR: 8.46e-05, LM: 0.0531, Age: 0.65, Sex: 0.000
2025-10-23 18:53:39,972 - INFO - Epoch 2, Step 2250/2500 - Loss: 0.0586, Perplexity: 1.1275, LR: 8.44e-05, LM: 0.0520, Age: 0.65, Sex: 0.000
2025-10-23 18:53:45,375 - INFO - Epoch 2, Step 2300/2500 - Loss: 0.0577, Perplexity: 1.1251, LR: 8.42e-05, LM: 0.0511, Age: 0.65, Sex: 0.000
2025-10-23 18:53:50,862 - INFO - Epoch 2, Step 2350/2500 - Loss: 0.0569, Perplexity: 1.1229, LR: 8.40e-05, LM: 0.0503, Age: 0.65, Sex: 0.000
2025-10-23 18:53:56,373 - INFO - Epoch 2, Step 2400/2500 - Loss: 0.0560, Perplexity: 1.1207, LR: 8.38e-05, LM: 0.0494, Age: 0.65, Sex: 0.000
2025-10-23 18:54:01,843 - INFO - Epoch 2, Step 2450/2500 - Loss: 0.0551, Perplexity: 1.1184, LR: 8.35e-05, LM: 0.0485, Age: 0.65, Sex: 0.000
2025-10-23 18:54:07,336 - INFO - Epoch 2, Step 2500/2500 - Loss: 0.0548, Perplexity: 1.1175, LR: 8.33e-05, LM: 0.0483, Age: 0.65, Sex: 0.000
2025-10-23 18:54:07,337 - INFO - Epoch 2 Complete - Avg Loss: 0.0548, Avg Perplexity: 1.1175, LM: 0.0483, Age: 0.65, Sex: 0.000
2025-10-23 18:54:29,623 - INFO - Validation - Loss: 0.0147, Perplexity: 1.0212, Token Accuracy: 0.9979, Code Accuracy: 0.9976
2025-10-23 18:54:29,624 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 18:54:32,017 - INFO - TPL computed on 500 samples: 1.0190
2025-10-23 18:54:32,017 - INFO - Temporal Perplexity (TPL): 1.0190
2025-10-23 18:54:32,017 - INFO - New best model! Validation loss: 0.0147
2025-10-23 18:54:34,514 - INFO - Checkpoint saved: epoch 2
2025-10-23 18:54:40,031 - INFO - Epoch 3, Step 50/2500 - Loss: 0.0601, Perplexity: 1.2195, LR: 8.31e-05, LM: 0.0539, Age: 0.59, Sex: 0.001
2025-10-23 18:54:45,580 - INFO - Epoch 3, Step 100/2500 - Loss: 0.0429, Perplexity: 1.1240, LR: 8.29e-05, LM: 0.0369, Age: 0.59, Sex: 0.001
2025-10-23 18:54:51,112 - INFO - Epoch 3, Step 150/2500 - Loss: 0.0334, Perplexity: 1.0876, LR: 8.27e-05, LM: 0.0276, Age: 0.58, Sex: 0.000
2025-10-23 18:54:56,649 - INFO - Epoch 3, Step 200/2500 - Loss: 0.0472, Perplexity: 1.1159, LR: 8.25e-05, LM: 0.0411, Age: 0.60, Sex: 0.000
2025-10-23 18:55:02,188 - INFO - Epoch 3, Step 250/2500 - Loss: 0.0405, Perplexity: 1.0955, LR: 8.23e-05, LM: 0.0345, Age: 0.60, Sex: 0.000
2025-10-23 18:55:07,709 - INFO - Epoch 3, Step 300/2500 - Loss: 0.0445, Perplexity: 1.1013, LR: 8.21e-05, LM: 0.0385, Age: 0.59, Sex: 0.000
2025-10-23 18:55:13,268 - INFO - Epoch 3, Step 350/2500 - Loss: 0.0418, Perplexity: 1.0910, LR: 8.19e-05, LM: 0.0358, Age: 0.59, Sex: 0.000
2025-10-23 18:55:18,830 - INFO - Epoch 3, Step 400/2500 - Loss: 0.0383, Perplexity: 1.0814, LR: 8.17e-05, LM: 0.0323, Age: 0.59, Sex: 0.000
2025-10-23 18:55:24,311 - INFO - Epoch 3, Step 450/2500 - Loss: 0.0419, Perplexity: 1.0878, LR: 8.15e-05, LM: 0.0358, Age: 0.59, Sex: 0.000
2025-10-23 18:55:29,888 - INFO - Epoch 3, Step 500/2500 - Loss: 0.0392, Perplexity: 1.0806, LR: 8.13e-05, LM: 0.0332, Age: 0.59, Sex: 0.000
2025-10-23 18:55:35,229 - INFO - Epoch 3, Step 550/2500 - Loss: 0.0388, Perplexity: 1.0772, LR: 8.10e-05, LM: 0.0328, Age: 0.60, Sex: 0.000
2025-10-23 18:55:41,014 - INFO - Epoch 3, Step 600/2500 - Loss: 0.0374, Perplexity: 1.0728, LR: 8.08e-05, LM: 0.0313, Age: 0.60, Sex: 0.000
2025-10-23 18:55:46,450 - INFO - Epoch 3, Step 650/2500 - Loss: 0.0355, Perplexity: 1.0682, LR: 8.06e-05, LM: 0.0295, Age: 0.60, Sex: 0.000
2025-10-23 18:55:52,030 - INFO - Epoch 3, Step 700/2500 - Loss: 0.0357, Perplexity: 1.0683, LR: 8.04e-05, LM: 0.0297, Age: 0.60, Sex: 0.000
2025-10-23 18:55:57,430 - INFO - Epoch 3, Step 750/2500 - Loss: 0.0348, Perplexity: 1.0655, LR: 8.02e-05, LM: 0.0288, Age: 0.60, Sex: 0.000
2025-10-23 18:56:03,099 - INFO - Epoch 3, Step 800/2500 - Loss: 0.0335, Perplexity: 1.0623, LR: 8.00e-05, LM: 0.0274, Age: 0.60, Sex: 0.000
2025-10-23 18:56:08,548 - INFO - Epoch 3, Step 850/2500 - Loss: 0.0357, Perplexity: 1.0669, LR: 7.98e-05, LM: 0.0296, Age: 0.60, Sex: 0.000
2025-10-23 18:56:13,961 - INFO - Epoch 3, Step 900/2500 - Loss: 0.0355, Perplexity: 1.0657, LR: 7.96e-05, LM: 0.0295, Age: 0.60, Sex: 0.000
2025-10-23 18:56:19,246 - INFO - Epoch 3, Step 950/2500 - Loss: 0.0352, Perplexity: 1.0643, LR: 7.94e-05, LM: 0.0292, Age: 0.60, Sex: 0.000
2025-10-23 18:56:24,656 - INFO - Epoch 3, Step 1000/2500 - Loss: 0.0351, Perplexity: 1.0639, LR: 7.92e-05, LM: 0.0291, Age: 0.60, Sex: 0.000
2025-10-23 18:56:30,323 - INFO - Epoch 3, Step 1050/2500 - Loss: 0.0351, Perplexity: 1.0639, LR: 7.90e-05, LM: 0.0291, Age: 0.59, Sex: 0.000
2025-10-23 18:56:35,915 - INFO - Epoch 3, Step 1100/2500 - Loss: 0.0358, Perplexity: 1.0664, LR: 7.88e-05, LM: 0.0298, Age: 0.59, Sex: 0.000
2025-10-23 18:56:41,572 - INFO - Epoch 3, Step 1150/2500 - Loss: 0.0371, Perplexity: 1.0681, LR: 7.85e-05, LM: 0.0311, Age: 0.60, Sex: 0.000
2025-10-23 18:56:47,150 - INFO - Epoch 3, Step 1200/2500 - Loss: 0.0386, Perplexity: 1.0737, LR: 7.83e-05, LM: 0.0326, Age: 0.60, Sex: 0.000
2025-10-23 18:56:52,731 - INFO - Epoch 3, Step 1250/2500 - Loss: 0.0374, Perplexity: 1.0711, LR: 7.81e-05, LM: 0.0313, Age: 0.60, Sex: 0.000
2025-10-23 18:56:58,422 - INFO - Epoch 3, Step 1300/2500 - Loss: 0.0371, Perplexity: 1.0698, LR: 7.79e-05, LM: 0.0310, Age: 0.60, Sex: 0.000
2025-10-23 18:57:03,963 - INFO - Epoch 3, Step 1350/2500 - Loss: 0.0368, Perplexity: 1.0686, LR: 7.77e-05, LM: 0.0308, Age: 0.60, Sex: 0.000
2025-10-23 18:57:09,273 - INFO - Epoch 3, Step 1400/2500 - Loss: 0.0363, Perplexity: 1.0670, LR: 7.75e-05, LM: 0.0303, Age: 0.60, Sex: 0.000
2025-10-23 18:57:14,824 - INFO - Epoch 3, Step 1450/2500 - Loss: 0.0355, Perplexity: 1.0652, LR: 7.73e-05, LM: 0.0295, Age: 0.60, Sex: 0.000
2025-10-23 18:57:20,530 - INFO - Epoch 3, Step 1500/2500 - Loss: 0.0365, Perplexity: 1.0668, LR: 7.71e-05, LM: 0.0305, Age: 0.60, Sex: 0.000
2025-10-23 18:57:26,097 - INFO - Epoch 3, Step 1550/2500 - Loss: 0.0361, Perplexity: 1.0655, LR: 7.69e-05, LM: 0.0301, Age: 0.60, Sex: 0.000
2025-10-23 18:57:31,713 - INFO - Epoch 3, Step 1600/2500 - Loss: 0.0355, Perplexity: 1.0639, LR: 7.67e-05, LM: 0.0295, Age: 0.60, Sex: 0.000
2025-10-23 18:57:37,266 - INFO - Epoch 3, Step 1650/2500 - Loss: 0.0347, Perplexity: 1.0623, LR: 7.65e-05, LM: 0.0286, Age: 0.60, Sex: 0.000
2025-10-23 18:57:42,882 - INFO - Epoch 3, Step 1700/2500 - Loss: 0.0354, Perplexity: 1.0641, LR: 7.62e-05, LM: 0.0293, Age: 0.60, Sex: 0.000
2025-10-23 18:57:48,531 - INFO - Epoch 3, Step 1750/2500 - Loss: 0.0376, Perplexity: 1.0688, LR: 7.60e-05, LM: 0.0315, Age: 0.60, Sex: 0.000
2025-10-23 18:57:54,029 - INFO - Epoch 3, Step 1800/2500 - Loss: 0.0372, Perplexity: 1.0676, LR: 7.58e-05, LM: 0.0311, Age: 0.60, Sex: 0.000
2025-10-23 18:57:59,504 - INFO - Epoch 3, Step 1850/2500 - Loss: 0.0369, Perplexity: 1.0668, LR: 7.56e-05, LM: 0.0308, Age: 0.60, Sex: 0.000
2025-10-23 18:58:05,104 - INFO - Epoch 3, Step 1900/2500 - Loss: 0.0363, Perplexity: 1.0654, LR: 7.54e-05, LM: 0.0302, Age: 0.61, Sex: 0.000
2025-10-23 18:58:10,562 - INFO - Epoch 3, Step 1950/2500 - Loss: 0.0356, Perplexity: 1.0640, LR: 7.52e-05, LM: 0.0295, Age: 0.60, Sex: 0.000
2025-10-23 18:58:16,197 - INFO - Epoch 3, Step 2000/2500 - Loss: 0.0351, Perplexity: 1.0627, LR: 7.50e-05, LM: 0.0290, Age: 0.60, Sex: 0.000
2025-10-23 18:58:21,637 - INFO - Epoch 3, Step 2050/2500 - Loss: 0.0344, Perplexity: 1.0614, LR: 7.48e-05, LM: 0.0283, Age: 0.60, Sex: 0.000
2025-10-23 18:58:27,188 - INFO - Epoch 3, Step 2100/2500 - Loss: 0.0340, Perplexity: 1.0604, LR: 7.46e-05, LM: 0.0279, Age: 0.60, Sex: 0.000
2025-10-23 18:58:32,732 - INFO - Epoch 3, Step 2150/2500 - Loss: 0.0337, Perplexity: 1.0596, LR: 7.44e-05, LM: 0.0276, Age: 0.60, Sex: 0.000
2025-10-23 18:58:38,134 - INFO - Epoch 3, Step 2200/2500 - Loss: 0.0340, Perplexity: 1.0610, LR: 7.42e-05, LM: 0.0279, Age: 0.60, Sex: 0.000
2025-10-23 18:58:43,680 - INFO - Epoch 3, Step 2250/2500 - Loss: 0.0334, Perplexity: 1.0598, LR: 7.40e-05, LM: 0.0273, Age: 0.60, Sex: 0.000
2025-10-23 18:58:49,452 - INFO - Epoch 3, Step 2300/2500 - Loss: 0.0335, Perplexity: 1.0595, LR: 7.38e-05, LM: 0.0274, Age: 0.60, Sex: 0.000
2025-10-23 18:58:55,141 - INFO - Epoch 3, Step 2350/2500 - Loss: 0.0342, Perplexity: 1.0619, LR: 7.35e-05, LM: 0.0281, Age: 0.60, Sex: 0.000
2025-10-23 18:59:00,770 - INFO - Epoch 3, Step 2400/2500 - Loss: 0.0353, Perplexity: 1.0654, LR: 7.33e-05, LM: 0.0292, Age: 0.60, Sex: 0.000
2025-10-23 18:59:06,101 - INFO - Epoch 3, Step 2450/2500 - Loss: 0.0348, Perplexity: 1.0643, LR: 7.31e-05, LM: 0.0288, Age: 0.60, Sex: 0.000
2025-10-23 18:59:11,423 - INFO - Epoch 3, Step 2500/2500 - Loss: 0.0352, Perplexity: 1.0648, LR: 7.29e-05, LM: 0.0292, Age: 0.60, Sex: 0.000
2025-10-23 18:59:11,424 - INFO - Epoch 3 Complete - Avg Loss: 0.0352, Avg Perplexity: 1.0648, LM: 0.0292, Age: 0.60, Sex: 0.000
2025-10-23 18:59:33,812 - INFO - Validation - Loss: 0.0100, Perplexity: 1.0128, Token Accuracy: 0.9985, Code Accuracy: 0.9982
2025-10-23 18:59:33,813 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 18:59:36,177 - INFO - TPL computed on 500 samples: 1.0122
2025-10-23 18:59:36,177 - INFO - Temporal Perplexity (TPL): 1.0122
2025-10-23 18:59:36,177 - INFO - New best model! Validation loss: 0.0100
2025-10-23 18:59:38,448 - INFO - Checkpoint saved: epoch 3
2025-10-23 18:59:44,181 - INFO - Epoch 4, Step 50/2500 - Loss: 0.0328, Perplexity: 1.0451, LR: 7.27e-05, LM: 0.0267, Age: 0.60, Sex: 0.000
2025-10-23 18:59:49,670 - INFO - Epoch 4, Step 100/2500 - Loss: 0.0288, Perplexity: 1.0399, LR: 7.25e-05, LM: 0.0230, Age: 0.58, Sex: 0.000
2025-10-23 18:59:55,131 - INFO - Epoch 4, Step 150/2500 - Loss: 0.0236, Perplexity: 1.0311, LR: 7.23e-05, LM: 0.0179, Age: 0.57, Sex: 0.000
2025-10-23 19:00:00,644 - INFO - Epoch 4, Step 200/2500 - Loss: 0.0382, Perplexity: 1.0697, LR: 7.21e-05, LM: 0.0324, Age: 0.58, Sex: 0.000
2025-10-23 19:00:06,273 - INFO - Epoch 4, Step 250/2500 - Loss: 0.0339, Perplexity: 1.0593, LR: 7.19e-05, LM: 0.0281, Age: 0.57, Sex: 0.000
2025-10-23 19:00:11,974 - INFO - Epoch 4, Step 300/2500 - Loss: 0.0300, Perplexity: 1.0513, LR: 7.17e-05, LM: 0.0244, Age: 0.56, Sex: 0.000
2025-10-23 19:00:17,495 - INFO - Epoch 4, Step 350/2500 - Loss: 0.0287, Perplexity: 1.0474, LR: 7.15e-05, LM: 0.0230, Age: 0.56, Sex: 0.000
2025-10-23 19:00:22,971 - INFO - Epoch 4, Step 400/2500 - Loss: 0.0265, Perplexity: 1.0429, LR: 7.13e-05, LM: 0.0209, Age: 0.56, Sex: 0.000
2025-10-23 19:00:28,380 - INFO - Epoch 4, Step 450/2500 - Loss: 0.0249, Perplexity: 1.0396, LR: 7.10e-05, LM: 0.0193, Age: 0.55, Sex: 0.000
2025-10-23 19:00:34,019 - INFO - Epoch 4, Step 500/2500 - Loss: 0.0232, Perplexity: 1.0364, LR: 7.08e-05, LM: 0.0176, Age: 0.55, Sex: 0.000
2025-10-23 19:00:39,514 - INFO - Epoch 4, Step 550/2500 - Loss: 0.0221, Perplexity: 1.0341, LR: 7.06e-05, LM: 0.0165, Age: 0.56, Sex: 0.000
2025-10-23 19:00:45,058 - INFO - Epoch 4, Step 600/2500 - Loss: 0.0215, Perplexity: 1.0326, LR: 7.04e-05, LM: 0.0159, Age: 0.56, Sex: 0.000
2025-10-23 19:00:50,584 - INFO - Epoch 4, Step 650/2500 - Loss: 0.0224, Perplexity: 1.0348, LR: 7.02e-05, LM: 0.0168, Age: 0.56, Sex: 0.000
2025-10-23 19:00:56,049 - INFO - Epoch 4, Step 700/2500 - Loss: 0.0229, Perplexity: 1.0347, LR: 7.00e-05, LM: 0.0172, Age: 0.56, Sex: 0.000
2025-10-23 19:01:01,725 - INFO - Epoch 4, Step 750/2500 - Loss: 0.0220, Perplexity: 1.0330, LR: 6.98e-05, LM: 0.0163, Age: 0.56, Sex: 0.000
2025-10-23 19:01:07,268 - INFO - Epoch 4, Step 800/2500 - Loss: 0.0248, Perplexity: 1.0389, LR: 6.96e-05, LM: 0.0192, Age: 0.56, Sex: 0.000
2025-10-23 19:01:12,680 - INFO - Epoch 4, Step 850/2500 - Loss: 0.0243, Perplexity: 1.0376, LR: 6.94e-05, LM: 0.0187, Age: 0.56, Sex: 0.000
2025-10-23 19:01:18,114 - INFO - Epoch 4, Step 900/2500 - Loss: 0.0243, Perplexity: 1.0373, LR: 6.92e-05, LM: 0.0186, Age: 0.57, Sex: 0.000
2025-10-23 19:01:23,547 - INFO - Epoch 4, Step 950/2500 - Loss: 0.0236, Perplexity: 1.0359, LR: 6.90e-05, LM: 0.0180, Age: 0.57, Sex: 0.000
2025-10-23 19:01:29,148 - INFO - Epoch 4, Step 1000/2500 - Loss: 0.0250, Perplexity: 1.0386, LR: 6.88e-05, LM: 0.0193, Age: 0.56, Sex: 0.000
2025-10-23 19:01:34,613 - INFO - Epoch 4, Step 1050/2500 - Loss: 0.0252, Perplexity: 1.0386, LR: 6.85e-05, LM: 0.0196, Age: 0.56, Sex: 0.000
2025-10-23 19:01:40,235 - INFO - Epoch 4, Step 1100/2500 - Loss: 0.0244, Perplexity: 1.0372, LR: 6.83e-05, LM: 0.0188, Age: 0.56, Sex: 0.000
2025-10-23 19:01:45,710 - INFO - Epoch 4, Step 1150/2500 - Loss: 0.0248, Perplexity: 1.0383, LR: 6.81e-05, LM: 0.0192, Age: 0.55, Sex: 0.000
2025-10-23 19:01:51,293 - INFO - Epoch 4, Step 1200/2500 - Loss: 0.0253, Perplexity: 1.0395, LR: 6.79e-05, LM: 0.0198, Age: 0.55, Sex: 0.000
2025-10-23 19:01:56,782 - INFO - Epoch 4, Step 1250/2500 - Loss: 0.0257, Perplexity: 1.0406, LR: 6.77e-05, LM: 0.0202, Age: 0.55, Sex: 0.000
2025-10-23 19:02:02,217 - INFO - Epoch 4, Step 1300/2500 - Loss: 0.0250, Perplexity: 1.0394, LR: 6.75e-05, LM: 0.0195, Age: 0.55, Sex: 0.000
2025-10-23 19:02:07,656 - INFO - Epoch 4, Step 1350/2500 - Loss: 0.0250, Perplexity: 1.0389, LR: 6.73e-05, LM: 0.0195, Age: 0.55, Sex: 0.000
2025-10-23 19:02:13,038 - INFO - Epoch 4, Step 1400/2500 - Loss: 0.0247, Perplexity: 1.0382, LR: 6.71e-05, LM: 0.0191, Age: 0.55, Sex: 0.000
2025-10-23 19:02:18,609 - INFO - Epoch 4, Step 1450/2500 - Loss: 0.0241, Perplexity: 1.0372, LR: 6.69e-05, LM: 0.0186, Age: 0.55, Sex: 0.000
2025-10-23 19:02:24,028 - INFO - Epoch 4, Step 1500/2500 - Loss: 0.0236, Perplexity: 1.0362, LR: 6.67e-05, LM: 0.0180, Age: 0.55, Sex: 0.000
2025-10-23 19:02:29,595 - INFO - Epoch 4, Step 1550/2500 - Loss: 0.0234, Perplexity: 1.0357, LR: 6.65e-05, LM: 0.0179, Age: 0.55, Sex: 0.000
2025-10-23 19:02:34,987 - INFO - Epoch 4, Step 1600/2500 - Loss: 0.0238, Perplexity: 1.0365, LR: 6.62e-05, LM: 0.0182, Age: 0.55, Sex: 0.000
2025-10-23 19:02:40,493 - INFO - Epoch 4, Step 1650/2500 - Loss: 0.0233, Perplexity: 1.0356, LR: 6.60e-05, LM: 0.0178, Age: 0.55, Sex: 0.000
2025-10-23 19:02:45,858 - INFO - Epoch 4, Step 1700/2500 - Loss: 0.0230, Perplexity: 1.0349, LR: 6.58e-05, LM: 0.0174, Age: 0.55, Sex: 0.000
2025-10-23 19:02:51,300 - INFO - Epoch 4, Step 1750/2500 - Loss: 0.0226, Perplexity: 1.0342, LR: 6.56e-05, LM: 0.0171, Age: 0.55, Sex: 0.000
2025-10-23 19:02:56,759 - INFO - Epoch 4, Step 1800/2500 - Loss: 0.0226, Perplexity: 1.0341, LR: 6.54e-05, LM: 0.0171, Age: 0.55, Sex: 0.000
2025-10-23 19:03:02,384 - INFO - Epoch 4, Step 1850/2500 - Loss: 0.0222, Perplexity: 1.0334, LR: 6.52e-05, LM: 0.0167, Age: 0.55, Sex: 0.000
2025-10-23 19:03:08,023 - INFO - Epoch 4, Step 1900/2500 - Loss: 0.0218, Perplexity: 1.0327, LR: 6.50e-05, LM: 0.0163, Age: 0.55, Sex: 0.000
2025-10-23 19:03:13,520 - INFO - Epoch 4, Step 1950/2500 - Loss: 0.0217, Perplexity: 1.0324, LR: 6.48e-05, LM: 0.0162, Age: 0.55, Sex: 0.000
2025-10-23 19:03:19,165 - INFO - Epoch 4, Step 2000/2500 - Loss: 0.0218, Perplexity: 1.0323, LR: 6.46e-05, LM: 0.0163, Age: 0.55, Sex: 0.000
2025-10-23 19:03:24,727 - INFO - Epoch 4, Step 2050/2500 - Loss: 0.0222, Perplexity: 1.0329, LR: 6.44e-05, LM: 0.0167, Age: 0.55, Sex: 0.000
2025-10-23 19:03:30,169 - INFO - Epoch 4, Step 2100/2500 - Loss: 0.0221, Perplexity: 1.0325, LR: 6.42e-05, LM: 0.0165, Age: 0.55, Sex: 0.000
2025-10-23 19:03:35,716 - INFO - Epoch 4, Step 2150/2500 - Loss: 0.0219, Perplexity: 1.0321, LR: 6.40e-05, LM: 0.0164, Age: 0.55, Sex: 0.000
2025-10-23 19:03:41,087 - INFO - Epoch 4, Step 2200/2500 - Loss: 0.0216, Perplexity: 1.0316, LR: 6.38e-05, LM: 0.0160, Age: 0.55, Sex: 0.000
2025-10-23 19:03:46,693 - INFO - Epoch 4, Step 2250/2500 - Loss: 0.0224, Perplexity: 1.0330, LR: 6.35e-05, LM: 0.0168, Age: 0.55, Sex: 0.000
2025-10-23 19:03:52,096 - INFO - Epoch 4, Step 2300/2500 - Loss: 0.0229, Perplexity: 1.0345, LR: 6.33e-05, LM: 0.0173, Age: 0.55, Sex: 0.000
2025-10-23 19:03:57,530 - INFO - Epoch 4, Step 2350/2500 - Loss: 0.0236, Perplexity: 1.0358, LR: 6.31e-05, LM: 0.0179, Age: 0.55, Sex: 0.000
2025-10-23 19:04:03,162 - INFO - Epoch 4, Step 2400/2500 - Loss: 0.0232, Perplexity: 1.0352, LR: 6.29e-05, LM: 0.0176, Age: 0.55, Sex: 0.000
2025-10-23 19:04:08,811 - INFO - Epoch 4, Step 2450/2500 - Loss: 0.0231, Perplexity: 1.0349, LR: 6.27e-05, LM: 0.0175, Age: 0.56, Sex: 0.000
2025-10-23 19:04:14,420 - INFO - Epoch 4, Step 2500/2500 - Loss: 0.0239, Perplexity: 1.0367, LR: 6.25e-05, LM: 0.0182, Age: 0.56, Sex: 0.000
2025-10-23 19:04:14,421 - INFO - Epoch 4 Complete - Avg Loss: 0.0239, Avg Perplexity: 1.0367, LM: 0.0182, Age: 0.56, Sex: 0.000
2025-10-23 19:04:36,715 - INFO - Validation - Loss: 0.0022, Perplexity: 1.0028, Token Accuracy: 0.9997, Code Accuracy: 0.9996
2025-10-23 19:04:36,717 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:04:39,090 - INFO - TPL computed on 500 samples: 1.0021
2025-10-23 19:04:39,090 - INFO - Temporal Perplexity (TPL): 1.0021
2025-10-23 19:04:39,090 - INFO - New best model! Validation loss: 0.0022
2025-10-23 19:04:41,974 - INFO - Checkpoint saved: epoch 4
2025-10-23 19:04:47,450 - INFO - Epoch 5, Step 50/2500 - Loss: 0.0310, Perplexity: 1.0467, LR: 6.23e-05, LM: 0.0256, Age: 0.53, Sex: 0.000
2025-10-23 19:04:53,126 - INFO - Epoch 5, Step 100/2500 - Loss: 0.0211, Perplexity: 1.0290, LR: 6.21e-05, LM: 0.0159, Age: 0.51, Sex: 0.000
2025-10-23 19:04:58,704 - INFO - Epoch 5, Step 150/2500 - Loss: 0.0167, Perplexity: 1.0220, LR: 6.19e-05, LM: 0.0115, Age: 0.52, Sex: 0.000
2025-10-23 19:05:04,270 - INFO - Epoch 5, Step 200/2500 - Loss: 0.0144, Perplexity: 1.0184, LR: 6.17e-05, LM: 0.0092, Age: 0.53, Sex: 0.000
2025-10-23 19:05:09,853 - INFO - Epoch 5, Step 250/2500 - Loss: 0.0132, Perplexity: 1.0165, LR: 6.15e-05, LM: 0.0080, Age: 0.52, Sex: 0.000
2025-10-23 19:05:15,361 - INFO - Epoch 5, Step 300/2500 - Loss: 0.0125, Perplexity: 1.0152, LR: 6.13e-05, LM: 0.0072, Age: 0.52, Sex: 0.000
2025-10-23 19:05:20,768 - INFO - Epoch 5, Step 350/2500 - Loss: 0.0127, Perplexity: 1.0153, LR: 6.10e-05, LM: 0.0075, Age: 0.52, Sex: 0.000
2025-10-23 19:05:26,420 - INFO - Epoch 5, Step 400/2500 - Loss: 0.0147, Perplexity: 1.0179, LR: 6.08e-05, LM: 0.0096, Age: 0.51, Sex: 0.000
2025-10-23 19:05:31,903 - INFO - Epoch 5, Step 450/2500 - Loss: 0.0174, Perplexity: 1.0231, LR: 6.06e-05, LM: 0.0124, Age: 0.50, Sex: 0.000
2025-10-23 19:05:37,548 - INFO - Epoch 5, Step 500/2500 - Loss: 0.0166, Perplexity: 1.0217, LR: 6.04e-05, LM: 0.0116, Age: 0.50, Sex: 0.000
2025-10-23 19:05:43,119 - INFO - Epoch 5, Step 550/2500 - Loss: 0.0157, Perplexity: 1.0204, LR: 6.02e-05, LM: 0.0106, Age: 0.50, Sex: 0.000
2025-10-23 19:05:48,563 - INFO - Epoch 5, Step 600/2500 - Loss: 0.0149, Perplexity: 1.0192, LR: 6.00e-05, LM: 0.0099, Age: 0.50, Sex: 0.000
2025-10-23 19:05:54,008 - INFO - Epoch 5, Step 650/2500 - Loss: 0.0147, Perplexity: 1.0188, LR: 5.98e-05, LM: 0.0098, Age: 0.50, Sex: 0.000
2025-10-23 19:05:59,701 - INFO - Epoch 5, Step 700/2500 - Loss: 0.0153, Perplexity: 1.0196, LR: 5.96e-05, LM: 0.0102, Age: 0.50, Sex: 0.000
2025-10-23 19:06:05,310 - INFO - Epoch 5, Step 750/2500 - Loss: 0.0162, Perplexity: 1.0214, LR: 5.94e-05, LM: 0.0111, Age: 0.51, Sex: 0.000
2025-10-23 19:06:10,760 - INFO - Epoch 5, Step 800/2500 - Loss: 0.0156, Perplexity: 1.0205, LR: 5.92e-05, LM: 0.0105, Age: 0.51, Sex: 0.000
2025-10-23 19:06:16,284 - INFO - Epoch 5, Step 850/2500 - Loss: 0.0161, Perplexity: 1.0214, LR: 5.90e-05, LM: 0.0111, Age: 0.50, Sex: 0.000
2025-10-23 19:06:21,864 - INFO - Epoch 5, Step 900/2500 - Loss: 0.0164, Perplexity: 1.0218, LR: 5.88e-05, LM: 0.0113, Age: 0.51, Sex: 0.000
2025-10-23 19:06:27,408 - INFO - Epoch 5, Step 950/2500 - Loss: 0.0167, Perplexity: 1.0223, LR: 5.85e-05, LM: 0.0116, Age: 0.50, Sex: 0.000
2025-10-23 19:06:32,959 - INFO - Epoch 5, Step 1000/2500 - Loss: 0.0175, Perplexity: 1.0238, LR: 5.83e-05, LM: 0.0123, Age: 0.51, Sex: 0.000
2025-10-23 19:06:38,440 - INFO - Epoch 5, Step 1050/2500 - Loss: 0.0171, Perplexity: 1.0232, LR: 5.81e-05, LM: 0.0120, Age: 0.51, Sex: 0.000
2025-10-23 19:06:44,008 - INFO - Epoch 5, Step 1100/2500 - Loss: 0.0168, Perplexity: 1.0226, LR: 5.79e-05, LM: 0.0117, Age: 0.51, Sex: 0.000
2025-10-23 19:06:49,493 - INFO - Epoch 5, Step 1150/2500 - Loss: 0.0164, Perplexity: 1.0219, LR: 5.77e-05, LM: 0.0112, Age: 0.51, Sex: 0.000
2025-10-23 19:06:55,043 - INFO - Epoch 5, Step 1200/2500 - Loss: 0.0159, Perplexity: 1.0212, LR: 5.75e-05, LM: 0.0108, Age: 0.51, Sex: 0.000
2025-10-23 19:07:00,523 - INFO - Epoch 5, Step 1250/2500 - Loss: 0.0167, Perplexity: 1.0223, LR: 5.73e-05, LM: 0.0115, Age: 0.51, Sex: 0.000
2025-10-23 19:07:05,933 - INFO - Epoch 5, Step 1300/2500 - Loss: 0.0163, Perplexity: 1.0217, LR: 5.71e-05, LM: 0.0112, Age: 0.51, Sex: 0.000
2025-10-23 19:07:11,405 - INFO - Epoch 5, Step 1350/2500 - Loss: 0.0160, Perplexity: 1.0212, LR: 5.69e-05, LM: 0.0108, Age: 0.51, Sex: 0.000
2025-10-23 19:07:16,884 - INFO - Epoch 5, Step 1400/2500 - Loss: 0.0157, Perplexity: 1.0207, LR: 5.67e-05, LM: 0.0105, Age: 0.51, Sex: 0.000
2025-10-23 19:07:22,380 - INFO - Epoch 5, Step 1450/2500 - Loss: 0.0155, Perplexity: 1.0204, LR: 5.65e-05, LM: 0.0103, Age: 0.51, Sex: 0.000
2025-10-23 19:07:27,799 - INFO - Epoch 5, Step 1500/2500 - Loss: 0.0167, Perplexity: 1.0222, LR: 5.63e-05, LM: 0.0115, Age: 0.51, Sex: 0.000
2025-10-23 19:07:33,382 - INFO - Epoch 5, Step 1550/2500 - Loss: 0.0174, Perplexity: 1.0240, LR: 5.60e-05, LM: 0.0122, Age: 0.51, Sex: 0.001
2025-10-23 19:07:38,661 - INFO - Epoch 5, Step 1600/2500 - Loss: 0.0181, Perplexity: 1.0261, LR: 5.58e-05, LM: 0.0128, Age: 0.51, Sex: 0.001
2025-10-23 19:07:44,221 - INFO - Epoch 5, Step 1650/2500 - Loss: 0.0182, Perplexity: 1.0260, LR: 5.56e-05, LM: 0.0129, Age: 0.52, Sex: 0.001
2025-10-23 19:07:49,569 - INFO - Epoch 5, Step 1700/2500 - Loss: 0.0179, Perplexity: 1.0255, LR: 5.54e-05, LM: 0.0126, Age: 0.52, Sex: 0.001
2025-10-23 19:07:55,071 - INFO - Epoch 5, Step 1750/2500 - Loss: 0.0177, Perplexity: 1.0251, LR: 5.52e-05, LM: 0.0124, Age: 0.52, Sex: 0.001
2025-10-23 19:08:00,536 - INFO - Epoch 5, Step 1800/2500 - Loss: 0.0180, Perplexity: 1.0255, LR: 5.50e-05, LM: 0.0126, Age: 0.52, Sex: 0.001
2025-10-23 19:08:06,039 - INFO - Epoch 5, Step 1850/2500 - Loss: 0.0178, Perplexity: 1.0252, LR: 5.48e-05, LM: 0.0125, Age: 0.52, Sex: 0.001
2025-10-23 19:08:11,646 - INFO - Epoch 5, Step 1900/2500 - Loss: 0.0177, Perplexity: 1.0249, LR: 5.46e-05, LM: 0.0124, Age: 0.52, Sex: 0.001
2025-10-23 19:08:17,132 - INFO - Epoch 5, Step 1950/2500 - Loss: 0.0180, Perplexity: 1.0256, LR: 5.44e-05, LM: 0.0126, Age: 0.52, Sex: 0.001
2025-10-23 19:08:22,606 - INFO - Epoch 5, Step 2000/2500 - Loss: 0.0179, Perplexity: 1.0253, LR: 5.42e-05, LM: 0.0125, Age: 0.52, Sex: 0.001
2025-10-23 19:08:28,016 - INFO - Epoch 5, Step 2050/2500 - Loss: 0.0180, Perplexity: 1.0254, LR: 5.40e-05, LM: 0.0125, Age: 0.52, Sex: 0.001
2025-10-23 19:08:33,409 - INFO - Epoch 5, Step 2100/2500 - Loss: 0.0177, Perplexity: 1.0249, LR: 5.37e-05, LM: 0.0123, Age: 0.52, Sex: 0.001
2025-10-23 19:08:39,118 - INFO - Epoch 5, Step 2150/2500 - Loss: 0.0179, Perplexity: 1.0251, LR: 5.35e-05, LM: 0.0125, Age: 0.52, Sex: 0.001
2025-10-23 19:08:44,399 - INFO - Epoch 5, Step 2200/2500 - Loss: 0.0177, Perplexity: 1.0247, LR: 5.33e-05, LM: 0.0123, Age: 0.52, Sex: 0.001
2025-10-23 19:08:49,865 - INFO - Epoch 5, Step 2250/2500 - Loss: 0.0175, Perplexity: 1.0244, LR: 5.31e-05, LM: 0.0121, Age: 0.52, Sex: 0.001
2025-10-23 19:08:55,345 - INFO - Epoch 5, Step 2300/2500 - Loss: 0.0173, Perplexity: 1.0240, LR: 5.29e-05, LM: 0.0119, Age: 0.52, Sex: 0.001
2025-10-23 19:09:00,885 - INFO - Epoch 5, Step 2350/2500 - Loss: 0.0171, Perplexity: 1.0237, LR: 5.27e-05, LM: 0.0117, Age: 0.52, Sex: 0.001
2025-10-23 19:09:06,208 - INFO - Epoch 5, Step 2400/2500 - Loss: 0.0170, Perplexity: 1.0235, LR: 5.25e-05, LM: 0.0116, Age: 0.52, Sex: 0.001
2025-10-23 19:09:11,843 - INFO - Epoch 5, Step 2450/2500 - Loss: 0.0168, Perplexity: 1.0231, LR: 5.23e-05, LM: 0.0114, Age: 0.52, Sex: 0.001
2025-10-23 19:09:17,276 - INFO - Epoch 5, Step 2500/2500 - Loss: 0.0166, Perplexity: 1.0228, LR: 5.21e-05, LM: 0.0112, Age: 0.52, Sex: 0.001
2025-10-23 19:09:17,277 - INFO - Epoch 5 Complete - Avg Loss: 0.0166, Avg Perplexity: 1.0228, LM: 0.0112, Age: 0.52, Sex: 0.001
2025-10-23 19:09:39,612 - INFO - Validation - Loss: 0.0025, Perplexity: 1.0033, Token Accuracy: 0.9995, Code Accuracy: 0.9994
2025-10-23 19:09:39,614 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:09:41,993 - INFO - TPL computed on 500 samples: 1.0010
2025-10-23 19:09:41,994 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-23 19:09:43,203 - INFO - Checkpoint saved: epoch 5
2025-10-23 19:09:48,649 - INFO - Epoch 6, Step 50/2500 - Loss: 0.0106, Perplexity: 1.0110, LR: 5.19e-05, LM: 0.0062, Age: 0.44, Sex: 0.000
2025-10-23 19:09:54,134 - INFO - Epoch 6, Step 100/2500 - Loss: 0.0097, Perplexity: 1.0100, LR: 5.17e-05, LM: 0.0052, Age: 0.45, Sex: 0.000
2025-10-23 19:09:59,559 - INFO - Epoch 6, Step 150/2500 - Loss: 0.0088, Perplexity: 1.0090, LR: 5.15e-05, LM: 0.0043, Age: 0.44, Sex: 0.000
2025-10-23 19:10:05,051 - INFO - Epoch 6, Step 200/2500 - Loss: 0.0082, Perplexity: 1.0084, LR: 5.12e-05, LM: 0.0037, Age: 0.45, Sex: 0.000
2025-10-23 19:10:10,541 - INFO - Epoch 6, Step 250/2500 - Loss: 0.0092, Perplexity: 1.0097, LR: 5.10e-05, LM: 0.0047, Age: 0.45, Sex: 0.000
2025-10-23 19:10:16,135 - INFO - Epoch 6, Step 300/2500 - Loss: 0.0101, Perplexity: 1.0109, LR: 5.08e-05, LM: 0.0055, Age: 0.46, Sex: 0.000
2025-10-23 19:10:21,617 - INFO - Epoch 6, Step 350/2500 - Loss: 0.0121, Perplexity: 1.0142, LR: 5.06e-05, LM: 0.0075, Age: 0.46, Sex: 0.000
2025-10-23 19:10:27,064 - INFO - Epoch 6, Step 400/2500 - Loss: 0.0135, Perplexity: 1.0171, LR: 5.04e-05, LM: 0.0090, Age: 0.45, Sex: 0.000
2025-10-23 19:10:32,617 - INFO - Epoch 6, Step 450/2500 - Loss: 0.0142, Perplexity: 1.0179, LR: 5.02e-05, LM: 0.0097, Age: 0.45, Sex: 0.000
2025-10-23 19:10:38,103 - INFO - Epoch 6, Step 500/2500 - Loss: 0.0148, Perplexity: 1.0188, LR: 5.00e-05, LM: 0.0102, Age: 0.46, Sex: 0.000
2025-10-23 19:10:43,608 - INFO - Epoch 6, Step 550/2500 - Loss: 0.0142, Perplexity: 1.0178, LR: 4.98e-05, LM: 0.0096, Age: 0.46, Sex: 0.000
2025-10-23 19:10:48,970 - INFO - Epoch 6, Step 600/2500 - Loss: 0.0135, Perplexity: 1.0168, LR: 4.96e-05, LM: 0.0088, Age: 0.46, Sex: 0.000
2025-10-23 19:10:54,483 - INFO - Epoch 6, Step 650/2500 - Loss: 0.0129, Perplexity: 1.0159, LR: 4.94e-05, LM: 0.0082, Age: 0.46, Sex: 0.000
2025-10-23 19:11:00,044 - INFO - Epoch 6, Step 700/2500 - Loss: 0.0125, Perplexity: 1.0153, LR: 4.92e-05, LM: 0.0078, Age: 0.46, Sex: 0.000
2025-10-23 19:11:05,788 - INFO - Epoch 6, Step 750/2500 - Loss: 0.0121, Perplexity: 1.0148, LR: 4.90e-05, LM: 0.0075, Age: 0.47, Sex: 0.000
2025-10-23 19:11:11,174 - INFO - Epoch 6, Step 800/2500 - Loss: 0.0123, Perplexity: 1.0148, LR: 4.87e-05, LM: 0.0075, Age: 0.47, Sex: 0.000
2025-10-23 19:11:16,794 - INFO - Epoch 6, Step 850/2500 - Loss: 0.0119, Perplexity: 1.0143, LR: 4.85e-05, LM: 0.0072, Age: 0.47, Sex: 0.000
2025-10-23 19:11:22,299 - INFO - Epoch 6, Step 900/2500 - Loss: 0.0131, Perplexity: 1.0164, LR: 4.83e-05, LM: 0.0083, Age: 0.47, Sex: 0.000
2025-10-23 19:11:27,767 - INFO - Epoch 6, Step 950/2500 - Loss: 0.0131, Perplexity: 1.0163, LR: 4.81e-05, LM: 0.0083, Age: 0.47, Sex: 0.000
2025-10-23 19:11:33,330 - INFO - Epoch 6, Step 1000/2500 - Loss: 0.0132, Perplexity: 1.0163, LR: 4.79e-05, LM: 0.0084, Age: 0.48, Sex: 0.000
2025-10-23 19:11:38,665 - INFO - Epoch 6, Step 1050/2500 - Loss: 0.0130, Perplexity: 1.0160, LR: 4.77e-05, LM: 0.0082, Age: 0.48, Sex: 0.000
2025-10-23 19:11:44,205 - INFO - Epoch 6, Step 1100/2500 - Loss: 0.0130, Perplexity: 1.0159, LR: 4.75e-05, LM: 0.0082, Age: 0.48, Sex: 0.000
2025-10-23 19:11:49,756 - INFO - Epoch 6, Step 1150/2500 - Loss: 0.0127, Perplexity: 1.0154, LR: 4.73e-05, LM: 0.0079, Age: 0.48, Sex: 0.000
2025-10-23 19:11:55,246 - INFO - Epoch 6, Step 1200/2500 - Loss: 0.0125, Perplexity: 1.0151, LR: 4.71e-05, LM: 0.0076, Age: 0.48, Sex: 0.000
2025-10-23 19:12:00,685 - INFO - Epoch 6, Step 1250/2500 - Loss: 0.0125, Perplexity: 1.0151, LR: 4.69e-05, LM: 0.0077, Age: 0.48, Sex: 0.000
2025-10-23 19:12:06,246 - INFO - Epoch 6, Step 1300/2500 - Loss: 0.0133, Perplexity: 1.0162, LR: 4.67e-05, LM: 0.0084, Age: 0.48, Sex: 0.000
2025-10-23 19:12:11,743 - INFO - Epoch 6, Step 1350/2500 - Loss: 0.0130, Perplexity: 1.0158, LR: 4.65e-05, LM: 0.0081, Age: 0.48, Sex: 0.000
2025-10-23 19:12:17,330 - INFO - Epoch 6, Step 1400/2500 - Loss: 0.0131, Perplexity: 1.0159, LR: 4.63e-05, LM: 0.0082, Age: 0.48, Sex: 0.000
2025-10-23 19:12:22,696 - INFO - Epoch 6, Step 1450/2500 - Loss: 0.0128, Perplexity: 1.0156, LR: 4.60e-05, LM: 0.0079, Age: 0.48, Sex: 0.000
2025-10-23 19:12:28,198 - INFO - Epoch 6, Step 1500/2500 - Loss: 0.0125, Perplexity: 1.0152, LR: 4.58e-05, LM: 0.0077, Age: 0.48, Sex: 0.000
2025-10-23 19:12:33,781 - INFO - Epoch 6, Step 1550/2500 - Loss: 0.0130, Perplexity: 1.0161, LR: 4.56e-05, LM: 0.0081, Age: 0.48, Sex: 0.000
2025-10-23 19:12:39,268 - INFO - Epoch 6, Step 1600/2500 - Loss: 0.0128, Perplexity: 1.0158, LR: 4.54e-05, LM: 0.0079, Age: 0.48, Sex: 0.000
2025-10-23 19:12:44,736 - INFO - Epoch 6, Step 1650/2500 - Loss: 0.0129, Perplexity: 1.0159, LR: 4.52e-05, LM: 0.0081, Age: 0.48, Sex: 0.000
2025-10-23 19:12:50,333 - INFO - Epoch 6, Step 1700/2500 - Loss: 0.0137, Perplexity: 1.0172, LR: 4.50e-05, LM: 0.0088, Age: 0.48, Sex: 0.000
2025-10-23 19:12:55,912 - INFO - Epoch 6, Step 1750/2500 - Loss: 0.0142, Perplexity: 1.0179, LR: 4.48e-05, LM: 0.0093, Age: 0.48, Sex: 0.000
2025-10-23 19:13:01,481 - INFO - Epoch 6, Step 1800/2500 - Loss: 0.0140, Perplexity: 1.0176, LR: 4.46e-05, LM: 0.0091, Age: 0.48, Sex: 0.000
2025-10-23 19:13:06,914 - INFO - Epoch 6, Step 1850/2500 - Loss: 0.0138, Perplexity: 1.0173, LR: 4.44e-05, LM: 0.0089, Age: 0.49, Sex: 0.000
2025-10-23 19:13:12,354 - INFO - Epoch 6, Step 1900/2500 - Loss: 0.0136, Perplexity: 1.0170, LR: 4.42e-05, LM: 0.0087, Age: 0.49, Sex: 0.000
2025-10-23 19:13:17,981 - INFO - Epoch 6, Step 1950/2500 - Loss: 0.0135, Perplexity: 1.0168, LR: 4.40e-05, LM: 0.0086, Age: 0.49, Sex: 0.000
2025-10-23 19:13:23,724 - INFO - Epoch 6, Step 2000/2500 - Loss: 0.0134, Perplexity: 1.0166, LR: 4.37e-05, LM: 0.0085, Age: 0.49, Sex: 0.000
2025-10-23 19:13:29,332 - INFO - Epoch 6, Step 2050/2500 - Loss: 0.0132, Perplexity: 1.0164, LR: 4.35e-05, LM: 0.0083, Age: 0.49, Sex: 0.000
2025-10-23 19:13:34,988 - INFO - Epoch 6, Step 2100/2500 - Loss: 0.0130, Perplexity: 1.0161, LR: 4.33e-05, LM: 0.0081, Age: 0.49, Sex: 0.000
2025-10-23 19:13:40,670 - INFO - Epoch 6, Step 2150/2500 - Loss: 0.0128, Perplexity: 1.0158, LR: 4.31e-05, LM: 0.0079, Age: 0.49, Sex: 0.000
2025-10-23 19:13:46,317 - INFO - Epoch 6, Step 2200/2500 - Loss: 0.0127, Perplexity: 1.0157, LR: 4.29e-05, LM: 0.0078, Age: 0.49, Sex: 0.000
2025-10-23 19:13:51,647 - INFO - Epoch 6, Step 2250/2500 - Loss: 0.0126, Perplexity: 1.0154, LR: 4.27e-05, LM: 0.0077, Age: 0.49, Sex: 0.000
2025-10-23 19:13:57,242 - INFO - Epoch 6, Step 2300/2500 - Loss: 0.0127, Perplexity: 1.0156, LR: 4.25e-05, LM: 0.0078, Age: 0.49, Sex: 0.000
2025-10-23 19:14:02,675 - INFO - Epoch 6, Step 2350/2500 - Loss: 0.0126, Perplexity: 1.0154, LR: 4.23e-05, LM: 0.0077, Age: 0.49, Sex: 0.000
2025-10-23 19:14:08,105 - INFO - Epoch 6, Step 2400/2500 - Loss: 0.0124, Perplexity: 1.0152, LR: 4.21e-05, LM: 0.0075, Age: 0.49, Sex: 0.000
2025-10-23 19:14:13,679 - INFO - Epoch 6, Step 2450/2500 - Loss: 0.0124, Perplexity: 1.0152, LR: 4.19e-05, LM: 0.0076, Age: 0.49, Sex: 0.000
2025-10-23 19:14:19,224 - INFO - Epoch 6, Step 2500/2500 - Loss: 0.0123, Perplexity: 1.0151, LR: 4.17e-05, LM: 0.0074, Age: 0.49, Sex: 0.000
2025-10-23 19:14:19,225 - INFO - Epoch 6 Complete - Avg Loss: 0.0123, Avg Perplexity: 1.0151, LM: 0.0074, Age: 0.49, Sex: 0.000
2025-10-23 19:14:41,397 - INFO - Validation - Loss: 0.0012, Perplexity: 1.0015, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-23 19:14:41,398 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:14:43,748 - INFO - TPL computed on 500 samples: 1.0001
2025-10-23 19:14:43,748 - INFO - Temporal Perplexity (TPL): 1.0001
2025-10-23 19:14:43,748 - INFO - New best model! Validation loss: 0.0012
2025-10-23 19:14:46,239 - INFO - Checkpoint saved: epoch 6
2025-10-23 19:14:51,776 - INFO - Epoch 7, Step 50/2500 - Loss: 0.0114, Perplexity: 1.0128, LR: 4.15e-05, LM: 0.0072, Age: 0.42, Sex: 0.000
2025-10-23 19:14:57,242 - INFO - Epoch 7, Step 100/2500 - Loss: 0.0083, Perplexity: 1.0090, LR: 4.12e-05, LM: 0.0040, Age: 0.42, Sex: 0.000
2025-10-23 19:15:02,656 - INFO - Epoch 7, Step 150/2500 - Loss: 0.0120, Perplexity: 1.0146, LR: 4.10e-05, LM: 0.0076, Age: 0.44, Sex: 0.000
2025-10-23 19:15:08,077 - INFO - Epoch 7, Step 200/2500 - Loss: 0.0103, Perplexity: 1.0122, LR: 4.08e-05, LM: 0.0059, Age: 0.44, Sex: 0.000
2025-10-23 19:15:13,540 - INFO - Epoch 7, Step 250/2500 - Loss: 0.0102, Perplexity: 1.0118, LR: 4.06e-05, LM: 0.0058, Age: 0.43, Sex: 0.000
2025-10-23 19:15:18,943 - INFO - Epoch 7, Step 300/2500 - Loss: 0.0095, Perplexity: 1.0109, LR: 4.04e-05, LM: 0.0052, Age: 0.43, Sex: 0.000
2025-10-23 19:15:24,331 - INFO - Epoch 7, Step 350/2500 - Loss: 0.0089, Perplexity: 1.0101, LR: 4.02e-05, LM: 0.0046, Age: 0.43, Sex: 0.000
2025-10-23 19:15:29,969 - INFO - Epoch 7, Step 400/2500 - Loss: 0.0117, Perplexity: 1.0144, LR: 4.00e-05, LM: 0.0074, Age: 0.43, Sex: 0.000
2025-10-23 19:15:35,589 - INFO - Epoch 7, Step 450/2500 - Loss: 0.0118, Perplexity: 1.0144, LR: 3.98e-05, LM: 0.0075, Age: 0.43, Sex: 0.000
2025-10-23 19:15:41,157 - INFO - Epoch 7, Step 500/2500 - Loss: 0.0116, Perplexity: 1.0140, LR: 3.96e-05, LM: 0.0073, Age: 0.43, Sex: 0.000
2025-10-23 19:15:46,658 - INFO - Epoch 7, Step 550/2500 - Loss: 0.0109, Perplexity: 1.0131, LR: 3.94e-05, LM: 0.0067, Age: 0.43, Sex: 0.000
2025-10-23 19:15:52,216 - INFO - Epoch 7, Step 600/2500 - Loss: 0.0116, Perplexity: 1.0143, LR: 3.92e-05, LM: 0.0073, Age: 0.43, Sex: 0.000
2025-10-23 19:15:57,889 - INFO - Epoch 7, Step 650/2500 - Loss: 0.0117, Perplexity: 1.0142, LR: 3.90e-05, LM: 0.0073, Age: 0.43, Sex: 0.000
2025-10-23 19:16:03,500 - INFO - Epoch 7, Step 700/2500 - Loss: 0.0120, Perplexity: 1.0147, LR: 3.87e-05, LM: 0.0076, Age: 0.43, Sex: 0.000
2025-10-23 19:16:08,997 - INFO - Epoch 7, Step 750/2500 - Loss: 0.0118, Perplexity: 1.0143, LR: 3.85e-05, LM: 0.0075, Age: 0.43, Sex: 0.000
2025-10-23 19:16:14,591 - INFO - Epoch 7, Step 800/2500 - Loss: 0.0114, Perplexity: 1.0137, LR: 3.83e-05, LM: 0.0070, Age: 0.43, Sex: 0.000
2025-10-23 19:16:20,057 - INFO - Epoch 7, Step 850/2500 - Loss: 0.0118, Perplexity: 1.0143, LR: 3.81e-05, LM: 0.0074, Age: 0.43, Sex: 0.000
2025-10-23 19:16:25,665 - INFO - Epoch 7, Step 900/2500 - Loss: 0.0121, Perplexity: 1.0148, LR: 3.79e-05, LM: 0.0077, Age: 0.43, Sex: 0.000
2025-10-23 19:16:31,159 - INFO - Epoch 7, Step 950/2500 - Loss: 0.0131, Perplexity: 1.0162, LR: 3.77e-05, LM: 0.0086, Age: 0.43, Sex: 0.001
2025-10-23 19:16:36,676 - INFO - Epoch 7, Step 1000/2500 - Loss: 0.0129, Perplexity: 1.0159, LR: 3.75e-05, LM: 0.0082, Age: 0.43, Sex: 0.002
2025-10-23 19:16:42,269 - INFO - Epoch 7, Step 1050/2500 - Loss: 0.0126, Perplexity: 1.0154, LR: 3.73e-05, LM: 0.0079, Age: 0.43, Sex: 0.002
2025-10-23 19:16:47,832 - INFO - Epoch 7, Step 1100/2500 - Loss: 0.0131, Perplexity: 1.0163, LR: 3.71e-05, LM: 0.0084, Age: 0.43, Sex: 0.002
2025-10-23 19:16:53,354 - INFO - Epoch 7, Step 1150/2500 - Loss: 0.0128, Perplexity: 1.0159, LR: 3.69e-05, LM: 0.0081, Age: 0.44, Sex: 0.002
2025-10-23 19:16:58,841 - INFO - Epoch 7, Step 1200/2500 - Loss: 0.0125, Perplexity: 1.0155, LR: 3.67e-05, LM: 0.0078, Age: 0.44, Sex: 0.002
2025-10-23 19:17:04,478 - INFO - Epoch 7, Step 1250/2500 - Loss: 0.0122, Perplexity: 1.0150, LR: 3.65e-05, LM: 0.0075, Age: 0.44, Sex: 0.002
2025-10-23 19:17:09,982 - INFO - Epoch 7, Step 1300/2500 - Loss: 0.0120, Perplexity: 1.0147, LR: 3.63e-05, LM: 0.0073, Age: 0.44, Sex: 0.001
2025-10-23 19:17:15,476 - INFO - Epoch 7, Step 1350/2500 - Loss: 0.0117, Perplexity: 1.0143, LR: 3.60e-05, LM: 0.0071, Age: 0.44, Sex: 0.001
2025-10-23 19:17:20,996 - INFO - Epoch 7, Step 1400/2500 - Loss: 0.0115, Perplexity: 1.0141, LR: 3.58e-05, LM: 0.0069, Age: 0.43, Sex: 0.001
2025-10-23 19:17:26,388 - INFO - Epoch 7, Step 1450/2500 - Loss: 0.0113, Perplexity: 1.0137, LR: 3.56e-05, LM: 0.0067, Age: 0.43, Sex: 0.001
2025-10-23 19:17:32,016 - INFO - Epoch 7, Step 1500/2500 - Loss: 0.0110, Perplexity: 1.0134, LR: 3.54e-05, LM: 0.0065, Age: 0.43, Sex: 0.001
2025-10-23 19:17:37,530 - INFO - Epoch 7, Step 1550/2500 - Loss: 0.0109, Perplexity: 1.0132, LR: 3.52e-05, LM: 0.0063, Age: 0.43, Sex: 0.001
2025-10-23 19:17:43,128 - INFO - Epoch 7, Step 1600/2500 - Loss: 0.0107, Perplexity: 1.0129, LR: 3.50e-05, LM: 0.0061, Age: 0.43, Sex: 0.001
2025-10-23 19:17:48,744 - INFO - Epoch 7, Step 1650/2500 - Loss: 0.0106, Perplexity: 1.0127, LR: 3.48e-05, LM: 0.0060, Age: 0.44, Sex: 0.001
2025-10-23 19:17:54,296 - INFO - Epoch 7, Step 1700/2500 - Loss: 0.0104, Perplexity: 1.0125, LR: 3.46e-05, LM: 0.0058, Age: 0.44, Sex: 0.001
2025-10-23 19:17:59,799 - INFO - Epoch 7, Step 1750/2500 - Loss: 0.0103, Perplexity: 1.0123, LR: 3.44e-05, LM: 0.0057, Age: 0.44, Sex: 0.001
2025-10-23 19:18:05,347 - INFO - Epoch 7, Step 1800/2500 - Loss: 0.0104, Perplexity: 1.0125, LR: 3.42e-05, LM: 0.0058, Age: 0.44, Sex: 0.001
2025-10-23 19:18:10,872 - INFO - Epoch 7, Step 1850/2500 - Loss: 0.0103, Perplexity: 1.0123, LR: 3.40e-05, LM: 0.0057, Age: 0.44, Sex: 0.001
2025-10-23 19:18:16,593 - INFO - Epoch 7, Step 1900/2500 - Loss: 0.0104, Perplexity: 1.0125, LR: 3.38e-05, LM: 0.0058, Age: 0.44, Sex: 0.001
2025-10-23 19:18:22,319 - INFO - Epoch 7, Step 1950/2500 - Loss: 0.0103, Perplexity: 1.0123, LR: 3.35e-05, LM: 0.0057, Age: 0.44, Sex: 0.001
2025-10-23 19:18:27,919 - INFO - Epoch 7, Step 2000/2500 - Loss: 0.0103, Perplexity: 1.0122, LR: 3.33e-05, LM: 0.0057, Age: 0.44, Sex: 0.001
2025-10-23 19:18:33,526 - INFO - Epoch 7, Step 2050/2500 - Loss: 0.0101, Perplexity: 1.0121, LR: 3.31e-05, LM: 0.0056, Age: 0.44, Sex: 0.001
2025-10-23 19:18:39,047 - INFO - Epoch 7, Step 2100/2500 - Loss: 0.0100, Perplexity: 1.0119, LR: 3.29e-05, LM: 0.0054, Age: 0.44, Sex: 0.001
2025-10-23 19:18:44,584 - INFO - Epoch 7, Step 2150/2500 - Loss: 0.0104, Perplexity: 1.0124, LR: 3.27e-05, LM: 0.0058, Age: 0.44, Sex: 0.001
2025-10-23 19:18:50,098 - INFO - Epoch 7, Step 2200/2500 - Loss: 0.0105, Perplexity: 1.0126, LR: 3.25e-05, LM: 0.0059, Age: 0.44, Sex: 0.001
2025-10-23 19:18:55,601 - INFO - Epoch 7, Step 2250/2500 - Loss: 0.0104, Perplexity: 1.0124, LR: 3.23e-05, LM: 0.0058, Age: 0.44, Sex: 0.001
2025-10-23 19:19:01,245 - INFO - Epoch 7, Step 2300/2500 - Loss: 0.0103, Perplexity: 1.0123, LR: 3.21e-05, LM: 0.0057, Age: 0.44, Sex: 0.001
2025-10-23 19:19:06,686 - INFO - Epoch 7, Step 2350/2500 - Loss: 0.0102, Perplexity: 1.0121, LR: 3.19e-05, LM: 0.0056, Age: 0.44, Sex: 0.001
2025-10-23 19:19:12,202 - INFO - Epoch 7, Step 2400/2500 - Loss: 0.0101, Perplexity: 1.0120, LR: 3.17e-05, LM: 0.0055, Age: 0.44, Sex: 0.001
2025-10-23 19:19:17,637 - INFO - Epoch 7, Step 2450/2500 - Loss: 0.0100, Perplexity: 1.0119, LR: 3.15e-05, LM: 0.0054, Age: 0.44, Sex: 0.001
2025-10-23 19:19:23,177 - INFO - Epoch 7, Step 2500/2500 - Loss: 0.0099, Perplexity: 1.0118, LR: 3.13e-05, LM: 0.0053, Age: 0.44, Sex: 0.001
2025-10-23 19:19:23,178 - INFO - Epoch 7 Complete - Avg Loss: 0.0099, Avg Perplexity: 1.0118, LM: 0.0053, Age: 0.44, Sex: 0.001
2025-10-23 19:19:45,387 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0010, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-23 19:19:45,388 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:19:47,733 - INFO - TPL computed on 500 samples: 1.0021
2025-10-23 19:19:47,733 - INFO - Temporal Perplexity (TPL): 1.0021
2025-10-23 19:19:47,733 - INFO - New best model! Validation loss: 0.0008
2025-10-23 19:19:50,337 - INFO - Checkpoint saved: epoch 7
2025-10-23 19:19:55,854 - INFO - Epoch 8, Step 50/2500 - Loss: 0.0046, Perplexity: 1.0046, LR: 3.10e-05, LM: 0.0006, Age: 0.40, Sex: 0.000
2025-10-23 19:20:01,502 - INFO - Epoch 8, Step 100/2500 - Loss: 0.0044, Perplexity: 1.0044, LR: 3.08e-05, LM: 0.0005, Age: 0.39, Sex: 0.000
2025-10-23 19:20:06,853 - INFO - Epoch 8, Step 150/2500 - Loss: 0.0121, Perplexity: 1.0149, LR: 3.06e-05, LM: 0.0081, Age: 0.40, Sex: 0.000
2025-10-23 19:20:12,406 - INFO - Epoch 8, Step 200/2500 - Loss: 0.0120, Perplexity: 1.0144, LR: 3.04e-05, LM: 0.0079, Age: 0.40, Sex: 0.000
2025-10-23 19:20:17,848 - INFO - Epoch 8, Step 250/2500 - Loss: 0.0106, Perplexity: 1.0126, LR: 3.02e-05, LM: 0.0065, Age: 0.41, Sex: 0.000
2025-10-23 19:20:23,346 - INFO - Epoch 8, Step 300/2500 - Loss: 0.0097, Perplexity: 1.0114, LR: 3.00e-05, LM: 0.0055, Age: 0.42, Sex: 0.000
2025-10-23 19:20:28,913 - INFO - Epoch 8, Step 350/2500 - Loss: 0.0091, Perplexity: 1.0105, LR: 2.98e-05, LM: 0.0049, Age: 0.42, Sex: 0.000
2025-10-23 19:20:34,509 - INFO - Epoch 8, Step 400/2500 - Loss: 0.0086, Perplexity: 1.0098, LR: 2.96e-05, LM: 0.0044, Age: 0.41, Sex: 0.000
2025-10-23 19:20:40,019 - INFO - Epoch 8, Step 450/2500 - Loss: 0.0081, Perplexity: 1.0092, LR: 2.94e-05, LM: 0.0039, Age: 0.42, Sex: 0.000
2025-10-23 19:20:45,518 - INFO - Epoch 8, Step 500/2500 - Loss: 0.0077, Perplexity: 1.0087, LR: 2.92e-05, LM: 0.0036, Age: 0.41, Sex: 0.000
2025-10-23 19:20:51,186 - INFO - Epoch 8, Step 550/2500 - Loss: 0.0085, Perplexity: 1.0098, LR: 2.90e-05, LM: 0.0044, Age: 0.40, Sex: 0.000
2025-10-23 19:20:56,653 - INFO - Epoch 8, Step 600/2500 - Loss: 0.0082, Perplexity: 1.0094, LR: 2.87e-05, LM: 0.0041, Age: 0.41, Sex: 0.000
2025-10-23 19:21:02,134 - INFO - Epoch 8, Step 650/2500 - Loss: 0.0079, Perplexity: 1.0090, LR: 2.85e-05, LM: 0.0039, Age: 0.40, Sex: 0.000
2025-10-23 19:21:07,663 - INFO - Epoch 8, Step 700/2500 - Loss: 0.0085, Perplexity: 1.0097, LR: 2.83e-05, LM: 0.0045, Age: 0.40, Sex: 0.000
2025-10-23 19:21:13,019 - INFO - Epoch 8, Step 750/2500 - Loss: 0.0084, Perplexity: 1.0096, LR: 2.81e-05, LM: 0.0044, Age: 0.40, Sex: 0.000
2025-10-23 19:21:18,440 - INFO - Epoch 8, Step 800/2500 - Loss: 0.0089, Perplexity: 1.0103, LR: 2.79e-05, LM: 0.0049, Age: 0.40, Sex: 0.000
2025-10-23 19:21:23,893 - INFO - Epoch 8, Step 850/2500 - Loss: 0.0092, Perplexity: 1.0107, LR: 2.77e-05, LM: 0.0052, Age: 0.40, Sex: 0.000
2025-10-23 19:21:29,364 - INFO - Epoch 8, Step 900/2500 - Loss: 0.0090, Perplexity: 1.0104, LR: 2.75e-05, LM: 0.0049, Age: 0.40, Sex: 0.000
2025-10-23 19:21:34,809 - INFO - Epoch 8, Step 950/2500 - Loss: 0.0088, Perplexity: 1.0101, LR: 2.73e-05, LM: 0.0047, Age: 0.40, Sex: 0.000
2025-10-23 19:21:40,408 - INFO - Epoch 8, Step 1000/2500 - Loss: 0.0092, Perplexity: 1.0105, LR: 2.71e-05, LM: 0.0051, Age: 0.41, Sex: 0.000
2025-10-23 19:21:45,822 - INFO - Epoch 8, Step 1050/2500 - Loss: 0.0089, Perplexity: 1.0102, LR: 2.69e-05, LM: 0.0049, Age: 0.41, Sex: 0.000
2025-10-23 19:21:51,198 - INFO - Epoch 8, Step 1100/2500 - Loss: 0.0087, Perplexity: 1.0100, LR: 2.67e-05, LM: 0.0046, Age: 0.41, Sex: 0.000
2025-10-23 19:21:56,794 - INFO - Epoch 8, Step 1150/2500 - Loss: 0.0086, Perplexity: 1.0098, LR: 2.65e-05, LM: 0.0045, Age: 0.41, Sex: 0.000
2025-10-23 19:22:02,373 - INFO - Epoch 8, Step 1200/2500 - Loss: 0.0084, Perplexity: 1.0096, LR: 2.63e-05, LM: 0.0043, Age: 0.41, Sex: 0.000
2025-10-23 19:22:07,888 - INFO - Epoch 8, Step 1250/2500 - Loss: 0.0086, Perplexity: 1.0098, LR: 2.60e-05, LM: 0.0045, Age: 0.41, Sex: 0.000
2025-10-23 19:22:13,477 - INFO - Epoch 8, Step 1300/2500 - Loss: 0.0085, Perplexity: 1.0097, LR: 2.58e-05, LM: 0.0045, Age: 0.40, Sex: 0.000
2025-10-23 19:22:18,995 - INFO - Epoch 8, Step 1350/2500 - Loss: 0.0084, Perplexity: 1.0095, LR: 2.56e-05, LM: 0.0043, Age: 0.40, Sex: 0.000
2025-10-23 19:22:24,474 - INFO - Epoch 8, Step 1400/2500 - Loss: 0.0082, Perplexity: 1.0093, LR: 2.54e-05, LM: 0.0042, Age: 0.40, Sex: 0.000
2025-10-23 19:22:30,159 - INFO - Epoch 8, Step 1450/2500 - Loss: 0.0081, Perplexity: 1.0092, LR: 2.52e-05, LM: 0.0041, Age: 0.41, Sex: 0.000
2025-10-23 19:22:35,676 - INFO - Epoch 8, Step 1500/2500 - Loss: 0.0080, Perplexity: 1.0090, LR: 2.50e-05, LM: 0.0039, Age: 0.41, Sex: 0.000
2025-10-23 19:22:41,297 - INFO - Epoch 8, Step 1550/2500 - Loss: 0.0081, Perplexity: 1.0091, LR: 2.48e-05, LM: 0.0040, Age: 0.41, Sex: 0.000
2025-10-23 19:22:46,943 - INFO - Epoch 8, Step 1600/2500 - Loss: 0.0080, Perplexity: 1.0089, LR: 2.46e-05, LM: 0.0039, Age: 0.41, Sex: 0.000
2025-10-23 19:22:52,406 - INFO - Epoch 8, Step 1650/2500 - Loss: 0.0081, Perplexity: 1.0090, LR: 2.44e-05, LM: 0.0040, Age: 0.41, Sex: 0.000
2025-10-23 19:22:57,754 - INFO - Epoch 8, Step 1700/2500 - Loss: 0.0084, Perplexity: 1.0095, LR: 2.42e-05, LM: 0.0043, Age: 0.41, Sex: 0.001
2025-10-23 19:23:03,338 - INFO - Epoch 8, Step 1750/2500 - Loss: 0.0083, Perplexity: 1.0094, LR: 2.40e-05, LM: 0.0041, Age: 0.41, Sex: 0.001
2025-10-23 19:23:08,941 - INFO - Epoch 8, Step 1800/2500 - Loss: 0.0082, Perplexity: 1.0093, LR: 2.38e-05, LM: 0.0040, Age: 0.41, Sex: 0.001
2025-10-23 19:23:14,612 - INFO - Epoch 8, Step 1850/2500 - Loss: 0.0081, Perplexity: 1.0091, LR: 2.35e-05, LM: 0.0039, Age: 0.41, Sex: 0.001
2025-10-23 19:23:20,201 - INFO - Epoch 8, Step 1900/2500 - Loss: 0.0081, Perplexity: 1.0091, LR: 2.33e-05, LM: 0.0039, Age: 0.41, Sex: 0.001
2025-10-23 19:23:25,728 - INFO - Epoch 8, Step 1950/2500 - Loss: 0.0080, Perplexity: 1.0090, LR: 2.31e-05, LM: 0.0038, Age: 0.41, Sex: 0.001
2025-10-23 19:23:31,651 - INFO - Epoch 8, Step 2000/2500 - Loss: 0.0079, Perplexity: 1.0089, LR: 2.29e-05, LM: 0.0037, Age: 0.41, Sex: 0.001
2025-10-23 19:23:37,355 - INFO - Epoch 8, Step 2050/2500 - Loss: 0.0079, Perplexity: 1.0088, LR: 2.27e-05, LM: 0.0037, Age: 0.41, Sex: 0.001
2025-10-23 19:23:42,758 - INFO - Epoch 8, Step 2100/2500 - Loss: 0.0078, Perplexity: 1.0087, LR: 2.25e-05, LM: 0.0036, Age: 0.40, Sex: 0.001
2025-10-23 19:23:48,261 - INFO - Epoch 8, Step 2150/2500 - Loss: 0.0077, Perplexity: 1.0086, LR: 2.23e-05, LM: 0.0036, Age: 0.40, Sex: 0.001
2025-10-23 19:23:53,651 - INFO - Epoch 8, Step 2200/2500 - Loss: 0.0076, Perplexity: 1.0085, LR: 2.21e-05, LM: 0.0035, Age: 0.40, Sex: 0.001
2025-10-23 19:23:59,290 - INFO - Epoch 8, Step 2250/2500 - Loss: 0.0076, Perplexity: 1.0084, LR: 2.19e-05, LM: 0.0034, Age: 0.40, Sex: 0.001
2025-10-23 19:24:04,800 - INFO - Epoch 8, Step 2300/2500 - Loss: 0.0076, Perplexity: 1.0085, LR: 2.17e-05, LM: 0.0035, Age: 0.40, Sex: 0.001
2025-10-23 19:24:10,437 - INFO - Epoch 8, Step 2350/2500 - Loss: 0.0076, Perplexity: 1.0084, LR: 2.15e-05, LM: 0.0034, Age: 0.40, Sex: 0.001
2025-10-23 19:24:16,108 - INFO - Epoch 8, Step 2400/2500 - Loss: 0.0075, Perplexity: 1.0083, LR: 2.13e-05, LM: 0.0034, Age: 0.40, Sex: 0.001
2025-10-23 19:24:21,521 - INFO - Epoch 8, Step 2450/2500 - Loss: 0.0074, Perplexity: 1.0082, LR: 2.10e-05, LM: 0.0033, Age: 0.40, Sex: 0.001
2025-10-23 19:24:27,066 - INFO - Epoch 8, Step 2500/2500 - Loss: 0.0074, Perplexity: 1.0082, LR: 2.08e-05, LM: 0.0032, Age: 0.41, Sex: 0.001
2025-10-23 19:24:27,067 - INFO - Epoch 8 Complete - Avg Loss: 0.0074, Avg Perplexity: 1.0082, LM: 0.0032, Age: 0.41, Sex: 0.001
2025-10-23 19:24:49,113 - INFO - Validation - Loss: 0.0003, Perplexity: 1.0003, Token Accuracy: 1.0000, Code Accuracy: 0.9999
2025-10-23 19:24:49,114 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:24:51,475 - INFO - TPL computed on 500 samples: 1.0000
2025-10-23 19:24:51,475 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-23 19:24:51,476 - INFO - New best model! Validation loss: 0.0003
2025-10-23 19:24:54,210 - INFO - Checkpoint saved: epoch 8
2025-10-23 19:24:59,667 - INFO - Epoch 9, Step 50/2500 - Loss: 0.0044, Perplexity: 1.0044, LR: 2.06e-05, LM: 0.0002, Age: 0.41, Sex: 0.000
2025-10-23 19:25:05,240 - INFO - Epoch 9, Step 100/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 2.04e-05, LM: 0.0002, Age: 0.39, Sex: 0.000
2025-10-23 19:25:10,721 - INFO - Epoch 9, Step 150/2500 - Loss: 0.0062, Perplexity: 1.0065, LR: 2.02e-05, LM: 0.0024, Age: 0.38, Sex: 0.000
2025-10-23 19:25:16,197 - INFO - Epoch 9, Step 200/2500 - Loss: 0.0107, Perplexity: 1.0127, LR: 2.00e-05, LM: 0.0068, Age: 0.38, Sex: 0.000
2025-10-23 19:25:21,786 - INFO - Epoch 9, Step 250/2500 - Loss: 0.0103, Perplexity: 1.0120, LR: 1.98e-05, LM: 0.0064, Age: 0.37, Sex: 0.000
2025-10-23 19:25:27,069 - INFO - Epoch 9, Step 300/2500 - Loss: 0.0093, Perplexity: 1.0108, LR: 1.96e-05, LM: 0.0054, Age: 0.38, Sex: 0.000
2025-10-23 19:25:32,762 - INFO - Epoch 9, Step 350/2500 - Loss: 0.0084, Perplexity: 1.0097, LR: 1.94e-05, LM: 0.0047, Age: 0.37, Sex: 0.000
2025-10-23 19:25:38,339 - INFO - Epoch 9, Step 400/2500 - Loss: 0.0078, Perplexity: 1.0090, LR: 1.92e-05, LM: 0.0041, Age: 0.37, Sex: 0.000
2025-10-23 19:25:43,915 - INFO - Epoch 9, Step 450/2500 - Loss: 0.0073, Perplexity: 1.0083, LR: 1.90e-05, LM: 0.0037, Age: 0.36, Sex: 0.000
2025-10-23 19:25:49,246 - INFO - Epoch 9, Step 500/2500 - Loss: 0.0069, Perplexity: 1.0078, LR: 1.88e-05, LM: 0.0033, Age: 0.36, Sex: 0.000
2025-10-23 19:25:54,799 - INFO - Epoch 9, Step 550/2500 - Loss: 0.0072, Perplexity: 1.0081, LR: 1.85e-05, LM: 0.0035, Age: 0.36, Sex: 0.000
2025-10-23 19:26:00,266 - INFO - Epoch 9, Step 600/2500 - Loss: 0.0069, Perplexity: 1.0077, LR: 1.83e-05, LM: 0.0032, Age: 0.36, Sex: 0.000
2025-10-23 19:26:05,872 - INFO - Epoch 9, Step 650/2500 - Loss: 0.0073, Perplexity: 1.0082, LR: 1.81e-05, LM: 0.0037, Age: 0.36, Sex: 0.000
2025-10-23 19:26:11,300 - INFO - Epoch 9, Step 700/2500 - Loss: 0.0074, Perplexity: 1.0083, LR: 1.79e-05, LM: 0.0038, Age: 0.36, Sex: 0.000
2025-10-23 19:26:16,791 - INFO - Epoch 9, Step 750/2500 - Loss: 0.0072, Perplexity: 1.0080, LR: 1.77e-05, LM: 0.0035, Age: 0.36, Sex: 0.000
2025-10-23 19:26:22,270 - INFO - Epoch 9, Step 800/2500 - Loss: 0.0070, Perplexity: 1.0077, LR: 1.75e-05, LM: 0.0033, Age: 0.36, Sex: 0.000
2025-10-23 19:26:28,092 - INFO - Epoch 9, Step 850/2500 - Loss: 0.0070, Perplexity: 1.0077, LR: 1.73e-05, LM: 0.0034, Age: 0.36, Sex: 0.000
2025-10-23 19:26:33,807 - INFO - Epoch 9, Step 900/2500 - Loss: 0.0068, Perplexity: 1.0075, LR: 1.71e-05, LM: 0.0032, Age: 0.36, Sex: 0.000
2025-10-23 19:26:39,652 - INFO - Epoch 9, Step 950/2500 - Loss: 0.0067, Perplexity: 1.0073, LR: 1.69e-05, LM: 0.0030, Age: 0.36, Sex: 0.000
2025-10-23 19:26:45,092 - INFO - Epoch 9, Step 1000/2500 - Loss: 0.0065, Perplexity: 1.0071, LR: 1.67e-05, LM: 0.0029, Age: 0.36, Sex: 0.000
2025-10-23 19:26:50,586 - INFO - Epoch 9, Step 1050/2500 - Loss: 0.0065, Perplexity: 1.0071, LR: 1.65e-05, LM: 0.0029, Age: 0.36, Sex: 0.000
2025-10-23 19:26:56,063 - INFO - Epoch 9, Step 1100/2500 - Loss: 0.0064, Perplexity: 1.0070, LR: 1.63e-05, LM: 0.0028, Age: 0.36, Sex: 0.000
2025-10-23 19:27:01,631 - INFO - Epoch 9, Step 1150/2500 - Loss: 0.0063, Perplexity: 1.0069, LR: 1.60e-05, LM: 0.0027, Age: 0.36, Sex: 0.000
2025-10-23 19:27:07,088 - INFO - Epoch 9, Step 1200/2500 - Loss: 0.0062, Perplexity: 1.0068, LR: 1.58e-05, LM: 0.0026, Age: 0.36, Sex: 0.000
2025-10-23 19:27:12,767 - INFO - Epoch 9, Step 1250/2500 - Loss: 0.0064, Perplexity: 1.0070, LR: 1.56e-05, LM: 0.0027, Age: 0.37, Sex: 0.000
2025-10-23 19:27:18,425 - INFO - Epoch 9, Step 1300/2500 - Loss: 0.0063, Perplexity: 1.0068, LR: 1.54e-05, LM: 0.0026, Age: 0.37, Sex: 0.000
2025-10-23 19:27:23,954 - INFO - Epoch 9, Step 1350/2500 - Loss: 0.0063, Perplexity: 1.0067, LR: 1.52e-05, LM: 0.0026, Age: 0.37, Sex: 0.000
2025-10-23 19:27:29,458 - INFO - Epoch 9, Step 1400/2500 - Loss: 0.0062, Perplexity: 1.0066, LR: 1.50e-05, LM: 0.0025, Age: 0.37, Sex: 0.000
2025-10-23 19:27:34,951 - INFO - Epoch 9, Step 1450/2500 - Loss: 0.0061, Perplexity: 1.0065, LR: 1.48e-05, LM: 0.0024, Age: 0.37, Sex: 0.000
2025-10-23 19:27:40,657 - INFO - Epoch 9, Step 1500/2500 - Loss: 0.0062, Perplexity: 1.0066, LR: 1.46e-05, LM: 0.0025, Age: 0.37, Sex: 0.000
2025-10-23 19:27:46,155 - INFO - Epoch 9, Step 1550/2500 - Loss: 0.0061, Perplexity: 1.0065, LR: 1.44e-05, LM: 0.0024, Age: 0.37, Sex: 0.000
2025-10-23 19:27:51,690 - INFO - Epoch 9, Step 1600/2500 - Loss: 0.0060, Perplexity: 1.0065, LR: 1.42e-05, LM: 0.0023, Age: 0.37, Sex: 0.000
2025-10-23 19:27:57,404 - INFO - Epoch 9, Step 1650/2500 - Loss: 0.0060, Perplexity: 1.0064, LR: 1.40e-05, LM: 0.0022, Age: 0.37, Sex: 0.000
2025-10-23 19:28:03,025 - INFO - Epoch 9, Step 1700/2500 - Loss: 0.0059, Perplexity: 1.0063, LR: 1.38e-05, LM: 0.0022, Age: 0.37, Sex: 0.000
2025-10-23 19:28:08,640 - INFO - Epoch 9, Step 1750/2500 - Loss: 0.0058, Perplexity: 1.0062, LR: 1.35e-05, LM: 0.0021, Age: 0.37, Sex: 0.000
2025-10-23 19:28:14,011 - INFO - Epoch 9, Step 1800/2500 - Loss: 0.0058, Perplexity: 1.0062, LR: 1.33e-05, LM: 0.0021, Age: 0.37, Sex: 0.000
2025-10-23 19:28:19,576 - INFO - Epoch 9, Step 1850/2500 - Loss: 0.0057, Perplexity: 1.0061, LR: 1.31e-05, LM: 0.0020, Age: 0.37, Sex: 0.000
2025-10-23 19:28:25,075 - INFO - Epoch 9, Step 1900/2500 - Loss: 0.0057, Perplexity: 1.0060, LR: 1.29e-05, LM: 0.0020, Age: 0.37, Sex: 0.000
2025-10-23 19:28:30,524 - INFO - Epoch 9, Step 1950/2500 - Loss: 0.0056, Perplexity: 1.0060, LR: 1.27e-05, LM: 0.0019, Age: 0.37, Sex: 0.000
2025-10-23 19:28:36,098 - INFO - Epoch 9, Step 2000/2500 - Loss: 0.0056, Perplexity: 1.0059, LR: 1.25e-05, LM: 0.0019, Age: 0.37, Sex: 0.000
2025-10-23 19:28:41,606 - INFO - Epoch 9, Step 2050/2500 - Loss: 0.0055, Perplexity: 1.0059, LR: 1.23e-05, LM: 0.0019, Age: 0.37, Sex: 0.000
2025-10-23 19:28:47,170 - INFO - Epoch 9, Step 2100/2500 - Loss: 0.0055, Perplexity: 1.0059, LR: 1.21e-05, LM: 0.0019, Age: 0.37, Sex: 0.000
2025-10-23 19:28:52,720 - INFO - Epoch 9, Step 2150/2500 - Loss: 0.0055, Perplexity: 1.0058, LR: 1.19e-05, LM: 0.0018, Age: 0.37, Sex: 0.000
2025-10-23 19:28:58,280 - INFO - Epoch 9, Step 2200/2500 - Loss: 0.0055, Perplexity: 1.0058, LR: 1.17e-05, LM: 0.0018, Age: 0.36, Sex: 0.000
2025-10-23 19:29:03,673 - INFO - Epoch 9, Step 2250/2500 - Loss: 0.0054, Perplexity: 1.0057, LR: 1.15e-05, LM: 0.0018, Age: 0.36, Sex: 0.000
2025-10-23 19:29:09,194 - INFO - Epoch 9, Step 2300/2500 - Loss: 0.0054, Perplexity: 1.0058, LR: 1.13e-05, LM: 0.0018, Age: 0.36, Sex: 0.000
2025-10-23 19:29:14,753 - INFO - Epoch 9, Step 2350/2500 - Loss: 0.0054, Perplexity: 1.0057, LR: 1.10e-05, LM: 0.0017, Age: 0.37, Sex: 0.000
2025-10-23 19:29:20,235 - INFO - Epoch 9, Step 2400/2500 - Loss: 0.0054, Perplexity: 1.0057, LR: 1.08e-05, LM: 0.0018, Age: 0.37, Sex: 0.000
2025-10-23 19:29:25,783 - INFO - Epoch 9, Step 2450/2500 - Loss: 0.0054, Perplexity: 1.0057, LR: 1.06e-05, LM: 0.0017, Age: 0.37, Sex: 0.000
2025-10-23 19:29:31,230 - INFO - Epoch 9, Step 2500/2500 - Loss: 0.0054, Perplexity: 1.0057, LR: 1.04e-05, LM: 0.0017, Age: 0.37, Sex: 0.000
2025-10-23 19:29:31,231 - INFO - Epoch 9 Complete - Avg Loss: 0.0054, Avg Perplexity: 1.0057, LM: 0.0017, Age: 0.37, Sex: 0.000
2025-10-23 19:29:53,562 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-23 19:29:53,564 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:29:55,925 - INFO - TPL computed on 500 samples: 1.0010
2025-10-23 19:29:55,925 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-23 19:29:55,925 - INFO - New best model! Validation loss: 0.0001
2025-10-23 19:29:58,527 - INFO - Checkpoint saved: epoch 9
2025-10-23 19:30:04,275 - INFO - Epoch 10, Step 50/2500 - Loss: 0.0034, Perplexity: 1.0035, LR: 1.02e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-23 19:30:09,826 - INFO - Epoch 10, Step 100/2500 - Loss: 0.0031, Perplexity: 1.0031, LR: 1.00e-05, LM: 0.0001, Age: 0.30, Sex: 0.000
2025-10-23 19:30:15,329 - INFO - Epoch 10, Step 150/2500 - Loss: 0.0032, Perplexity: 1.0032, LR: 9.79e-06, LM: 0.0001, Age: 0.31, Sex: 0.000
2025-10-23 19:30:20,785 - INFO - Epoch 10, Step 200/2500 - Loss: 0.0033, Perplexity: 1.0033, LR: 9.58e-06, LM: 0.0002, Age: 0.31, Sex: 0.000
2025-10-23 19:30:26,513 - INFO - Epoch 10, Step 250/2500 - Loss: 0.0033, Perplexity: 1.0033, LR: 9.38e-06, LM: 0.0002, Age: 0.31, Sex: 0.000
2025-10-23 19:30:32,062 - INFO - Epoch 10, Step 300/2500 - Loss: 0.0033, Perplexity: 1.0033, LR: 9.17e-06, LM: 0.0002, Age: 0.32, Sex: 0.000
2025-10-23 19:30:37,639 - INFO - Epoch 10, Step 350/2500 - Loss: 0.0037, Perplexity: 1.0038, LR: 8.96e-06, LM: 0.0005, Age: 0.32, Sex: 0.000
2025-10-23 19:30:43,317 - INFO - Epoch 10, Step 400/2500 - Loss: 0.0040, Perplexity: 1.0041, LR: 8.75e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:30:48,970 - INFO - Epoch 10, Step 450/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 8.54e-06, LM: 0.0006, Age: 0.35, Sex: 0.000
2025-10-23 19:30:54,477 - INFO - Epoch 10, Step 500/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 8.33e-06, LM: 0.0005, Age: 0.35, Sex: 0.000
2025-10-23 19:31:00,080 - INFO - Epoch 10, Step 550/2500 - Loss: 0.0039, Perplexity: 1.0040, LR: 8.13e-06, LM: 0.0005, Age: 0.35, Sex: 0.000
2025-10-23 19:31:05,675 - INFO - Epoch 10, Step 600/2500 - Loss: 0.0039, Perplexity: 1.0039, LR: 7.92e-06, LM: 0.0004, Age: 0.35, Sex: 0.000
2025-10-23 19:31:11,120 - INFO - Epoch 10, Step 650/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 7.71e-06, LM: 0.0005, Age: 0.34, Sex: 0.000
2025-10-23 19:31:16,665 - INFO - Epoch 10, Step 700/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 7.50e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:31:22,201 - INFO - Epoch 10, Step 750/2500 - Loss: 0.0042, Perplexity: 1.0043, LR: 7.29e-06, LM: 0.0008, Age: 0.35, Sex: 0.000
2025-10-23 19:31:27,612 - INFO - Epoch 10, Step 800/2500 - Loss: 0.0043, Perplexity: 1.0044, LR: 7.08e-06, LM: 0.0009, Age: 0.34, Sex: 0.000
2025-10-23 19:31:33,226 - INFO - Epoch 10, Step 850/2500 - Loss: 0.0044, Perplexity: 1.0045, LR: 6.88e-06, LM: 0.0009, Age: 0.35, Sex: 0.000
2025-10-23 19:31:38,638 - INFO - Epoch 10, Step 900/2500 - Loss: 0.0043, Perplexity: 1.0044, LR: 6.67e-06, LM: 0.0009, Age: 0.34, Sex: 0.000
2025-10-23 19:31:44,244 - INFO - Epoch 10, Step 950/2500 - Loss: 0.0043, Perplexity: 1.0043, LR: 6.46e-06, LM: 0.0008, Age: 0.34, Sex: 0.000
2025-10-23 19:31:49,732 - INFO - Epoch 10, Step 1000/2500 - Loss: 0.0042, Perplexity: 1.0043, LR: 6.25e-06, LM: 0.0008, Age: 0.34, Sex: 0.000
2025-10-23 19:31:55,296 - INFO - Epoch 10, Step 1050/2500 - Loss: 0.0042, Perplexity: 1.0042, LR: 6.04e-06, LM: 0.0008, Age: 0.34, Sex: 0.000
2025-10-23 19:32:00,845 - INFO - Epoch 10, Step 1100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 5.83e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:32:06,321 - INFO - Epoch 10, Step 1150/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 5.63e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:32:11,958 - INFO - Epoch 10, Step 1200/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 5.42e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:32:17,776 - INFO - Epoch 10, Step 1250/2500 - Loss: 0.0040, Perplexity: 1.0041, LR: 5.21e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:23,149 - INFO - Epoch 10, Step 1300/2500 - Loss: 0.0040, Perplexity: 1.0041, LR: 5.00e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:28,492 - INFO - Epoch 10, Step 1350/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 4.79e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:34,004 - INFO - Epoch 10, Step 1400/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 4.58e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:39,536 - INFO - Epoch 10, Step 1450/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 4.37e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:45,030 - INFO - Epoch 10, Step 1500/2500 - Loss: 0.0040, Perplexity: 1.0040, LR: 4.17e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:50,636 - INFO - Epoch 10, Step 1550/2500 - Loss: 0.0040, Perplexity: 1.0041, LR: 3.96e-06, LM: 0.0006, Age: 0.34, Sex: 0.000
2025-10-23 19:32:56,174 - INFO - Epoch 10, Step 1600/2500 - Loss: 0.0042, Perplexity: 1.0042, LR: 3.75e-06, LM: 0.0008, Age: 0.34, Sex: 0.000
2025-10-23 19:33:01,683 - INFO - Epoch 10, Step 1650/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 3.54e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:07,223 - INFO - Epoch 10, Step 1700/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 3.33e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:12,610 - INFO - Epoch 10, Step 1750/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 3.13e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:18,065 - INFO - Epoch 10, Step 1800/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 2.92e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:23,531 - INFO - Epoch 10, Step 1850/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 2.71e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:29,307 - INFO - Epoch 10, Step 1900/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 2.50e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:34,855 - INFO - Epoch 10, Step 1950/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 2.29e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:40,253 - INFO - Epoch 10, Step 2000/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 2.08e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:45,805 - INFO - Epoch 10, Step 2050/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 1.88e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:51,274 - INFO - Epoch 10, Step 2100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 1.67e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:33:56,790 - INFO - Epoch 10, Step 2150/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 1.46e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:02,380 - INFO - Epoch 10, Step 2200/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 1.25e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:07,684 - INFO - Epoch 10, Step 2250/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 1.04e-06, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:13,163 - INFO - Epoch 10, Step 2300/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 8.33e-07, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:18,553 - INFO - Epoch 10, Step 2350/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 6.25e-07, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:24,137 - INFO - Epoch 10, Step 2400/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 4.17e-07, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:29,769 - INFO - Epoch 10, Step 2450/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 2.08e-07, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:35,255 - INFO - Epoch 10, Step 2500/2500 - Loss: 0.0041, Perplexity: 1.0041, LR: 0.00e+00, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:35,256 - INFO - Epoch 10 Complete - Avg Loss: 0.0041, Avg Perplexity: 1.0041, LM: 0.0007, Age: 0.34, Sex: 0.000
2025-10-23 19:34:57,329 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-23 19:34:57,331 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-23 19:34:59,703 - INFO - TPL computed on 500 samples: 1.0008
2025-10-23 19:34:59,703 - INFO - Temporal Perplexity (TPL): 1.0008
2025-10-23 19:34:59,704 - INFO - New best model! Validation loss: 0.0000
2025-10-23 19:35:02,416 - INFO - Checkpoint saved: epoch 10
2025-10-23 19:35:02,417 - INFO - 
================================================================================
2025-10-23 19:35:02,417 - INFO - Training Complete!
2025-10-23 19:35:02,417 - INFO - ================================================================================
2025-10-23 19:35:02,417 - INFO - Best validation loss: 0.0000
2025-10-23 19:35:02,417 - INFO - Best validation perplexity: 1.0000
2025-10-24 05:18:19,732 - INFO - ================================================================================
2025-10-24 05:18:19,732 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-24 05:18:19,732 - INFO - ================================================================================
2025-10-24 05:18:19,732 - INFO - 
Configuration:

[Data]
  Patients: 25000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-24 05:18:19,735 - INFO - 
Random seed: 42
2025-10-24 05:18:20,006 - INFO - Device: cuda
2025-10-24 05:18:20,006 - INFO - 
================================================================================
2025-10-24 05:18:20,006 - INFO - Loading MIMIC-III Data
2025-10-24 05:18:20,006 - INFO - ================================================================================
2025-10-24 05:18:20,006 - INFO - Loading MIMIC-III data files
2025-10-24 05:18:20,065 - INFO - Loaded 46520 patients
2025-10-24 05:18:20,215 - INFO - Loaded 58976 admissions
2025-10-24 05:18:20,380 - INFO - Loaded 651047 diagnosis records
2025-10-24 05:18:20,656 - INFO - Processing patient records
2025-10-24 05:18:41,864 - INFO - Loaded 25000 patient records
2025-10-24 05:18:41,865 - INFO - Diagnosis vocabulary size: 5562
2025-10-24 05:18:41,879 - INFO - Average visits per patient: 1.30
2025-10-24 05:18:41,879 - INFO - Average codes per visit: 9.15
2025-10-24 05:18:41,883 - INFO - Gender distribution: {'M': 14038, 'F': 10962}
2025-10-24 05:18:41,902 - INFO - Loaded 25000 patients
2025-10-24 05:18:41,902 - INFO - Vocabulary size: 5562 diagnosis codes
2025-10-24 05:18:41,902 - INFO - Tokenizer vocab size: 5569
2025-10-24 05:18:41,903 - INFO - Dataset size: 25000 patients
2025-10-24 05:18:41,904 - INFO - Train size: 20000, Validation size: 5000
2025-10-24 05:18:41,904 - INFO - Train batches: 2500, Validation batches: 625
2025-10-24 05:18:41,904 - INFO - 
================================================================================
2025-10-24 05:18:41,904 - INFO - Initializing Model
2025-10-24 05:18:41,905 - INFO - ================================================================================
2025-10-24 05:18:42,003 - INFO - BART config vocab size: 5569
2025-10-24 05:18:43,922 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-24 05:18:43,922 - INFO -   Age loss weight: 0.001
2025-10-24 05:18:43,922 - INFO -   Sex loss weight: 0.001
2025-10-24 05:18:44,183 - INFO - Total parameters: 105,688,328
2025-10-24 05:18:44,184 - INFO - Trainable parameters: 105,688,328
2025-10-24 05:18:44,185 - INFO - Total training steps: 75000
2025-10-24 05:18:44,185 - INFO - Warmup steps: 1000
2025-10-24 05:18:44,185 - INFO - 
================================================================================
2025-10-24 05:18:44,185 - INFO - Starting Training
2025-10-24 05:18:44,185 - INFO - ================================================================================
2025-10-24 05:18:57,168 - INFO - Epoch 1, Step 50/2500 - Loss: 7.8553, Perplexity: 2945.5640, LR: 5.00e-06, LM: 7.8528, Age: 1.79, Sex: 0.704
2025-10-24 05:19:09,907 - INFO - Epoch 1, Step 100/2500 - Loss: 7.0835, Perplexity: 1782.2662, LR: 1.00e-05, LM: 7.0810, Age: 1.72, Sex: 0.695
2025-10-24 05:19:22,473 - INFO - Epoch 1, Step 150/2500 - Loss: 6.5866, Perplexity: 1296.0957, LR: 1.50e-05, LM: 6.5843, Age: 1.65, Sex: 0.690
2025-10-24 05:19:35,219 - INFO - Epoch 1, Step 200/2500 - Loss: 6.1915, Perplexity: 1017.4253, LR: 2.00e-05, LM: 6.1892, Age: 1.57, Sex: 0.690
2025-10-24 05:19:48,028 - INFO - Epoch 1, Step 250/2500 - Loss: 5.9026, Perplexity: 841.5655, LR: 2.50e-05, LM: 5.9005, Age: 1.47, Sex: 0.687
2025-10-24 05:20:00,938 - INFO - Epoch 1, Step 300/2500 - Loss: 5.7011, Perplexity: 722.9221, LR: 3.00e-05, LM: 5.6990, Age: 1.39, Sex: 0.686
2025-10-24 05:20:13,653 - INFO - Epoch 1, Step 350/2500 - Loss: 5.5164, Perplexity: 633.2851, LR: 3.50e-05, LM: 5.5144, Age: 1.33, Sex: 0.684
2025-10-24 05:20:26,395 - INFO - Epoch 1, Step 400/2500 - Loss: 5.3437, Perplexity: 563.9436, LR: 4.00e-05, LM: 5.3418, Age: 1.26, Sex: 0.677
2025-10-24 05:20:38,610 - INFO - Epoch 1, Step 450/2500 - Loss: 5.1874, Perplexity: 508.5700, LR: 4.50e-05, LM: 5.1855, Age: 1.20, Sex: 0.676
2025-10-24 05:20:51,571 - INFO - Epoch 1, Step 500/2500 - Loss: 5.0325, Perplexity: 462.7366, LR: 5.00e-05, LM: 5.0307, Age: 1.16, Sex: 0.674
2025-10-24 05:21:04,073 - INFO - Epoch 1, Step 550/2500 - Loss: 4.8421, Perplexity: 423.1352, LR: 5.50e-05, LM: 4.8403, Age: 1.14, Sex: 0.674
2025-10-24 05:21:16,694 - INFO - Epoch 1, Step 600/2500 - Loss: 4.6289, Perplexity: 389.0230, LR: 6.00e-05, LM: 4.6271, Age: 1.12, Sex: 0.674
2025-10-24 05:21:29,266 - INFO - Epoch 1, Step 650/2500 - Loss: 4.3985, Perplexity: 359.7124, LR: 6.50e-05, LM: 4.3968, Age: 1.10, Sex: 0.674
2025-10-24 05:21:41,920 - INFO - Epoch 1, Step 700/2500 - Loss: 4.1783, Perplexity: 334.3918, LR: 7.00e-05, LM: 4.1765, Age: 1.09, Sex: 0.673
2025-10-24 05:21:54,821 - INFO - Epoch 1, Step 750/2500 - Loss: 3.9691, Perplexity: 312.3573, LR: 7.50e-05, LM: 3.9674, Age: 1.08, Sex: 0.670
2025-10-24 05:22:07,500 - INFO - Epoch 1, Step 800/2500 - Loss: 3.7735, Perplexity: 293.0737, LR: 8.00e-05, LM: 3.7717, Age: 1.07, Sex: 0.657
2025-10-24 05:22:20,003 - INFO - Epoch 1, Step 850/2500 - Loss: 3.5963, Perplexity: 276.0595, LR: 8.50e-05, LM: 3.5946, Age: 1.06, Sex: 0.633
2025-10-24 05:22:32,379 - INFO - Epoch 1, Step 900/2500 - Loss: 3.4327, Perplexity: 260.9375, LR: 9.00e-05, LM: 3.4311, Age: 1.05, Sex: 0.606
2025-10-24 05:22:45,280 - INFO - Epoch 1, Step 950/2500 - Loss: 3.2822, Perplexity: 247.3661, LR: 9.50e-05, LM: 3.2806, Age: 1.04, Sex: 0.581
2025-10-24 05:22:58,038 - INFO - Epoch 1, Step 1000/2500 - Loss: 3.1419, Perplexity: 235.0876, LR: 1.00e-04, LM: 3.1403, Age: 1.03, Sex: 0.557
2025-10-24 05:23:10,948 - INFO - Epoch 1, Step 1050/2500 - Loss: 3.0123, Perplexity: 223.9840, LR: 9.99e-05, LM: 3.0108, Age: 1.02, Sex: 0.533
2025-10-24 05:23:23,651 - INFO - Epoch 1, Step 1100/2500 - Loss: 2.8907, Perplexity: 213.8720, LR: 9.99e-05, LM: 2.8892, Age: 1.02, Sex: 0.511
2025-10-24 05:23:36,280 - INFO - Epoch 1, Step 1150/2500 - Loss: 2.7806, Perplexity: 204.6586, LR: 9.98e-05, LM: 2.7791, Age: 1.01, Sex: 0.491
2025-10-24 05:23:48,644 - INFO - Epoch 1, Step 1200/2500 - Loss: 2.6775, Perplexity: 196.2058, LR: 9.97e-05, LM: 2.6760, Age: 1.00, Sex: 0.472
2025-10-24 05:24:01,641 - INFO - Epoch 1, Step 1250/2500 - Loss: 2.5851, Perplexity: 188.4474, LR: 9.97e-05, LM: 2.5837, Age: 0.99, Sex: 0.455
2025-10-24 05:24:14,407 - INFO - Epoch 1, Step 1300/2500 - Loss: 2.4942, Perplexity: 181.2513, LR: 9.96e-05, LM: 2.4928, Age: 0.99, Sex: 0.440
2025-10-24 05:24:26,762 - INFO - Epoch 1, Step 1350/2500 - Loss: 2.4070, Perplexity: 174.5813, LR: 9.95e-05, LM: 2.4056, Age: 0.98, Sex: 0.425
2025-10-24 05:24:39,216 - INFO - Epoch 1, Step 1400/2500 - Loss: 2.3300, Perplexity: 168.4417, LR: 9.95e-05, LM: 2.3287, Age: 0.98, Sex: 0.411
2025-10-24 05:24:51,910 - INFO - Epoch 1, Step 1450/2500 - Loss: 2.2626, Perplexity: 162.7148, LR: 9.94e-05, LM: 2.2613, Age: 0.97, Sex: 0.399
2025-10-24 05:25:04,887 - INFO - Epoch 1, Step 1500/2500 - Loss: 2.1927, Perplexity: 157.3401, LR: 9.93e-05, LM: 2.1914, Age: 0.97, Sex: 0.386
2025-10-24 05:25:17,730 - INFO - Epoch 1, Step 1550/2500 - Loss: 2.1272, Perplexity: 152.3181, LR: 9.93e-05, LM: 2.1259, Age: 0.96, Sex: 0.375
2025-10-24 05:25:30,455 - INFO - Epoch 1, Step 1600/2500 - Loss: 2.0651, Perplexity: 147.5959, LR: 9.92e-05, LM: 2.0638, Age: 0.96, Sex: 0.364
2025-10-24 05:25:43,032 - INFO - Epoch 1, Step 1650/2500 - Loss: 2.0077, Perplexity: 143.1620, LR: 9.91e-05, LM: 2.0063, Age: 0.95, Sex: 0.354
2025-10-24 05:25:55,853 - INFO - Epoch 1, Step 1700/2500 - Loss: 1.9533, Perplexity: 139.0014, LR: 9.91e-05, LM: 1.9520, Age: 0.95, Sex: 0.344
2025-10-24 05:26:08,179 - INFO - Epoch 1, Step 1750/2500 - Loss: 1.9016, Perplexity: 135.0703, LR: 9.90e-05, LM: 1.9003, Age: 0.94, Sex: 0.336
2025-10-24 05:26:20,848 - INFO - Epoch 1, Step 1800/2500 - Loss: 1.8519, Perplexity: 131.3505, LR: 9.89e-05, LM: 1.8506, Age: 0.94, Sex: 0.327
2025-10-24 05:26:33,457 - INFO - Epoch 1, Step 1850/2500 - Loss: 1.8042, Perplexity: 127.8304, LR: 9.89e-05, LM: 1.8029, Age: 0.93, Sex: 0.319
2025-10-24 05:26:46,106 - INFO - Epoch 1, Step 1900/2500 - Loss: 1.7593, Perplexity: 124.4985, LR: 9.88e-05, LM: 1.7581, Age: 0.93, Sex: 0.311
2025-10-24 05:26:58,940 - INFO - Epoch 1, Step 1950/2500 - Loss: 1.7178, Perplexity: 121.3450, LR: 9.87e-05, LM: 1.7165, Age: 0.92, Sex: 0.304
2025-10-24 05:27:11,823 - INFO - Epoch 1, Step 2000/2500 - Loss: 1.6794, Perplexity: 118.3487, LR: 9.86e-05, LM: 1.6781, Age: 0.92, Sex: 0.297
2025-10-24 05:27:24,909 - INFO - Epoch 1, Step 2050/2500 - Loss: 1.6407, Perplexity: 115.4913, LR: 9.86e-05, LM: 1.6395, Age: 0.92, Sex: 0.291
2025-10-24 05:27:37,454 - INFO - Epoch 1, Step 2100/2500 - Loss: 1.6056, Perplexity: 112.7727, LR: 9.85e-05, LM: 1.6044, Age: 0.91, Sex: 0.286
2025-10-24 05:27:50,053 - INFO - Epoch 1, Step 2150/2500 - Loss: 1.5704, Perplexity: 110.1777, LR: 9.84e-05, LM: 1.5692, Age: 0.91, Sex: 0.280
2025-10-24 05:28:02,600 - INFO - Epoch 1, Step 2200/2500 - Loss: 1.5367, Perplexity: 107.7005, LR: 9.84e-05, LM: 1.5355, Age: 0.91, Sex: 0.274
2025-10-24 05:28:15,152 - INFO - Epoch 1, Step 2250/2500 - Loss: 1.5072, Perplexity: 105.3464, LR: 9.83e-05, LM: 1.5060, Age: 0.91, Sex: 0.269
2025-10-24 05:28:27,666 - INFO - Epoch 1, Step 2300/2500 - Loss: 1.4773, Perplexity: 103.0880, LR: 9.82e-05, LM: 1.4761, Age: 0.90, Sex: 0.263
2025-10-24 05:28:40,488 - INFO - Epoch 1, Step 2350/2500 - Loss: 1.4482, Perplexity: 100.9204, LR: 9.82e-05, LM: 1.4470, Age: 0.90, Sex: 0.258
2025-10-24 05:28:53,073 - INFO - Epoch 1, Step 2400/2500 - Loss: 1.4197, Perplexity: 98.8444, LR: 9.81e-05, LM: 1.4185, Age: 0.90, Sex: 0.254
2025-10-24 05:29:05,661 - INFO - Epoch 1, Step 2450/2500 - Loss: 1.3921, Perplexity: 96.8492, LR: 9.80e-05, LM: 1.3910, Age: 0.89, Sex: 0.249
2025-10-24 05:29:18,514 - INFO - Epoch 1, Step 2500/2500 - Loss: 1.3651, Perplexity: 94.9332, LR: 9.80e-05, LM: 1.3639, Age: 0.89, Sex: 0.245
2025-10-24 05:29:18,516 - INFO - Epoch 1 Complete - Avg Loss: 1.3651, Avg Perplexity: 94.9332, LM: 1.3639, Age: 0.89, Sex: 0.245
2025-10-24 05:30:08,377 - INFO - Validation - Loss: 0.0514, Perplexity: 1.1025, Token Accuracy: 0.9925, Code Accuracy: 0.9914
2025-10-24 05:30:08,380 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:30:13,250 - INFO - TPL computed on 500 samples: 1.0887
2025-10-24 05:30:13,251 - INFO - Temporal Perplexity (TPL): 1.0887
2025-10-24 05:30:13,252 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:30:23,140 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0000
2025-10-24 05:30:23,141 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 05:30:23,141 - INFO - New best model! Validation loss: 0.0514
2025-10-24 05:30:27,576 - INFO - Checkpoint saved: epoch 1
2025-10-24 05:30:40,232 - INFO - Epoch 2, Step 50/2500 - Loss: 0.0743, Perplexity: 1.2490, LR: 9.79e-05, LM: 0.0735, Age: 0.72, Sex: 0.020
2025-10-24 05:30:52,508 - INFO - Epoch 2, Step 100/2500 - Loss: 0.0746, Perplexity: 1.2245, LR: 9.78e-05, LM: 0.0738, Age: 0.76, Sex: 0.028
2025-10-24 05:31:05,324 - INFO - Epoch 2, Step 150/2500 - Loss: 0.0657, Perplexity: 1.1683, LR: 9.78e-05, LM: 0.0649, Age: 0.75, Sex: 0.026
2025-10-24 05:31:18,068 - INFO - Epoch 2, Step 200/2500 - Loss: 0.0662, Perplexity: 1.1667, LR: 9.77e-05, LM: 0.0654, Age: 0.76, Sex: 0.024
2025-10-24 05:31:30,420 - INFO - Epoch 2, Step 250/2500 - Loss: 0.0871, Perplexity: 1.2085, LR: 9.76e-05, LM: 0.0863, Age: 0.76, Sex: 0.025
2025-10-24 05:31:42,675 - INFO - Epoch 2, Step 300/2500 - Loss: 0.0782, Perplexity: 1.1805, LR: 9.76e-05, LM: 0.0774, Age: 0.76, Sex: 0.023
2025-10-24 05:31:55,658 - INFO - Epoch 2, Step 350/2500 - Loss: 0.0717, Perplexity: 1.1599, LR: 9.75e-05, LM: 0.0710, Age: 0.75, Sex: 0.022
2025-10-24 05:32:08,782 - INFO - Epoch 2, Step 400/2500 - Loss: 0.0901, Perplexity: 1.2180, LR: 9.74e-05, LM: 0.0893, Age: 0.76, Sex: 0.026
2025-10-24 05:32:21,744 - INFO - Epoch 2, Step 450/2500 - Loss: 0.0825, Perplexity: 1.1964, LR: 9.74e-05, LM: 0.0817, Age: 0.76, Sex: 0.034
2025-10-24 05:32:34,684 - INFO - Epoch 2, Step 500/2500 - Loss: 0.0823, Perplexity: 1.1938, LR: 9.73e-05, LM: 0.0815, Age: 0.76, Sex: 0.033
2025-10-24 05:32:47,025 - INFO - Epoch 2, Step 550/2500 - Loss: 0.0836, Perplexity: 1.1992, LR: 9.72e-05, LM: 0.0828, Age: 0.77, Sex: 0.033
2025-10-24 05:32:59,576 - INFO - Epoch 2, Step 600/2500 - Loss: 0.0789, Perplexity: 1.1851, LR: 9.72e-05, LM: 0.0781, Age: 0.77, Sex: 0.032
2025-10-24 05:33:12,090 - INFO - Epoch 2, Step 650/2500 - Loss: 0.0766, Perplexity: 1.1757, LR: 9.71e-05, LM: 0.0758, Age: 0.76, Sex: 0.032
2025-10-24 05:33:24,770 - INFO - Epoch 2, Step 700/2500 - Loss: 0.0756, Perplexity: 1.1721, LR: 9.70e-05, LM: 0.0748, Age: 0.76, Sex: 0.031
2025-10-24 05:33:37,191 - INFO - Epoch 2, Step 750/2500 - Loss: 0.0723, Perplexity: 1.1626, LR: 9.70e-05, LM: 0.0715, Age: 0.76, Sex: 0.030
2025-10-24 05:33:49,985 - INFO - Epoch 2, Step 800/2500 - Loss: 0.0698, Perplexity: 1.1546, LR: 9.69e-05, LM: 0.0690, Age: 0.76, Sex: 0.029
2025-10-24 05:34:02,348 - INFO - Epoch 2, Step 850/2500 - Loss: 0.0688, Perplexity: 1.1523, LR: 9.68e-05, LM: 0.0680, Age: 0.75, Sex: 0.029
2025-10-24 05:34:15,277 - INFO - Epoch 2, Step 900/2500 - Loss: 0.0660, Perplexity: 1.1449, LR: 9.68e-05, LM: 0.0652, Age: 0.75, Sex: 0.028
2025-10-24 05:34:28,061 - INFO - Epoch 2, Step 950/2500 - Loss: 0.0670, Perplexity: 1.1480, LR: 9.67e-05, LM: 0.0662, Age: 0.75, Sex: 0.028
2025-10-24 05:34:40,535 - INFO - Epoch 2, Step 1000/2500 - Loss: 0.0662, Perplexity: 1.1487, LR: 9.66e-05, LM: 0.0654, Age: 0.75, Sex: 0.027
2025-10-24 05:34:53,410 - INFO - Epoch 2, Step 1050/2500 - Loss: 0.0649, Perplexity: 1.1438, LR: 9.66e-05, LM: 0.0642, Age: 0.75, Sex: 0.027
2025-10-24 05:35:05,806 - INFO - Epoch 2, Step 1100/2500 - Loss: 0.0697, Perplexity: 1.1696, LR: 9.65e-05, LM: 0.0689, Age: 0.74, Sex: 0.026
2025-10-24 05:35:18,348 - INFO - Epoch 2, Step 1150/2500 - Loss: 0.0679, Perplexity: 1.1639, LR: 9.64e-05, LM: 0.0671, Age: 0.74, Sex: 0.026
2025-10-24 05:35:31,062 - INFO - Epoch 2, Step 1200/2500 - Loss: 0.0675, Perplexity: 1.1612, LR: 9.64e-05, LM: 0.0667, Age: 0.74, Sex: 0.025
2025-10-24 05:35:43,570 - INFO - Epoch 2, Step 1250/2500 - Loss: 0.0655, Perplexity: 1.1556, LR: 9.63e-05, LM: 0.0647, Age: 0.74, Sex: 0.025
2025-10-24 05:35:56,146 - INFO - Epoch 2, Step 1300/2500 - Loss: 0.0665, Perplexity: 1.1569, LR: 9.62e-05, LM: 0.0657, Age: 0.74, Sex: 0.025
2025-10-24 05:36:08,885 - INFO - Epoch 2, Step 1350/2500 - Loss: 0.0713, Perplexity: 1.1782, LR: 9.61e-05, LM: 0.0706, Age: 0.74, Sex: 0.025
2025-10-24 05:36:21,726 - INFO - Epoch 2, Step 1400/2500 - Loss: 0.0702, Perplexity: 1.1737, LR: 9.61e-05, LM: 0.0694, Age: 0.74, Sex: 0.025
2025-10-24 05:36:34,311 - INFO - Epoch 2, Step 1450/2500 - Loss: 0.0716, Perplexity: 1.1778, LR: 9.60e-05, LM: 0.0709, Age: 0.74, Sex: 0.024
2025-10-24 05:36:47,333 - INFO - Epoch 2, Step 1500/2500 - Loss: 0.0711, Perplexity: 1.1762, LR: 9.59e-05, LM: 0.0703, Age: 0.74, Sex: 0.025
2025-10-24 05:36:59,595 - INFO - Epoch 2, Step 1550/2500 - Loss: 0.0714, Perplexity: 1.1765, LR: 9.59e-05, LM: 0.0707, Age: 0.74, Sex: 0.025
2025-10-24 05:37:12,481 - INFO - Epoch 2, Step 1600/2500 - Loss: 0.0727, Perplexity: 1.1793, LR: 9.58e-05, LM: 0.0720, Age: 0.74, Sex: 0.025
2025-10-24 05:37:25,427 - INFO - Epoch 2, Step 1650/2500 - Loss: 0.0726, Perplexity: 1.1794, LR: 9.57e-05, LM: 0.0719, Age: 0.74, Sex: 0.025
2025-10-24 05:37:38,185 - INFO - Epoch 2, Step 1700/2500 - Loss: 0.0723, Perplexity: 1.1791, LR: 9.57e-05, LM: 0.0716, Age: 0.74, Sex: 0.025
2025-10-24 05:37:50,873 - INFO - Epoch 2, Step 1750/2500 - Loss: 0.0709, Perplexity: 1.1747, LR: 9.56e-05, LM: 0.0701, Age: 0.74, Sex: 0.025
2025-10-24 05:38:03,500 - INFO - Epoch 2, Step 1800/2500 - Loss: 0.0705, Perplexity: 1.1735, LR: 9.55e-05, LM: 0.0697, Age: 0.74, Sex: 0.025
2025-10-24 05:38:16,136 - INFO - Epoch 2, Step 1850/2500 - Loss: 0.0714, Perplexity: 1.1791, LR: 9.55e-05, LM: 0.0706, Age: 0.74, Sex: 0.025
2025-10-24 05:38:28,478 - INFO - Epoch 2, Step 1900/2500 - Loss: 0.0705, Perplexity: 1.1759, LR: 9.54e-05, LM: 0.0697, Age: 0.74, Sex: 0.025
2025-10-24 05:38:41,591 - INFO - Epoch 2, Step 1950/2500 - Loss: 0.0690, Perplexity: 1.1717, LR: 9.53e-05, LM: 0.0682, Age: 0.73, Sex: 0.025
2025-10-24 05:38:54,324 - INFO - Epoch 2, Step 2000/2500 - Loss: 0.0695, Perplexity: 1.1716, LR: 9.53e-05, LM: 0.0688, Age: 0.73, Sex: 0.025
2025-10-24 05:39:07,018 - INFO - Epoch 2, Step 2050/2500 - Loss: 0.0683, Perplexity: 1.1680, LR: 9.52e-05, LM: 0.0676, Age: 0.73, Sex: 0.025
2025-10-24 05:39:20,027 - INFO - Epoch 2, Step 2100/2500 - Loss: 0.0675, Perplexity: 1.1652, LR: 9.51e-05, LM: 0.0667, Age: 0.73, Sex: 0.024
2025-10-24 05:39:32,779 - INFO - Epoch 2, Step 2150/2500 - Loss: 0.0692, Perplexity: 1.1691, LR: 9.51e-05, LM: 0.0684, Age: 0.74, Sex: 0.025
2025-10-24 05:39:45,436 - INFO - Epoch 2, Step 2200/2500 - Loss: 0.0679, Perplexity: 1.1656, LR: 9.50e-05, LM: 0.0671, Age: 0.74, Sex: 0.025
2025-10-24 05:39:58,552 - INFO - Epoch 2, Step 2250/2500 - Loss: 0.0666, Perplexity: 1.1622, LR: 9.49e-05, LM: 0.0659, Age: 0.74, Sex: 0.025
2025-10-24 05:40:11,187 - INFO - Epoch 2, Step 2300/2500 - Loss: 0.0656, Perplexity: 1.1590, LR: 9.49e-05, LM: 0.0648, Age: 0.74, Sex: 0.025
2025-10-24 05:40:24,086 - INFO - Epoch 2, Step 2350/2500 - Loss: 0.0649, Perplexity: 1.1564, LR: 9.48e-05, LM: 0.0641, Age: 0.73, Sex: 0.025
2025-10-24 05:40:36,444 - INFO - Epoch 2, Step 2400/2500 - Loss: 0.0638, Perplexity: 1.1535, LR: 9.47e-05, LM: 0.0630, Age: 0.73, Sex: 0.024
2025-10-24 05:40:48,724 - INFO - Epoch 2, Step 2450/2500 - Loss: 0.0627, Perplexity: 1.1506, LR: 9.47e-05, LM: 0.0620, Age: 0.73, Sex: 0.024
2025-10-24 05:41:01,693 - INFO - Epoch 2, Step 2500/2500 - Loss: 0.0627, Perplexity: 1.1503, LR: 9.46e-05, LM: 0.0619, Age: 0.73, Sex: 0.024
2025-10-24 05:41:01,695 - INFO - Epoch 2 Complete - Avg Loss: 0.0627, Avg Perplexity: 1.1503, LM: 0.0619, Age: 0.73, Sex: 0.024
2025-10-24 05:41:51,730 - INFO - Validation - Loss: 0.0212, Perplexity: 1.0355, Token Accuracy: 0.9968, Code Accuracy: 0.9962
2025-10-24 05:41:51,733 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:41:56,653 - INFO - TPL computed on 500 samples: 1.0408
2025-10-24 05:41:56,653 - INFO - Temporal Perplexity (TPL): 1.0408
2025-10-24 05:41:56,654 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:42:09,500 - INFO - Reconstruction Jaccard computed on 137 visits: 0.0000
2025-10-24 05:42:09,501 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 05:42:09,501 - INFO - New best model! Validation loss: 0.0212
2025-10-24 05:42:13,919 - INFO - Checkpoint saved: epoch 2
2025-10-24 05:42:26,772 - INFO - Epoch 3, Step 50/2500 - Loss: 0.0523, Perplexity: 1.1726, LR: 9.45e-05, LM: 0.0516, Age: 0.67, Sex: 0.051
2025-10-24 05:42:39,279 - INFO - Epoch 3, Step 100/2500 - Loss: 0.0449, Perplexity: 1.1145, LR: 9.45e-05, LM: 0.0441, Age: 0.67, Sex: 0.038
2025-10-24 05:42:52,130 - INFO - Epoch 3, Step 150/2500 - Loss: 0.0322, Perplexity: 1.0786, LR: 9.44e-05, LM: 0.0315, Age: 0.67, Sex: 0.025
2025-10-24 05:43:04,676 - INFO - Epoch 3, Step 200/2500 - Loss: 0.0493, Perplexity: 1.1295, LR: 9.43e-05, LM: 0.0486, Age: 0.69, Sex: 0.023
2025-10-24 05:43:17,289 - INFO - Epoch 3, Step 250/2500 - Loss: 0.0415, Perplexity: 1.1057, LR: 9.43e-05, LM: 0.0407, Age: 0.69, Sex: 0.019
2025-10-24 05:43:29,700 - INFO - Epoch 3, Step 300/2500 - Loss: 0.0488, Perplexity: 1.1229, LR: 9.42e-05, LM: 0.0481, Age: 0.69, Sex: 0.021
2025-10-24 05:43:42,441 - INFO - Epoch 3, Step 350/2500 - Loss: 0.0457, Perplexity: 1.1101, LR: 9.41e-05, LM: 0.0450, Age: 0.69, Sex: 0.020
2025-10-24 05:43:54,912 - INFO - Epoch 3, Step 400/2500 - Loss: 0.0416, Perplexity: 1.0979, LR: 9.41e-05, LM: 0.0409, Age: 0.69, Sex: 0.018
2025-10-24 05:44:07,525 - INFO - Epoch 3, Step 450/2500 - Loss: 0.0473, Perplexity: 1.1159, LR: 9.40e-05, LM: 0.0466, Age: 0.70, Sex: 0.019
2025-10-24 05:44:20,268 - INFO - Epoch 3, Step 500/2500 - Loss: 0.0442, Perplexity: 1.1059, LR: 9.39e-05, LM: 0.0435, Age: 0.70, Sex: 0.019
2025-10-24 05:44:32,706 - INFO - Epoch 3, Step 550/2500 - Loss: 0.0428, Perplexity: 1.0998, LR: 9.39e-05, LM: 0.0421, Age: 0.70, Sex: 0.019
2025-10-24 05:44:45,335 - INFO - Epoch 3, Step 600/2500 - Loss: 0.0411, Perplexity: 1.0936, LR: 9.38e-05, LM: 0.0404, Age: 0.71, Sex: 0.019
2025-10-24 05:44:57,997 - INFO - Epoch 3, Step 650/2500 - Loss: 0.0385, Perplexity: 1.0870, LR: 9.37e-05, LM: 0.0378, Age: 0.71, Sex: 0.018
2025-10-24 05:45:10,938 - INFO - Epoch 3, Step 700/2500 - Loss: 0.0388, Perplexity: 1.0859, LR: 9.36e-05, LM: 0.0381, Age: 0.71, Sex: 0.019
2025-10-24 05:45:23,256 - INFO - Epoch 3, Step 750/2500 - Loss: 0.0378, Perplexity: 1.0821, LR: 9.36e-05, LM: 0.0371, Age: 0.71, Sex: 0.019
2025-10-24 05:45:35,623 - INFO - Epoch 3, Step 800/2500 - Loss: 0.0360, Perplexity: 1.0774, LR: 9.35e-05, LM: 0.0352, Age: 0.71, Sex: 0.019
2025-10-24 05:45:48,497 - INFO - Epoch 3, Step 850/2500 - Loss: 0.0381, Perplexity: 1.0816, LR: 9.34e-05, LM: 0.0373, Age: 0.71, Sex: 0.018
2025-10-24 05:46:01,351 - INFO - Epoch 3, Step 900/2500 - Loss: 0.0376, Perplexity: 1.0792, LR: 9.34e-05, LM: 0.0368, Age: 0.70, Sex: 0.019
2025-10-24 05:46:13,916 - INFO - Epoch 3, Step 950/2500 - Loss: 0.0380, Perplexity: 1.0813, LR: 9.33e-05, LM: 0.0373, Age: 0.70, Sex: 0.018
2025-10-24 05:46:26,345 - INFO - Epoch 3, Step 1000/2500 - Loss: 0.0392, Perplexity: 1.0867, LR: 9.32e-05, LM: 0.0385, Age: 0.70, Sex: 0.018
2025-10-24 05:46:38,879 - INFO - Epoch 3, Step 1050/2500 - Loss: 0.0389, Perplexity: 1.0856, LR: 9.32e-05, LM: 0.0381, Age: 0.70, Sex: 0.018
2025-10-24 05:46:51,466 - INFO - Epoch 3, Step 1100/2500 - Loss: 0.0390, Perplexity: 1.0855, LR: 9.31e-05, LM: 0.0382, Age: 0.70, Sex: 0.018
2025-10-24 05:47:04,469 - INFO - Epoch 3, Step 1150/2500 - Loss: 0.0405, Perplexity: 1.0881, LR: 9.30e-05, LM: 0.0398, Age: 0.70, Sex: 0.018
2025-10-24 05:47:17,056 - INFO - Epoch 3, Step 1200/2500 - Loss: 0.0412, Perplexity: 1.0896, LR: 9.30e-05, LM: 0.0405, Age: 0.70, Sex: 0.017
2025-10-24 05:47:29,978 - INFO - Epoch 3, Step 1250/2500 - Loss: 0.0399, Perplexity: 1.0864, LR: 9.29e-05, LM: 0.0392, Age: 0.70, Sex: 0.017
2025-10-24 05:47:42,574 - INFO - Epoch 3, Step 1300/2500 - Loss: 0.0393, Perplexity: 1.0843, LR: 9.28e-05, LM: 0.0386, Age: 0.70, Sex: 0.018
2025-10-24 05:47:55,312 - INFO - Epoch 3, Step 1350/2500 - Loss: 0.0394, Perplexity: 1.0852, LR: 9.28e-05, LM: 0.0387, Age: 0.70, Sex: 0.018
2025-10-24 05:48:07,910 - INFO - Epoch 3, Step 1400/2500 - Loss: 0.0386, Perplexity: 1.0828, LR: 9.27e-05, LM: 0.0379, Age: 0.70, Sex: 0.018
2025-10-24 05:48:20,455 - INFO - Epoch 3, Step 1450/2500 - Loss: 0.0376, Perplexity: 1.0803, LR: 9.26e-05, LM: 0.0368, Age: 0.70, Sex: 0.017
2025-10-24 05:48:33,219 - INFO - Epoch 3, Step 1500/2500 - Loss: 0.0386, Perplexity: 1.0838, LR: 9.26e-05, LM: 0.0379, Age: 0.70, Sex: 0.018
2025-10-24 05:48:46,156 - INFO - Epoch 3, Step 1550/2500 - Loss: 0.0377, Perplexity: 1.0814, LR: 9.25e-05, LM: 0.0370, Age: 0.70, Sex: 0.017
2025-10-24 05:48:59,116 - INFO - Epoch 3, Step 1600/2500 - Loss: 0.0367, Perplexity: 1.0791, LR: 9.24e-05, LM: 0.0360, Age: 0.70, Sex: 0.017
2025-10-24 05:49:11,744 - INFO - Epoch 3, Step 1650/2500 - Loss: 0.0359, Perplexity: 1.0770, LR: 9.24e-05, LM: 0.0352, Age: 0.70, Sex: 0.017
2025-10-24 05:49:24,293 - INFO - Epoch 3, Step 1700/2500 - Loss: 0.0369, Perplexity: 1.0795, LR: 9.23e-05, LM: 0.0362, Age: 0.70, Sex: 0.017
2025-10-24 05:49:36,806 - INFO - Epoch 3, Step 1750/2500 - Loss: 0.0387, Perplexity: 1.0823, LR: 9.22e-05, LM: 0.0379, Age: 0.71, Sex: 0.018
2025-10-24 05:49:49,458 - INFO - Epoch 3, Step 1800/2500 - Loss: 0.0378, Perplexity: 1.0803, LR: 9.22e-05, LM: 0.0371, Age: 0.71, Sex: 0.018
2025-10-24 05:50:02,058 - INFO - Epoch 3, Step 1850/2500 - Loss: 0.0373, Perplexity: 1.0787, LR: 9.21e-05, LM: 0.0365, Age: 0.71, Sex: 0.018
2025-10-24 05:50:14,764 - INFO - Epoch 3, Step 1900/2500 - Loss: 0.0366, Perplexity: 1.0770, LR: 9.20e-05, LM: 0.0359, Age: 0.71, Sex: 0.017
2025-10-24 05:50:27,347 - INFO - Epoch 3, Step 1950/2500 - Loss: 0.0360, Perplexity: 1.0753, LR: 9.20e-05, LM: 0.0352, Age: 0.71, Sex: 0.017
2025-10-24 05:50:40,663 - INFO - Epoch 3, Step 2000/2500 - Loss: 0.0354, Perplexity: 1.0738, LR: 9.19e-05, LM: 0.0347, Age: 0.71, Sex: 0.017
2025-10-24 05:50:53,343 - INFO - Epoch 3, Step 2050/2500 - Loss: 0.0348, Perplexity: 1.0723, LR: 9.18e-05, LM: 0.0341, Age: 0.71, Sex: 0.017
2025-10-24 05:51:06,042 - INFO - Epoch 3, Step 2100/2500 - Loss: 0.0343, Perplexity: 1.0710, LR: 9.18e-05, LM: 0.0336, Age: 0.71, Sex: 0.017
2025-10-24 05:51:19,010 - INFO - Epoch 3, Step 2150/2500 - Loss: 0.0340, Perplexity: 1.0699, LR: 9.17e-05, LM: 0.0333, Age: 0.71, Sex: 0.017
2025-10-24 05:51:31,601 - INFO - Epoch 3, Step 2200/2500 - Loss: 0.0342, Perplexity: 1.0716, LR: 9.16e-05, LM: 0.0335, Age: 0.70, Sex: 0.017
2025-10-24 05:51:44,125 - INFO - Epoch 3, Step 2250/2500 - Loss: 0.0336, Perplexity: 1.0701, LR: 9.16e-05, LM: 0.0329, Age: 0.70, Sex: 0.017
2025-10-24 05:51:57,063 - INFO - Epoch 3, Step 2300/2500 - Loss: 0.0337, Perplexity: 1.0698, LR: 9.15e-05, LM: 0.0329, Age: 0.70, Sex: 0.017
2025-10-24 05:52:09,860 - INFO - Epoch 3, Step 2350/2500 - Loss: 0.0346, Perplexity: 1.0736, LR: 9.14e-05, LM: 0.0339, Age: 0.70, Sex: 0.017
2025-10-24 05:52:22,897 - INFO - Epoch 3, Step 2400/2500 - Loss: 0.0355, Perplexity: 1.0759, LR: 9.14e-05, LM: 0.0348, Age: 0.70, Sex: 0.017
2025-10-24 05:52:35,533 - INFO - Epoch 3, Step 2450/2500 - Loss: 0.0349, Perplexity: 1.0745, LR: 9.13e-05, LM: 0.0341, Age: 0.70, Sex: 0.017
2025-10-24 05:52:48,329 - INFO - Epoch 3, Step 2500/2500 - Loss: 0.0352, Perplexity: 1.0749, LR: 9.12e-05, LM: 0.0345, Age: 0.70, Sex: 0.017
2025-10-24 05:52:48,331 - INFO - Epoch 3 Complete - Avg Loss: 0.0352, Avg Perplexity: 1.0749, LM: 0.0345, Age: 0.70, Sex: 0.017
2025-10-24 05:53:38,252 - INFO - Validation - Loss: 0.0148, Perplexity: 1.0213, Token Accuracy: 0.9978, Code Accuracy: 0.9974
2025-10-24 05:53:38,254 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:53:43,191 - INFO - TPL computed on 500 samples: 1.0279
2025-10-24 05:53:43,191 - INFO - Temporal Perplexity (TPL): 1.0279
2025-10-24 05:53:43,192 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:53:54,037 - INFO - Reconstruction Jaccard computed on 123 visits: 0.0020
2025-10-24 05:53:54,037 - INFO - Reconstruction Jaccard: 0.0020
2025-10-24 05:53:54,038 - INFO - New best model! Validation loss: 0.0148
2025-10-24 05:53:58,505 - INFO - Checkpoint saved: epoch 3
2025-10-24 05:54:11,163 - INFO - Epoch 4, Step 50/2500 - Loss: 0.0280, Perplexity: 1.0381, LR: 9.11e-05, LM: 0.0272, Age: 0.73, Sex: 0.027
2025-10-24 05:54:23,756 - INFO - Epoch 4, Step 100/2500 - Loss: 0.0294, Perplexity: 1.0421, LR: 9.11e-05, LM: 0.0287, Age: 0.71, Sex: 0.023
2025-10-24 05:54:36,524 - INFO - Epoch 4, Step 150/2500 - Loss: 0.0251, Perplexity: 1.0341, LR: 9.10e-05, LM: 0.0244, Age: 0.70, Sex: 0.019
2025-10-24 05:54:48,984 - INFO - Epoch 4, Step 200/2500 - Loss: 0.0386, Perplexity: 1.0637, LR: 9.09e-05, LM: 0.0379, Age: 0.71, Sex: 0.020
2025-10-24 05:55:01,700 - INFO - Epoch 4, Step 250/2500 - Loss: 0.0340, Perplexity: 1.0544, LR: 9.09e-05, LM: 0.0332, Age: 0.70, Sex: 0.019
2025-10-24 05:55:14,411 - INFO - Epoch 4, Step 300/2500 - Loss: 0.0300, Perplexity: 1.0471, LR: 9.08e-05, LM: 0.0292, Age: 0.70, Sex: 0.018
2025-10-24 05:55:27,165 - INFO - Epoch 4, Step 350/2500 - Loss: 0.0283, Perplexity: 1.0434, LR: 9.07e-05, LM: 0.0276, Age: 0.70, Sex: 0.018
2025-10-24 05:55:39,889 - INFO - Epoch 4, Step 400/2500 - Loss: 0.0258, Perplexity: 1.0390, LR: 9.07e-05, LM: 0.0251, Age: 0.69, Sex: 0.018
2025-10-24 05:55:52,217 - INFO - Epoch 4, Step 450/2500 - Loss: 0.0240, Perplexity: 1.0358, LR: 9.06e-05, LM: 0.0233, Age: 0.69, Sex: 0.017
2025-10-24 05:56:04,914 - INFO - Epoch 4, Step 500/2500 - Loss: 0.0223, Perplexity: 1.0330, LR: 9.05e-05, LM: 0.0216, Age: 0.69, Sex: 0.016
2025-10-24 05:56:17,389 - INFO - Epoch 4, Step 550/2500 - Loss: 0.0210, Perplexity: 1.0307, LR: 9.05e-05, LM: 0.0203, Age: 0.69, Sex: 0.015
2025-10-24 05:56:30,107 - INFO - Epoch 4, Step 600/2500 - Loss: 0.0207, Perplexity: 1.0301, LR: 9.04e-05, LM: 0.0200, Age: 0.69, Sex: 0.014
2025-10-24 05:56:42,866 - INFO - Epoch 4, Step 650/2500 - Loss: 0.0213, Perplexity: 1.0317, LR: 9.03e-05, LM: 0.0206, Age: 0.69, Sex: 0.013
2025-10-24 05:56:55,435 - INFO - Epoch 4, Step 700/2500 - Loss: 0.0212, Perplexity: 1.0312, LR: 9.03e-05, LM: 0.0205, Age: 0.69, Sex: 0.013
2025-10-24 05:57:08,252 - INFO - Epoch 4, Step 750/2500 - Loss: 0.0202, Perplexity: 1.0295, LR: 9.02e-05, LM: 0.0195, Age: 0.69, Sex: 0.012
2025-10-24 05:57:20,972 - INFO - Epoch 4, Step 800/2500 - Loss: 0.0232, Perplexity: 1.0359, LR: 9.01e-05, LM: 0.0225, Age: 0.69, Sex: 0.013
2025-10-24 05:57:34,002 - INFO - Epoch 4, Step 850/2500 - Loss: 0.0226, Perplexity: 1.0346, LR: 9.01e-05, LM: 0.0219, Age: 0.69, Sex: 0.012
2025-10-24 05:57:46,569 - INFO - Epoch 4, Step 900/2500 - Loss: 0.0224, Perplexity: 1.0340, LR: 9.00e-05, LM: 0.0217, Age: 0.69, Sex: 0.012
2025-10-24 05:57:58,978 - INFO - Epoch 4, Step 950/2500 - Loss: 0.0216, Perplexity: 1.0327, LR: 8.99e-05, LM: 0.0209, Age: 0.69, Sex: 0.013
2025-10-24 05:58:11,520 - INFO - Epoch 4, Step 1000/2500 - Loss: 0.0235, Perplexity: 1.0367, LR: 8.99e-05, LM: 0.0228, Age: 0.68, Sex: 0.012
2025-10-24 05:58:24,052 - INFO - Epoch 4, Step 1050/2500 - Loss: 0.0233, Perplexity: 1.0361, LR: 8.98e-05, LM: 0.0226, Age: 0.68, Sex: 0.012
2025-10-24 05:58:36,996 - INFO - Epoch 4, Step 1100/2500 - Loss: 0.0224, Perplexity: 1.0347, LR: 8.97e-05, LM: 0.0218, Age: 0.68, Sex: 0.012
2025-10-24 05:58:49,183 - INFO - Epoch 4, Step 1150/2500 - Loss: 0.0231, Perplexity: 1.0369, LR: 8.97e-05, LM: 0.0224, Age: 0.68, Sex: 0.012
2025-10-24 05:59:02,034 - INFO - Epoch 4, Step 1200/2500 - Loss: 0.0230, Perplexity: 1.0365, LR: 8.96e-05, LM: 0.0223, Age: 0.68, Sex: 0.012
2025-10-24 05:59:14,787 - INFO - Epoch 4, Step 1250/2500 - Loss: 0.0233, Perplexity: 1.0376, LR: 8.95e-05, LM: 0.0227, Age: 0.68, Sex: 0.011
2025-10-24 05:59:27,322 - INFO - Epoch 4, Step 1300/2500 - Loss: 0.0229, Perplexity: 1.0367, LR: 8.95e-05, LM: 0.0222, Age: 0.68, Sex: 0.012
2025-10-24 05:59:40,235 - INFO - Epoch 4, Step 1350/2500 - Loss: 0.0228, Perplexity: 1.0361, LR: 8.94e-05, LM: 0.0221, Age: 0.68, Sex: 0.012
2025-10-24 05:59:52,548 - INFO - Epoch 4, Step 1400/2500 - Loss: 0.0225, Perplexity: 1.0354, LR: 8.93e-05, LM: 0.0218, Age: 0.68, Sex: 0.012
2025-10-24 06:00:05,002 - INFO - Epoch 4, Step 1450/2500 - Loss: 0.0222, Perplexity: 1.0347, LR: 8.93e-05, LM: 0.0215, Age: 0.68, Sex: 0.011
2025-10-24 06:00:17,311 - INFO - Epoch 4, Step 1500/2500 - Loss: 0.0217, Perplexity: 1.0338, LR: 8.92e-05, LM: 0.0210, Age: 0.68, Sex: 0.011
2025-10-24 06:00:29,978 - INFO - Epoch 4, Step 1550/2500 - Loss: 0.0217, Perplexity: 1.0337, LR: 8.91e-05, LM: 0.0210, Age: 0.68, Sex: 0.012
2025-10-24 06:00:42,494 - INFO - Epoch 4, Step 1600/2500 - Loss: 0.0221, Perplexity: 1.0349, LR: 8.91e-05, LM: 0.0214, Age: 0.68, Sex: 0.012
2025-10-24 06:00:55,298 - INFO - Epoch 4, Step 1650/2500 - Loss: 0.0217, Perplexity: 1.0341, LR: 8.90e-05, LM: 0.0210, Age: 0.68, Sex: 0.012
2025-10-24 06:01:07,856 - INFO - Epoch 4, Step 1700/2500 - Loss: 0.0218, Perplexity: 1.0339, LR: 8.89e-05, LM: 0.0211, Age: 0.68, Sex: 0.013
2025-10-24 06:01:20,652 - INFO - Epoch 4, Step 1750/2500 - Loss: 0.0216, Perplexity: 1.0333, LR: 8.89e-05, LM: 0.0209, Age: 0.68, Sex: 0.012
2025-10-24 06:01:33,323 - INFO - Epoch 4, Step 1800/2500 - Loss: 0.0216, Perplexity: 1.0334, LR: 8.88e-05, LM: 0.0210, Age: 0.68, Sex: 0.013
2025-10-24 06:01:45,878 - INFO - Epoch 4, Step 1850/2500 - Loss: 0.0212, Perplexity: 1.0326, LR: 8.87e-05, LM: 0.0205, Age: 0.68, Sex: 0.013
2025-10-24 06:01:58,674 - INFO - Epoch 4, Step 1900/2500 - Loss: 0.0209, Perplexity: 1.0320, LR: 8.86e-05, LM: 0.0202, Age: 0.68, Sex: 0.013
2025-10-24 06:02:11,641 - INFO - Epoch 4, Step 1950/2500 - Loss: 0.0207, Perplexity: 1.0315, LR: 8.86e-05, LM: 0.0200, Age: 0.68, Sex: 0.013
2025-10-24 06:02:24,264 - INFO - Epoch 4, Step 2000/2500 - Loss: 0.0206, Perplexity: 1.0313, LR: 8.85e-05, LM: 0.0199, Age: 0.68, Sex: 0.013
2025-10-24 06:02:37,146 - INFO - Epoch 4, Step 2050/2500 - Loss: 0.0210, Perplexity: 1.0320, LR: 8.84e-05, LM: 0.0203, Age: 0.67, Sex: 0.013
2025-10-24 06:02:49,842 - INFO - Epoch 4, Step 2100/2500 - Loss: 0.0207, Perplexity: 1.0315, LR: 8.84e-05, LM: 0.0200, Age: 0.67, Sex: 0.012
2025-10-24 06:03:02,681 - INFO - Epoch 4, Step 2150/2500 - Loss: 0.0206, Perplexity: 1.0311, LR: 8.83e-05, LM: 0.0199, Age: 0.67, Sex: 0.012
2025-10-24 06:03:15,229 - INFO - Epoch 4, Step 2200/2500 - Loss: 0.0202, Perplexity: 1.0305, LR: 8.82e-05, LM: 0.0195, Age: 0.67, Sex: 0.012
2025-10-24 06:03:27,952 - INFO - Epoch 4, Step 2250/2500 - Loss: 0.0210, Perplexity: 1.0321, LR: 8.82e-05, LM: 0.0203, Age: 0.67, Sex: 0.012
2025-10-24 06:03:40,905 - INFO - Epoch 4, Step 2300/2500 - Loss: 0.0212, Perplexity: 1.0328, LR: 8.81e-05, LM: 0.0206, Age: 0.67, Sex: 0.012
2025-10-24 06:03:53,448 - INFO - Epoch 4, Step 2350/2500 - Loss: 0.0218, Perplexity: 1.0338, LR: 8.80e-05, LM: 0.0211, Age: 0.67, Sex: 0.012
2025-10-24 06:04:05,995 - INFO - Epoch 4, Step 2400/2500 - Loss: 0.0214, Perplexity: 1.0332, LR: 8.80e-05, LM: 0.0207, Age: 0.67, Sex: 0.012
2025-10-24 06:04:18,795 - INFO - Epoch 4, Step 2450/2500 - Loss: 0.0212, Perplexity: 1.0329, LR: 8.79e-05, LM: 0.0205, Age: 0.67, Sex: 0.012
2025-10-24 06:04:31,197 - INFO - Epoch 4, Step 2500/2500 - Loss: 0.0219, Perplexity: 1.0345, LR: 8.78e-05, LM: 0.0212, Age: 0.67, Sex: 0.012
2025-10-24 06:04:31,199 - INFO - Epoch 4 Complete - Avg Loss: 0.0219, Avg Perplexity: 1.0345, LM: 0.0212, Age: 0.67, Sex: 0.012
2025-10-24 06:05:21,267 - INFO - Validation - Loss: 0.0046, Perplexity: 1.0055, Token Accuracy: 0.9994, Code Accuracy: 0.9992
2025-10-24 06:05:21,269 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:05:26,158 - INFO - TPL computed on 500 samples: 1.0069
2025-10-24 06:05:26,158 - INFO - Temporal Perplexity (TPL): 1.0069
2025-10-24 06:05:26,159 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:05:35,206 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0012
2025-10-24 06:05:35,206 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 06:05:35,206 - INFO - New best model! Validation loss: 0.0046
2025-10-24 06:05:39,694 - INFO - Checkpoint saved: epoch 4
2025-10-24 06:05:52,394 - INFO - Epoch 5, Step 50/2500 - Loss: 0.0305, Perplexity: 1.0497, LR: 8.78e-05, LM: 0.0298, Age: 0.67, Sex: 0.014
2025-10-24 06:06:05,153 - INFO - Epoch 5, Step 100/2500 - Loss: 0.0184, Perplexity: 1.0281, LR: 8.77e-05, LM: 0.0178, Age: 0.66, Sex: 0.014
2025-10-24 06:06:17,898 - INFO - Epoch 5, Step 150/2500 - Loss: 0.0146, Perplexity: 1.0211, LR: 8.76e-05, LM: 0.0139, Age: 0.66, Sex: 0.012
2025-10-24 06:06:30,373 - INFO - Epoch 5, Step 200/2500 - Loss: 0.0129, Perplexity: 1.0178, LR: 8.76e-05, LM: 0.0122, Age: 0.66, Sex: 0.009
2025-10-24 06:06:43,110 - INFO - Epoch 5, Step 250/2500 - Loss: 0.0130, Perplexity: 1.0170, LR: 8.75e-05, LM: 0.0124, Age: 0.66, Sex: 0.010
2025-10-24 06:06:55,920 - INFO - Epoch 5, Step 300/2500 - Loss: 0.0127, Perplexity: 1.0161, LR: 8.74e-05, LM: 0.0120, Age: 0.66, Sex: 0.009
2025-10-24 06:07:08,791 - INFO - Epoch 5, Step 350/2500 - Loss: 0.0137, Perplexity: 1.0171, LR: 8.74e-05, LM: 0.0130, Age: 0.66, Sex: 0.010
2025-10-24 06:07:21,312 - INFO - Epoch 5, Step 400/2500 - Loss: 0.0173, Perplexity: 1.0233, LR: 8.73e-05, LM: 0.0167, Age: 0.65, Sex: 0.011
2025-10-24 06:07:33,691 - INFO - Epoch 5, Step 450/2500 - Loss: 0.0192, Perplexity: 1.0267, LR: 8.72e-05, LM: 0.0185, Age: 0.65, Sex: 0.011
2025-10-24 06:07:46,374 - INFO - Epoch 5, Step 500/2500 - Loss: 0.0187, Perplexity: 1.0256, LR: 8.72e-05, LM: 0.0180, Age: 0.65, Sex: 0.011
2025-10-24 06:07:59,163 - INFO - Epoch 5, Step 550/2500 - Loss: 0.0175, Perplexity: 1.0238, LR: 8.71e-05, LM: 0.0168, Age: 0.65, Sex: 0.011
2025-10-24 06:08:11,864 - INFO - Epoch 5, Step 600/2500 - Loss: 0.0163, Perplexity: 1.0221, LR: 8.70e-05, LM: 0.0157, Age: 0.65, Sex: 0.010
2025-10-24 06:08:24,286 - INFO - Epoch 5, Step 650/2500 - Loss: 0.0162, Perplexity: 1.0218, LR: 8.70e-05, LM: 0.0156, Age: 0.65, Sex: 0.010
2025-10-24 06:08:37,244 - INFO - Epoch 5, Step 700/2500 - Loss: 0.0165, Perplexity: 1.0222, LR: 8.69e-05, LM: 0.0158, Age: 0.65, Sex: 0.010
2025-10-24 06:08:49,808 - INFO - Epoch 5, Step 750/2500 - Loss: 0.0169, Perplexity: 1.0233, LR: 8.68e-05, LM: 0.0162, Age: 0.65, Sex: 0.009
2025-10-24 06:09:02,168 - INFO - Epoch 5, Step 800/2500 - Loss: 0.0161, Perplexity: 1.0221, LR: 8.68e-05, LM: 0.0154, Age: 0.66, Sex: 0.009
2025-10-24 06:09:14,843 - INFO - Epoch 5, Step 850/2500 - Loss: 0.0165, Perplexity: 1.0224, LR: 8.67e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:09:27,475 - INFO - Epoch 5, Step 900/2500 - Loss: 0.0167, Perplexity: 1.0229, LR: 8.66e-05, LM: 0.0160, Age: 0.65, Sex: 0.010
2025-10-24 06:09:39,808 - INFO - Epoch 5, Step 950/2500 - Loss: 0.0171, Perplexity: 1.0238, LR: 8.66e-05, LM: 0.0164, Age: 0.65, Sex: 0.010
2025-10-24 06:09:52,665 - INFO - Epoch 5, Step 1000/2500 - Loss: 0.0173, Perplexity: 1.0241, LR: 8.65e-05, LM: 0.0167, Age: 0.65, Sex: 0.009
2025-10-24 06:10:05,321 - INFO - Epoch 5, Step 1050/2500 - Loss: 0.0168, Perplexity: 1.0233, LR: 8.64e-05, LM: 0.0162, Age: 0.65, Sex: 0.009
2025-10-24 06:10:18,506 - INFO - Epoch 5, Step 1100/2500 - Loss: 0.0163, Perplexity: 1.0225, LR: 8.64e-05, LM: 0.0156, Age: 0.65, Sex: 0.009
2025-10-24 06:10:31,054 - INFO - Epoch 5, Step 1150/2500 - Loss: 0.0158, Perplexity: 1.0217, LR: 8.63e-05, LM: 0.0152, Age: 0.65, Sex: 0.008
2025-10-24 06:10:43,848 - INFO - Epoch 5, Step 1200/2500 - Loss: 0.0155, Perplexity: 1.0212, LR: 8.62e-05, LM: 0.0149, Age: 0.65, Sex: 0.008
2025-10-24 06:10:56,508 - INFO - Epoch 5, Step 1250/2500 - Loss: 0.0160, Perplexity: 1.0218, LR: 8.61e-05, LM: 0.0154, Age: 0.66, Sex: 0.008
2025-10-24 06:11:09,309 - INFO - Epoch 5, Step 1300/2500 - Loss: 0.0156, Perplexity: 1.0211, LR: 8.61e-05, LM: 0.0149, Age: 0.66, Sex: 0.008
2025-10-24 06:11:21,707 - INFO - Epoch 5, Step 1350/2500 - Loss: 0.0153, Perplexity: 1.0207, LR: 8.60e-05, LM: 0.0146, Age: 0.66, Sex: 0.008
2025-10-24 06:11:34,128 - INFO - Epoch 5, Step 1400/2500 - Loss: 0.0149, Perplexity: 1.0201, LR: 8.59e-05, LM: 0.0143, Age: 0.66, Sex: 0.008
2025-10-24 06:11:46,981 - INFO - Epoch 5, Step 1450/2500 - Loss: 0.0149, Perplexity: 1.0199, LR: 8.59e-05, LM: 0.0142, Age: 0.66, Sex: 0.008
2025-10-24 06:11:59,839 - INFO - Epoch 5, Step 1500/2500 - Loss: 0.0165, Perplexity: 1.0230, LR: 8.58e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:12:12,386 - INFO - Epoch 5, Step 1550/2500 - Loss: 0.0173, Perplexity: 1.0244, LR: 8.57e-05, LM: 0.0166, Age: 0.66, Sex: 0.009
2025-10-24 06:12:24,972 - INFO - Epoch 5, Step 1600/2500 - Loss: 0.0175, Perplexity: 1.0250, LR: 8.57e-05, LM: 0.0168, Age: 0.66, Sex: 0.009
2025-10-24 06:12:37,899 - INFO - Epoch 5, Step 1650/2500 - Loss: 0.0175, Perplexity: 1.0248, LR: 8.56e-05, LM: 0.0168, Age: 0.66, Sex: 0.009
2025-10-24 06:12:50,542 - INFO - Epoch 5, Step 1700/2500 - Loss: 0.0172, Perplexity: 1.0242, LR: 8.55e-05, LM: 0.0165, Age: 0.66, Sex: 0.009
2025-10-24 06:13:02,950 - INFO - Epoch 5, Step 1750/2500 - Loss: 0.0168, Perplexity: 1.0237, LR: 8.55e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:13:15,366 - INFO - Epoch 5, Step 1800/2500 - Loss: 0.0170, Perplexity: 1.0240, LR: 8.54e-05, LM: 0.0163, Age: 0.66, Sex: 0.009
2025-10-24 06:13:28,062 - INFO - Epoch 5, Step 1850/2500 - Loss: 0.0170, Perplexity: 1.0239, LR: 8.53e-05, LM: 0.0163, Age: 0.66, Sex: 0.009
2025-10-24 06:13:40,687 - INFO - Epoch 5, Step 1900/2500 - Loss: 0.0168, Perplexity: 1.0236, LR: 8.53e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:13:53,544 - INFO - Epoch 5, Step 1950/2500 - Loss: 0.0170, Perplexity: 1.0242, LR: 8.52e-05, LM: 0.0164, Age: 0.66, Sex: 0.009
2025-10-24 06:14:06,149 - INFO - Epoch 5, Step 2000/2500 - Loss: 0.0168, Perplexity: 1.0238, LR: 8.51e-05, LM: 0.0162, Age: 0.66, Sex: 0.009
2025-10-24 06:14:18,926 - INFO - Epoch 5, Step 2050/2500 - Loss: 0.0168, Perplexity: 1.0238, LR: 8.51e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:14:31,289 - INFO - Epoch 5, Step 2100/2500 - Loss: 0.0165, Perplexity: 1.0233, LR: 8.50e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:14:43,990 - INFO - Epoch 5, Step 2150/2500 - Loss: 0.0167, Perplexity: 1.0235, LR: 8.49e-05, LM: 0.0160, Age: 0.66, Sex: 0.009
2025-10-24 06:14:56,555 - INFO - Epoch 5, Step 2200/2500 - Loss: 0.0165, Perplexity: 1.0232, LR: 8.49e-05, LM: 0.0159, Age: 0.66, Sex: 0.009
2025-10-24 06:15:09,106 - INFO - Epoch 5, Step 2250/2500 - Loss: 0.0163, Perplexity: 1.0228, LR: 8.48e-05, LM: 0.0156, Age: 0.66, Sex: 0.009
2025-10-24 06:15:21,819 - INFO - Epoch 5, Step 2300/2500 - Loss: 0.0160, Perplexity: 1.0224, LR: 8.47e-05, LM: 0.0154, Age: 0.66, Sex: 0.009
2025-10-24 06:15:34,936 - INFO - Epoch 5, Step 2350/2500 - Loss: 0.0159, Perplexity: 1.0222, LR: 8.47e-05, LM: 0.0152, Age: 0.66, Sex: 0.009
2025-10-24 06:15:47,469 - INFO - Epoch 5, Step 2400/2500 - Loss: 0.0158, Perplexity: 1.0219, LR: 8.46e-05, LM: 0.0151, Age: 0.66, Sex: 0.009
2025-10-24 06:16:00,077 - INFO - Epoch 5, Step 2450/2500 - Loss: 0.0155, Perplexity: 1.0215, LR: 8.45e-05, LM: 0.0149, Age: 0.66, Sex: 0.009
2025-10-24 06:16:12,887 - INFO - Epoch 5, Step 2500/2500 - Loss: 0.0154, Perplexity: 1.0213, LR: 8.45e-05, LM: 0.0148, Age: 0.66, Sex: 0.009
2025-10-24 06:16:12,889 - INFO - Epoch 5 Complete - Avg Loss: 0.0154, Avg Perplexity: 1.0213, LM: 0.0148, Age: 0.66, Sex: 0.009
2025-10-24 06:17:02,655 - INFO - Validation - Loss: 0.0067, Perplexity: 1.0078, Token Accuracy: 0.9990, Code Accuracy: 0.9989
2025-10-24 06:17:02,657 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:17:07,559 - INFO - TPL computed on 500 samples: 1.0137
2025-10-24 06:17:07,559 - INFO - Temporal Perplexity (TPL): 1.0137
2025-10-24 06:17:07,560 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:17:17,103 - INFO - Reconstruction Jaccard computed on 117 visits: 0.0038
2025-10-24 06:17:17,104 - INFO - Reconstruction Jaccard: 0.0038
2025-10-24 06:17:19,471 - INFO - Checkpoint saved: epoch 5
2025-10-24 06:17:32,246 - INFO - Epoch 6, Step 50/2500 - Loss: 0.0126, Perplexity: 1.0136, LR: 8.44e-05, LM: 0.0120, Age: 0.60, Sex: 0.018
2025-10-24 06:17:44,833 - INFO - Epoch 6, Step 100/2500 - Loss: 0.0109, Perplexity: 1.0116, LR: 8.43e-05, LM: 0.0103, Age: 0.61, Sex: 0.016
2025-10-24 06:17:57,189 - INFO - Epoch 6, Step 150/2500 - Loss: 0.0086, Perplexity: 1.0091, LR: 8.43e-05, LM: 0.0080, Age: 0.62, Sex: 0.012
2025-10-24 06:18:09,321 - INFO - Epoch 6, Step 200/2500 - Loss: 0.0077, Perplexity: 1.0081, LR: 8.42e-05, LM: 0.0070, Age: 0.64, Sex: 0.010
2025-10-24 06:18:21,934 - INFO - Epoch 6, Step 250/2500 - Loss: 0.0084, Perplexity: 1.0090, LR: 8.41e-05, LM: 0.0078, Age: 0.63, Sex: 0.013
2025-10-24 06:18:34,660 - INFO - Epoch 6, Step 300/2500 - Loss: 0.0095, Perplexity: 1.0109, LR: 8.41e-05, LM: 0.0089, Age: 0.63, Sex: 0.013
2025-10-24 06:18:47,512 - INFO - Epoch 6, Step 350/2500 - Loss: 0.0113, Perplexity: 1.0134, LR: 8.40e-05, LM: 0.0106, Age: 0.63, Sex: 0.013
2025-10-24 06:19:00,185 - INFO - Epoch 6, Step 400/2500 - Loss: 0.0122, Perplexity: 1.0154, LR: 8.39e-05, LM: 0.0116, Age: 0.62, Sex: 0.012
2025-10-24 06:19:12,992 - INFO - Epoch 6, Step 450/2500 - Loss: 0.0130, Perplexity: 1.0164, LR: 8.39e-05, LM: 0.0124, Age: 0.63, Sex: 0.013
2025-10-24 06:19:25,691 - INFO - Epoch 6, Step 500/2500 - Loss: 0.0145, Perplexity: 1.0193, LR: 8.38e-05, LM: 0.0138, Age: 0.62, Sex: 0.012
2025-10-24 06:19:38,162 - INFO - Epoch 6, Step 550/2500 - Loss: 0.0140, Perplexity: 1.0185, LR: 8.37e-05, LM: 0.0134, Age: 0.62, Sex: 0.012
2025-10-24 06:19:50,531 - INFO - Epoch 6, Step 600/2500 - Loss: 0.0136, Perplexity: 1.0177, LR: 8.36e-05, LM: 0.0130, Age: 0.62, Sex: 0.011
2025-10-24 06:20:03,581 - INFO - Epoch 6, Step 650/2500 - Loss: 0.0131, Perplexity: 1.0169, LR: 8.36e-05, LM: 0.0124, Age: 0.63, Sex: 0.012
2025-10-24 06:20:16,172 - INFO - Epoch 6, Step 700/2500 - Loss: 0.0126, Perplexity: 1.0161, LR: 8.35e-05, LM: 0.0119, Age: 0.63, Sex: 0.011
2025-10-24 06:20:29,101 - INFO - Epoch 6, Step 750/2500 - Loss: 0.0119, Perplexity: 1.0152, LR: 8.34e-05, LM: 0.0112, Age: 0.62, Sex: 0.012
2025-10-24 06:20:41,628 - INFO - Epoch 6, Step 800/2500 - Loss: 0.0119, Perplexity: 1.0151, LR: 8.34e-05, LM: 0.0113, Age: 0.63, Sex: 0.012
2025-10-24 06:20:54,206 - INFO - Epoch 6, Step 850/2500 - Loss: 0.0118, Perplexity: 1.0148, LR: 8.33e-05, LM: 0.0112, Age: 0.63, Sex: 0.012
2025-10-24 06:21:06,773 - INFO - Epoch 6, Step 900/2500 - Loss: 0.0128, Perplexity: 1.0164, LR: 8.32e-05, LM: 0.0122, Age: 0.64, Sex: 0.012
2025-10-24 06:21:19,515 - INFO - Epoch 6, Step 950/2500 - Loss: 0.0139, Perplexity: 1.0184, LR: 8.32e-05, LM: 0.0133, Age: 0.63, Sex: 0.012
2025-10-24 06:21:32,193 - INFO - Epoch 6, Step 1000/2500 - Loss: 0.0139, Perplexity: 1.0182, LR: 8.31e-05, LM: 0.0133, Age: 0.64, Sex: 0.012
2025-10-24 06:21:44,946 - INFO - Epoch 6, Step 1050/2500 - Loss: 0.0137, Perplexity: 1.0179, LR: 8.30e-05, LM: 0.0131, Age: 0.64, Sex: 0.011
2025-10-24 06:21:57,767 - INFO - Epoch 6, Step 1100/2500 - Loss: 0.0136, Perplexity: 1.0176, LR: 8.30e-05, LM: 0.0130, Age: 0.64, Sex: 0.012
2025-10-24 06:22:10,292 - INFO - Epoch 6, Step 1150/2500 - Loss: 0.0131, Perplexity: 1.0169, LR: 8.29e-05, LM: 0.0125, Age: 0.64, Sex: 0.011
2025-10-24 06:22:22,747 - INFO - Epoch 6, Step 1200/2500 - Loss: 0.0127, Perplexity: 1.0164, LR: 8.28e-05, LM: 0.0121, Age: 0.64, Sex: 0.011
2025-10-24 06:22:35,098 - INFO - Epoch 6, Step 1250/2500 - Loss: 0.0127, Perplexity: 1.0164, LR: 8.28e-05, LM: 0.0121, Age: 0.64, Sex: 0.010
2025-10-24 06:22:47,811 - INFO - Epoch 6, Step 1300/2500 - Loss: 0.0134, Perplexity: 1.0175, LR: 8.27e-05, LM: 0.0127, Age: 0.64, Sex: 0.010
2025-10-24 06:23:00,199 - INFO - Epoch 6, Step 1350/2500 - Loss: 0.0130, Perplexity: 1.0170, LR: 8.26e-05, LM: 0.0124, Age: 0.64, Sex: 0.010
2025-10-24 06:23:12,991 - INFO - Epoch 6, Step 1400/2500 - Loss: 0.0130, Perplexity: 1.0169, LR: 8.26e-05, LM: 0.0123, Age: 0.64, Sex: 0.010
2025-10-24 06:23:25,799 - INFO - Epoch 6, Step 1450/2500 - Loss: 0.0126, Perplexity: 1.0164, LR: 8.25e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:23:38,626 - INFO - Epoch 6, Step 1500/2500 - Loss: 0.0122, Perplexity: 1.0159, LR: 8.24e-05, LM: 0.0116, Age: 0.64, Sex: 0.009
2025-10-24 06:23:51,629 - INFO - Epoch 6, Step 1550/2500 - Loss: 0.0126, Perplexity: 1.0166, LR: 8.24e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:24:04,560 - INFO - Epoch 6, Step 1600/2500 - Loss: 0.0126, Perplexity: 1.0164, LR: 8.23e-05, LM: 0.0119, Age: 0.64, Sex: 0.009
2025-10-24 06:24:17,429 - INFO - Epoch 6, Step 1650/2500 - Loss: 0.0126, Perplexity: 1.0165, LR: 8.22e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:24:30,483 - INFO - Epoch 6, Step 1700/2500 - Loss: 0.0133, Perplexity: 1.0177, LR: 8.22e-05, LM: 0.0126, Age: 0.64, Sex: 0.010
2025-10-24 06:24:43,133 - INFO - Epoch 6, Step 1750/2500 - Loss: 0.0138, Perplexity: 1.0184, LR: 8.21e-05, LM: 0.0131, Age: 0.64, Sex: 0.010
2025-10-24 06:24:55,833 - INFO - Epoch 6, Step 1800/2500 - Loss: 0.0136, Perplexity: 1.0181, LR: 8.20e-05, LM: 0.0129, Age: 0.64, Sex: 0.009
2025-10-24 06:25:08,404 - INFO - Epoch 6, Step 1850/2500 - Loss: 0.0134, Perplexity: 1.0178, LR: 8.20e-05, LM: 0.0128, Age: 0.64, Sex: 0.009
2025-10-24 06:25:21,117 - INFO - Epoch 6, Step 1900/2500 - Loss: 0.0132, Perplexity: 1.0175, LR: 8.19e-05, LM: 0.0125, Age: 0.64, Sex: 0.009
2025-10-24 06:25:33,919 - INFO - Epoch 6, Step 1950/2500 - Loss: 0.0130, Perplexity: 1.0171, LR: 8.18e-05, LM: 0.0123, Age: 0.64, Sex: 0.009
2025-10-24 06:25:46,406 - INFO - Epoch 6, Step 2000/2500 - Loss: 0.0128, Perplexity: 1.0169, LR: 8.18e-05, LM: 0.0122, Age: 0.64, Sex: 0.009
2025-10-24 06:25:58,935 - INFO - Epoch 6, Step 2050/2500 - Loss: 0.0126, Perplexity: 1.0166, LR: 8.17e-05, LM: 0.0119, Age: 0.64, Sex: 0.009
2025-10-24 06:26:11,901 - INFO - Epoch 6, Step 2100/2500 - Loss: 0.0124, Perplexity: 1.0163, LR: 8.16e-05, LM: 0.0117, Age: 0.64, Sex: 0.009
2025-10-24 06:26:24,563 - INFO - Epoch 6, Step 2150/2500 - Loss: 0.0122, Perplexity: 1.0160, LR: 8.16e-05, LM: 0.0116, Age: 0.64, Sex: 0.009
2025-10-24 06:26:37,287 - INFO - Epoch 6, Step 2200/2500 - Loss: 0.0121, Perplexity: 1.0158, LR: 8.15e-05, LM: 0.0115, Age: 0.64, Sex: 0.008
2025-10-24 06:26:49,674 - INFO - Epoch 6, Step 2250/2500 - Loss: 0.0119, Perplexity: 1.0156, LR: 8.14e-05, LM: 0.0113, Age: 0.64, Sex: 0.008
2025-10-24 06:27:02,524 - INFO - Epoch 6, Step 2300/2500 - Loss: 0.0119, Perplexity: 1.0155, LR: 8.14e-05, LM: 0.0113, Age: 0.64, Sex: 0.008
2025-10-24 06:27:15,005 - INFO - Epoch 6, Step 2350/2500 - Loss: 0.0118, Perplexity: 1.0153, LR: 8.13e-05, LM: 0.0111, Age: 0.64, Sex: 0.008
2025-10-24 06:27:27,863 - INFO - Epoch 6, Step 2400/2500 - Loss: 0.0117, Perplexity: 1.0151, LR: 8.12e-05, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:27:40,626 - INFO - Epoch 6, Step 2450/2500 - Loss: 0.0118, Perplexity: 1.0153, LR: 8.11e-05, LM: 0.0111, Age: 0.64, Sex: 0.008
2025-10-24 06:27:53,353 - INFO - Epoch 6, Step 2500/2500 - Loss: 0.0116, Perplexity: 1.0151, LR: 8.11e-05, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:27:53,354 - INFO - Epoch 6 Complete - Avg Loss: 0.0116, Avg Perplexity: 1.0151, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:28:43,057 - INFO - Validation - Loss: 0.0032, Perplexity: 1.0034, Token Accuracy: 0.9995, Code Accuracy: 0.9995
2025-10-24 06:28:43,059 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:28:47,917 - INFO - TPL computed on 500 samples: 1.0062
2025-10-24 06:28:47,917 - INFO - Temporal Perplexity (TPL): 1.0062
2025-10-24 06:28:47,918 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:28:54,354 - INFO - Reconstruction Jaccard computed on 116 visits: 0.0158
2025-10-24 06:28:54,354 - INFO - Reconstruction Jaccard: 0.0158
2025-10-24 06:28:54,355 - INFO - New best model! Validation loss: 0.0032
2025-10-24 06:28:58,853 - INFO - Checkpoint saved: epoch 6
2025-10-24 06:29:11,533 - INFO - Epoch 7, Step 50/2500 - Loss: 0.0253, Perplexity: 1.0321, LR: 8.10e-05, LM: 0.0247, Age: 0.63, Sex: 0.002
2025-10-24 06:29:23,964 - INFO - Epoch 7, Step 100/2500 - Loss: 0.0147, Perplexity: 1.0181, LR: 8.09e-05, LM: 0.0141, Age: 0.65, Sex: 0.001
2025-10-24 06:29:36,596 - INFO - Epoch 7, Step 150/2500 - Loss: 0.0162, Perplexity: 1.0200, LR: 8.09e-05, LM: 0.0155, Age: 0.68, Sex: 0.003
2025-10-24 06:29:49,420 - INFO - Epoch 7, Step 200/2500 - Loss: 0.0134, Perplexity: 1.0162, LR: 8.08e-05, LM: 0.0127, Age: 0.67, Sex: 0.003
2025-10-24 06:30:02,339 - INFO - Epoch 7, Step 250/2500 - Loss: 0.0133, Perplexity: 1.0161, LR: 8.07e-05, LM: 0.0126, Age: 0.66, Sex: 0.004
2025-10-24 06:30:15,022 - INFO - Epoch 7, Step 300/2500 - Loss: 0.0116, Perplexity: 1.0140, LR: 8.07e-05, LM: 0.0109, Age: 0.65, Sex: 0.004
2025-10-24 06:30:27,762 - INFO - Epoch 7, Step 350/2500 - Loss: 0.0107, Perplexity: 1.0128, LR: 8.06e-05, LM: 0.0101, Age: 0.65, Sex: 0.004
2025-10-24 06:30:40,723 - INFO - Epoch 7, Step 400/2500 - Loss: 0.0144, Perplexity: 1.0185, LR: 8.05e-05, LM: 0.0137, Age: 0.65, Sex: 0.005
2025-10-24 06:30:53,561 - INFO - Epoch 7, Step 450/2500 - Loss: 0.0143, Perplexity: 1.0182, LR: 8.05e-05, LM: 0.0137, Age: 0.65, Sex: 0.006
2025-10-24 06:31:06,297 - INFO - Epoch 7, Step 500/2500 - Loss: 0.0146, Perplexity: 1.0184, LR: 8.04e-05, LM: 0.0139, Age: 0.65, Sex: 0.007
2025-10-24 06:31:18,975 - INFO - Epoch 7, Step 550/2500 - Loss: 0.0138, Perplexity: 1.0173, LR: 8.03e-05, LM: 0.0131, Age: 0.65, Sex: 0.007
2025-10-24 06:31:31,809 - INFO - Epoch 7, Step 600/2500 - Loss: 0.0138, Perplexity: 1.0173, LR: 8.03e-05, LM: 0.0131, Age: 0.65, Sex: 0.007
2025-10-24 06:31:44,153 - INFO - Epoch 7, Step 650/2500 - Loss: 0.0142, Perplexity: 1.0181, LR: 8.02e-05, LM: 0.0135, Age: 0.65, Sex: 0.007
2025-10-24 06:31:56,976 - INFO - Epoch 7, Step 700/2500 - Loss: 0.0146, Perplexity: 1.0188, LR: 8.01e-05, LM: 0.0140, Age: 0.65, Sex: 0.007
2025-10-24 06:32:09,587 - INFO - Epoch 7, Step 750/2500 - Loss: 0.0144, Perplexity: 1.0185, LR: 8.01e-05, LM: 0.0138, Age: 0.64, Sex: 0.007
2025-10-24 06:32:22,342 - INFO - Epoch 7, Step 800/2500 - Loss: 0.0136, Perplexity: 1.0174, LR: 8.00e-05, LM: 0.0129, Age: 0.64, Sex: 0.007
2025-10-24 06:32:34,976 - INFO - Epoch 7, Step 850/2500 - Loss: 0.0136, Perplexity: 1.0173, LR: 7.99e-05, LM: 0.0129, Age: 0.64, Sex: 0.007
2025-10-24 06:32:47,188 - INFO - Epoch 7, Step 900/2500 - Loss: 0.0135, Perplexity: 1.0172, LR: 7.99e-05, LM: 0.0128, Age: 0.64, Sex: 0.007
2025-10-24 06:33:00,181 - INFO - Epoch 7, Step 950/2500 - Loss: 0.0140, Perplexity: 1.0178, LR: 7.98e-05, LM: 0.0133, Age: 0.64, Sex: 0.007
2025-10-24 06:33:12,926 - INFO - Epoch 7, Step 1000/2500 - Loss: 0.0134, Perplexity: 1.0170, LR: 7.97e-05, LM: 0.0127, Age: 0.63, Sex: 0.007
2025-10-24 06:33:25,951 - INFO - Epoch 7, Step 1050/2500 - Loss: 0.0130, Perplexity: 1.0165, LR: 7.97e-05, LM: 0.0123, Age: 0.63, Sex: 0.007
2025-10-24 06:33:38,711 - INFO - Epoch 7, Step 1100/2500 - Loss: 0.0131, Perplexity: 1.0166, LR: 7.96e-05, LM: 0.0124, Age: 0.63, Sex: 0.006
2025-10-24 06:33:51,522 - INFO - Epoch 7, Step 1150/2500 - Loss: 0.0127, Perplexity: 1.0161, LR: 7.95e-05, LM: 0.0121, Age: 0.63, Sex: 0.006
2025-10-24 06:34:03,918 - INFO - Epoch 7, Step 1200/2500 - Loss: 0.0126, Perplexity: 1.0159, LR: 7.95e-05, LM: 0.0120, Age: 0.63, Sex: 0.006
2025-10-24 06:34:16,479 - INFO - Epoch 7, Step 1250/2500 - Loss: 0.0124, Perplexity: 1.0155, LR: 7.94e-05, LM: 0.0117, Age: 0.63, Sex: 0.006
2025-10-24 06:34:29,272 - INFO - Epoch 7, Step 1300/2500 - Loss: 0.0122, Perplexity: 1.0152, LR: 7.93e-05, LM: 0.0115, Age: 0.63, Sex: 0.006
2025-10-24 06:34:41,980 - INFO - Epoch 7, Step 1350/2500 - Loss: 0.0118, Perplexity: 1.0147, LR: 7.93e-05, LM: 0.0112, Age: 0.63, Sex: 0.006
2025-10-24 06:34:54,839 - INFO - Epoch 7, Step 1400/2500 - Loss: 0.0116, Perplexity: 1.0144, LR: 7.92e-05, LM: 0.0109, Age: 0.63, Sex: 0.006
2025-10-24 06:35:07,482 - INFO - Epoch 7, Step 1450/2500 - Loss: 0.0113, Perplexity: 1.0140, LR: 7.91e-05, LM: 0.0107, Age: 0.62, Sex: 0.006
2025-10-24 06:35:20,340 - INFO - Epoch 7, Step 1500/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.91e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:35:33,053 - INFO - Epoch 7, Step 1550/2500 - Loss: 0.0109, Perplexity: 1.0135, LR: 7.90e-05, LM: 0.0103, Age: 0.62, Sex: 0.006
2025-10-24 06:35:45,726 - INFO - Epoch 7, Step 1600/2500 - Loss: 0.0108, Perplexity: 1.0133, LR: 7.89e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:35:58,462 - INFO - Epoch 7, Step 1650/2500 - Loss: 0.0108, Perplexity: 1.0132, LR: 7.89e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:11,237 - INFO - Epoch 7, Step 1700/2500 - Loss: 0.0107, Perplexity: 1.0132, LR: 7.88e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:23,834 - INFO - Epoch 7, Step 1750/2500 - Loss: 0.0105, Perplexity: 1.0129, LR: 7.87e-05, LM: 0.0099, Age: 0.62, Sex: 0.006
2025-10-24 06:36:36,938 - INFO - Epoch 7, Step 1800/2500 - Loss: 0.0108, Perplexity: 1.0132, LR: 7.86e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:49,865 - INFO - Epoch 7, Step 1850/2500 - Loss: 0.0108, Perplexity: 1.0131, LR: 7.86e-05, LM: 0.0101, Age: 0.62, Sex: 0.005
2025-10-24 06:37:02,577 - INFO - Epoch 7, Step 1900/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.85e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:37:15,335 - INFO - Epoch 7, Step 1950/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.84e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:37:28,262 - INFO - Epoch 7, Step 2000/2500 - Loss: 0.0109, Perplexity: 1.0134, LR: 7.84e-05, LM: 0.0102, Age: 0.62, Sex: 0.006
2025-10-24 06:37:41,291 - INFO - Epoch 7, Step 2050/2500 - Loss: 0.0107, Perplexity: 1.0132, LR: 7.83e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:37:53,957 - INFO - Epoch 7, Step 2100/2500 - Loss: 0.0107, Perplexity: 1.0131, LR: 7.82e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:38:06,441 - INFO - Epoch 7, Step 2150/2500 - Loss: 0.0110, Perplexity: 1.0135, LR: 7.82e-05, LM: 0.0103, Age: 0.62, Sex: 0.007
2025-10-24 06:38:19,205 - INFO - Epoch 7, Step 2200/2500 - Loss: 0.0109, Perplexity: 1.0134, LR: 7.81e-05, LM: 0.0103, Age: 0.62, Sex: 0.006
2025-10-24 06:38:31,867 - INFO - Epoch 7, Step 2250/2500 - Loss: 0.0107, Perplexity: 1.0131, LR: 7.80e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:38:44,604 - INFO - Epoch 7, Step 2300/2500 - Loss: 0.0105, Perplexity: 1.0129, LR: 7.80e-05, LM: 0.0099, Age: 0.62, Sex: 0.006
2025-10-24 06:38:57,075 - INFO - Epoch 7, Step 2350/2500 - Loss: 0.0103, Perplexity: 1.0126, LR: 7.79e-05, LM: 0.0097, Age: 0.62, Sex: 0.006
2025-10-24 06:39:09,813 - INFO - Epoch 7, Step 2400/2500 - Loss: 0.0104, Perplexity: 1.0127, LR: 7.78e-05, LM: 0.0098, Age: 0.62, Sex: 0.006
2025-10-24 06:39:22,796 - INFO - Epoch 7, Step 2450/2500 - Loss: 0.0102, Perplexity: 1.0125, LR: 7.78e-05, LM: 0.0096, Age: 0.62, Sex: 0.006
2025-10-24 06:39:35,369 - INFO - Epoch 7, Step 2500/2500 - Loss: 0.0100, Perplexity: 1.0123, LR: 7.77e-05, LM: 0.0094, Age: 0.62, Sex: 0.006
2025-10-24 06:39:35,370 - INFO - Epoch 7 Complete - Avg Loss: 0.0100, Avg Perplexity: 1.0123, LM: 0.0094, Age: 0.62, Sex: 0.006
2025-10-24 06:40:24,940 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0008, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 06:40:24,942 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:40:29,794 - INFO - TPL computed on 500 samples: 1.0022
2025-10-24 06:40:29,794 - INFO - Temporal Perplexity (TPL): 1.0022
2025-10-24 06:40:29,795 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:40:37,312 - INFO - Reconstruction Jaccard computed on 126 visits: 0.0191
2025-10-24 06:40:37,312 - INFO - Reconstruction Jaccard: 0.0191
2025-10-24 06:40:37,312 - INFO - New best model! Validation loss: 0.0007
2025-10-24 06:40:41,628 - INFO - Checkpoint saved: epoch 7
2025-10-24 06:40:54,196 - INFO - Epoch 8, Step 50/2500 - Loss: 0.0027, Perplexity: 1.0027, LR: 7.76e-05, LM: 0.0021, Age: 0.59, Sex: 0.001
2025-10-24 06:41:06,900 - INFO - Epoch 8, Step 100/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 7.76e-05, LM: 0.0014, Age: 0.57, Sex: 0.001
2025-10-24 06:41:19,629 - INFO - Epoch 8, Step 150/2500 - Loss: 0.0081, Perplexity: 1.0101, LR: 7.75e-05, LM: 0.0075, Age: 0.59, Sex: 0.004
2025-10-24 06:41:32,508 - INFO - Epoch 8, Step 200/2500 - Loss: 0.0081, Perplexity: 1.0099, LR: 7.74e-05, LM: 0.0075, Age: 0.60, Sex: 0.005
2025-10-24 06:41:45,278 - INFO - Epoch 8, Step 250/2500 - Loss: 0.0078, Perplexity: 1.0094, LR: 7.74e-05, LM: 0.0072, Age: 0.59, Sex: 0.005
2025-10-24 06:41:57,957 - INFO - Epoch 8, Step 300/2500 - Loss: 0.0076, Perplexity: 1.0089, LR: 7.73e-05, LM: 0.0070, Age: 0.60, Sex: 0.005
2025-10-24 06:42:10,683 - INFO - Epoch 8, Step 350/2500 - Loss: 0.0072, Perplexity: 1.0084, LR: 7.72e-05, LM: 0.0066, Age: 0.61, Sex: 0.005
2025-10-24 06:42:23,414 - INFO - Epoch 8, Step 400/2500 - Loss: 0.0074, Perplexity: 1.0085, LR: 7.72e-05, LM: 0.0067, Age: 0.61, Sex: 0.007
2025-10-24 06:42:35,892 - INFO - Epoch 8, Step 450/2500 - Loss: 0.0071, Perplexity: 1.0081, LR: 7.71e-05, LM: 0.0065, Age: 0.61, Sex: 0.008
2025-10-24 06:42:48,576 - INFO - Epoch 8, Step 500/2500 - Loss: 0.0066, Perplexity: 1.0076, LR: 7.70e-05, LM: 0.0060, Age: 0.61, Sex: 0.008
2025-10-24 06:43:01,333 - INFO - Epoch 8, Step 550/2500 - Loss: 0.0083, Perplexity: 1.0097, LR: 7.70e-05, LM: 0.0077, Age: 0.60, Sex: 0.008
2025-10-24 06:43:13,977 - INFO - Epoch 8, Step 600/2500 - Loss: 0.0077, Perplexity: 1.0091, LR: 7.69e-05, LM: 0.0071, Age: 0.61, Sex: 0.008
2025-10-24 06:43:26,628 - INFO - Epoch 8, Step 650/2500 - Loss: 0.0080, Perplexity: 1.0092, LR: 7.68e-05, LM: 0.0073, Age: 0.60, Sex: 0.010
2025-10-24 06:43:39,289 - INFO - Epoch 8, Step 700/2500 - Loss: 0.0086, Perplexity: 1.0101, LR: 7.68e-05, LM: 0.0080, Age: 0.60, Sex: 0.010
2025-10-24 06:43:52,365 - INFO - Epoch 8, Step 750/2500 - Loss: 0.0092, Perplexity: 1.0112, LR: 7.67e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:44:05,028 - INFO - Epoch 8, Step 800/2500 - Loss: 0.0095, Perplexity: 1.0116, LR: 7.66e-05, LM: 0.0089, Age: 0.60, Sex: 0.010
2025-10-24 06:44:17,800 - INFO - Epoch 8, Step 850/2500 - Loss: 0.0097, Perplexity: 1.0118, LR: 7.66e-05, LM: 0.0091, Age: 0.60, Sex: 0.010
2025-10-24 06:44:30,485 - INFO - Epoch 8, Step 900/2500 - Loss: 0.0092, Perplexity: 1.0113, LR: 7.65e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:44:43,232 - INFO - Epoch 8, Step 950/2500 - Loss: 0.0088, Perplexity: 1.0107, LR: 7.64e-05, LM: 0.0082, Age: 0.60, Sex: 0.009
2025-10-24 06:44:55,864 - INFO - Epoch 8, Step 1000/2500 - Loss: 0.0094, Perplexity: 1.0114, LR: 7.64e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:45:08,584 - INFO - Epoch 8, Step 1050/2500 - Loss: 0.0092, Perplexity: 1.0111, LR: 7.63e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:45:21,532 - INFO - Epoch 8, Step 1100/2500 - Loss: 0.0091, Perplexity: 1.0109, LR: 7.62e-05, LM: 0.0084, Age: 0.60, Sex: 0.009
2025-10-24 06:45:33,946 - INFO - Epoch 8, Step 1150/2500 - Loss: 0.0089, Perplexity: 1.0107, LR: 7.61e-05, LM: 0.0083, Age: 0.60, Sex: 0.010
2025-10-24 06:45:46,769 - INFO - Epoch 8, Step 1200/2500 - Loss: 0.0087, Perplexity: 1.0104, LR: 7.61e-05, LM: 0.0081, Age: 0.60, Sex: 0.010
2025-10-24 06:45:59,561 - INFO - Epoch 8, Step 1250/2500 - Loss: 0.0088, Perplexity: 1.0105, LR: 7.60e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:46:12,671 - INFO - Epoch 8, Step 1300/2500 - Loss: 0.0090, Perplexity: 1.0108, LR: 7.59e-05, LM: 0.0084, Age: 0.59, Sex: 0.010
2025-10-24 06:46:24,959 - INFO - Epoch 8, Step 1350/2500 - Loss: 0.0089, Perplexity: 1.0106, LR: 7.59e-05, LM: 0.0083, Age: 0.59, Sex: 0.010
2025-10-24 06:46:37,648 - INFO - Epoch 8, Step 1400/2500 - Loss: 0.0088, Perplexity: 1.0104, LR: 7.58e-05, LM: 0.0082, Age: 0.59, Sex: 0.010
2025-10-24 06:46:50,185 - INFO - Epoch 8, Step 1450/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.57e-05, LM: 0.0082, Age: 0.59, Sex: 0.010
2025-10-24 06:47:02,875 - INFO - Epoch 8, Step 1500/2500 - Loss: 0.0087, Perplexity: 1.0103, LR: 7.57e-05, LM: 0.0081, Age: 0.59, Sex: 0.010
2025-10-24 06:47:15,525 - INFO - Epoch 8, Step 1550/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.56e-05, LM: 0.0081, Age: 0.60, Sex: 0.010
2025-10-24 06:47:28,202 - INFO - Epoch 8, Step 1600/2500 - Loss: 0.0086, Perplexity: 1.0101, LR: 7.55e-05, LM: 0.0080, Age: 0.60, Sex: 0.010
2025-10-24 06:47:40,896 - INFO - Epoch 8, Step 1650/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.55e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:47:53,496 - INFO - Epoch 8, Step 1700/2500 - Loss: 0.0091, Perplexity: 1.0108, LR: 7.54e-05, LM: 0.0085, Age: 0.60, Sex: 0.010
2025-10-24 06:48:06,250 - INFO - Epoch 8, Step 1750/2500 - Loss: 0.0090, Perplexity: 1.0106, LR: 7.53e-05, LM: 0.0084, Age: 0.60, Sex: 0.010
2025-10-24 06:48:19,121 - INFO - Epoch 8, Step 1800/2500 - Loss: 0.0090, Perplexity: 1.0106, LR: 7.53e-05, LM: 0.0084, Age: 0.60, Sex: 0.010
2025-10-24 06:48:31,537 - INFO - Epoch 8, Step 1850/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.52e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:48:44,289 - INFO - Epoch 8, Step 1900/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.51e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:48:56,876 - INFO - Epoch 8, Step 1950/2500 - Loss: 0.0087, Perplexity: 1.0101, LR: 7.51e-05, LM: 0.0080, Age: 0.60, Sex: 0.009
2025-10-24 06:49:09,630 - INFO - Epoch 8, Step 2000/2500 - Loss: 0.0085, Perplexity: 1.0099, LR: 7.50e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:49:22,483 - INFO - Epoch 8, Step 2050/2500 - Loss: 0.0084, Perplexity: 1.0098, LR: 7.49e-05, LM: 0.0078, Age: 0.60, Sex: 0.009
2025-10-24 06:49:34,990 - INFO - Epoch 8, Step 2100/2500 - Loss: 0.0083, Perplexity: 1.0097, LR: 7.49e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:49:47,569 - INFO - Epoch 8, Step 2150/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.48e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:00,168 - INFO - Epoch 8, Step 2200/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.47e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:13,242 - INFO - Epoch 8, Step 2250/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.47e-05, LM: 0.0076, Age: 0.60, Sex: 0.008
2025-10-24 06:50:26,024 - INFO - Epoch 8, Step 2300/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.46e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:38,800 - INFO - Epoch 8, Step 2350/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.45e-05, LM: 0.0076, Age: 0.60, Sex: 0.009
2025-10-24 06:50:51,478 - INFO - Epoch 8, Step 2400/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.45e-05, LM: 0.0076, Age: 0.60, Sex: 0.010
2025-10-24 06:51:04,093 - INFO - Epoch 8, Step 2450/2500 - Loss: 0.0082, Perplexity: 1.0094, LR: 7.44e-05, LM: 0.0076, Age: 0.60, Sex: 0.010
2025-10-24 06:51:16,601 - INFO - Epoch 8, Step 2500/2500 - Loss: 0.0081, Perplexity: 1.0093, LR: 7.43e-05, LM: 0.0074, Age: 0.60, Sex: 0.010
2025-10-24 06:51:16,602 - INFO - Epoch 8 Complete - Avg Loss: 0.0081, Avg Perplexity: 1.0093, LM: 0.0074, Age: 0.60, Sex: 0.010
2025-10-24 06:52:06,763 - INFO - Validation - Loss: 0.0010, Perplexity: 1.0011, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 06:52:06,766 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:52:11,720 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 06:52:11,721 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 06:52:11,722 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:52:20,443 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0163
2025-10-24 06:52:20,443 - INFO - Reconstruction Jaccard: 0.0163
2025-10-24 06:52:32,933 - INFO - Epoch 9, Step 50/2500 - Loss: 0.0023, Perplexity: 1.0023, LR: 7.43e-05, LM: 0.0016, Age: 0.60, Sex: 0.008
2025-10-24 06:52:45,417 - INFO - Epoch 9, Step 100/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 7.42e-05, LM: 0.0009, Age: 0.58, Sex: 0.005
2025-10-24 06:52:58,246 - INFO - Epoch 9, Step 150/2500 - Loss: 0.0052, Perplexity: 1.0058, LR: 7.41e-05, LM: 0.0047, Age: 0.58, Sex: 0.008
2025-10-24 06:53:10,951 - INFO - Epoch 9, Step 200/2500 - Loss: 0.0099, Perplexity: 1.0121, LR: 7.41e-05, LM: 0.0092, Age: 0.59, Sex: 0.014
2025-10-24 06:53:23,576 - INFO - Epoch 9, Step 250/2500 - Loss: 0.0097, Perplexity: 1.0119, LR: 7.40e-05, LM: 0.0091, Age: 0.58, Sex: 0.015
2025-10-24 06:53:36,095 - INFO - Epoch 9, Step 300/2500 - Loss: 0.0090, Perplexity: 1.0109, LR: 7.39e-05, LM: 0.0084, Age: 0.60, Sex: 0.014
2025-10-24 06:53:48,795 - INFO - Epoch 9, Step 350/2500 - Loss: 0.0079, Perplexity: 1.0095, LR: 7.39e-05, LM: 0.0073, Age: 0.59, Sex: 0.012
2025-10-24 06:54:01,676 - INFO - Epoch 9, Step 400/2500 - Loss: 0.0070, Perplexity: 1.0084, LR: 7.38e-05, LM: 0.0064, Age: 0.58, Sex: 0.011
2025-10-24 06:54:14,701 - INFO - Epoch 9, Step 450/2500 - Loss: 0.0065, Perplexity: 1.0078, LR: 7.37e-05, LM: 0.0059, Age: 0.59, Sex: 0.010
2025-10-24 06:54:27,365 - INFO - Epoch 9, Step 500/2500 - Loss: 0.0064, Perplexity: 1.0076, LR: 7.36e-05, LM: 0.0058, Age: 0.58, Sex: 0.010
2025-10-24 06:54:40,328 - INFO - Epoch 9, Step 550/2500 - Loss: 0.0073, Perplexity: 1.0085, LR: 7.36e-05, LM: 0.0067, Age: 0.59, Sex: 0.011
2025-10-24 06:54:52,814 - INFO - Epoch 9, Step 600/2500 - Loss: 0.0114, Perplexity: 1.0314, LR: 7.35e-05, LM: 0.0108, Age: 0.59, Sex: 0.011
2025-10-24 06:55:05,448 - INFO - Epoch 9, Step 650/2500 - Loss: 0.0117, Perplexity: 1.0303, LR: 7.34e-05, LM: 0.0111, Age: 0.59, Sex: 0.011
2025-10-24 06:55:17,892 - INFO - Epoch 9, Step 700/2500 - Loss: 0.0115, Perplexity: 1.0289, LR: 7.34e-05, LM: 0.0109, Age: 0.60, Sex: 0.011
2025-10-24 06:55:30,758 - INFO - Epoch 9, Step 750/2500 - Loss: 0.0111, Perplexity: 1.0273, LR: 7.33e-05, LM: 0.0105, Age: 0.60, Sex: 0.011
2025-10-24 06:55:43,175 - INFO - Epoch 9, Step 800/2500 - Loss: 0.0106, Perplexity: 1.0258, LR: 7.32e-05, LM: 0.0100, Age: 0.60, Sex: 0.011
2025-10-24 06:55:55,986 - INFO - Epoch 9, Step 850/2500 - Loss: 0.0105, Perplexity: 1.0249, LR: 7.32e-05, LM: 0.0099, Age: 0.61, Sex: 0.010
2025-10-24 06:56:08,550 - INFO - Epoch 9, Step 900/2500 - Loss: 0.0103, Perplexity: 1.0239, LR: 7.31e-05, LM: 0.0097, Age: 0.60, Sex: 0.010
2025-10-24 06:56:21,113 - INFO - Epoch 9, Step 950/2500 - Loss: 0.0101, Perplexity: 1.0230, LR: 7.30e-05, LM: 0.0095, Age: 0.60, Sex: 0.010
2025-10-24 06:56:33,935 - INFO - Epoch 9, Step 1000/2500 - Loss: 0.0097, Perplexity: 1.0219, LR: 7.30e-05, LM: 0.0091, Age: 0.60, Sex: 0.009
2025-10-24 06:56:46,562 - INFO - Epoch 9, Step 1050/2500 - Loss: 0.0097, Perplexity: 1.0214, LR: 7.29e-05, LM: 0.0091, Age: 0.60, Sex: 0.009
2025-10-24 06:56:59,362 - INFO - Epoch 9, Step 1100/2500 - Loss: 0.0094, Perplexity: 1.0206, LR: 7.28e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:57:11,858 - INFO - Epoch 9, Step 1150/2500 - Loss: 0.0095, Perplexity: 1.0203, LR: 7.28e-05, LM: 0.0089, Age: 0.60, Sex: 0.009
2025-10-24 06:57:24,362 - INFO - Epoch 9, Step 1200/2500 - Loss: 0.0094, Perplexity: 1.0197, LR: 7.27e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:57:37,383 - INFO - Epoch 9, Step 1250/2500 - Loss: 0.0096, Perplexity: 1.0195, LR: 7.26e-05, LM: 0.0090, Age: 0.60, Sex: 0.009
2025-10-24 06:57:50,166 - INFO - Epoch 9, Step 1300/2500 - Loss: 0.0093, Perplexity: 1.0189, LR: 7.26e-05, LM: 0.0087, Age: 0.60, Sex: 0.010
2025-10-24 06:58:03,073 - INFO - Epoch 9, Step 1350/2500 - Loss: 0.0091, Perplexity: 1.0183, LR: 7.25e-05, LM: 0.0085, Age: 0.60, Sex: 0.010
2025-10-24 06:58:15,831 - INFO - Epoch 9, Step 1400/2500 - Loss: 0.0088, Perplexity: 1.0177, LR: 7.24e-05, LM: 0.0082, Age: 0.60, Sex: 0.009
2025-10-24 06:58:28,683 - INFO - Epoch 9, Step 1450/2500 - Loss: 0.0085, Perplexity: 1.0171, LR: 7.24e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:58:40,917 - INFO - Epoch 9, Step 1500/2500 - Loss: 0.0088, Perplexity: 1.0172, LR: 7.23e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:58:53,173 - INFO - Epoch 9, Step 1550/2500 - Loss: 0.0086, Perplexity: 1.0167, LR: 7.22e-05, LM: 0.0080, Age: 0.60, Sex: 0.009
2025-10-24 06:59:05,903 - INFO - Epoch 9, Step 1600/2500 - Loss: 0.0085, Perplexity: 1.0163, LR: 7.22e-05, LM: 0.0079, Age: 0.60, Sex: 0.010
2025-10-24 06:59:18,748 - INFO - Epoch 9, Step 1650/2500 - Loss: 0.0085, Perplexity: 1.0162, LR: 7.21e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:59:31,610 - INFO - Epoch 9, Step 1700/2500 - Loss: 0.0083, Perplexity: 1.0158, LR: 7.20e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:59:43,982 - INFO - Epoch 9, Step 1750/2500 - Loss: 0.0082, Perplexity: 1.0154, LR: 7.20e-05, LM: 0.0075, Age: 0.60, Sex: 0.009
2025-10-24 06:59:56,682 - INFO - Epoch 9, Step 1800/2500 - Loss: 0.0080, Perplexity: 1.0150, LR: 7.19e-05, LM: 0.0073, Age: 0.60, Sex: 0.009
2025-10-24 07:00:09,350 - INFO - Epoch 9, Step 1850/2500 - Loss: 0.0078, Perplexity: 1.0146, LR: 7.18e-05, LM: 0.0071, Age: 0.60, Sex: 0.009
2025-10-24 07:00:22,068 - INFO - Epoch 9, Step 1900/2500 - Loss: 0.0076, Perplexity: 1.0143, LR: 7.18e-05, LM: 0.0070, Age: 0.60, Sex: 0.008
2025-10-24 07:00:34,722 - INFO - Epoch 9, Step 1950/2500 - Loss: 0.0074, Perplexity: 1.0139, LR: 7.17e-05, LM: 0.0068, Age: 0.59, Sex: 0.008
2025-10-24 07:00:47,172 - INFO - Epoch 9, Step 2000/2500 - Loss: 0.0073, Perplexity: 1.0136, LR: 7.16e-05, LM: 0.0067, Age: 0.59, Sex: 0.008
2025-10-24 07:00:59,608 - INFO - Epoch 9, Step 2050/2500 - Loss: 0.0072, Perplexity: 1.0134, LR: 7.16e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:01:11,890 - INFO - Epoch 9, Step 2100/2500 - Loss: 0.0072, Perplexity: 1.0132, LR: 7.15e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:01:24,498 - INFO - Epoch 9, Step 2150/2500 - Loss: 0.0071, Perplexity: 1.0130, LR: 7.14e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:01:37,078 - INFO - Epoch 9, Step 2200/2500 - Loss: 0.0071, Perplexity: 1.0129, LR: 7.14e-05, LM: 0.0065, Age: 0.59, Sex: 0.007
2025-10-24 07:01:49,737 - INFO - Epoch 9, Step 2250/2500 - Loss: 0.0071, Perplexity: 1.0127, LR: 7.13e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:02,503 - INFO - Epoch 9, Step 2300/2500 - Loss: 0.0072, Perplexity: 1.0127, LR: 7.12e-05, LM: 0.0066, Age: 0.59, Sex: 0.009
2025-10-24 07:02:15,371 - INFO - Epoch 9, Step 2350/2500 - Loss: 0.0071, Perplexity: 1.0126, LR: 7.11e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:27,656 - INFO - Epoch 9, Step 2400/2500 - Loss: 0.0072, Perplexity: 1.0125, LR: 7.11e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:02:40,331 - INFO - Epoch 9, Step 2450/2500 - Loss: 0.0071, Perplexity: 1.0124, LR: 7.10e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:53,392 - INFO - Epoch 9, Step 2500/2500 - Loss: 0.0070, Perplexity: 1.0122, LR: 7.09e-05, LM: 0.0064, Age: 0.59, Sex: 0.008
2025-10-24 07:02:53,393 - INFO - Epoch 9 Complete - Avg Loss: 0.0070, Avg Perplexity: 1.0122, LM: 0.0064, Age: 0.59, Sex: 0.008
2025-10-24 07:03:43,052 - INFO - Validation - Loss: 0.0033, Perplexity: 1.0035, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-24 07:03:43,054 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:03:47,887 - INFO - TPL computed on 500 samples: 1.0050
2025-10-24 07:03:47,887 - INFO - Temporal Perplexity (TPL): 1.0050
2025-10-24 07:03:47,888 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:03:57,228 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0215
2025-10-24 07:03:57,228 - INFO - Reconstruction Jaccard: 0.0215
2025-10-24 07:04:09,819 - INFO - Epoch 10, Step 50/2500 - Loss: 0.0070, Perplexity: 1.0073, LR: 7.09e-05, LM: 0.0065, Age: 0.54, Sex: 0.022
2025-10-24 07:04:22,321 - INFO - Epoch 10, Step 100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 7.08e-05, LM: 0.0035, Age: 0.54, Sex: 0.012
2025-10-24 07:04:34,766 - INFO - Epoch 10, Step 150/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 7.07e-05, LM: 0.0024, Age: 0.55, Sex: 0.008
2025-10-24 07:04:47,712 - INFO - Epoch 10, Step 200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 7.07e-05, LM: 0.0019, Age: 0.54, Sex: 0.006
2025-10-24 07:05:00,336 - INFO - Epoch 10, Step 250/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 7.06e-05, LM: 0.0019, Age: 0.55, Sex: 0.005
2025-10-24 07:05:13,003 - INFO - Epoch 10, Step 300/2500 - Loss: 0.0029, Perplexity: 1.0029, LR: 7.05e-05, LM: 0.0023, Age: 0.54, Sex: 0.005
2025-10-24 07:05:25,444 - INFO - Epoch 10, Step 350/2500 - Loss: 0.0041, Perplexity: 1.0046, LR: 7.05e-05, LM: 0.0035, Age: 0.55, Sex: 0.005
2025-10-24 07:05:37,906 - INFO - Epoch 10, Step 400/2500 - Loss: 0.0044, Perplexity: 1.0049, LR: 7.04e-05, LM: 0.0038, Age: 0.56, Sex: 0.005
2025-10-24 07:05:50,781 - INFO - Epoch 10, Step 450/2500 - Loss: 0.0042, Perplexity: 1.0046, LR: 7.03e-05, LM: 0.0036, Age: 0.57, Sex: 0.005
2025-10-24 07:06:03,134 - INFO - Epoch 10, Step 500/2500 - Loss: 0.0039, Perplexity: 1.0043, LR: 7.03e-05, LM: 0.0033, Age: 0.57, Sex: 0.005
2025-10-24 07:06:15,695 - INFO - Epoch 10, Step 550/2500 - Loss: 0.0039, Perplexity: 1.0042, LR: 7.02e-05, LM: 0.0033, Age: 0.57, Sex: 0.004
2025-10-24 07:06:28,323 - INFO - Epoch 10, Step 600/2500 - Loss: 0.0038, Perplexity: 1.0041, LR: 7.01e-05, LM: 0.0032, Age: 0.57, Sex: 0.005
2025-10-24 07:06:41,052 - INFO - Epoch 10, Step 650/2500 - Loss: 0.0040, Perplexity: 1.0044, LR: 7.01e-05, LM: 0.0034, Age: 0.57, Sex: 0.004
2025-10-24 07:06:53,553 - INFO - Epoch 10, Step 700/2500 - Loss: 0.0048, Perplexity: 1.0054, LR: 7.00e-05, LM: 0.0043, Age: 0.57, Sex: 0.004
2025-10-24 07:07:06,237 - INFO - Epoch 10, Step 750/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.99e-05, LM: 0.0049, Age: 0.57, Sex: 0.004
2025-10-24 07:07:19,153 - INFO - Epoch 10, Step 800/2500 - Loss: 0.0059, Perplexity: 1.0067, LR: 6.99e-05, LM: 0.0054, Age: 0.57, Sex: 0.005
2025-10-24 07:07:32,076 - INFO - Epoch 10, Step 850/2500 - Loss: 0.0061, Perplexity: 1.0069, LR: 6.98e-05, LM: 0.0056, Age: 0.57, Sex: 0.005
2025-10-24 07:07:44,759 - INFO - Epoch 10, Step 900/2500 - Loss: 0.0059, Perplexity: 1.0066, LR: 6.97e-05, LM: 0.0053, Age: 0.57, Sex: 0.004
2025-10-24 07:07:57,338 - INFO - Epoch 10, Step 950/2500 - Loss: 0.0058, Perplexity: 1.0065, LR: 6.97e-05, LM: 0.0052, Age: 0.57, Sex: 0.004
2025-10-24 07:08:10,273 - INFO - Epoch 10, Step 1000/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.96e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:08:22,596 - INFO - Epoch 10, Step 1050/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.95e-05, LM: 0.0048, Age: 0.57, Sex: 0.004
2025-10-24 07:08:35,455 - INFO - Epoch 10, Step 1100/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.95e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:08:48,009 - INFO - Epoch 10, Step 1150/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.94e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:09:00,319 - INFO - Epoch 10, Step 1200/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.93e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:09:13,297 - INFO - Epoch 10, Step 1250/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.93e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:09:25,908 - INFO - Epoch 10, Step 1300/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.92e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:09:38,494 - INFO - Epoch 10, Step 1350/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.91e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:09:50,980 - INFO - Epoch 10, Step 1400/2500 - Loss: 0.0058, Perplexity: 1.0064, LR: 6.91e-05, LM: 0.0052, Age: 0.57, Sex: 0.004
2025-10-24 07:10:03,740 - INFO - Epoch 10, Step 1450/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.90e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:10:16,191 - INFO - Epoch 10, Step 1500/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.89e-05, LM: 0.0049, Age: 0.57, Sex: 0.004
2025-10-24 07:10:29,177 - INFO - Epoch 10, Step 1550/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.89e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:10:41,847 - INFO - Epoch 10, Step 1600/2500 - Loss: 0.0060, Perplexity: 1.0067, LR: 6.88e-05, LM: 0.0054, Age: 0.57, Sex: 0.004
2025-10-24 07:10:54,691 - INFO - Epoch 10, Step 1650/2500 - Loss: 0.0058, Perplexity: 1.0065, LR: 6.87e-05, LM: 0.0053, Age: 0.57, Sex: 0.004
2025-10-24 07:11:07,357 - INFO - Epoch 10, Step 1700/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.86e-05, LM: 0.0051, Age: 0.57, Sex: 0.003
2025-10-24 07:11:19,990 - INFO - Epoch 10, Step 1750/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.86e-05, LM: 0.0050, Age: 0.57, Sex: 0.003
2025-10-24 07:11:32,873 - INFO - Epoch 10, Step 1800/2500 - Loss: 0.0054, Perplexity: 1.0061, LR: 6.85e-05, LM: 0.0049, Age: 0.57, Sex: 0.003
2025-10-24 07:11:45,272 - INFO - Epoch 10, Step 1850/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.84e-05, LM: 0.0048, Age: 0.56, Sex: 0.003
2025-10-24 07:11:58,271 - INFO - Epoch 10, Step 1900/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.84e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:12:11,278 - INFO - Epoch 10, Step 1950/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.83e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:12:24,155 - INFO - Epoch 10, Step 2000/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.82e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:12:36,856 - INFO - Epoch 10, Step 2050/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.82e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:12:49,057 - INFO - Epoch 10, Step 2100/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.81e-05, LM: 0.0052, Age: 0.56, Sex: 0.004
2025-10-24 07:13:01,524 - INFO - Epoch 10, Step 2150/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.80e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:13:14,053 - INFO - Epoch 10, Step 2200/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.80e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:13:26,865 - INFO - Epoch 10, Step 2250/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.79e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:13:39,439 - INFO - Epoch 10, Step 2300/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.78e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:13:52,159 - INFO - Epoch 10, Step 2350/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.78e-05, LM: 0.0048, Age: 0.56, Sex: 0.004
2025-10-24 07:14:05,079 - INFO - Epoch 10, Step 2400/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.77e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:17,629 - INFO - Epoch 10, Step 2450/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.76e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:30,570 - INFO - Epoch 10, Step 2500/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.76e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:30,572 - INFO - Epoch 10 Complete - Avg Loss: 0.0053, Avg Perplexity: 1.0059, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:15:20,448 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0008, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 07:15:20,450 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:15:25,333 - INFO - TPL computed on 500 samples: 1.0019
2025-10-24 07:15:25,333 - INFO - Temporal Perplexity (TPL): 1.0019
2025-10-24 07:15:25,334 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:15:34,367 - INFO - Reconstruction Jaccard computed on 117 visits: 0.0266
2025-10-24 07:15:34,367 - INFO - Reconstruction Jaccard: 0.0266
2025-10-24 07:15:36,829 - INFO - Checkpoint saved: epoch 10
2025-10-24 07:15:49,579 - INFO - Epoch 11, Step 50/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 6.75e-05, LM: 0.0011, Age: 0.59, Sex: 0.003
2025-10-24 07:16:02,416 - INFO - Epoch 11, Step 100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 6.74e-05, LM: 0.0035, Age: 0.55, Sex: 0.004
2025-10-24 07:16:15,300 - INFO - Epoch 11, Step 150/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.74e-05, LM: 0.0030, Age: 0.53, Sex: 0.003
2025-10-24 07:16:27,928 - INFO - Epoch 11, Step 200/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 6.73e-05, LM: 0.0024, Age: 0.55, Sex: 0.003
2025-10-24 07:16:40,533 - INFO - Epoch 11, Step 250/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.72e-05, LM: 0.0029, Age: 0.54, Sex: 0.002
2025-10-24 07:16:53,069 - INFO - Epoch 11, Step 300/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.72e-05, LM: 0.0030, Age: 0.54, Sex: 0.003
2025-10-24 07:17:05,493 - INFO - Epoch 11, Step 350/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 6.71e-05, LM: 0.0027, Age: 0.54, Sex: 0.003
2025-10-24 07:17:18,371 - INFO - Epoch 11, Step 400/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 6.70e-05, LM: 0.0026, Age: 0.54, Sex: 0.003
2025-10-24 07:17:30,951 - INFO - Epoch 11, Step 450/2500 - Loss: 0.0032, Perplexity: 1.0032, LR: 6.70e-05, LM: 0.0026, Age: 0.55, Sex: 0.002
2025-10-24 07:17:43,647 - INFO - Epoch 11, Step 500/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.69e-05, LM: 0.0030, Age: 0.55, Sex: 0.003
2025-10-24 07:17:56,267 - INFO - Epoch 11, Step 550/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.68e-05, LM: 0.0032, Age: 0.55, Sex: 0.003
2025-10-24 07:18:09,476 - INFO - Epoch 11, Step 600/2500 - Loss: 0.0039, Perplexity: 1.0040, LR: 6.68e-05, LM: 0.0033, Age: 0.55, Sex: 0.003
2025-10-24 07:18:22,372 - INFO - Epoch 11, Step 650/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.67e-05, LM: 0.0035, Age: 0.55, Sex: 0.004
2025-10-24 07:18:35,406 - INFO - Epoch 11, Step 700/2500 - Loss: 0.0045, Perplexity: 1.0048, LR: 6.66e-05, LM: 0.0039, Age: 0.55, Sex: 0.004
2025-10-24 07:18:48,256 - INFO - Epoch 11, Step 750/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.66e-05, LM: 0.0044, Age: 0.55, Sex: 0.004
2025-10-24 07:19:01,073 - INFO - Epoch 11, Step 800/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.65e-05, LM: 0.0042, Age: 0.55, Sex: 0.004
2025-10-24 07:19:13,667 - INFO - Epoch 11, Step 850/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.64e-05, LM: 0.0042, Age: 0.54, Sex: 0.004
2025-10-24 07:19:26,256 - INFO - Epoch 11, Step 900/2500 - Loss: 0.0048, Perplexity: 1.0052, LR: 6.64e-05, LM: 0.0042, Age: 0.54, Sex: 0.004
2025-10-24 07:19:38,734 - INFO - Epoch 11, Step 950/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.63e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:19:51,388 - INFO - Epoch 11, Step 1000/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.62e-05, LM: 0.0044, Age: 0.54, Sex: 0.005
2025-10-24 07:20:04,064 - INFO - Epoch 11, Step 1050/2500 - Loss: 0.0048, Perplexity: 1.0052, LR: 6.61e-05, LM: 0.0043, Age: 0.54, Sex: 0.005
2025-10-24 07:20:17,009 - INFO - Epoch 11, Step 1100/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.61e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:20:29,781 - INFO - Epoch 11, Step 1150/2500 - Loss: 0.0045, Perplexity: 1.0048, LR: 6.60e-05, LM: 0.0039, Age: 0.54, Sex: 0.005
2025-10-24 07:20:42,547 - INFO - Epoch 11, Step 1200/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.59e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:20:54,955 - INFO - Epoch 11, Step 1250/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.59e-05, LM: 0.0043, Age: 0.54, Sex: 0.004
2025-10-24 07:21:07,779 - INFO - Epoch 11, Step 1300/2500 - Loss: 0.0051, Perplexity: 1.0055, LR: 6.58e-05, LM: 0.0045, Age: 0.53, Sex: 0.005
2025-10-24 07:21:20,228 - INFO - Epoch 11, Step 1350/2500 - Loss: 0.0441, Perplexity: 1.6338, LR: 6.57e-05, LM: 0.0435, Age: 0.54, Sex: 0.010
2025-10-24 07:21:32,758 - INFO - Epoch 11, Step 1400/2500 - Loss: 0.0426, Perplexity: 1.6113, LR: 6.57e-05, LM: 0.0420, Age: 0.54, Sex: 0.011
2025-10-24 07:21:45,382 - INFO - Epoch 11, Step 1450/2500 - Loss: 0.0413, Perplexity: 1.5904, LR: 6.56e-05, LM: 0.0407, Age: 0.54, Sex: 0.011
2025-10-24 07:21:58,075 - INFO - Epoch 11, Step 1500/2500 - Loss: 0.0401, Perplexity: 1.5709, LR: 6.55e-05, LM: 0.0395, Age: 0.54, Sex: 0.010
2025-10-24 07:22:10,890 - INFO - Epoch 11, Step 1550/2500 - Loss: 0.0389, Perplexity: 1.5525, LR: 6.55e-05, LM: 0.0383, Age: 0.54, Sex: 0.010
2025-10-24 07:22:23,582 - INFO - Epoch 11, Step 1600/2500 - Loss: 0.0377, Perplexity: 1.5353, LR: 6.54e-05, LM: 0.0372, Age: 0.54, Sex: 0.010
2025-10-24 07:22:36,038 - INFO - Epoch 11, Step 1650/2500 - Loss: 0.0368, Perplexity: 1.5193, LR: 6.53e-05, LM: 0.0362, Age: 0.54, Sex: 0.010
2025-10-24 07:22:48,341 - INFO - Epoch 11, Step 1700/2500 - Loss: 0.0358, Perplexity: 1.5041, LR: 6.53e-05, LM: 0.0352, Age: 0.55, Sex: 0.010
2025-10-24 07:23:01,135 - INFO - Epoch 11, Step 1750/2500 - Loss: 0.0348, Perplexity: 1.4898, LR: 6.52e-05, LM: 0.0342, Age: 0.54, Sex: 0.010
2025-10-24 07:23:14,006 - INFO - Epoch 11, Step 1800/2500 - Loss: 0.0339, Perplexity: 1.4762, LR: 6.51e-05, LM: 0.0333, Age: 0.54, Sex: 0.010
2025-10-24 07:23:26,588 - INFO - Epoch 11, Step 1850/2500 - Loss: 0.0331, Perplexity: 1.4635, LR: 6.51e-05, LM: 0.0326, Age: 0.55, Sex: 0.009
2025-10-24 07:23:38,909 - INFO - Epoch 11, Step 1900/2500 - Loss: 0.0325, Perplexity: 1.4516, LR: 6.50e-05, LM: 0.0319, Age: 0.55, Sex: 0.009
2025-10-24 07:23:51,636 - INFO - Epoch 11, Step 1950/2500 - Loss: 0.0318, Perplexity: 1.4402, LR: 6.49e-05, LM: 0.0312, Age: 0.55, Sex: 0.009
2025-10-24 07:24:04,591 - INFO - Epoch 11, Step 2000/2500 - Loss: 0.0311, Perplexity: 1.4292, LR: 6.49e-05, LM: 0.0305, Age: 0.55, Sex: 0.009
2025-10-24 07:24:17,009 - INFO - Epoch 11, Step 2050/2500 - Loss: 0.0303, Perplexity: 1.4188, LR: 6.48e-05, LM: 0.0298, Age: 0.55, Sex: 0.009
2025-10-24 07:24:29,575 - INFO - Epoch 11, Step 2100/2500 - Loss: 0.0296, Perplexity: 1.4088, LR: 6.47e-05, LM: 0.0291, Age: 0.55, Sex: 0.009
2025-10-24 07:24:42,104 - INFO - Epoch 11, Step 2150/2500 - Loss: 0.0290, Perplexity: 1.3994, LR: 6.47e-05, LM: 0.0285, Age: 0.55, Sex: 0.008
2025-10-24 07:24:54,754 - INFO - Epoch 11, Step 2200/2500 - Loss: 0.0284, Perplexity: 1.3904, LR: 6.46e-05, LM: 0.0279, Age: 0.55, Sex: 0.008
2025-10-24 07:25:07,736 - INFO - Epoch 11, Step 2250/2500 - Loss: 0.0279, Perplexity: 1.3818, LR: 6.45e-05, LM: 0.0273, Age: 0.55, Sex: 0.008
2025-10-24 07:25:20,434 - INFO - Epoch 11, Step 2300/2500 - Loss: 0.0273, Perplexity: 1.3735, LR: 6.45e-05, LM: 0.0267, Age: 0.55, Sex: 0.008
2025-10-24 07:25:33,243 - INFO - Epoch 11, Step 2350/2500 - Loss: 0.0268, Perplexity: 1.3656, LR: 6.44e-05, LM: 0.0262, Age: 0.55, Sex: 0.008
2025-10-24 07:25:45,894 - INFO - Epoch 11, Step 2400/2500 - Loss: 0.0262, Perplexity: 1.3580, LR: 6.43e-05, LM: 0.0257, Age: 0.55, Sex: 0.008
2025-10-24 07:25:58,687 - INFO - Epoch 11, Step 2450/2500 - Loss: 0.0257, Perplexity: 1.3508, LR: 6.43e-05, LM: 0.0252, Age: 0.55, Sex: 0.008
2025-10-24 07:26:11,489 - INFO - Epoch 11, Step 2500/2500 - Loss: 0.0253, Perplexity: 1.3438, LR: 6.42e-05, LM: 0.0247, Age: 0.55, Sex: 0.008
2025-10-24 07:26:11,491 - INFO - Epoch 11 Complete - Avg Loss: 0.0253, Avg Perplexity: 1.3438, LM: 0.0247, Age: 0.55, Sex: 0.008
2025-10-24 07:27:01,214 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0009, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 07:27:01,217 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:27:06,065 - INFO - TPL computed on 500 samples: 1.0004
2025-10-24 07:27:06,066 - INFO - Temporal Perplexity (TPL): 1.0004
2025-10-24 07:27:06,067 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:27:15,890 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0144
2025-10-24 07:27:15,890 - INFO - Reconstruction Jaccard: 0.0144
2025-10-24 07:27:28,496 - INFO - Epoch 12, Step 50/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 6.41e-05, LM: 0.0003, Age: 0.52, Sex: 0.001
2025-10-24 07:27:41,353 - INFO - Epoch 12, Step 100/2500 - Loss: 0.0034, Perplexity: 1.0037, LR: 6.41e-05, LM: 0.0029, Age: 0.50, Sex: 0.004
2025-10-24 07:27:54,127 - INFO - Epoch 12, Step 150/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.40e-05, LM: 0.0050, Age: 0.52, Sex: 0.006
2025-10-24 07:28:06,721 - INFO - Epoch 12, Step 200/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.39e-05, LM: 0.0052, Age: 0.53, Sex: 0.004
2025-10-24 07:28:19,268 - INFO - Epoch 12, Step 250/2500 - Loss: 0.0051, Perplexity: 1.0056, LR: 6.39e-05, LM: 0.0046, Age: 0.54, Sex: 0.004
2025-10-24 07:28:32,386 - INFO - Epoch 12, Step 300/2500 - Loss: 0.0045, Perplexity: 1.0049, LR: 6.38e-05, LM: 0.0039, Age: 0.54, Sex: 0.004
2025-10-24 07:28:45,276 - INFO - Epoch 12, Step 350/2500 - Loss: 0.0040, Perplexity: 1.0044, LR: 6.37e-05, LM: 0.0035, Age: 0.54, Sex: 0.003
2025-10-24 07:28:57,712 - INFO - Epoch 12, Step 400/2500 - Loss: 0.0036, Perplexity: 1.0039, LR: 6.36e-05, LM: 0.0031, Age: 0.53, Sex: 0.003
2025-10-24 07:29:10,460 - INFO - Epoch 12, Step 450/2500 - Loss: 0.0038, Perplexity: 1.0041, LR: 6.36e-05, LM: 0.0032, Age: 0.53, Sex: 0.004
2025-10-24 07:29:23,203 - INFO - Epoch 12, Step 500/2500 - Loss: 0.0037, Perplexity: 1.0040, LR: 6.35e-05, LM: 0.0032, Age: 0.53, Sex: 0.004
2025-10-24 07:29:35,603 - INFO - Epoch 12, Step 550/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.34e-05, LM: 0.0037, Age: 0.53, Sex: 0.004
2025-10-24 07:29:48,412 - INFO - Epoch 12, Step 600/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.34e-05, LM: 0.0037, Age: 0.54, Sex: 0.004
2025-10-24 07:30:00,838 - INFO - Epoch 12, Step 650/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.33e-05, LM: 0.0036, Age: 0.54, Sex: 0.004
2025-10-24 07:30:13,580 - INFO - Epoch 12, Step 700/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.32e-05, LM: 0.0037, Age: 0.54, Sex: 0.003
2025-10-24 07:30:26,257 - INFO - Epoch 12, Step 750/2500 - Loss: 0.0042, Perplexity: 1.0044, LR: 6.32e-05, LM: 0.0037, Age: 0.54, Sex: 0.003
2025-10-24 07:30:38,874 - INFO - Epoch 12, Step 800/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.31e-05, LM: 0.0037, Age: 0.54, Sex: 0.004
2025-10-24 07:30:51,921 - INFO - Epoch 12, Step 850/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.30e-05, LM: 0.0035, Age: 0.54, Sex: 0.003
2025-10-24 07:31:04,662 - INFO - Epoch 12, Step 900/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.30e-05, LM: 0.0034, Age: 0.54, Sex: 0.003
2025-10-24 07:31:17,349 - INFO - Epoch 12, Step 950/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.29e-05, LM: 0.0033, Age: 0.54, Sex: 0.003
2025-10-24 07:31:30,208 - INFO - Epoch 12, Step 1000/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.28e-05, LM: 0.0032, Age: 0.54, Sex: 0.003
2025-10-24 07:31:42,938 - INFO - Epoch 12, Step 1050/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.28e-05, LM: 0.0032, Age: 0.54, Sex: 0.003
2025-10-24 07:31:55,901 - INFO - Epoch 12, Step 1100/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.27e-05, LM: 0.0031, Age: 0.54, Sex: 0.003
2025-10-24 07:32:08,775 - INFO - Epoch 12, Step 1150/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.26e-05, LM: 0.0030, Age: 0.54, Sex: 0.003
2025-10-24 07:32:21,734 - INFO - Epoch 12, Step 1200/2500 - Loss: 0.0034, Perplexity: 1.0036, LR: 6.26e-05, LM: 0.0028, Age: 0.54, Sex: 0.003
2025-10-24 07:32:34,522 - INFO - Epoch 12, Step 1250/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.25e-05, LM: 0.0029, Age: 0.54, Sex: 0.004
2025-10-24 07:32:47,108 - INFO - Epoch 12, Step 1300/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.24e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:32:59,536 - INFO - Epoch 12, Step 1350/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.24e-05, LM: 0.0033, Age: 0.54, Sex: 0.004
2025-10-24 07:33:12,280 - INFO - Epoch 12, Step 1400/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.23e-05, LM: 0.0032, Age: 0.54, Sex: 0.004
2025-10-24 07:33:24,943 - INFO - Epoch 12, Step 1450/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.22e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:33:37,597 - INFO - Epoch 12, Step 1500/2500 - Loss: 0.0037, Perplexity: 1.0038, LR: 6.22e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:33:50,306 - INFO - Epoch 12, Step 1550/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.21e-05, LM: 0.0032, Age: 0.54, Sex: 0.004
2025-10-24 07:34:03,149 - INFO - Epoch 12, Step 1600/2500 - Loss: 0.0039, Perplexity: 1.0041, LR: 6.20e-05, LM: 0.0033, Age: 0.54, Sex: 0.004
2025-10-24 07:34:15,692 - INFO - Epoch 12, Step 1650/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.20e-05, LM: 0.0035, Age: 0.54, Sex: 0.005
2025-10-24 07:34:28,354 - INFO - Epoch 12, Step 1700/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.19e-05, LM: 0.0035, Age: 0.54, Sex: 0.005
2025-10-24 07:34:40,771 - INFO - Epoch 12, Step 1750/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.18e-05, LM: 0.0035, Age: 0.54, Sex: 0.006
2025-10-24 07:34:53,775 - INFO - Epoch 12, Step 1800/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.18e-05, LM: 0.0035, Age: 0.54, Sex: 0.006
2025-10-24 07:35:06,016 - INFO - Epoch 12, Step 1850/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.17e-05, LM: 0.0035, Age: 0.55, Sex: 0.006
2025-10-24 07:35:18,719 - INFO - Epoch 12, Step 1900/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.16e-05, LM: 0.0035, Age: 0.55, Sex: 0.006
2025-10-24 07:35:31,576 - INFO - Epoch 12, Step 1950/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.16e-05, LM: 0.0034, Age: 0.55, Sex: 0.006
2025-10-24 07:35:44,100 - INFO - Epoch 12, Step 2000/2500 - Loss: 0.0039, Perplexity: 1.0041, LR: 6.15e-05, LM: 0.0034, Age: 0.54, Sex: 0.006
2025-10-24 07:35:56,709 - INFO - Epoch 12, Step 2050/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.14e-05, LM: 0.0033, Age: 0.54, Sex: 0.005
2025-10-24 07:36:09,636 - INFO - Epoch 12, Step 2100/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.14e-05, LM: 0.0032, Age: 0.55, Sex: 0.005
2025-10-24 07:36:22,251 - INFO - Epoch 12, Step 2150/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.13e-05, LM: 0.0032, Age: 0.55, Sex: 0.005
2025-10-24 07:36:34,843 - INFO - Epoch 12, Step 2200/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.12e-05, LM: 0.0031, Age: 0.54, Sex: 0.006
2025-10-24 07:36:47,334 - INFO - Epoch 12, Step 2250/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.11e-05, LM: 0.0031, Age: 0.55, Sex: 0.006
2025-10-24 07:36:59,854 - INFO - Epoch 12, Step 2300/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.11e-05, LM: 0.0031, Age: 0.54, Sex: 0.006
2025-10-24 07:37:12,363 - INFO - Epoch 12, Step 2350/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.10e-05, LM: 0.0030, Age: 0.54, Sex: 0.006
2025-10-24 07:37:24,886 - INFO - Epoch 12, Step 2400/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.09e-05, LM: 0.0030, Age: 0.55, Sex: 0.005
2025-10-24 07:37:37,302 - INFO - Epoch 12, Step 2450/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.09e-05, LM: 0.0029, Age: 0.54, Sex: 0.005
2025-10-24 07:37:50,124 - INFO - Epoch 12, Step 2500/2500 - Loss: 0.0034, Perplexity: 1.0036, LR: 6.08e-05, LM: 0.0028, Age: 0.54, Sex: 0.005
2025-10-24 07:37:50,126 - INFO - Epoch 12 Complete - Avg Loss: 0.0034, Avg Perplexity: 1.0036, LM: 0.0028, Age: 0.54, Sex: 0.005
2025-10-24 07:38:39,720 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 07:38:39,722 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:38:44,591 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 07:38:44,591 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 07:38:44,592 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:38:52,788 - INFO - Reconstruction Jaccard computed on 106 visits: 0.0013
2025-10-24 07:38:52,788 - INFO - Reconstruction Jaccard: 0.0013
2025-10-24 07:38:52,789 - INFO - New best model! Validation loss: 0.0001
2025-10-24 07:38:57,072 - INFO - Checkpoint saved: epoch 12
2025-10-24 07:39:10,060 - INFO - Epoch 13, Step 50/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 6.07e-05, LM: 0.0012, Age: 0.49, Sex: 0.000
2025-10-24 07:39:22,481 - INFO - Epoch 13, Step 100/2500 - Loss: 0.0036, Perplexity: 1.0039, LR: 6.07e-05, LM: 0.0031, Age: 0.52, Sex: 0.003
2025-10-24 07:39:34,829 - INFO - Epoch 13, Step 150/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.06e-05, LM: 0.0041, Age: 0.52, Sex: 0.006
2025-10-24 07:39:47,259 - INFO - Epoch 13, Step 200/2500 - Loss: 0.0039, Perplexity: 1.0042, LR: 6.05e-05, LM: 0.0034, Age: 0.52, Sex: 0.007
2025-10-24 07:39:59,732 - INFO - Epoch 13, Step 250/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.05e-05, LM: 0.0035, Age: 0.53, Sex: 0.006
2025-10-24 07:40:12,487 - INFO - Epoch 13, Step 300/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.04e-05, LM: 0.0032, Age: 0.51, Sex: 0.006
2025-10-24 07:40:25,130 - INFO - Epoch 13, Step 350/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.03e-05, LM: 0.0029, Age: 0.51, Sex: 0.005
2025-10-24 07:40:37,714 - INFO - Epoch 13, Step 400/2500 - Loss: 0.0033, Perplexity: 1.0035, LR: 6.03e-05, LM: 0.0028, Age: 0.51, Sex: 0.006
2025-10-24 07:40:50,232 - INFO - Epoch 13, Step 450/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.02e-05, LM: 0.0029, Age: 0.52, Sex: 0.005
2025-10-24 07:41:02,756 - INFO - Epoch 13, Step 500/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 6.01e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:15,686 - INFO - Epoch 13, Step 550/2500 - Loss: 0.0033, Perplexity: 1.0034, LR: 6.01e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:27,987 - INFO - Epoch 13, Step 600/2500 - Loss: 0.0031, Perplexity: 1.0032, LR: 6.00e-05, LM: 0.0025, Age: 0.52, Sex: 0.005
2025-10-24 07:41:40,463 - INFO - Epoch 13, Step 650/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 5.99e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:52,868 - INFO - Epoch 13, Step 700/2500 - Loss: 0.0033, Perplexity: 1.0035, LR: 5.99e-05, LM: 0.0028, Age: 0.52, Sex: 0.005
2025-10-24 07:42:05,361 - INFO - Epoch 13, Step 750/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.98e-05, LM: 0.0026, Age: 0.52, Sex: 0.004
2025-10-24 07:42:17,881 - INFO - Epoch 13, Step 800/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.97e-05, LM: 0.0026, Age: 0.52, Sex: 0.004
2025-10-24 07:42:30,720 - INFO - Epoch 13, Step 850/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.97e-05, LM: 0.0025, Age: 0.51, Sex: 0.004
2025-10-24 07:42:43,545 - INFO - Epoch 13, Step 900/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.96e-05, LM: 0.0024, Age: 0.51, Sex: 0.004
2025-10-24 07:42:56,420 - INFO - Epoch 13, Step 950/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.95e-05, LM: 0.0023, Age: 0.51, Sex: 0.004
2025-10-24 07:43:09,157 - INFO - Epoch 13, Step 1000/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.95e-05, LM: 0.0024, Age: 0.51, Sex: 0.004
2025-10-24 07:43:21,879 - INFO - Epoch 13, Step 1050/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.94e-05, LM: 0.0025, Age: 0.51, Sex: 0.004
2025-10-24 07:43:34,650 - INFO - Epoch 13, Step 1100/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.93e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:43:47,528 - INFO - Epoch 13, Step 1150/2500 - Loss: 0.0031, Perplexity: 1.0032, LR: 5.93e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:44:00,143 - INFO - Epoch 13, Step 1200/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.92e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:44:12,733 - INFO - Epoch 13, Step 1250/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.91e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:25,228 - INFO - Epoch 13, Step 1300/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.91e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:37,996 - INFO - Epoch 13, Step 1350/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.90e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:50,638 - INFO - Epoch 13, Step 1400/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.89e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:03,344 - INFO - Epoch 13, Step 1450/2500 - Loss: 0.0033, Perplexity: 1.0034, LR: 5.89e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:16,106 - INFO - Epoch 13, Step 1500/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 5.88e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:28,334 - INFO - Epoch 13, Step 1550/2500 - Loss: 0.0031, Perplexity: 1.0033, LR: 5.87e-05, LM: 0.0026, Age: 0.51, Sex: 0.004
2025-10-24 07:45:40,929 - INFO - Epoch 13, Step 1600/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.86e-05, LM: 0.0025, Age: 0.51, Sex: 0.005
2025-10-24 07:45:53,966 - INFO - Epoch 13, Step 1650/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.86e-05, LM: 0.0025, Age: 0.51, Sex: 0.005
2025-10-24 07:46:06,497 - INFO - Epoch 13, Step 1700/2500 - Loss: 0.0029, Perplexity: 1.0031, LR: 5.85e-05, LM: 0.0024, Age: 0.51, Sex: 0.005
2025-10-24 07:46:19,307 - INFO - Epoch 13, Step 1750/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.84e-05, LM: 0.0024, Age: 0.51, Sex: 0.005
2025-10-24 07:46:31,885 - INFO - Epoch 13, Step 1800/2500 - Loss: 0.0029, Perplexity: 1.0031, LR: 5.84e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:46:44,632 - INFO - Epoch 13, Step 1850/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.83e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:46:57,271 - INFO - Epoch 13, Step 1900/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.82e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:09,681 - INFO - Epoch 13, Step 1950/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.82e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:22,045 - INFO - Epoch 13, Step 2000/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.81e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:34,545 - INFO - Epoch 13, Step 2050/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.80e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:47:47,360 - INFO - Epoch 13, Step 2100/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.80e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:00,064 - INFO - Epoch 13, Step 2150/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.79e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:12,976 - INFO - Epoch 13, Step 2200/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.78e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:25,677 - INFO - Epoch 13, Step 2250/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.78e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:38,443 - INFO - Epoch 13, Step 2300/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.77e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:48:51,648 - INFO - Epoch 13, Step 2350/2500 - Loss: 0.0027, Perplexity: 1.0029, LR: 5.76e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:49:04,469 - INFO - Epoch 13, Step 2400/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.76e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:49:17,017 - INFO - Epoch 13, Step 2450/2500 - Loss: 0.0027, Perplexity: 1.0029, LR: 5.75e-05, LM: 0.0022, Age: 0.51, Sex: 0.005
2025-10-24 07:49:29,580 - INFO - Epoch 13, Step 2500/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.74e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:49:29,582 - INFO - Epoch 13 Complete - Avg Loss: 0.0029, Avg Perplexity: 1.0030, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:50:19,782 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0006, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 07:50:19,785 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:50:24,604 - INFO - TPL computed on 500 samples: 1.0012
2025-10-24 07:50:24,604 - INFO - Temporal Perplexity (TPL): 1.0012
2025-10-24 07:50:24,605 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:50:33,910 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0103
2025-10-24 07:50:33,910 - INFO - Reconstruction Jaccard: 0.0103
2025-10-24 07:50:46,539 - INFO - Epoch 14, Step 50/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 5.74e-05, LM: 0.0032, Age: 0.47, Sex: 0.002
2025-10-24 07:50:59,502 - INFO - Epoch 14, Step 100/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.73e-05, LM: 0.0016, Age: 0.49, Sex: 0.001
2025-10-24 07:51:12,311 - INFO - Epoch 14, Step 150/2500 - Loss: 0.0025, Perplexity: 1.0027, LR: 5.72e-05, LM: 0.0021, Age: 0.48, Sex: 0.001
2025-10-24 07:51:25,002 - INFO - Epoch 14, Step 200/2500 - Loss: 0.0023, Perplexity: 1.0024, LR: 5.72e-05, LM: 0.0018, Age: 0.48, Sex: 0.002
2025-10-24 07:51:38,049 - INFO - Epoch 14, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.71e-05, LM: 0.0015, Age: 0.49, Sex: 0.002
2025-10-24 07:51:50,084 - INFO - Epoch 14, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.70e-05, LM: 0.0017, Age: 0.49, Sex: 0.002
2025-10-24 07:52:02,992 - INFO - Epoch 14, Step 350/2500 - Loss: 0.0024, Perplexity: 1.0024, LR: 5.70e-05, LM: 0.0019, Age: 0.48, Sex: 0.002
2025-10-24 07:52:15,819 - INFO - Epoch 14, Step 400/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.69e-05, LM: 0.0023, Age: 0.49, Sex: 0.001
2025-10-24 07:52:28,448 - INFO - Epoch 14, Step 450/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.68e-05, LM: 0.0024, Age: 0.49, Sex: 0.001
2025-10-24 07:52:41,282 - INFO - Epoch 14, Step 500/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.68e-05, LM: 0.0023, Age: 0.50, Sex: 0.001
2025-10-24 07:52:53,907 - INFO - Epoch 14, Step 550/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.67e-05, LM: 0.0021, Age: 0.49, Sex: 0.001
2025-10-24 07:53:06,516 - INFO - Epoch 14, Step 600/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.66e-05, LM: 0.0021, Age: 0.51, Sex: 0.002
2025-10-24 07:53:19,051 - INFO - Epoch 14, Step 650/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.66e-05, LM: 0.0024, Age: 0.51, Sex: 0.002
2025-10-24 07:53:31,653 - INFO - Epoch 14, Step 700/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.65e-05, LM: 0.0022, Age: 0.51, Sex: 0.002
2025-10-24 07:53:44,877 - INFO - Epoch 14, Step 750/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.64e-05, LM: 0.0021, Age: 0.51, Sex: 0.002
2025-10-24 07:53:57,555 - INFO - Epoch 14, Step 800/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.64e-05, LM: 0.0022, Age: 0.51, Sex: 0.004
2025-10-24 07:54:10,259 - INFO - Epoch 14, Step 850/2500 - Loss: 0.0026, Perplexity: 1.0028, LR: 5.63e-05, LM: 0.0021, Age: 0.50, Sex: 0.004
2025-10-24 07:54:22,650 - INFO - Epoch 14, Step 900/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.62e-05, LM: 0.0021, Age: 0.50, Sex: 0.004
2025-10-24 07:54:34,985 - INFO - Epoch 14, Step 950/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.61e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 07:54:47,774 - INFO - Epoch 14, Step 1000/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.61e-05, LM: 0.0023, Age: 0.50, Sex: 0.004
2025-10-24 07:55:00,359 - INFO - Epoch 14, Step 1050/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.60e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 07:55:13,225 - INFO - Epoch 14, Step 1100/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.59e-05, LM: 0.0022, Age: 0.50, Sex: 0.003
2025-10-24 07:55:26,033 - INFO - Epoch 14, Step 1150/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.59e-05, LM: 0.0021, Age: 0.50, Sex: 0.003
2025-10-24 07:55:38,513 - INFO - Epoch 14, Step 1200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.58e-05, LM: 0.0020, Age: 0.50, Sex: 0.003
2025-10-24 07:55:51,094 - INFO - Epoch 14, Step 1250/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.57e-05, LM: 0.0020, Age: 0.50, Sex: 0.003
2025-10-24 07:56:03,706 - INFO - Epoch 14, Step 1300/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.57e-05, LM: 0.0021, Age: 0.50, Sex: 0.003
2025-10-24 07:56:16,654 - INFO - Epoch 14, Step 1350/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.56e-05, LM: 0.0021, Age: 0.50, Sex: 0.007
2025-10-24 07:56:29,341 - INFO - Epoch 14, Step 1400/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.55e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:56:41,845 - INFO - Epoch 14, Step 1450/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.55e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:56:54,214 - INFO - Epoch 14, Step 1500/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.54e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:57:06,788 - INFO - Epoch 14, Step 1550/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.53e-05, LM: 0.0020, Age: 0.50, Sex: 0.012
2025-10-24 07:57:19,313 - INFO - Epoch 14, Step 1600/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.53e-05, LM: 0.0020, Age: 0.50, Sex: 0.012
2025-10-24 07:57:31,977 - INFO - Epoch 14, Step 1650/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.52e-05, LM: 0.0020, Age: 0.50, Sex: 0.013
2025-10-24 07:57:44,694 - INFO - Epoch 14, Step 1700/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 5.51e-05, LM: 0.0019, Age: 0.50, Sex: 0.013
2025-10-24 07:57:57,080 - INFO - Epoch 14, Step 1750/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 5.51e-05, LM: 0.0019, Age: 0.50, Sex: 0.013
2025-10-24 07:58:09,935 - INFO - Epoch 14, Step 1800/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.50e-05, LM: 0.0020, Age: 0.50, Sex: 0.013
2025-10-24 07:58:22,601 - INFO - Epoch 14, Step 1850/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.49e-05, LM: 0.0020, Age: 0.50, Sex: 0.018
2025-10-24 07:58:35,570 - INFO - Epoch 14, Step 1900/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.49e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:58:48,733 - INFO - Epoch 14, Step 1950/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.48e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:59:01,154 - INFO - Epoch 14, Step 2000/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.47e-05, LM: 0.0021, Age: 0.50, Sex: 0.017
2025-10-24 07:59:13,619 - INFO - Epoch 14, Step 2050/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.47e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:59:26,330 - INFO - Epoch 14, Step 2100/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.46e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 07:59:39,187 - INFO - Epoch 14, Step 2150/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.45e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 07:59:51,743 - INFO - Epoch 14, Step 2200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.45e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 08:00:04,635 - INFO - Epoch 14, Step 2250/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.44e-05, LM: 0.0021, Age: 0.50, Sex: 0.016
2025-10-24 08:00:17,793 - INFO - Epoch 14, Step 2300/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.43e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 08:00:30,366 - INFO - Epoch 14, Step 2350/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.43e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:00:43,061 - INFO - Epoch 14, Step 2400/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.42e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:00:55,672 - INFO - Epoch 14, Step 2450/2500 - Loss: 0.0025, Perplexity: 1.0025, LR: 5.41e-05, LM: 0.0019, Age: 0.50, Sex: 0.015
2025-10-24 08:01:08,352 - INFO - Epoch 14, Step 2500/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.41e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:01:08,354 - INFO - Epoch 14 Complete - Avg Loss: 0.0025, Avg Perplexity: 1.0026, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:01:57,961 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:01:57,963 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:02:02,784 - INFO - TPL computed on 500 samples: 1.0013
2025-10-24 08:02:02,784 - INFO - Temporal Perplexity (TPL): 1.0013
2025-10-24 08:02:02,785 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:02:12,631 - INFO - Reconstruction Jaccard computed on 126 visits: 0.0000
2025-10-24 08:02:12,631 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 08:02:25,002 - INFO - Epoch 15, Step 50/2500 - Loss: 0.0012, Perplexity: 1.0012, LR: 5.40e-05, LM: 0.0007, Age: 0.48, Sex: 0.005
2025-10-24 08:02:37,812 - INFO - Epoch 15, Step 100/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.39e-05, LM: 0.0023, Age: 0.46, Sex: 0.012
2025-10-24 08:02:50,654 - INFO - Epoch 15, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.39e-05, LM: 0.0016, Age: 0.46, Sex: 0.009
2025-10-24 08:03:03,142 - INFO - Epoch 15, Step 200/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.38e-05, LM: 0.0013, Age: 0.46, Sex: 0.008
2025-10-24 08:03:16,122 - INFO - Epoch 15, Step 250/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.37e-05, LM: 0.0012, Age: 0.46, Sex: 0.009
2025-10-24 08:03:28,574 - INFO - Epoch 15, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.36e-05, LM: 0.0017, Age: 0.47, Sex: 0.009
2025-10-24 08:03:41,311 - INFO - Epoch 15, Step 350/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.36e-05, LM: 0.0015, Age: 0.47, Sex: 0.009
2025-10-24 08:03:53,692 - INFO - Epoch 15, Step 400/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.35e-05, LM: 0.0015, Age: 0.48, Sex: 0.010
2025-10-24 08:04:06,355 - INFO - Epoch 15, Step 450/2500 - Loss: 0.0019, Perplexity: 1.0020, LR: 5.34e-05, LM: 0.0015, Age: 0.48, Sex: 0.011
2025-10-24 08:04:18,889 - INFO - Epoch 15, Step 500/2500 - Loss: 0.0018, Perplexity: 1.0019, LR: 5.34e-05, LM: 0.0013, Age: 0.48, Sex: 0.010
2025-10-24 08:04:31,672 - INFO - Epoch 15, Step 550/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.33e-05, LM: 0.0012, Age: 0.47, Sex: 0.009
2025-10-24 08:04:44,258 - INFO - Epoch 15, Step 600/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 5.32e-05, LM: 0.0012, Age: 0.48, Sex: 0.009
2025-10-24 08:04:56,789 - INFO - Epoch 15, Step 650/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.32e-05, LM: 0.0012, Age: 0.47, Sex: 0.015
2025-10-24 08:05:09,753 - INFO - Epoch 15, Step 700/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 5.31e-05, LM: 0.0036, Age: 0.47, Sex: 0.021
2025-10-24 08:05:21,983 - INFO - Epoch 15, Step 750/2500 - Loss: 0.1663, Perplexity: 3.7070, LR: 5.30e-05, LM: 0.1657, Age: 0.49, Sex: 0.071
2025-10-24 08:05:34,584 - INFO - Epoch 15, Step 800/2500 - Loss: 0.1680, Perplexity: 3.5526, LR: 5.30e-05, LM: 0.1674, Age: 0.49, Sex: 0.094
2025-10-24 08:05:47,247 - INFO - Epoch 15, Step 850/2500 - Loss: 0.1673, Perplexity: 3.4146, LR: 5.29e-05, LM: 0.1667, Age: 0.50, Sex: 0.098
2025-10-24 08:06:00,059 - INFO - Epoch 15, Step 900/2500 - Loss: 0.1581, Perplexity: 3.2805, LR: 5.28e-05, LM: 0.1575, Age: 0.50, Sex: 0.093
2025-10-24 08:06:12,582 - INFO - Epoch 15, Step 950/2500 - Loss: 0.1501, Perplexity: 3.1609, LR: 5.28e-05, LM: 0.1495, Age: 0.50, Sex: 0.089
2025-10-24 08:06:25,074 - INFO - Epoch 15, Step 1000/2500 - Loss: 0.1427, Perplexity: 3.0529, LR: 5.27e-05, LM: 0.1421, Age: 0.50, Sex: 0.085
2025-10-24 08:06:37,465 - INFO - Epoch 15, Step 1050/2500 - Loss: 0.1359, Perplexity: 2.9552, LR: 5.26e-05, LM: 0.1354, Age: 0.50, Sex: 0.082
2025-10-24 08:06:49,866 - INFO - Epoch 15, Step 1100/2500 - Loss: 0.1298, Perplexity: 2.8664, LR: 5.26e-05, LM: 0.1292, Age: 0.50, Sex: 0.078
2025-10-24 08:07:02,349 - INFO - Epoch 15, Step 1150/2500 - Loss: 0.1242, Perplexity: 2.7853, LR: 5.25e-05, LM: 0.1237, Age: 0.50, Sex: 0.075
2025-10-24 08:07:15,098 - INFO - Epoch 15, Step 1200/2500 - Loss: 0.1191, Perplexity: 2.7109, LR: 5.24e-05, LM: 0.1185, Age: 0.50, Sex: 0.072
2025-10-24 08:07:27,699 - INFO - Epoch 15, Step 1250/2500 - Loss: 0.1143, Perplexity: 2.6425, LR: 5.24e-05, LM: 0.1138, Age: 0.50, Sex: 0.069
2025-10-24 08:07:40,360 - INFO - Epoch 15, Step 1300/2500 - Loss: 0.1100, Perplexity: 2.5794, LR: 5.23e-05, LM: 0.1094, Age: 0.50, Sex: 0.067
2025-10-24 08:07:52,894 - INFO - Epoch 15, Step 1350/2500 - Loss: 0.1060, Perplexity: 2.5209, LR: 5.22e-05, LM: 0.1054, Age: 0.50, Sex: 0.065
2025-10-24 08:08:05,185 - INFO - Epoch 15, Step 1400/2500 - Loss: 0.1022, Perplexity: 2.4667, LR: 5.22e-05, LM: 0.1017, Age: 0.50, Sex: 0.063
2025-10-24 08:08:17,820 - INFO - Epoch 15, Step 1450/2500 - Loss: 0.0987, Perplexity: 2.4161, LR: 5.21e-05, LM: 0.0982, Age: 0.50, Sex: 0.061
2025-10-24 08:08:30,145 - INFO - Epoch 15, Step 1500/2500 - Loss: 0.0955, Perplexity: 2.3690, LR: 5.20e-05, LM: 0.0950, Age: 0.50, Sex: 0.059
2025-10-24 08:08:43,107 - INFO - Epoch 15, Step 1550/2500 - Loss: 0.0926, Perplexity: 2.3250, LR: 5.20e-05, LM: 0.0920, Age: 0.50, Sex: 0.058
2025-10-24 08:08:56,217 - INFO - Epoch 15, Step 1600/2500 - Loss: 0.0897, Perplexity: 2.2836, LR: 5.19e-05, LM: 0.0892, Age: 0.50, Sex: 0.056
2025-10-24 08:09:09,273 - INFO - Epoch 15, Step 1650/2500 - Loss: 0.0870, Perplexity: 2.2447, LR: 5.18e-05, LM: 0.0865, Age: 0.50, Sex: 0.055
2025-10-24 08:09:22,074 - INFO - Epoch 15, Step 1700/2500 - Loss: 0.0845, Perplexity: 2.2082, LR: 5.18e-05, LM: 0.0839, Age: 0.50, Sex: 0.053
2025-10-24 08:09:34,733 - INFO - Epoch 15, Step 1750/2500 - Loss: 0.0821, Perplexity: 2.1737, LR: 5.17e-05, LM: 0.0816, Age: 0.50, Sex: 0.052
2025-10-24 08:09:47,163 - INFO - Epoch 15, Step 1800/2500 - Loss: 0.0799, Perplexity: 2.1411, LR: 5.16e-05, LM: 0.0794, Age: 0.50, Sex: 0.050
2025-10-24 08:09:59,802 - INFO - Epoch 15, Step 1850/2500 - Loss: 0.0778, Perplexity: 2.1103, LR: 5.16e-05, LM: 0.0772, Age: 0.50, Sex: 0.049
2025-10-24 08:10:12,540 - INFO - Epoch 15, Step 1900/2500 - Loss: 0.0757, Perplexity: 2.0811, LR: 5.15e-05, LM: 0.0752, Age: 0.50, Sex: 0.048
2025-10-24 08:10:25,392 - INFO - Epoch 15, Step 1950/2500 - Loss: 0.0738, Perplexity: 2.0534, LR: 5.14e-05, LM: 0.0733, Age: 0.50, Sex: 0.047
2025-10-24 08:10:38,018 - INFO - Epoch 15, Step 2000/2500 - Loss: 0.0720, Perplexity: 2.0271, LR: 5.14e-05, LM: 0.0714, Age: 0.50, Sex: 0.045
2025-10-24 08:10:50,745 - INFO - Epoch 15, Step 2050/2500 - Loss: 0.0703, Perplexity: 2.0021, LR: 5.13e-05, LM: 0.0697, Age: 0.50, Sex: 0.044
2025-10-24 08:11:03,759 - INFO - Epoch 15, Step 2100/2500 - Loss: 0.0686, Perplexity: 1.9783, LR: 5.12e-05, LM: 0.0681, Age: 0.50, Sex: 0.043
2025-10-24 08:11:16,687 - INFO - Epoch 15, Step 2150/2500 - Loss: 0.0670, Perplexity: 1.9555, LR: 5.11e-05, LM: 0.0665, Age: 0.50, Sex: 0.042
2025-10-24 08:11:29,109 - INFO - Epoch 15, Step 2200/2500 - Loss: 0.0656, Perplexity: 1.9338, LR: 5.11e-05, LM: 0.0650, Age: 0.50, Sex: 0.042
2025-10-24 08:11:41,876 - INFO - Epoch 15, Step 2250/2500 - Loss: 0.0641, Perplexity: 1.9131, LR: 5.10e-05, LM: 0.0636, Age: 0.50, Sex: 0.041
2025-10-24 08:11:54,335 - INFO - Epoch 15, Step 2300/2500 - Loss: 0.0627, Perplexity: 1.8933, LR: 5.09e-05, LM: 0.0622, Age: 0.50, Sex: 0.040
2025-10-24 08:12:07,307 - INFO - Epoch 15, Step 2350/2500 - Loss: 0.0614, Perplexity: 1.8743, LR: 5.09e-05, LM: 0.0609, Age: 0.50, Sex: 0.039
2025-10-24 08:12:19,882 - INFO - Epoch 15, Step 2400/2500 - Loss: 0.0602, Perplexity: 1.8561, LR: 5.08e-05, LM: 0.0596, Age: 0.49, Sex: 0.038
2025-10-24 08:12:32,778 - INFO - Epoch 15, Step 2450/2500 - Loss: 0.0589, Perplexity: 1.8386, LR: 5.07e-05, LM: 0.0584, Age: 0.49, Sex: 0.037
2025-10-24 08:12:45,692 - INFO - Epoch 15, Step 2500/2500 - Loss: 0.0578, Perplexity: 1.8219, LR: 5.07e-05, LM: 0.0573, Age: 0.50, Sex: 0.037
2025-10-24 08:12:45,694 - INFO - Epoch 15 Complete - Avg Loss: 0.0578, Avg Perplexity: 1.8219, LM: 0.0573, Age: 0.50, Sex: 0.037
2025-10-24 08:13:35,177 - INFO - Validation - Loss: 0.0022, Perplexity: 1.0023, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 08:13:35,179 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:13:40,002 - INFO - TPL computed on 500 samples: 1.0041
2025-10-24 08:13:40,003 - INFO - Temporal Perplexity (TPL): 1.0041
2025-10-24 08:13:40,004 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:13:43,902 - INFO - Reconstruction Jaccard computed on 129 visits: 0.0450
2025-10-24 08:13:43,903 - INFO - Reconstruction Jaccard: 0.0450
2025-10-24 08:13:46,245 - INFO - Checkpoint saved: epoch 15
2025-10-24 08:13:58,868 - INFO - Epoch 16, Step 50/2500 - Loss: 0.0042, Perplexity: 1.0044, LR: 5.06e-05, LM: 0.0038, Age: 0.44, Sex: 0.005
2025-10-24 08:14:11,518 - INFO - Epoch 16, Step 100/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.05e-05, LM: 0.0020, Age: 0.47, Sex: 0.003
2025-10-24 08:14:24,410 - INFO - Epoch 16, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.05e-05, LM: 0.0016, Age: 0.50, Sex: 0.002
2025-10-24 08:14:37,026 - INFO - Epoch 16, Step 200/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 5.04e-05, LM: 0.0015, Age: 0.49, Sex: 0.001
2025-10-24 08:14:49,590 - INFO - Epoch 16, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.03e-05, LM: 0.0015, Age: 0.49, Sex: 0.003
2025-10-24 08:15:02,211 - INFO - Epoch 16, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.03e-05, LM: 0.0017, Age: 0.48, Sex: 0.004
2025-10-24 08:15:14,642 - INFO - Epoch 16, Step 350/2500 - Loss: 0.0021, Perplexity: 1.0021, LR: 5.02e-05, LM: 0.0016, Age: 0.48, Sex: 0.003
2025-10-24 08:15:27,456 - INFO - Epoch 16, Step 400/2500 - Loss: 0.0019, Perplexity: 1.0020, LR: 5.01e-05, LM: 0.0015, Age: 0.48, Sex: 0.003
2025-10-24 08:15:39,932 - INFO - Epoch 16, Step 450/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 5.01e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:15:52,518 - INFO - Epoch 16, Step 500/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 5.00e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:16:05,287 - INFO - Epoch 16, Step 550/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.99e-05, LM: 0.0013, Age: 0.47, Sex: 0.003
2025-10-24 08:16:18,035 - INFO - Epoch 16, Step 600/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.99e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:16:30,963 - INFO - Epoch 16, Step 650/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.98e-05, LM: 0.0012, Age: 0.49, Sex: 0.003
2025-10-24 08:16:43,748 - INFO - Epoch 16, Step 700/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.97e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:16:56,496 - INFO - Epoch 16, Step 750/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.97e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:17:09,059 - INFO - Epoch 16, Step 800/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.96e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:17:21,534 - INFO - Epoch 16, Step 850/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.95e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:17:34,228 - INFO - Epoch 16, Step 900/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.95e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:17:46,907 - INFO - Epoch 16, Step 950/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.94e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:17:59,596 - INFO - Epoch 16, Step 1000/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.93e-05, LM: 0.0009, Age: 0.47, Sex: 0.002
2025-10-24 08:18:12,419 - INFO - Epoch 16, Step 1050/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.93e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:18:24,852 - INFO - Epoch 16, Step 1100/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.92e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:18:37,669 - INFO - Epoch 16, Step 1150/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.91e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:18:50,677 - INFO - Epoch 16, Step 1200/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.91e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:19:03,459 - INFO - Epoch 16, Step 1250/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.90e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:19:15,867 - INFO - Epoch 16, Step 1300/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.89e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:28,379 - INFO - Epoch 16, Step 1350/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.89e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:40,587 - INFO - Epoch 16, Step 1400/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.88e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:53,277 - INFO - Epoch 16, Step 1450/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.87e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:05,912 - INFO - Epoch 16, Step 1500/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.86e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:20:19,155 - INFO - Epoch 16, Step 1550/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.86e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:31,736 - INFO - Epoch 16, Step 1600/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.85e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:44,199 - INFO - Epoch 16, Step 1650/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.84e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:20:56,978 - INFO - Epoch 16, Step 1700/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.84e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:09,586 - INFO - Epoch 16, Step 1750/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.83e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:22,215 - INFO - Epoch 16, Step 1800/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.82e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:34,684 - INFO - Epoch 16, Step 1850/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.82e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:21:47,792 - INFO - Epoch 16, Step 1900/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.81e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:22:00,233 - INFO - Epoch 16, Step 1950/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.80e-05, LM: 0.0010, Age: 0.48, Sex: 0.004
2025-10-24 08:22:12,867 - INFO - Epoch 16, Step 2000/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.80e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:25,563 - INFO - Epoch 16, Step 2050/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.79e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:38,339 - INFO - Epoch 16, Step 2100/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.78e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:50,875 - INFO - Epoch 16, Step 2150/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.78e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:23:03,546 - INFO - Epoch 16, Step 2200/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.77e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:23:16,321 - INFO - Epoch 16, Step 2250/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.76e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:29,079 - INFO - Epoch 16, Step 2300/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.76e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:41,772 - INFO - Epoch 16, Step 2350/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.75e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:54,379 - INFO - Epoch 16, Step 2400/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.74e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:24:06,672 - INFO - Epoch 16, Step 2450/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.74e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:24:19,505 - INFO - Epoch 16, Step 2500/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.73e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:24:19,507 - INFO - Epoch 16 Complete - Avg Loss: 0.0014, Avg Perplexity: 1.0014, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:25:08,960 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0007, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 08:25:08,962 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:25:13,806 - INFO - TPL computed on 500 samples: 1.0020
2025-10-24 08:25:13,806 - INFO - Temporal Perplexity (TPL): 1.0020
2025-10-24 08:25:13,807 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:25:22,015 - INFO - Reconstruction Jaccard computed on 114 visits: 0.0000
2025-10-24 08:25:22,016 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 08:25:34,727 - INFO - Epoch 17, Step 50/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 4.72e-05, LM: 0.0002, Age: 0.46, Sex: 0.001
2025-10-24 08:25:47,352 - INFO - Epoch 17, Step 100/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 4.72e-05, LM: 0.0018, Age: 0.46, Sex: 0.001
2025-10-24 08:26:00,618 - INFO - Epoch 17, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 4.71e-05, LM: 0.0016, Age: 0.47, Sex: 0.001
2025-10-24 08:26:13,167 - INFO - Epoch 17, Step 200/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.70e-05, LM: 0.0019, Age: 0.49, Sex: 0.002
2025-10-24 08:26:25,957 - INFO - Epoch 17, Step 250/2500 - Loss: 0.0029, Perplexity: 1.0029, LR: 4.70e-05, LM: 0.0024, Age: 0.50, Sex: 0.002
2025-10-24 08:26:38,392 - INFO - Epoch 17, Step 300/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 4.69e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 08:26:50,987 - INFO - Epoch 17, Step 350/2500 - Loss: 0.0025, Perplexity: 1.0025, LR: 4.68e-05, LM: 0.0020, Age: 0.51, Sex: 0.004
2025-10-24 08:27:03,709 - INFO - Epoch 17, Step 400/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.68e-05, LM: 0.0019, Age: 0.51, Sex: 0.005
2025-10-24 08:27:16,103 - INFO - Epoch 17, Step 450/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.67e-05, LM: 0.0019, Age: 0.50, Sex: 0.004
2025-10-24 08:27:28,618 - INFO - Epoch 17, Step 500/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 4.66e-05, LM: 0.0017, Age: 0.50, Sex: 0.004
2025-10-24 08:27:41,460 - INFO - Epoch 17, Step 550/2500 - Loss: 0.0022, Perplexity: 1.0022, LR: 4.66e-05, LM: 0.0017, Age: 0.49, Sex: 0.004
2025-10-24 08:27:54,319 - INFO - Epoch 17, Step 600/2500 - Loss: 0.0022, Perplexity: 1.0022, LR: 4.65e-05, LM: 0.0017, Age: 0.49, Sex: 0.004
2025-10-24 08:28:07,025 - INFO - Epoch 17, Step 650/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.64e-05, LM: 0.0015, Age: 0.49, Sex: 0.004
2025-10-24 08:28:19,691 - INFO - Epoch 17, Step 700/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 4.64e-05, LM: 0.0015, Age: 0.49, Sex: 0.004
2025-10-24 08:28:32,246 - INFO - Epoch 17, Step 750/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.63e-05, LM: 0.0014, Age: 0.49, Sex: 0.003
2025-10-24 08:28:45,079 - INFO - Epoch 17, Step 800/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.62e-05, LM: 0.0013, Age: 0.49, Sex: 0.003
2025-10-24 08:28:57,895 - INFO - Epoch 17, Step 850/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.61e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:29:10,402 - INFO - Epoch 17, Step 900/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.61e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:22,880 - INFO - Epoch 17, Step 950/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.60e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:35,064 - INFO - Epoch 17, Step 1000/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.59e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:47,781 - INFO - Epoch 17, Step 1050/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.59e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:30:00,742 - INFO - Epoch 17, Step 1100/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.58e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:30:13,407 - INFO - Epoch 17, Step 1150/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.57e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:30:26,325 - INFO - Epoch 17, Step 1200/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.57e-05, LM: 0.0011, Age: 0.48, Sex: 0.002
2025-10-24 08:30:38,874 - INFO - Epoch 17, Step 1250/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.56e-05, LM: 0.0011, Age: 0.48, Sex: 0.002
2025-10-24 08:30:51,564 - INFO - Epoch 17, Step 1300/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.55e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:31:04,017 - INFO - Epoch 17, Step 1350/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.55e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:31:16,900 - INFO - Epoch 17, Step 1400/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.54e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:31:29,414 - INFO - Epoch 17, Step 1450/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.53e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:31:42,326 - INFO - Epoch 17, Step 1500/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.53e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:31:55,247 - INFO - Epoch 17, Step 1550/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.52e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:32:07,567 - INFO - Epoch 17, Step 1600/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.51e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:19,854 - INFO - Epoch 17, Step 1650/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.51e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:32,860 - INFO - Epoch 17, Step 1700/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.50e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:45,873 - INFO - Epoch 17, Step 1750/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.49e-05, LM: 0.0012, Age: 0.47, Sex: 0.003
2025-10-24 08:32:58,292 - INFO - Epoch 17, Step 1800/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.49e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:33:11,002 - INFO - Epoch 17, Step 1850/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.48e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:33:23,320 - INFO - Epoch 17, Step 1900/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.47e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:33:35,943 - INFO - Epoch 17, Step 1950/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.47e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:33:48,809 - INFO - Epoch 17, Step 2000/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.46e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:01,512 - INFO - Epoch 17, Step 2050/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.45e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:14,071 - INFO - Epoch 17, Step 2100/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.45e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:27,008 - INFO - Epoch 17, Step 2150/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.44e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:34:39,562 - INFO - Epoch 17, Step 2200/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.43e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:34:52,331 - INFO - Epoch 17, Step 2250/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.43e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:35:05,206 - INFO - Epoch 17, Step 2300/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.42e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:35:17,969 - INFO - Epoch 17, Step 2350/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.41e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:30,521 - INFO - Epoch 17, Step 2400/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.41e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:43,057 - INFO - Epoch 17, Step 2450/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.40e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:55,703 - INFO - Epoch 17, Step 2500/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.39e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:35:55,705 - INFO - Epoch 17 Complete - Avg Loss: 0.0015, Avg Perplexity: 1.0015, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:36:45,051 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:36:45,054 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:36:49,907 - INFO - TPL computed on 500 samples: 1.0011
2025-10-24 08:36:49,907 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-24 08:36:49,908 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:37:00,055 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0108
2025-10-24 08:37:00,056 - INFO - Reconstruction Jaccard: 0.0108
2025-10-24 08:37:00,056 - INFO - New best model! Validation loss: 0.0000
2025-10-24 08:37:04,731 - INFO - Checkpoint saved: epoch 17
2025-10-24 08:37:17,448 - INFO - Epoch 18, Step 50/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 4.39e-05, LM: 0.0000, Age: 0.43, Sex: 0.001
2025-10-24 08:37:30,295 - INFO - Epoch 18, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 4.38e-05, LM: 0.0003, Age: 0.48, Sex: 0.001
2025-10-24 08:37:43,024 - INFO - Epoch 18, Step 150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 4.37e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 08:37:55,789 - INFO - Epoch 18, Step 200/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.36e-05, LM: 0.0016, Age: 0.44, Sex: 0.001
2025-10-24 08:38:08,595 - INFO - Epoch 18, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.36e-05, LM: 0.0015, Age: 0.45, Sex: 0.002
2025-10-24 08:38:21,697 - INFO - Epoch 18, Step 300/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.35e-05, LM: 0.0014, Age: 0.44, Sex: 0.002
2025-10-24 08:38:34,324 - INFO - Epoch 18, Step 350/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.34e-05, LM: 0.0014, Age: 0.45, Sex: 0.002
2025-10-24 08:38:46,970 - INFO - Epoch 18, Step 400/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.34e-05, LM: 0.0013, Age: 0.45, Sex: 0.002
2025-10-24 08:39:00,290 - INFO - Epoch 18, Step 450/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.33e-05, LM: 0.0012, Age: 0.44, Sex: 0.002
2025-10-24 08:39:13,329 - INFO - Epoch 18, Step 500/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.32e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:25,573 - INFO - Epoch 18, Step 550/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.32e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:38,122 - INFO - Epoch 18, Step 600/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.31e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:50,677 - INFO - Epoch 18, Step 650/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.30e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:40:03,764 - INFO - Epoch 18, Step 700/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.30e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:40:16,425 - INFO - Epoch 18, Step 750/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.29e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:40:29,142 - INFO - Epoch 18, Step 800/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.28e-05, LM: 0.0010, Age: 0.45, Sex: 0.001
2025-10-24 08:40:41,645 - INFO - Epoch 18, Step 850/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.28e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 08:40:54,458 - INFO - Epoch 18, Step 900/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.27e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 08:41:07,291 - INFO - Epoch 18, Step 950/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.26e-05, LM: 0.0009, Age: 0.45, Sex: 0.002
2025-10-24 08:41:19,943 - INFO - Epoch 18, Step 1000/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.26e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:32,407 - INFO - Epoch 18, Step 1050/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.25e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:44,766 - INFO - Epoch 18, Step 1100/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.24e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:57,418 - INFO - Epoch 18, Step 1150/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.24e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:42:09,941 - INFO - Epoch 18, Step 1200/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.23e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:42:22,243 - INFO - Epoch 18, Step 1250/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.22e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:42:35,397 - INFO - Epoch 18, Step 1300/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.22e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:42:48,033 - INFO - Epoch 18, Step 1350/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.21e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:01,000 - INFO - Epoch 18, Step 1400/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.20e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:13,705 - INFO - Epoch 18, Step 1450/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.20e-05, LM: 0.0012, Age: 0.45, Sex: 0.003
2025-10-24 08:43:26,518 - INFO - Epoch 18, Step 1500/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.19e-05, LM: 0.0012, Age: 0.45, Sex: 0.003
2025-10-24 08:43:39,417 - INFO - Epoch 18, Step 1550/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.18e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:52,156 - INFO - Epoch 18, Step 1600/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.18e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:04,717 - INFO - Epoch 18, Step 1650/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.17e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:17,332 - INFO - Epoch 18, Step 1700/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.16e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:29,975 - INFO - Epoch 18, Step 1750/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.16e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:44:42,821 - INFO - Epoch 18, Step 1800/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.15e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:44:55,712 - INFO - Epoch 18, Step 1850/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.14e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:45:08,585 - INFO - Epoch 18, Step 1900/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.14e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:45:21,281 - INFO - Epoch 18, Step 1950/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.13e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:45:33,973 - INFO - Epoch 18, Step 2000/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.12e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:45:46,569 - INFO - Epoch 18, Step 2050/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.11e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:45:59,009 - INFO - Epoch 18, Step 2100/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.11e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:46:11,667 - INFO - Epoch 18, Step 2150/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.10e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:46:24,192 - INFO - Epoch 18, Step 2200/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.09e-05, LM: 0.0010, Age: 0.46, Sex: 0.002
2025-10-24 08:46:36,792 - INFO - Epoch 18, Step 2250/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.09e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:46:49,350 - INFO - Epoch 18, Step 2300/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.08e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:02,107 - INFO - Epoch 18, Step 2350/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.07e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:14,846 - INFO - Epoch 18, Step 2400/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.07e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:27,439 - INFO - Epoch 18, Step 2450/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.06e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:39,950 - INFO - Epoch 18, Step 2500/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.05e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:39,952 - INFO - Epoch 18 Complete - Avg Loss: 0.0013, Avg Perplexity: 1.0014, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:48:29,539 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:48:29,542 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:48:34,413 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 08:48:34,413 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 08:48:34,414 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:48:44,597 - INFO - Reconstruction Jaccard computed on 131 visits: 0.0119
2025-10-24 08:48:44,597 - INFO - Reconstruction Jaccard: 0.0119
2025-10-24 08:48:44,597 - INFO - New best model! Validation loss: 0.0000
2025-10-24 08:48:49,189 - INFO - Checkpoint saved: epoch 18
2025-10-24 08:49:01,899 - INFO - Epoch 19, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 4.05e-05, LM: 0.0000, Age: 0.42, Sex: 0.000
2025-10-24 08:49:14,533 - INFO - Epoch 19, Step 100/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.04e-05, LM: 0.0006, Age: 0.45, Sex: 0.002
2025-10-24 08:49:27,102 - INFO - Epoch 19, Step 150/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.03e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:49:39,881 - INFO - Epoch 19, Step 200/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.03e-05, LM: 0.0009, Age: 0.43, Sex: 0.003
2025-10-24 08:49:52,533 - INFO - Epoch 19, Step 250/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.02e-05, LM: 0.0007, Age: 0.42, Sex: 0.002
2025-10-24 08:50:05,396 - INFO - Epoch 19, Step 300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 4.01e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:50:18,035 - INFO - Epoch 19, Step 350/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 4.01e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:50:30,965 - INFO - Epoch 19, Step 400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 4.00e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:50:43,495 - INFO - Epoch 19, Step 450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.99e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:50:56,127 - INFO - Epoch 19, Step 500/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.99e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:51:08,847 - INFO - Epoch 19, Step 550/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.98e-05, LM: 0.0005, Age: 0.42, Sex: 0.001
2025-10-24 08:51:21,848 - INFO - Epoch 19, Step 600/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.97e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:51:34,707 - INFO - Epoch 19, Step 650/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.97e-05, LM: 0.0004, Age: 0.42, Sex: 0.001
2025-10-24 08:51:47,573 - INFO - Epoch 19, Step 700/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.96e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:52:00,535 - INFO - Epoch 19, Step 750/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.95e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:13,202 - INFO - Epoch 19, Step 800/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.95e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:25,842 - INFO - Epoch 19, Step 850/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.94e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:38,510 - INFO - Epoch 19, Step 900/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.93e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:52:51,125 - INFO - Epoch 19, Step 950/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.93e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:53:04,051 - INFO - Epoch 19, Step 1000/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.92e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:53:16,590 - INFO - Epoch 19, Step 1050/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.91e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:53:28,961 - INFO - Epoch 19, Step 1100/2500 - Loss: 0.0010, Perplexity: 1.0011, LR: 3.91e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:53:41,465 - INFO - Epoch 19, Step 1150/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.90e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:53:54,064 - INFO - Epoch 19, Step 1200/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.89e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:07,048 - INFO - Epoch 19, Step 1250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.89e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:19,803 - INFO - Epoch 19, Step 1300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.88e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:31,876 - INFO - Epoch 19, Step 1350/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.87e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:54:44,791 - INFO - Epoch 19, Step 1400/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.86e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:54:57,910 - INFO - Epoch 19, Step 1450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.86e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:10,699 - INFO - Epoch 19, Step 1500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.85e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:23,113 - INFO - Epoch 19, Step 1550/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.84e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:35,796 - INFO - Epoch 19, Step 1600/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.84e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:48,731 - INFO - Epoch 19, Step 1650/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.83e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:01,734 - INFO - Epoch 19, Step 1700/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.82e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:14,985 - INFO - Epoch 19, Step 1750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.82e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:27,769 - INFO - Epoch 19, Step 1800/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.81e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:40,531 - INFO - Epoch 19, Step 1850/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.80e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:53,387 - INFO - Epoch 19, Step 1900/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.80e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:06,144 - INFO - Epoch 19, Step 1950/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.79e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:18,751 - INFO - Epoch 19, Step 2000/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.78e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:31,713 - INFO - Epoch 19, Step 2050/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.78e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:44,296 - INFO - Epoch 19, Step 2100/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.77e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:57,010 - INFO - Epoch 19, Step 2150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.76e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:09,221 - INFO - Epoch 19, Step 2200/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.76e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:58:21,898 - INFO - Epoch 19, Step 2250/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.75e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:34,163 - INFO - Epoch 19, Step 2300/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.74e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:46,501 - INFO - Epoch 19, Step 2350/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.74e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:59,390 - INFO - Epoch 19, Step 2400/2500 - Loss: 0.0010, Perplexity: 1.0011, LR: 3.73e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:11,602 - INFO - Epoch 19, Step 2450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.72e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:24,379 - INFO - Epoch 19, Step 2500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.72e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:24,380 - INFO - Epoch 19 Complete - Avg Loss: 0.0010, Avg Perplexity: 1.0010, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 09:00:14,623 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:00:14,626 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:00:19,479 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 09:00:19,479 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 09:00:19,480 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:00:29,327 - INFO - Reconstruction Jaccard computed on 125 visits: 0.0117
2025-10-24 09:00:29,327 - INFO - Reconstruction Jaccard: 0.0117
2025-10-24 09:00:29,327 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:00:33,663 - INFO - Checkpoint saved: epoch 19
2025-10-24 09:00:46,518 - INFO - Epoch 20, Step 50/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.71e-05, LM: 0.0005, Age: 0.42, Sex: 0.000
2025-10-24 09:00:59,291 - INFO - Epoch 20, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.70e-05, LM: 0.0004, Age: 0.45, Sex: 0.001
2025-10-24 09:01:11,880 - INFO - Epoch 20, Step 150/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 3.70e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 09:01:24,028 - INFO - Epoch 20, Step 200/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.69e-05, LM: 0.0007, Age: 0.45, Sex: 0.001
2025-10-24 09:01:36,597 - INFO - Epoch 20, Step 250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.68e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:01:49,228 - INFO - Epoch 20, Step 300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.68e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:02:01,822 - INFO - Epoch 20, Step 350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.67e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:14,409 - INFO - Epoch 20, Step 400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.66e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:27,052 - INFO - Epoch 20, Step 450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.66e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:02:39,820 - INFO - Epoch 20, Step 500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.65e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:52,629 - INFO - Epoch 20, Step 550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.64e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:03:05,014 - INFO - Epoch 20, Step 600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.64e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:03:17,492 - INFO - Epoch 20, Step 650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.63e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:30,140 - INFO - Epoch 20, Step 700/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.62e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:42,900 - INFO - Epoch 20, Step 750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.61e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:55,614 - INFO - Epoch 20, Step 800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.61e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:04:08,402 - INFO - Epoch 20, Step 850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.60e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:04:20,819 - INFO - Epoch 20, Step 900/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.59e-05, LM: 0.0005, Age: 0.43, Sex: 0.001
2025-10-24 09:04:33,641 - INFO - Epoch 20, Step 950/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.59e-05, LM: 0.0005, Age: 0.43, Sex: 0.001
2025-10-24 09:04:46,385 - INFO - Epoch 20, Step 1000/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.58e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:04:59,458 - INFO - Epoch 20, Step 1050/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.57e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:11,754 - INFO - Epoch 20, Step 1100/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.57e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:24,541 - INFO - Epoch 20, Step 1150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.56e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:05:37,115 - INFO - Epoch 20, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.55e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:49,685 - INFO - Epoch 20, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.55e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:06:02,122 - INFO - Epoch 20, Step 1300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.54e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:06:15,195 - INFO - Epoch 20, Step 1350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.53e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:27,355 - INFO - Epoch 20, Step 1400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.53e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:39,908 - INFO - Epoch 20, Step 1450/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.52e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:52,205 - INFO - Epoch 20, Step 1500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.51e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:04,510 - INFO - Epoch 20, Step 1550/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.51e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:17,521 - INFO - Epoch 20, Step 1600/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.50e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:30,266 - INFO - Epoch 20, Step 1650/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.49e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:42,714 - INFO - Epoch 20, Step 1700/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.49e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:55,532 - INFO - Epoch 20, Step 1750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.48e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:08,649 - INFO - Epoch 20, Step 1800/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.47e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:21,133 - INFO - Epoch 20, Step 1850/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.47e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:33,711 - INFO - Epoch 20, Step 1900/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.46e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:08:46,592 - INFO - Epoch 20, Step 1950/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.45e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:08:59,458 - INFO - Epoch 20, Step 2000/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.45e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:09:11,822 - INFO - Epoch 20, Step 2050/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.44e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:09:24,586 - INFO - Epoch 20, Step 2100/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.43e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:09:37,347 - INFO - Epoch 20, Step 2150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.43e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:09:50,216 - INFO - Epoch 20, Step 2200/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.42e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:02,840 - INFO - Epoch 20, Step 2250/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.41e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:15,888 - INFO - Epoch 20, Step 2300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.41e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:28,255 - INFO - Epoch 20, Step 2350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.40e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:41,275 - INFO - Epoch 20, Step 2400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.39e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:10:53,937 - INFO - Epoch 20, Step 2450/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.39e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:06,635 - INFO - Epoch 20, Step 2500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.38e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:06,636 - INFO - Epoch 20 Complete - Avg Loss: 0.0009, Avg Perplexity: 1.0009, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:56,396 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:11:56,398 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:12:01,248 - INFO - TPL computed on 500 samples: 1.0017
2025-10-24 09:12:01,248 - INFO - Temporal Perplexity (TPL): 1.0017
2025-10-24 09:12:01,249 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:12:13,761 - INFO - Reconstruction Jaccard computed on 138 visits: 0.0020
2025-10-24 09:12:13,761 - INFO - Reconstruction Jaccard: 0.0020
2025-10-24 09:12:16,166 - INFO - Checkpoint saved: epoch 20
2025-10-24 09:12:28,878 - INFO - Epoch 21, Step 50/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 3.37e-05, LM: 0.0010, Age: 0.38, Sex: 0.002
2025-10-24 09:12:41,506 - INFO - Epoch 21, Step 100/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 3.36e-05, LM: 0.0009, Age: 0.40, Sex: 0.003
2025-10-24 09:12:54,002 - INFO - Epoch 21, Step 150/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 3.36e-05, LM: 0.0009, Age: 0.41, Sex: 0.003
2025-10-24 09:13:06,867 - INFO - Epoch 21, Step 200/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.35e-05, LM: 0.0007, Age: 0.41, Sex: 0.003
2025-10-24 09:13:19,559 - INFO - Epoch 21, Step 250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.34e-05, LM: 0.0006, Age: 0.41, Sex: 0.002
2025-10-24 09:13:31,911 - INFO - Epoch 21, Step 300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.34e-05, LM: 0.0005, Age: 0.40, Sex: 0.002
2025-10-24 09:13:44,740 - INFO - Epoch 21, Step 350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.33e-05, LM: 0.0004, Age: 0.40, Sex: 0.002
2025-10-24 09:13:57,369 - INFO - Epoch 21, Step 400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.32e-05, LM: 0.0004, Age: 0.39, Sex: 0.002
2025-10-24 09:14:10,230 - INFO - Epoch 21, Step 450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.32e-05, LM: 0.0004, Age: 0.39, Sex: 0.002
2025-10-24 09:14:23,037 - INFO - Epoch 21, Step 500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.31e-05, LM: 0.0003, Age: 0.40, Sex: 0.002
2025-10-24 09:14:35,296 - INFO - Epoch 21, Step 550/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.30e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:14:47,938 - INFO - Epoch 21, Step 600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.30e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:00,810 - INFO - Epoch 21, Step 650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.29e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:13,636 - INFO - Epoch 21, Step 700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.28e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:26,434 - INFO - Epoch 21, Step 750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.28e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:15:39,234 - INFO - Epoch 21, Step 800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.27e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:15:52,002 - INFO - Epoch 21, Step 850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.26e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:16:04,920 - INFO - Epoch 21, Step 900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.26e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:16:17,406 - INFO - Epoch 21, Step 950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.25e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:16:29,901 - INFO - Epoch 21, Step 1000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.24e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:16:42,231 - INFO - Epoch 21, Step 1050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.24e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:16:55,046 - INFO - Epoch 21, Step 1100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.23e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:17:08,164 - INFO - Epoch 21, Step 1150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.22e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:17:20,856 - INFO - Epoch 21, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.22e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:17:33,498 - INFO - Epoch 21, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.21e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:17:46,181 - INFO - Epoch 21, Step 1300/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.20e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:17:59,179 - INFO - Epoch 21, Step 1350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.20e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:18:11,453 - INFO - Epoch 21, Step 1400/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.19e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:18:24,109 - INFO - Epoch 21, Step 1450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.18e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:18:36,899 - INFO - Epoch 21, Step 1500/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.18e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:18:49,542 - INFO - Epoch 21, Step 1550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.17e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:02,148 - INFO - Epoch 21, Step 1600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.16e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:15,138 - INFO - Epoch 21, Step 1650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.16e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:28,138 - INFO - Epoch 21, Step 1700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.15e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:19:40,861 - INFO - Epoch 21, Step 1750/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.14e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:19:53,588 - INFO - Epoch 21, Step 1800/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.14e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:06,661 - INFO - Epoch 21, Step 1850/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.13e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:19,442 - INFO - Epoch 21, Step 1900/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.12e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:32,151 - INFO - Epoch 21, Step 1950/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.11e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:44,437 - INFO - Epoch 21, Step 2000/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.11e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:57,689 - INFO - Epoch 21, Step 2050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.10e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:10,237 - INFO - Epoch 21, Step 2100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.09e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:22,802 - INFO - Epoch 21, Step 2150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.09e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:35,625 - INFO - Epoch 21, Step 2200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.08e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:48,306 - INFO - Epoch 21, Step 2250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.07e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:00,688 - INFO - Epoch 21, Step 2300/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.07e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:13,296 - INFO - Epoch 21, Step 2350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.06e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:25,872 - INFO - Epoch 21, Step 2400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.05e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:38,603 - INFO - Epoch 21, Step 2450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.05e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:51,248 - INFO - Epoch 21, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.04e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:51,250 - INFO - Epoch 21 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:23:40,972 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:23:40,974 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:23:45,828 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 09:23:45,829 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 09:23:45,830 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:23:55,936 - INFO - Reconstruction Jaccard computed on 132 visits: 0.0000
2025-10-24 09:23:55,936 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 09:23:55,936 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:24:00,238 - INFO - Checkpoint saved: epoch 21
2025-10-24 09:24:12,996 - INFO - Epoch 22, Step 50/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.03e-05, LM: 0.0003, Age: 0.35, Sex: 0.001
2025-10-24 09:24:25,323 - INFO - Epoch 22, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.03e-05, LM: 0.0004, Age: 0.39, Sex: 0.001
2025-10-24 09:24:37,939 - INFO - Epoch 22, Step 150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.02e-05, LM: 0.0002, Age: 0.40, Sex: 0.001
2025-10-24 09:24:50,591 - INFO - Epoch 22, Step 200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.01e-05, LM: 0.0002, Age: 0.40, Sex: 0.001
2025-10-24 09:25:03,417 - INFO - Epoch 22, Step 250/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.01e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:25:16,015 - INFO - Epoch 22, Step 300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.00e-05, LM: 0.0006, Age: 0.39, Sex: 0.001
2025-10-24 09:25:28,800 - INFO - Epoch 22, Step 350/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.99e-05, LM: 0.0005, Age: 0.39, Sex: 0.001
2025-10-24 09:25:41,713 - INFO - Epoch 22, Step 400/2500 - Loss: 0.0012, Perplexity: 1.0012, LR: 2.99e-05, LM: 0.0008, Age: 0.39, Sex: 0.001
2025-10-24 09:25:54,280 - INFO - Epoch 22, Step 450/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 2.98e-05, LM: 0.0007, Age: 0.40, Sex: 0.001
2025-10-24 09:26:07,068 - INFO - Epoch 22, Step 500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.97e-05, LM: 0.0006, Age: 0.40, Sex: 0.001
2025-10-24 09:26:20,103 - INFO - Epoch 22, Step 550/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.97e-05, LM: 0.0006, Age: 0.41, Sex: 0.001
2025-10-24 09:26:32,902 - INFO - Epoch 22, Step 600/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.96e-05, LM: 0.0006, Age: 0.41, Sex: 0.001
2025-10-24 09:26:45,660 - INFO - Epoch 22, Step 650/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.95e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:26:58,047 - INFO - Epoch 22, Step 700/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.95e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:27:10,712 - INFO - Epoch 22, Step 750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.94e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:27:23,596 - INFO - Epoch 22, Step 800/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.93e-05, LM: 0.0005, Age: 0.40, Sex: 0.001
2025-10-24 09:27:36,413 - INFO - Epoch 22, Step 850/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.93e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:27:49,010 - INFO - Epoch 22, Step 900/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.92e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:01,355 - INFO - Epoch 22, Step 950/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.91e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:14,182 - INFO - Epoch 22, Step 1000/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.91e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:27,294 - INFO - Epoch 22, Step 1050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.90e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:40,088 - INFO - Epoch 22, Step 1100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.89e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:52,911 - INFO - Epoch 22, Step 1150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.89e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:05,104 - INFO - Epoch 22, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.88e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:18,150 - INFO - Epoch 22, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.87e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:30,802 - INFO - Epoch 22, Step 1300/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.86e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:43,837 - INFO - Epoch 22, Step 1350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.86e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:56,442 - INFO - Epoch 22, Step 1400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.85e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:08,830 - INFO - Epoch 22, Step 1450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.84e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:21,653 - INFO - Epoch 22, Step 1500/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.84e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:34,620 - INFO - Epoch 22, Step 1550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.83e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:47,678 - INFO - Epoch 22, Step 1600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.82e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:00,441 - INFO - Epoch 22, Step 1650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.82e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:13,090 - INFO - Epoch 22, Step 1700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.81e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:25,623 - INFO - Epoch 22, Step 1750/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.80e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:38,167 - INFO - Epoch 22, Step 1800/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 2.80e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:31:50,788 - INFO - Epoch 22, Step 1850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.79e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:03,307 - INFO - Epoch 22, Step 1900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.78e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:16,294 - INFO - Epoch 22, Step 1950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.78e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:28,979 - INFO - Epoch 22, Step 2000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.77e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:41,493 - INFO - Epoch 22, Step 2050/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.76e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:54,045 - INFO - Epoch 22, Step 2100/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.76e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:06,550 - INFO - Epoch 22, Step 2150/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.75e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:19,290 - INFO - Epoch 22, Step 2200/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.74e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:31,910 - INFO - Epoch 22, Step 2250/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.74e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:44,619 - INFO - Epoch 22, Step 2300/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.73e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:57,174 - INFO - Epoch 22, Step 2350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.72e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:09,712 - INFO - Epoch 22, Step 2400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.72e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:22,769 - INFO - Epoch 22, Step 2450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.71e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:35,465 - INFO - Epoch 22, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.70e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:35,467 - INFO - Epoch 22 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:35:24,959 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:35:24,961 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:35:29,780 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 09:35:29,780 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 09:35:29,781 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:35:40,036 - INFO - Reconstruction Jaccard computed on 129 visits: 0.0012
2025-10-24 09:35:40,036 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 09:35:52,453 - INFO - Epoch 23, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.70e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:05,459 - INFO - Epoch 23, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.69e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:18,155 - INFO - Epoch 23, Step 150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.68e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:30,677 - INFO - Epoch 23, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.68e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:36:43,573 - INFO - Epoch 23, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.67e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:36:56,430 - INFO - Epoch 23, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.66e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:37:09,470 - INFO - Epoch 23, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.66e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:22,020 - INFO - Epoch 23, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.65e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:34,751 - INFO - Epoch 23, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.64e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:47,715 - INFO - Epoch 23, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.64e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:38:00,198 - INFO - Epoch 23, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.63e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:38:12,771 - INFO - Epoch 23, Step 600/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.62e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:38:25,630 - INFO - Epoch 23, Step 650/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.61e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:38:38,082 - INFO - Epoch 23, Step 700/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.61e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:38:50,498 - INFO - Epoch 23, Step 750/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.60e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:03,040 - INFO - Epoch 23, Step 800/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.59e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:15,650 - INFO - Epoch 23, Step 850/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.59e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:28,507 - INFO - Epoch 23, Step 900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.58e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:39:41,451 - INFO - Epoch 23, Step 950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.57e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:39:54,093 - INFO - Epoch 23, Step 1000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.57e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:06,830 - INFO - Epoch 23, Step 1050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.56e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:19,631 - INFO - Epoch 23, Step 1100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.55e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:32,075 - INFO - Epoch 23, Step 1150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.55e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:44,454 - INFO - Epoch 23, Step 1200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.54e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:40:57,321 - INFO - Epoch 23, Step 1250/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.53e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:41:10,364 - INFO - Epoch 23, Step 1300/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.53e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:41:23,102 - INFO - Epoch 23, Step 1350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.52e-05, LM: 0.0003, Age: 0.38, Sex: 0.001
2025-10-24 09:41:35,880 - INFO - Epoch 23, Step 1400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.51e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:41:48,385 - INFO - Epoch 23, Step 1450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.51e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:42:00,972 - INFO - Epoch 23, Step 1500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.50e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:13,640 - INFO - Epoch 23, Step 1550/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.49e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:26,625 - INFO - Epoch 23, Step 1600/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.49e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:39,242 - INFO - Epoch 23, Step 1650/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.48e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:42:51,988 - INFO - Epoch 23, Step 1700/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.47e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:43:04,613 - INFO - Epoch 23, Step 1750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.47e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:43:17,325 - INFO - Epoch 23, Step 1800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.46e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:43:30,056 - INFO - Epoch 23, Step 1850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.45e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:43:42,478 - INFO - Epoch 23, Step 1900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.45e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:43:54,746 - INFO - Epoch 23, Step 1950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.44e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:07,495 - INFO - Epoch 23, Step 2000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.43e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:20,289 - INFO - Epoch 23, Step 2050/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.43e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:32,806 - INFO - Epoch 23, Step 2100/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.42e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:44:45,435 - INFO - Epoch 23, Step 2150/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.41e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:44:57,997 - INFO - Epoch 23, Step 2200/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.41e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:10,558 - INFO - Epoch 23, Step 2250/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.40e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:23,071 - INFO - Epoch 23, Step 2300/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.39e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:36,305 - INFO - Epoch 23, Step 2350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.39e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:49,001 - INFO - Epoch 23, Step 2400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.38e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:46:01,731 - INFO - Epoch 23, Step 2450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.37e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:46:14,450 - INFO - Epoch 23, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.36e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:46:14,452 - INFO - Epoch 23 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:47:04,266 - INFO - Validation - Loss: 0.0004, Perplexity: 1.0004, Token Accuracy: 1.0000, Code Accuracy: 0.9999
2025-10-24 09:47:04,268 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:47:09,086 - INFO - TPL computed on 500 samples: 1.0011
2025-10-24 09:47:09,086 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-24 09:47:09,087 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:47:18,915 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0033
2025-10-24 09:47:18,915 - INFO - Reconstruction Jaccard: 0.0033
2025-10-24 09:47:31,481 - INFO - Epoch 24, Step 50/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.36e-05, LM: 0.0004, Age: 0.38, Sex: 0.000
2025-10-24 09:47:44,180 - INFO - Epoch 24, Step 100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.35e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:47:57,129 - INFO - Epoch 24, Step 150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.34e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:48:10,093 - INFO - Epoch 24, Step 200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.34e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:48:22,712 - INFO - Epoch 24, Step 250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.33e-05, LM: 0.0001, Age: 0.39, Sex: 0.000
2025-10-24 09:48:35,575 - INFO - Epoch 24, Step 300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.32e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:48:48,139 - INFO - Epoch 24, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.32e-05, LM: 0.0001, Age: 0.39, Sex: 0.000
2025-10-24 09:49:00,715 - INFO - Epoch 24, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.31e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:13,616 - INFO - Epoch 24, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.30e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:26,244 - INFO - Epoch 24, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.30e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 09:49:38,920 - INFO - Epoch 24, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.29e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:51,674 - INFO - Epoch 24, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.28e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:50:04,280 - INFO - Epoch 24, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.28e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:50:17,144 - INFO - Epoch 24, Step 700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.27e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:50:30,004 - INFO - Epoch 24, Step 750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.26e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:50:42,226 - INFO - Epoch 24, Step 800/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.26e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:50:55,119 - INFO - Epoch 24, Step 850/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.25e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:07,867 - INFO - Epoch 24, Step 900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.24e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:20,340 - INFO - Epoch 24, Step 950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.24e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:33,144 - INFO - Epoch 24, Step 1000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.23e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:45,227 - INFO - Epoch 24, Step 1050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.22e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:51:57,620 - INFO - Epoch 24, Step 1100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.22e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:10,123 - INFO - Epoch 24, Step 1150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.21e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:22,751 - INFO - Epoch 24, Step 1200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.20e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:35,595 - INFO - Epoch 24, Step 1250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.20e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:52:48,130 - INFO - Epoch 24, Step 1300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.19e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:01,088 - INFO - Epoch 24, Step 1350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.18e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:13,432 - INFO - Epoch 24, Step 1400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.18e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:53:25,980 - INFO - Epoch 24, Step 1450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.17e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:53:39,022 - INFO - Epoch 24, Step 1500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.16e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:51,481 - INFO - Epoch 24, Step 1550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.16e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:04,169 - INFO - Epoch 24, Step 1600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.15e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:17,055 - INFO - Epoch 24, Step 1650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.14e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:54:29,810 - INFO - Epoch 24, Step 1700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.14e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:42,813 - INFO - Epoch 24, Step 1750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.13e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:54:55,883 - INFO - Epoch 24, Step 1800/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.12e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:08,292 - INFO - Epoch 24, Step 1850/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.11e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:21,092 - INFO - Epoch 24, Step 1900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.11e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:33,931 - INFO - Epoch 24, Step 1950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.10e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:46,427 - INFO - Epoch 24, Step 2000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.09e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:58,804 - INFO - Epoch 24, Step 2050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.09e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:11,491 - INFO - Epoch 24, Step 2100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.08e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:24,195 - INFO - Epoch 24, Step 2150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.07e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:56:36,667 - INFO - Epoch 24, Step 2200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.07e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:49,032 - INFO - Epoch 24, Step 2250/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.06e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:01,520 - INFO - Epoch 24, Step 2300/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.05e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:13,912 - INFO - Epoch 24, Step 2350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.05e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:26,258 - INFO - Epoch 24, Step 2400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.04e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:38,693 - INFO - Epoch 24, Step 2450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.03e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:51,350 - INFO - Epoch 24, Step 2500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.03e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:51,352 - INFO - Epoch 24 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0005, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:58:41,328 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:58:41,330 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:58:46,260 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 09:58:46,260 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 09:58:46,261 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:58:56,800 - INFO - Reconstruction Jaccard computed on 133 visits: 0.0000
2025-10-24 09:58:56,801 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 09:58:56,801 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:59:01,098 - INFO - Checkpoint saved: epoch 24
2025-10-24 09:59:13,777 - INFO - Epoch 25, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.02e-05, LM: 0.0000, Age: 0.42, Sex: 0.000
2025-10-24 09:59:26,787 - INFO - Epoch 25, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.01e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:59:39,683 - INFO - Epoch 25, Step 150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.01e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 09:59:52,583 - INFO - Epoch 25, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.00e-05, LM: 0.0000, Age: 0.38, Sex: 0.001
2025-10-24 10:00:05,082 - INFO - Epoch 25, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.99e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 10:00:17,978 - INFO - Epoch 25, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.99e-05, LM: 0.0000, Age: 0.38, Sex: 0.002
2025-10-24 10:00:31,385 - INFO - Epoch 25, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.98e-05, LM: 0.0000, Age: 0.38, Sex: 0.002
2025-10-24 10:00:44,431 - INFO - Epoch 25, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.97e-05, LM: 0.0001, Age: 0.38, Sex: 0.002
2025-10-24 10:00:56,947 - INFO - Epoch 25, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.97e-05, LM: 0.0001, Age: 0.37, Sex: 0.003
2025-10-24 10:01:09,604 - INFO - Epoch 25, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.96e-05, LM: 0.0001, Age: 0.37, Sex: 0.003
2025-10-24 10:01:22,521 - INFO - Epoch 25, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.95e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:01:35,349 - INFO - Epoch 25, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.95e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:01:48,076 - INFO - Epoch 25, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.94e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:02:00,520 - INFO - Epoch 25, Step 700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.93e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:02:12,878 - INFO - Epoch 25, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.93e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:25,507 - INFO - Epoch 25, Step 800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.92e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:37,775 - INFO - Epoch 25, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.91e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:50,214 - INFO - Epoch 25, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.91e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:02,839 - INFO - Epoch 25, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.90e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:15,538 - INFO - Epoch 25, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.89e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:28,015 - INFO - Epoch 25, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.89e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:03:40,438 - INFO - Epoch 25, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.88e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:03:52,879 - INFO - Epoch 25, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.87e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:04:05,490 - INFO - Epoch 25, Step 1200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.86e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:18,108 - INFO - Epoch 25, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.86e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:30,905 - INFO - Epoch 25, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.85e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:43,979 - INFO - Epoch 25, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.84e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:56,914 - INFO - Epoch 25, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.84e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:05:09,781 - INFO - Epoch 25, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.83e-05, LM: 0.0000, Age: 0.37, Sex: 0.001
2025-10-24 10:05:22,361 - INFO - Epoch 25, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.82e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:05:35,379 - INFO - Epoch 25, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.82e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:05:47,825 - INFO - Epoch 25, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.81e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:00,604 - INFO - Epoch 25, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.80e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:13,193 - INFO - Epoch 25, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.80e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:25,981 - INFO - Epoch 25, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.79e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:38,762 - INFO - Epoch 25, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.78e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:51,478 - INFO - Epoch 25, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.78e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:04,130 - INFO - Epoch 25, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.77e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:16,688 - INFO - Epoch 25, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.76e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:29,568 - INFO - Epoch 25, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.76e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:42,381 - INFO - Epoch 25, Step 2050/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.75e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:07:55,543 - INFO - Epoch 25, Step 2100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.74e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:08,415 - INFO - Epoch 25, Step 2150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.74e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:21,104 - INFO - Epoch 25, Step 2200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.73e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:33,982 - INFO - Epoch 25, Step 2250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.72e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:46,606 - INFO - Epoch 25, Step 2300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.72e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:59,155 - INFO - Epoch 25, Step 2350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.71e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:09:11,806 - INFO - Epoch 25, Step 2400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.70e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:09:24,475 - INFO - Epoch 25, Step 2450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.70e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:09:37,290 - INFO - Epoch 25, Step 2500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.69e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:09:37,291 - INFO - Epoch 25 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0005, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:10:27,334 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:10:27,336 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:10:32,167 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 10:10:32,168 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 10:10:32,169 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:10:42,076 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0012
2025-10-24 10:10:42,076 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 10:10:44,483 - INFO - Checkpoint saved: epoch 25
2025-10-24 10:10:57,100 - INFO - Epoch 26, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.68e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 10:11:09,644 - INFO - Epoch 26, Step 100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.68e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:11:22,625 - INFO - Epoch 26, Step 150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.67e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:11:34,812 - INFO - Epoch 26, Step 200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.66e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:11:47,392 - INFO - Epoch 26, Step 250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.66e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:11:59,916 - INFO - Epoch 26, Step 300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.65e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:12:12,409 - INFO - Epoch 26, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.64e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:12:24,901 - INFO - Epoch 26, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.64e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:12:37,852 - INFO - Epoch 26, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.63e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:12:50,407 - INFO - Epoch 26, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.62e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:13:02,984 - INFO - Epoch 26, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.61e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:15,389 - INFO - Epoch 26, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.61e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:28,079 - INFO - Epoch 26, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.60e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:40,883 - INFO - Epoch 26, Step 700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.59e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:13:53,313 - INFO - Epoch 26, Step 750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.59e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:14:05,953 - INFO - Epoch 26, Step 800/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.58e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:14:18,940 - INFO - Epoch 26, Step 850/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.57e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:31,768 - INFO - Epoch 26, Step 900/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.57e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:44,460 - INFO - Epoch 26, Step 950/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.56e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:57,008 - INFO - Epoch 26, Step 1000/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.55e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:10,159 - INFO - Epoch 26, Step 1050/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.55e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:22,953 - INFO - Epoch 26, Step 1100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.54e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:35,437 - INFO - Epoch 26, Step 1150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.53e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:47,738 - INFO - Epoch 26, Step 1200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.53e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:00,357 - INFO - Epoch 26, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.52e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:13,265 - INFO - Epoch 26, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.51e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:25,759 - INFO - Epoch 26, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.51e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:38,287 - INFO - Epoch 26, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.50e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:50,914 - INFO - Epoch 26, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.49e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:03,849 - INFO - Epoch 26, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.49e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:16,540 - INFO - Epoch 26, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.48e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:29,301 - INFO - Epoch 26, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.47e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:41,768 - INFO - Epoch 26, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.47e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:54,857 - INFO - Epoch 26, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.46e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:07,645 - INFO - Epoch 26, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.45e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:20,390 - INFO - Epoch 26, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.45e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:33,033 - INFO - Epoch 26, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.44e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:18:45,875 - INFO - Epoch 26, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.43e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:18:58,498 - INFO - Epoch 26, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.43e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:19:11,397 - INFO - Epoch 26, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.42e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:23,994 - INFO - Epoch 26, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.41e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:36,585 - INFO - Epoch 26, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.41e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:49,048 - INFO - Epoch 26, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.40e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:01,569 - INFO - Epoch 26, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.39e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:14,463 - INFO - Epoch 26, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.39e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:26,876 - INFO - Epoch 26, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.38e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:39,430 - INFO - Epoch 26, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.37e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:52,026 - INFO - Epoch 26, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.36e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:04,615 - INFO - Epoch 26, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.36e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:17,046 - INFO - Epoch 26, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.35e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:17,048 - INFO - Epoch 26 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:22:06,593 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:22:06,595 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:22:11,418 - INFO - TPL computed on 500 samples: 1.0012
2025-10-24 10:22:11,418 - INFO - Temporal Perplexity (TPL): 1.0012
2025-10-24 10:22:11,419 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:22:20,869 - INFO - Reconstruction Jaccard computed on 120 visits: 0.0006
2025-10-24 10:22:20,870 - INFO - Reconstruction Jaccard: 0.0006
2025-10-24 10:22:20,870 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:22:25,426 - INFO - Checkpoint saved: epoch 26
2025-10-24 10:22:38,376 - INFO - Epoch 27, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.34e-05, LM: 0.0000, Age: 0.29, Sex: 0.000
2025-10-24 10:22:50,869 - INFO - Epoch 27, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.34e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:03,819 - INFO - Epoch 27, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.33e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:16,795 - INFO - Epoch 27, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.32e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:29,663 - INFO - Epoch 27, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.32e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:42,250 - INFO - Epoch 27, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.31e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:23:55,293 - INFO - Epoch 27, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.30e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:07,642 - INFO - Epoch 27, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.30e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:20,229 - INFO - Epoch 27, Step 450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.29e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:32,675 - INFO - Epoch 27, Step 500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.28e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:45,435 - INFO - Epoch 27, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.28e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:57,859 - INFO - Epoch 27, Step 600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.27e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:25:10,350 - INFO - Epoch 27, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.26e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:25:23,166 - INFO - Epoch 27, Step 700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.26e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:25:36,288 - INFO - Epoch 27, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.25e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:25:48,907 - INFO - Epoch 27, Step 800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.24e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:01,513 - INFO - Epoch 27, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.24e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:14,215 - INFO - Epoch 27, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.23e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:26,947 - INFO - Epoch 27, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.22e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:39,657 - INFO - Epoch 27, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.22e-05, LM: 0.0001, Age: 0.33, Sex: 0.000
2025-10-24 10:26:52,027 - INFO - Epoch 27, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.21e-05, LM: 0.0001, Age: 0.33, Sex: 0.000
2025-10-24 10:27:04,816 - INFO - Epoch 27, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.20e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:17,517 - INFO - Epoch 27, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.20e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:30,078 - INFO - Epoch 27, Step 1200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.19e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:42,673 - INFO - Epoch 27, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.18e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:27:55,229 - INFO - Epoch 27, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.18e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:07,957 - INFO - Epoch 27, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.17e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:20,643 - INFO - Epoch 27, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.16e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:33,620 - INFO - Epoch 27, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.16e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:46,125 - INFO - Epoch 27, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.15e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:58,544 - INFO - Epoch 27, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.14e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:11,087 - INFO - Epoch 27, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.14e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:23,893 - INFO - Epoch 27, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.13e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:36,422 - INFO - Epoch 27, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.12e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:48,565 - INFO - Epoch 27, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.11e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:01,254 - INFO - Epoch 27, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.11e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:14,230 - INFO - Epoch 27, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.10e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:26,919 - INFO - Epoch 27, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.09e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:39,313 - INFO - Epoch 27, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.09e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:52,162 - INFO - Epoch 27, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.08e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:04,880 - INFO - Epoch 27, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.07e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:17,398 - INFO - Epoch 27, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.07e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:30,299 - INFO - Epoch 27, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.06e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:43,142 - INFO - Epoch 27, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.05e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:55,838 - INFO - Epoch 27, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.05e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:08,596 - INFO - Epoch 27, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.04e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:21,369 - INFO - Epoch 27, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.03e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:33,886 - INFO - Epoch 27, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.03e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:46,298 - INFO - Epoch 27, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.02e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:58,816 - INFO - Epoch 27, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.01e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:58,818 - INFO - Epoch 27 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:33:48,162 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:33:48,165 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:33:53,069 - INFO - TPL computed on 500 samples: 1.0009
2025-10-24 10:33:53,069 - INFO - Temporal Perplexity (TPL): 1.0009
2025-10-24 10:33:53,070 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:34:02,951 - INFO - Reconstruction Jaccard computed on 128 visits: 0.0000
2025-10-24 10:34:02,951 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 10:34:15,536 - INFO - Epoch 28, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.01e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:34:28,182 - INFO - Epoch 28, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.00e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:34:41,075 - INFO - Epoch 28, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.93e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:34:53,711 - INFO - Epoch 28, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.86e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:06,138 - INFO - Epoch 28, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.80e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:18,919 - INFO - Epoch 28, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.73e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:31,944 - INFO - Epoch 28, Step 350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.66e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:35:44,560 - INFO - Epoch 28, Step 400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.59e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:35:57,042 - INFO - Epoch 28, Step 450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.53e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:09,952 - INFO - Epoch 28, Step 500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.46e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:36:22,545 - INFO - Epoch 28, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.39e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:35,533 - INFO - Epoch 28, Step 600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.32e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:47,982 - INFO - Epoch 28, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.26e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:37:00,705 - INFO - Epoch 28, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.19e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:13,271 - INFO - Epoch 28, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.12e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:37:25,828 - INFO - Epoch 28, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.05e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:38,411 - INFO - Epoch 28, Step 850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.99e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:51,270 - INFO - Epoch 28, Step 900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.92e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:04,206 - INFO - Epoch 28, Step 950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.85e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:16,848 - INFO - Epoch 28, Step 1000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.78e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:29,475 - INFO - Epoch 28, Step 1050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.72e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:42,400 - INFO - Epoch 28, Step 1100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.65e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:54,697 - INFO - Epoch 28, Step 1150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.58e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:07,502 - INFO - Epoch 28, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.51e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:20,311 - INFO - Epoch 28, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.45e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:33,300 - INFO - Epoch 28, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.38e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:45,937 - INFO - Epoch 28, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.31e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:58,629 - INFO - Epoch 28, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.24e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:11,634 - INFO - Epoch 28, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.18e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:23,938 - INFO - Epoch 28, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.11e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:36,894 - INFO - Epoch 28, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 8.04e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:49,785 - INFO - Epoch 28, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.97e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:02,205 - INFO - Epoch 28, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.91e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:14,602 - INFO - Epoch 28, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.84e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:27,421 - INFO - Epoch 28, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.77e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:39,894 - INFO - Epoch 28, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.70e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:41:53,029 - INFO - Epoch 28, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.64e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:05,496 - INFO - Epoch 28, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.57e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:17,854 - INFO - Epoch 28, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.50e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:42:30,420 - INFO - Epoch 28, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.43e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:43,132 - INFO - Epoch 28, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.36e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:55,699 - INFO - Epoch 28, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.30e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:08,200 - INFO - Epoch 28, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.23e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:43:20,869 - INFO - Epoch 28, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.16e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:33,600 - INFO - Epoch 28, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.09e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:45,869 - INFO - Epoch 28, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.03e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:43:58,372 - INFO - Epoch 28, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.96e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:44:10,805 - INFO - Epoch 28, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.89e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:23,583 - INFO - Epoch 28, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.82e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:36,242 - INFO - Epoch 28, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.76e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:36,244 - INFO - Epoch 28 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:45:26,233 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:45:26,235 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:45:31,143 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 10:45:31,143 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 10:45:31,144 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:45:40,949 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0000
2025-10-24 10:45:40,949 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 10:45:40,950 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:45:45,629 - INFO - Checkpoint saved: epoch 28
2025-10-24 10:45:58,076 - INFO - Epoch 29, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.69e-06, LM: 0.0000, Age: 0.29, Sex: 0.000
2025-10-24 10:46:10,562 - INFO - Epoch 29, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.62e-06, LM: 0.0000, Age: 0.32, Sex: 0.001
2025-10-24 10:46:23,255 - INFO - Epoch 29, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.55e-06, LM: 0.0000, Age: 0.33, Sex: 0.001
2025-10-24 10:46:36,057 - INFO - Epoch 29, Step 200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.49e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:46:48,772 - INFO - Epoch 29, Step 250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.42e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:47:01,406 - INFO - Epoch 29, Step 300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.35e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:47:13,917 - INFO - Epoch 29, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.28e-06, LM: 0.0001, Age: 0.31, Sex: 0.000
2025-10-24 10:47:26,147 - INFO - Epoch 29, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.22e-06, LM: 0.0001, Age: 0.31, Sex: 0.000
2025-10-24 10:47:39,471 - INFO - Epoch 29, Step 450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.15e-06, LM: 0.0001, Age: 0.32, Sex: 0.000
2025-10-24 10:47:52,182 - INFO - Epoch 29, Step 500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.08e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:04,845 - INFO - Epoch 29, Step 550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.01e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:17,688 - INFO - Epoch 29, Step 600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.95e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:48:29,959 - INFO - Epoch 29, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.88e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:48:42,344 - INFO - Epoch 29, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.81e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:54,955 - INFO - Epoch 29, Step 750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.74e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:49:08,073 - INFO - Epoch 29, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.68e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:20,379 - INFO - Epoch 29, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.61e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:33,565 - INFO - Epoch 29, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.54e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:46,114 - INFO - Epoch 29, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.47e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:58,780 - INFO - Epoch 29, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.41e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:11,159 - INFO - Epoch 29, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.34e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:23,768 - INFO - Epoch 29, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.27e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:36,618 - INFO - Epoch 29, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.20e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:49,435 - INFO - Epoch 29, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.14e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:02,514 - INFO - Epoch 29, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.07e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:15,158 - INFO - Epoch 29, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.00e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:51:28,137 - INFO - Epoch 29, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.93e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:40,565 - INFO - Epoch 29, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.86e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:51:53,689 - INFO - Epoch 29, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.80e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:06,479 - INFO - Epoch 29, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.73e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:19,293 - INFO - Epoch 29, Step 1550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.66e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:31,459 - INFO - Epoch 29, Step 1600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.59e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:44,293 - INFO - Epoch 29, Step 1650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.53e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:57,020 - INFO - Epoch 29, Step 1700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.46e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:09,962 - INFO - Epoch 29, Step 1750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.39e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:22,805 - INFO - Epoch 29, Step 1800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.32e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:35,362 - INFO - Epoch 29, Step 1850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.26e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:47,859 - INFO - Epoch 29, Step 1900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.19e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:00,481 - INFO - Epoch 29, Step 1950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.12e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:13,095 - INFO - Epoch 29, Step 2000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.05e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:25,867 - INFO - Epoch 29, Step 2050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.99e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:38,346 - INFO - Epoch 29, Step 2100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.92e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:50,940 - INFO - Epoch 29, Step 2150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.85e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:03,699 - INFO - Epoch 29, Step 2200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.78e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:16,606 - INFO - Epoch 29, Step 2250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.72e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:29,245 - INFO - Epoch 29, Step 2300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.65e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:42,046 - INFO - Epoch 29, Step 2350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.58e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:54,932 - INFO - Epoch 29, Step 2400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.51e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:07,499 - INFO - Epoch 29, Step 2450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.45e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:20,420 - INFO - Epoch 29, Step 2500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.38e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:20,422 - INFO - Epoch 29 Complete - Avg Loss: 0.0003, Avg Perplexity: 1.0003, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:57:10,218 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:57:10,220 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:57:15,098 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 10:57:15,098 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 10:57:15,099 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:57:26,218 - INFO - Reconstruction Jaccard computed on 134 visits: 0.0008
2025-10-24 10:57:26,218 - INFO - Reconstruction Jaccard: 0.0008
2025-10-24 10:57:26,218 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:57:30,658 - INFO - Checkpoint saved: epoch 29
2025-10-24 10:57:43,369 - INFO - Epoch 30, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.31e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:57:56,051 - INFO - Epoch 30, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 3.24e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:58:08,729 - INFO - Epoch 30, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.18e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:58:21,321 - INFO - Epoch 30, Step 200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.11e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:58:33,859 - INFO - Epoch 30, Step 250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.04e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:58:46,611 - INFO - Epoch 30, Step 300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.97e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:58:59,294 - INFO - Epoch 30, Step 350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.91e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:59:12,009 - INFO - Epoch 30, Step 400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.84e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:24,848 - INFO - Epoch 30, Step 450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.77e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:37,789 - INFO - Epoch 30, Step 500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.70e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:50,197 - INFO - Epoch 30, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.64e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:02,643 - INFO - Epoch 30, Step 600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.57e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:15,615 - INFO - Epoch 30, Step 650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.50e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:28,278 - INFO - Epoch 30, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.43e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:00:40,849 - INFO - Epoch 30, Step 750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.36e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:00:53,431 - INFO - Epoch 30, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.30e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:01:05,933 - INFO - Epoch 30, Step 850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.23e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:01:18,370 - INFO - Epoch 30, Step 900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.16e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:31,119 - INFO - Epoch 30, Step 950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.09e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:43,827 - INFO - Epoch 30, Step 1000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.03e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:56,732 - INFO - Epoch 30, Step 1050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.96e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:09,437 - INFO - Epoch 30, Step 1100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.89e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:02:22,030 - INFO - Epoch 30, Step 1150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.82e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:34,946 - INFO - Epoch 30, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.76e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:47,321 - INFO - Epoch 30, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.69e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:00,249 - INFO - Epoch 30, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.62e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:12,786 - INFO - Epoch 30, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.55e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:25,296 - INFO - Epoch 30, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.49e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:38,175 - INFO - Epoch 30, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.42e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:50,923 - INFO - Epoch 30, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.35e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:04:03,471 - INFO - Epoch 30, Step 1550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.28e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:16,618 - INFO - Epoch 30, Step 1600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.22e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:04:29,284 - INFO - Epoch 30, Step 1650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.15e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:41,785 - INFO - Epoch 30, Step 1700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.08e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:54,604 - INFO - Epoch 30, Step 1750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.01e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:07,138 - INFO - Epoch 30, Step 1800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.46e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:20,238 - INFO - Epoch 30, Step 1850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.78e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:33,268 - INFO - Epoch 30, Step 1900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.11e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:45,879 - INFO - Epoch 30, Step 1950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 7.43e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:58,552 - INFO - Epoch 30, Step 2000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.76e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:11,223 - INFO - Epoch 30, Step 2050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.08e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:23,831 - INFO - Epoch 30, Step 2100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.41e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:36,516 - INFO - Epoch 30, Step 2150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.73e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:49,508 - INFO - Epoch 30, Step 2200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.05e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:02,161 - INFO - Epoch 30, Step 2250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.38e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:14,663 - INFO - Epoch 30, Step 2300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.70e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:27,440 - INFO - Epoch 30, Step 2350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.03e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:39,864 - INFO - Epoch 30, Step 2400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.35e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:52,481 - INFO - Epoch 30, Step 2450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.76e-08, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:05,051 - INFO - Epoch 30, Step 2500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 0.00e+00, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:05,053 - INFO - Epoch 30 Complete - Avg Loss: 0.0003, Avg Perplexity: 1.0003, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:54,466 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 11:08:54,468 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 11:08:59,302 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 11:08:59,303 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 11:08:59,304 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 11:09:10,016 - INFO - Reconstruction Jaccard computed on 131 visits: 0.0004
2025-10-24 11:09:10,016 - INFO - Reconstruction Jaccard: 0.0004
2025-10-24 11:09:10,016 - INFO - New best model! Validation loss: 0.0000
2025-10-24 11:09:14,534 - INFO - Checkpoint saved: epoch 30
2025-10-24 11:09:14,534 - INFO - 
================================================================================
2025-10-24 11:09:14,534 - INFO - Training Complete!
2025-10-24 11:09:14,534 - INFO - ================================================================================
2025-10-24 11:09:14,534 - INFO - Best validation loss: 0.0000
2025-10-24 11:09:14,534 - INFO - Best validation perplexity: 1.0000
