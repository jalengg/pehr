2025-10-09 05:10:03 | INFO     | <module>:562 | === EHR Generation Training Started ===
2025-10-09 05:10:03 | INFO     | <module>:583 | Configuration: {'model_name': 'facebook/bart-base', 'num_patients': 3000, 'max_seq_length': 256, 'batch_size': 16, 'num_epochs': 30, 'learning_rate': 0.0002, 'generation_temp': 1.3, 'generation_max_length': 256, 'num_warmup_steps': 0, 'top_k': 100, 'data_dir': 'data_files', 'mimic_paths': {'patients_path': 'data_files/PATIENTS.csv', 'admissions_path': 'data_files/ADMISSIONS.csv', 'diagnoses_path': 'data_files/DIAGNOSES_ICD.csv'}}
2025-10-09 05:10:03 | INFO     | <module>:587 | Using device: cuda
2025-10-09 05:10:03 | INFO     | <module>:590 | Loading pretrained BART model: facebook/bart-base
2025-10-09 05:10:04 | INFO     | <module>:599 | Added 3 special tokens: <v>, <\v>, <END>
2025-10-09 05:10:04 | INFO     | <module>:603 | Resized model embeddings to 50268 tokens
2025-10-09 05:10:04 | DEBUG    | <module>:606 | Token ID for <v>: 50265
2025-10-09 05:10:04 | DEBUG    | <module>:607 | Token ID for <\v>: 50266
2025-10-09 05:10:04 | DEBUG    | <module>:608 | Token ID for <END>: 50267
2025-10-09 05:10:04 | INFO     | load_and_format_mimic_data:147 | Loading MIMIC-III data files
2025-10-09 05:10:04 | DEBUG    | load_and_format_mimic_data:148 | Patients: data_files/PATIENTS.csv
2025-10-09 05:10:04 | DEBUG    | load_and_format_mimic_data:149 | Admissions: data_files/ADMISSIONS.csv
2025-10-09 05:10:04 | DEBUG    | load_and_format_mimic_data:150 | Diagnoses: data_files/DIAGNOSES_ICD.csv
2025-10-09 05:10:04 | INFO     | load_and_format_mimic_data:155 | Loaded 46520 patients
2025-10-09 05:10:04 | INFO     | load_and_format_mimic_data:158 | Loaded 58976 admissions
2025-10-09 05:10:04 | INFO     | load_and_format_mimic_data:161 | Loaded 651047 diagnosis records
2025-10-09 05:10:05 | INFO     | load_and_format_mimic_data:219 | Data processing complete. Formatting sequences...
2025-10-09 05:10:07 | INFO     | load_and_format_mimic_data:258 | Sequence formatting complete. Generated 3000 patient sequences
2025-10-09 05:10:07 | DEBUG    | load_and_format_mimic_data:262 | Sample sequence: 0 ASIAN M <demo> <v> V3001 V053 V290 <\v> <END>...
2025-10-09 05:10:07 | INFO     | load_and_format_mimic_data:267 | Average visits per patient: 1.27
2025-10-09 05:10:07 | INFO     | load_and_format_mimic_data:268 | Average tokens per sequence: 19.69
2025-10-09 05:10:07 | INFO     | <module>:622 | Sample patient sequences:
2025-10-09 05:10:07 | INFO     | <module>:624 | Sample 1: 80 WHITE M <demo> <v> 41071 4280 42840 5180 501 V4502 4940 5771 <\v> <END>...
2025-10-09 05:10:07 | INFO     | <module>:624 | Sample 2: 79 WHITE M <demo> <v> 0389 78552 42731 496 1550 99592 4019 <\v> <END>...
2025-10-09 05:10:07 | INFO     | <module>:624 | Sample 3: 22 WHITE F <demo> <v> 25013 27651 V5867 <\v> <END>...
2025-10-09 05:10:07 | INFO     | <module>:624 | Sample 4: 0 WHITE M <demo> <v> V3001 7706 V290 <\v> <END>...
2025-10-09 05:10:07 | INFO     | <module>:624 | Sample 5: 76 WHITE M <demo> <v> 5781 2800 5849 585 5712 7907 2848 496 42830 <\v> <END>...
2025-10-09 05:10:07 | DEBUG    | __init__:294 | First sequence length: 24 tokens
2025-10-09 05:10:07 | DEBUG    | __init__:295 | Pad token ID: 1
2025-10-09 05:10:07 | INFO     | <module>:628 | Created dataset with 3000 samples, 188 batches
2025-10-09 05:10:07 | INFO     | <module>:639 | Optimizer: AdamW with lr=0.0002
2025-10-09 05:10:07 | INFO     | <module>:640 | Scheduler: linear with 0 warmup steps
2025-10-09 05:10:08 | INFO     | train_model:351 | Starting model training for 30 epochs
2025-10-09 05:10:08 | INFO     | train_model:352 | Training steps: 5640
2025-10-09 05:10:08 | INFO     | train_model:353 | Device: cuda
2025-10-09 05:10:08 | DEBUG    | train_model:372 | First batch input_ids shape: torch.Size([16, 256])
2025-10-09 05:10:08 | DEBUG    | train_model:373 | First batch labels shape: torch.Size([16, 256])
2025-10-09 05:10:08 | DEBUG    | train_model:374 | First batch attention_mask shape: torch.Size([16, 256])
2025-10-09 05:10:08 | DEBUG    | train_model:375 | Initial loss: 2.2945
2025-10-09 05:10:08 | DEBUG    | train_model:382 | Special tokens in first batch: {'pad': 3351, 'masked_labels': 3351}
2025-10-09 05:10:54 | INFO     | train_model:401 | Epoch 1/30 completed | Avg Loss: 0.4592
2025-10-09 05:11:41 | INFO     | train_model:401 | Epoch 2/30 completed | Avg Loss: 0.0688
2025-10-09 05:12:28 | INFO     | train_model:401 | Epoch 3/30 completed | Avg Loss: 0.0212
2025-10-09 05:13:14 | INFO     | train_model:401 | Epoch 4/30 completed | Avg Loss: 0.0185
2025-10-09 05:14:01 | INFO     | train_model:401 | Epoch 5/30 completed | Avg Loss: 0.0331
2025-10-09 05:14:47 | INFO     | train_model:401 | Epoch 6/30 completed | Avg Loss: 0.0341
2025-10-09 05:15:34 | INFO     | train_model:401 | Epoch 7/30 completed | Avg Loss: 0.0187
2025-10-09 05:16:20 | INFO     | train_model:401 | Epoch 8/30 completed | Avg Loss: 0.0166
2025-10-09 05:17:07 | INFO     | train_model:401 | Epoch 9/30 completed | Avg Loss: 0.0114
2025-10-09 05:17:53 | INFO     | train_model:401 | Epoch 10/30 completed | Avg Loss: 0.0097
2025-10-09 05:18:40 | INFO     | train_model:401 | Epoch 11/30 completed | Avg Loss: 0.0150
2025-10-09 05:19:27 | INFO     | train_model:401 | Epoch 12/30 completed | Avg Loss: 0.0076
2025-10-09 05:20:13 | INFO     | train_model:401 | Epoch 13/30 completed | Avg Loss: 0.0079
2025-10-09 05:21:00 | INFO     | train_model:401 | Epoch 14/30 completed | Avg Loss: 0.0067
2025-10-09 05:21:46 | INFO     | train_model:401 | Epoch 15/30 completed | Avg Loss: 0.0062
2025-10-09 05:22:33 | INFO     | train_model:401 | Epoch 16/30 completed | Avg Loss: 0.0100
2025-10-09 05:23:19 | INFO     | train_model:401 | Epoch 17/30 completed | Avg Loss: 0.0070
2025-10-09 05:24:06 | INFO     | train_model:401 | Epoch 18/30 completed | Avg Loss: 0.0055
2025-10-09 05:24:52 | INFO     | train_model:401 | Epoch 19/30 completed | Avg Loss: 0.0029
2025-10-09 05:25:39 | INFO     | train_model:401 | Epoch 20/30 completed | Avg Loss: 0.0016
2025-10-09 05:26:25 | INFO     | train_model:401 | Epoch 21/30 completed | Avg Loss: 0.0012
2025-10-09 05:27:12 | INFO     | train_model:401 | Epoch 22/30 completed | Avg Loss: 0.0023
2025-10-09 05:27:59 | INFO     | train_model:401 | Epoch 23/30 completed | Avg Loss: 0.0015
2025-10-09 05:28:45 | INFO     | train_model:401 | Epoch 24/30 completed | Avg Loss: 0.0008
2025-10-09 05:29:32 | INFO     | train_model:401 | Epoch 25/30 completed | Avg Loss: 0.0009
2025-10-09 05:30:18 | INFO     | train_model:401 | Epoch 26/30 completed | Avg Loss: 0.0010
2025-10-09 05:31:05 | INFO     | train_model:401 | Epoch 27/30 completed | Avg Loss: 0.0010
2025-10-09 05:31:51 | INFO     | train_model:401 | Epoch 28/30 completed | Avg Loss: 0.0010
2025-10-09 05:32:38 | INFO     | train_model:401 | Epoch 29/30 completed | Avg Loss: 0.0005
2025-10-09 05:33:24 | INFO     | train_model:401 | Epoch 30/30 completed | Avg Loss: 0.0005
2025-10-09 05:33:24 | INFO     | train_model:403 | Training complete
2025-10-09 05:33:24 | INFO     | train_model:404 | Final average loss: 0.0005
2025-10-09 05:33:24 | DEBUG    | train_model:405 | Loss history: [0.4592287894734677, 0.06879276993679517, 0.02115783587617037, 0.018524651429888375, 0.03307105769016879, 0.034079925671710254, 0.01867016305434245, 0.01655782241574885, 0.011390928024527656, 0.009676200325787811, 0.015014243018045586, 0.007566284568035391, 0.007912835235904997, 0.006684119975885706, 0.0061624420451017676, 0.010049333799233477, 0.006993478623932807, 0.005544824591894174, 0.0028895541191230494, 0.0015648245361010963, 0.0012240222151686272, 0.002267819585792127, 0.001480910557531504, 0.000817918282569116, 0.0008602860191573161, 0.0010229181304489334, 0.0009790532773316025, 0.0010132765948215588, 0.0004657560765677927, 0.0004874807292795362]
2025-10-09 05:33:24 | INFO     | <module>:654 | === Generating synthetic patient data ===
2025-10-09 05:33:24 | INFO     | <module>:663 | 
--- Sample 1/5 ---
2025-10-09 05:33:24 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '54 UNABLE TO OBTAIN M <demo>'
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 4283, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '54', ' U', 'NA', 'BLE', ' TO', ' OB', 'TAIN', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 4283, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000019
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.000109
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.994765
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.994765 | ID: 2
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 2: 71                   | Prob: 0.000242 | ID: 5339
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 3: 70                   | Prob: 0.000215 | ID: 3083
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 4: 01                   | Prob: 0.000215 | ID: 2663
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 5:  <                   | Prob: 0.000204 | ID: 28696
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 6: o                    | Prob: 0.000180 | ID: 139
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 7: 19                   | Prob: 0.000159 | ID: 1646
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 1                    | Prob: 0.000135 | ID: 134
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 9: <s>                  | Prob: 0.000118 | ID: 0
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 10: <END>                | Prob: 0.000109 | ID: 50267
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 001                  | Prob: 0.000105 | ID: 19089
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 80                   | Prob: 0.000098 | ID: 2940
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 674                  | Prob: 0.000096 | ID: 38715
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 88                   | Prob: 0.000091 | ID: 4652
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 441                  | Prob: 0.000081 | ID: 36011
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 66                   | Prob: 0.000080 | ID: 4280
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 69                   | Prob: 0.000069 | ID: 4563
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 18: AN                   | Prob: 0.000059 | ID: 1889
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 11                   | Prob: 0.000057 | ID: 1225
2025-10-09 05:33:24 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 73                   | Prob: 0.000050 | ID: 5352
2025-10-09 05:33:24 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=100, max_length=256
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 4283, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 50267]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:521 | Generated length: 20 tokens
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>54 UNABLE TO OBTAIN M <demo></s> <v> </s></s></s> <END>
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 54 UNABLE TO OBTAIN M <demo>
2025-10-09 05:33:25 | INFO     | <module>:663 | 
--- Sample 2/5 ---
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '82 UNABLE TO OBTAIN M <demo>'
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 6551, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '82', ' U', 'NA', 'BLE', ' TO', ' OB', 'TAIN', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 6551, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000005
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.000035
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.996801
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 1: <EOS>                | Prob: 0.996801 | ID: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 2: 01                   | Prob: 0.000181 | ID: 2663
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 3: 71                   | Prob: 0.000122 | ID: 5339
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <s>                  | Prob: 0.000090 | ID: 0
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 5: o                    | Prob: 0.000086 | ID: 139
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 6: 80                   | Prob: 0.000084 | ID: 2940
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 7:                      | Prob: 0.000082 | ID: 1437
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 19                   | Prob: 0.000081 | ID: 1646
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 9:  <                   | Prob: 0.000079 | ID: 28696
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 1                    | Prob: 0.000072 | ID: 134
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 70                   | Prob: 0.000055 | ID: 3083
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 88                   | Prob: 0.000050 | ID: 4652
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 13: 66                   | Prob: 0.000044 | ID: 4280
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 11                   | Prob: 0.000041 | ID: 1225
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 81                   | Prob: 0.000040 | ID: 6668
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 001                  | Prob: 0.000038 | ID: 19089
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 69                   | Prob: 0.000038 | ID: 4563
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 59                   | Prob: 0.000037 | ID: 4156
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 19: <END>                | Prob: 0.000035 | ID: 50267
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 20: AN                   | Prob: 0.000034 | ID: 1889
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=100, max_length=256
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 6551, 121, 4444, 30876, 3842, 28214, 23177, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 16536, 2, 2, 1646, 4444, 30876, 6390, 28214, 23177, 274, 28696, 12789, 8271, 15698, 1437, 50267]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:521 | Generated length: 35 tokens
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>82 UNABLE TO OBTAIN M <demo></s> <v> </s></s></s> OTHER</s></s>19NABLETO OBTAIN F <demoa>  <END>
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 82 UNABLE TO OBTAIN M <demo> OTHER19NABLETO OBTAIN F <demoa> 
2025-10-09 05:33:25 | INFO     | <module>:663 | 
--- Sample 3/5 ---
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '52 HISPANIC OR LATINO M <demo>'
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 4429, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '52', ' HIS', 'P', 'AN', 'IC', ' OR', ' LAT', 'INO', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 4429, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000013
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.000039
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.002514
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 1:  LAT                 | Prob: 0.996996 | ID: 21455
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.002514 | ID: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 3:  OTHER               | Prob: 0.000091 | ID: 16536
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 4: <END>                | Prob: 0.000039 | ID: 50267
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 5: 19                   | Prob: 0.000016 | ID: 1646
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 6: L                    | Prob: 0.000014 | ID: 574
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 7: <v>                  | Prob: 0.000013 | ID: 50265
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 8: LIN                  | Prob: 0.000012 | ID: 13748
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 9: 379                  | Prob: 0.000010 | ID: 34309
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 10:  PAT                 | Prob: 0.000009 | ID: 28284
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 11:  311                 | Prob: 0.000008 | ID: 33067
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 12: 363                  | Prob: 0.000008 | ID: 34401
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 13: ICAN                 | Prob: 0.000007 | ID: 25692
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 365                  | Prob: 0.000007 | ID: 24406
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 15: Lat                  | Prob: 0.000007 | ID: 41933
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 16: <\v>                 | Prob: 0.000007 | ID: 50266
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 17:                      | Prob: 0.000005 | ID: 1437
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 669                  | Prob: 0.000004 | ID: 36400
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 671                  | Prob: 0.000004 | ID: 39392
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 66                   | Prob: 0.000004 | ID: 4280
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=100, max_length=256
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 4429, 37350, 510, 1889, 2371, 6532, 21455, 30535, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 3083, 3083, 15698, 1437, 50267]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:521 | Generated length: 25 tokens
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 0, <END>: 1
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>52 HISPANIC OR LATINO M <demo></s> <v> </s></s></s>7070>  <END>
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 52 HISPANIC OR LATINO M <demo>7070> 
2025-10-09 05:33:25 | INFO     | <module>:663 | 
--- Sample 4/5 ---
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '40 UNKNOWN/NOT SPECIFIED M <demo>'
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 1749, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '40', ' UN', 'KNOWN', '/', 'NOT', ' SPEC', 'IFIED', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 1749, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000002
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.000005
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.022845
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 1: NOT                  | Prob: 0.976284 | ID: 37049
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.022845 | ID: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 3:                      | Prob: 0.000066 | ID: 1437
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 4: 88                   | Prob: 0.000053 | ID: 4652
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 5:  SPEC                | Prob: 0.000051 | ID: 44921
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 6: 01                   | Prob: 0.000041 | ID: 2663
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 7:  <                   | Prob: 0.000028 | ID: 28696
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 70                   | Prob: 0.000022 | ID: 3083
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 9: KNOWN                | Prob: 0.000014 | ID: 47300
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 10: 000                  | Prob: 0.000013 | ID: 151
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 80                   | Prob: 0.000011 | ID: 2940
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 12:  255                 | Prob: 0.000011 | ID: 28080
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 13:  428                 | Prob: 0.000011 | ID: 42829
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 14: o                    | Prob: 0.000010 | ID: 139
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 68                   | Prob: 0.000010 | ID: 4671
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 16: 290                  | Prob: 0.000009 | ID: 24675
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 17: 674                  | Prob: 0.000008 | ID: 38715
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 310                  | Prob: 0.000007 | ID: 23417
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 19:  NOT                 | Prob: 0.000007 | ID: 8127
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 98                   | Prob: 0.000007 | ID: 5208
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=100, max_length=256
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 1749, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 0, 2, 2, 22388, 2, 2, 38749, 2, 2, 4390, 2940, 6668, 15698, 1437, 50266, 1437, 50267]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:521 | Generated length: 36 tokens
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 1, <\v>: 1, <END>: 1
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>40 UNKNOWN/NOT SPECIFIED M <demo></s> <v> </s></s></s><s></s></s>121</s></s>551</s></s>578081>  <\v>   <END>
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 40 UNKNOWN/NOT SPECIFIED M <demo>121551578081>  
2025-10-09 05:33:25 | INFO     | <module>:663 | 
--- Sample 5/5 ---
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:443 | Generating sequence for prompt: '38 UNKNOWN/NOT SPECIFIED M <demo>'
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:447 | Prompt token IDs: [0, 3170, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:448 | Prompt tokens: ['<s>', '38', ' UN', 'KNOWN', '/', 'NOT', ' SPEC', 'IFIED', ' M', ' <', 'dem', 'o', '>', '</s>']
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:457 | Special token IDs - <v>: 50265, <\v>: 50266, <END>: 50267, PAD: 1, EOS: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:464 | Initial decoder input (with forced <v>): [0, 3170, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2, 50265]
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:478 | After prompt, probability of <v>: 0.000001
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:479 | After prompt, probability of <END>: 0.000002
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:480 | After prompt, probability of PAD: 0.000000
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:481 | After prompt, probability of EOS: 0.004226
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:485 | Top 20 next token predictions after prompt:
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 1: NOT                  | Prob: 0.995353 | ID: 37049
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 2: <EOS>                | Prob: 0.004226 | ID: 2
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 3: 88                   | Prob: 0.000048 | ID: 4652
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 4:                      | Prob: 0.000022 | ID: 1437
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 5:  SPEC                | Prob: 0.000020 | ID: 44921
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 6: 01                   | Prob: 0.000014 | ID: 2663
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 7: 68                   | Prob: 0.000011 | ID: 4671
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 8: 58                   | Prob: 0.000009 | ID: 4432
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 9: 70                   | Prob: 0.000009 | ID: 3083
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 10:  <                   | Prob: 0.000008 | ID: 28696
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 11: 000                  | Prob: 0.000007 | ID: 151
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 12:  428                 | Prob: 0.000006 | ID: 42829
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 13: KNOWN                | Prob: 0.000006 | ID: 47300
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 14: 78                   | Prob: 0.000005 | ID: 5479
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 15: 18                   | Prob: 0.000005 | ID: 1366
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 16:  NOT                 | Prob: 0.000005 | ID: 8127
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 17: o                    | Prob: 0.000004 | ID: 139
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 18: 80                   | Prob: 0.000004 | ID: 2940
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 19: 98                   | Prob: 0.000004 | ID: 5208
2025-10-09 05:33:25 | DEBUG    | generate_patient_sequence:503 |   Rank 20: 288                  | Prob: 0.000004 | ID: 29443
2025-10-09 05:33:25 | INFO     | generate_patient_sequence:507 | Starting generation with temp=1.3, top_k=100, max_length=256
2025-10-09 05:33:26 | DEBUG    | generate_patient_sequence:520 | Generated token IDs: [2, 0, 3170, 2604, 47300, 73, 37049, 44921, 36482, 256, 28696, 12789, 139, 15698, 2, 50265, 2, 2, 2, 4390, 1646, 2, 139, 15698, 1437, 50265, 204, 3761, 844, 2, 2, 4111, 612, 1437, 50266, 1437, 50267]
2025-10-09 05:33:26 | DEBUG    | generate_patient_sequence:521 | Generated length: 37 tokens
2025-10-09 05:33:26 | INFO     | generate_patient_sequence:529 | Generated token counts - <v>: 2, <\v>: 1, <END>: 1
2025-10-09 05:33:26 | DEBUG    | generate_patient_sequence:537 | Raw generated sequence: </s><s>38 UNKNOWN/NOT SPECIFIED M <demo></s> <v> </s></s></s>5719</s>o>  <v>  44620</s></s>6700  <\v>   <END>
2025-10-09 05:33:26 | INFO     | generate_patient_sequence:540 | Generated sequence (clean): 38 UNKNOWN/NOT SPECIFIED M <demo>5719o>  446206700  
2025-10-09 05:33:26 | INFO     | <module>:677 | === Training and generation complete ===
