========================================
PromptEHR Training Job
========================================
Job ID: 5501701
Job Name: promptehr_semantic_fix_aux0001
Node: ccc0387
Partition: IllinoisComputes-GPU
Working Directory: /u/jalenj4/pehr_scratch
CUDA_VISIBLE_DEVICES: 0
Start Time: Fri Oct 24 05:18:09 CDT 2025
========================================
GPU Information:
Fri Oct 24 05:18:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.95.05              Driver Version: 580.95.05      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:C1:00.0 Off |                    0 |
| N/A   22C    P0             61W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
========================================
Environment:
Python version: Python 3.12.11
PyTorch version: 2.8.0+cu128
CUDA available: True
CUDA version: 12.8
========================================
Starting PromptEHR training...
2025-10-24 05:18:19,732 - INFO - ================================================================================
2025-10-24 05:18:19,732 - INFO - PromptEHR Training Pipeline - Phase 3
2025-10-24 05:18:19,732 - INFO - ================================================================================
2025-10-24 05:18:19,732 - INFO - 
Configuration:

[Data]
  Patients: 25000
  Max sequence length: 256
  Train/val split: 0.2

[Model]
  Base model: facebook/bart-base
  Continuous features: 1
  Categorical features: 1
  Prompt length: 1

[Training]
  Batch size: 8
  Epochs: 30
  Learning rate: 0.0001
  Warmup steps: 1000
  Device: cuda

[Corruptions]
  Lambda Poisson: 3.0
  Deletion prob: 0.15
  Replacement prob: 0.15
  Corruption prob: 0.5
  Mask infilling: True
  Token deletion: True
  Token replacement: True
  Next-visit prediction: True

[Evaluation]
  Compute TPL: True
  Compute SPL: False
2025-10-24 05:18:19,735 - INFO - 
Random seed: 42
2025-10-24 05:18:20,006 - INFO - Device: cuda
2025-10-24 05:18:20,006 - INFO - 
================================================================================
2025-10-24 05:18:20,006 - INFO - Loading MIMIC-III Data
2025-10-24 05:18:20,006 - INFO - ================================================================================
2025-10-24 05:18:20,006 - INFO - Loading MIMIC-III data files
2025-10-24 05:18:20,065 - INFO - Loaded 46520 patients
2025-10-24 05:18:20,215 - INFO - Loaded 58976 admissions
2025-10-24 05:18:20,380 - INFO - Loaded 651047 diagnosis records
2025-10-24 05:18:20,656 - INFO - Processing patient records
2025-10-24 05:18:41,864 - INFO - Loaded 25000 patient records
2025-10-24 05:18:41,865 - INFO - Diagnosis vocabulary size: 5562
2025-10-24 05:18:41,879 - INFO - Average visits per patient: 1.30
2025-10-24 05:18:41,879 - INFO - Average codes per visit: 9.15
2025-10-24 05:18:41,883 - INFO - Gender distribution: {'M': 14038, 'F': 10962}
2025-10-24 05:18:41,902 - INFO - Loaded 25000 patients
2025-10-24 05:18:41,902 - INFO - Vocabulary size: 5562 diagnosis codes
2025-10-24 05:18:41,902 - INFO - Tokenizer vocab size: 5569
2025-10-24 05:18:41,903 - INFO - Dataset size: 25000 patients
2025-10-24 05:18:41,904 - INFO - Train size: 20000, Validation size: 5000
2025-10-24 05:18:41,904 - INFO - Train batches: 2500, Validation batches: 625
2025-10-24 05:18:41,904 - INFO - 
================================================================================
2025-10-24 05:18:41,904 - INFO - Initializing Model
2025-10-24 05:18:41,905 - INFO - ================================================================================
2025-10-24 05:18:42,003 - INFO - BART config vocab size: 5569
2025-10-24 05:18:43,922 - INFO - Model: PromptBartWithDemographicPrediction (multi-task learning)
2025-10-24 05:18:43,922 - INFO -   Age loss weight: 0.001
2025-10-24 05:18:43,922 - INFO -   Sex loss weight: 0.001
2025-10-24 05:18:44,183 - INFO - Total parameters: 105,688,328
2025-10-24 05:18:44,184 - INFO - Trainable parameters: 105,688,328
2025-10-24 05:18:44,185 - INFO - Total training steps: 75000
2025-10-24 05:18:44,185 - INFO - Warmup steps: 1000
2025-10-24 05:18:44,185 - INFO - 
================================================================================
2025-10-24 05:18:44,185 - INFO - Starting Training
2025-10-24 05:18:44,185 - INFO - ================================================================================
2025-10-24 05:18:57,168 - INFO - Epoch 1, Step 50/2500 - Loss: 7.8553, Perplexity: 2945.5640, LR: 5.00e-06, LM: 7.8528, Age: 1.79, Sex: 0.704
2025-10-24 05:19:09,907 - INFO - Epoch 1, Step 100/2500 - Loss: 7.0835, Perplexity: 1782.2662, LR: 1.00e-05, LM: 7.0810, Age: 1.72, Sex: 0.695
2025-10-24 05:19:22,473 - INFO - Epoch 1, Step 150/2500 - Loss: 6.5866, Perplexity: 1296.0957, LR: 1.50e-05, LM: 6.5843, Age: 1.65, Sex: 0.690
2025-10-24 05:19:35,219 - INFO - Epoch 1, Step 200/2500 - Loss: 6.1915, Perplexity: 1017.4253, LR: 2.00e-05, LM: 6.1892, Age: 1.57, Sex: 0.690
2025-10-24 05:19:48,028 - INFO - Epoch 1, Step 250/2500 - Loss: 5.9026, Perplexity: 841.5655, LR: 2.50e-05, LM: 5.9005, Age: 1.47, Sex: 0.687
2025-10-24 05:20:00,938 - INFO - Epoch 1, Step 300/2500 - Loss: 5.7011, Perplexity: 722.9221, LR: 3.00e-05, LM: 5.6990, Age: 1.39, Sex: 0.686
2025-10-24 05:20:13,653 - INFO - Epoch 1, Step 350/2500 - Loss: 5.5164, Perplexity: 633.2851, LR: 3.50e-05, LM: 5.5144, Age: 1.33, Sex: 0.684
2025-10-24 05:20:26,395 - INFO - Epoch 1, Step 400/2500 - Loss: 5.3437, Perplexity: 563.9436, LR: 4.00e-05, LM: 5.3418, Age: 1.26, Sex: 0.677
2025-10-24 05:20:38,610 - INFO - Epoch 1, Step 450/2500 - Loss: 5.1874, Perplexity: 508.5700, LR: 4.50e-05, LM: 5.1855, Age: 1.20, Sex: 0.676
2025-10-24 05:20:51,571 - INFO - Epoch 1, Step 500/2500 - Loss: 5.0325, Perplexity: 462.7366, LR: 5.00e-05, LM: 5.0307, Age: 1.16, Sex: 0.674
2025-10-24 05:21:04,073 - INFO - Epoch 1, Step 550/2500 - Loss: 4.8421, Perplexity: 423.1352, LR: 5.50e-05, LM: 4.8403, Age: 1.14, Sex: 0.674
2025-10-24 05:21:16,694 - INFO - Epoch 1, Step 600/2500 - Loss: 4.6289, Perplexity: 389.0230, LR: 6.00e-05, LM: 4.6271, Age: 1.12, Sex: 0.674
2025-10-24 05:21:29,266 - INFO - Epoch 1, Step 650/2500 - Loss: 4.3985, Perplexity: 359.7124, LR: 6.50e-05, LM: 4.3968, Age: 1.10, Sex: 0.674
2025-10-24 05:21:41,920 - INFO - Epoch 1, Step 700/2500 - Loss: 4.1783, Perplexity: 334.3918, LR: 7.00e-05, LM: 4.1765, Age: 1.09, Sex: 0.673
2025-10-24 05:21:54,821 - INFO - Epoch 1, Step 750/2500 - Loss: 3.9691, Perplexity: 312.3573, LR: 7.50e-05, LM: 3.9674, Age: 1.08, Sex: 0.670
2025-10-24 05:22:07,500 - INFO - Epoch 1, Step 800/2500 - Loss: 3.7735, Perplexity: 293.0737, LR: 8.00e-05, LM: 3.7717, Age: 1.07, Sex: 0.657
2025-10-24 05:22:20,003 - INFO - Epoch 1, Step 850/2500 - Loss: 3.5963, Perplexity: 276.0595, LR: 8.50e-05, LM: 3.5946, Age: 1.06, Sex: 0.633
2025-10-24 05:22:32,379 - INFO - Epoch 1, Step 900/2500 - Loss: 3.4327, Perplexity: 260.9375, LR: 9.00e-05, LM: 3.4311, Age: 1.05, Sex: 0.606
2025-10-24 05:22:45,280 - INFO - Epoch 1, Step 950/2500 - Loss: 3.2822, Perplexity: 247.3661, LR: 9.50e-05, LM: 3.2806, Age: 1.04, Sex: 0.581
2025-10-24 05:22:58,038 - INFO - Epoch 1, Step 1000/2500 - Loss: 3.1419, Perplexity: 235.0876, LR: 1.00e-04, LM: 3.1403, Age: 1.03, Sex: 0.557
2025-10-24 05:23:10,948 - INFO - Epoch 1, Step 1050/2500 - Loss: 3.0123, Perplexity: 223.9840, LR: 9.99e-05, LM: 3.0108, Age: 1.02, Sex: 0.533
2025-10-24 05:23:23,651 - INFO - Epoch 1, Step 1100/2500 - Loss: 2.8907, Perplexity: 213.8720, LR: 9.99e-05, LM: 2.8892, Age: 1.02, Sex: 0.511
2025-10-24 05:23:36,280 - INFO - Epoch 1, Step 1150/2500 - Loss: 2.7806, Perplexity: 204.6586, LR: 9.98e-05, LM: 2.7791, Age: 1.01, Sex: 0.491
2025-10-24 05:23:48,644 - INFO - Epoch 1, Step 1200/2500 - Loss: 2.6775, Perplexity: 196.2058, LR: 9.97e-05, LM: 2.6760, Age: 1.00, Sex: 0.472
2025-10-24 05:24:01,641 - INFO - Epoch 1, Step 1250/2500 - Loss: 2.5851, Perplexity: 188.4474, LR: 9.97e-05, LM: 2.5837, Age: 0.99, Sex: 0.455
2025-10-24 05:24:14,407 - INFO - Epoch 1, Step 1300/2500 - Loss: 2.4942, Perplexity: 181.2513, LR: 9.96e-05, LM: 2.4928, Age: 0.99, Sex: 0.440
2025-10-24 05:24:26,762 - INFO - Epoch 1, Step 1350/2500 - Loss: 2.4070, Perplexity: 174.5813, LR: 9.95e-05, LM: 2.4056, Age: 0.98, Sex: 0.425
2025-10-24 05:24:39,216 - INFO - Epoch 1, Step 1400/2500 - Loss: 2.3300, Perplexity: 168.4417, LR: 9.95e-05, LM: 2.3287, Age: 0.98, Sex: 0.411
2025-10-24 05:24:51,910 - INFO - Epoch 1, Step 1450/2500 - Loss: 2.2626, Perplexity: 162.7148, LR: 9.94e-05, LM: 2.2613, Age: 0.97, Sex: 0.399
2025-10-24 05:25:04,887 - INFO - Epoch 1, Step 1500/2500 - Loss: 2.1927, Perplexity: 157.3401, LR: 9.93e-05, LM: 2.1914, Age: 0.97, Sex: 0.386
2025-10-24 05:25:17,730 - INFO - Epoch 1, Step 1550/2500 - Loss: 2.1272, Perplexity: 152.3181, LR: 9.93e-05, LM: 2.1259, Age: 0.96, Sex: 0.375
2025-10-24 05:25:30,455 - INFO - Epoch 1, Step 1600/2500 - Loss: 2.0651, Perplexity: 147.5959, LR: 9.92e-05, LM: 2.0638, Age: 0.96, Sex: 0.364
2025-10-24 05:25:43,032 - INFO - Epoch 1, Step 1650/2500 - Loss: 2.0077, Perplexity: 143.1620, LR: 9.91e-05, LM: 2.0063, Age: 0.95, Sex: 0.354
2025-10-24 05:25:55,853 - INFO - Epoch 1, Step 1700/2500 - Loss: 1.9533, Perplexity: 139.0014, LR: 9.91e-05, LM: 1.9520, Age: 0.95, Sex: 0.344
2025-10-24 05:26:08,179 - INFO - Epoch 1, Step 1750/2500 - Loss: 1.9016, Perplexity: 135.0703, LR: 9.90e-05, LM: 1.9003, Age: 0.94, Sex: 0.336
2025-10-24 05:26:20,848 - INFO - Epoch 1, Step 1800/2500 - Loss: 1.8519, Perplexity: 131.3505, LR: 9.89e-05, LM: 1.8506, Age: 0.94, Sex: 0.327
2025-10-24 05:26:33,457 - INFO - Epoch 1, Step 1850/2500 - Loss: 1.8042, Perplexity: 127.8304, LR: 9.89e-05, LM: 1.8029, Age: 0.93, Sex: 0.319
2025-10-24 05:26:46,106 - INFO - Epoch 1, Step 1900/2500 - Loss: 1.7593, Perplexity: 124.4985, LR: 9.88e-05, LM: 1.7581, Age: 0.93, Sex: 0.311
2025-10-24 05:26:58,940 - INFO - Epoch 1, Step 1950/2500 - Loss: 1.7178, Perplexity: 121.3450, LR: 9.87e-05, LM: 1.7165, Age: 0.92, Sex: 0.304
2025-10-24 05:27:11,823 - INFO - Epoch 1, Step 2000/2500 - Loss: 1.6794, Perplexity: 118.3487, LR: 9.86e-05, LM: 1.6781, Age: 0.92, Sex: 0.297
2025-10-24 05:27:24,909 - INFO - Epoch 1, Step 2050/2500 - Loss: 1.6407, Perplexity: 115.4913, LR: 9.86e-05, LM: 1.6395, Age: 0.92, Sex: 0.291
2025-10-24 05:27:37,454 - INFO - Epoch 1, Step 2100/2500 - Loss: 1.6056, Perplexity: 112.7727, LR: 9.85e-05, LM: 1.6044, Age: 0.91, Sex: 0.286
2025-10-24 05:27:50,053 - INFO - Epoch 1, Step 2150/2500 - Loss: 1.5704, Perplexity: 110.1777, LR: 9.84e-05, LM: 1.5692, Age: 0.91, Sex: 0.280
2025-10-24 05:28:02,600 - INFO - Epoch 1, Step 2200/2500 - Loss: 1.5367, Perplexity: 107.7005, LR: 9.84e-05, LM: 1.5355, Age: 0.91, Sex: 0.274
2025-10-24 05:28:15,152 - INFO - Epoch 1, Step 2250/2500 - Loss: 1.5072, Perplexity: 105.3464, LR: 9.83e-05, LM: 1.5060, Age: 0.91, Sex: 0.269
2025-10-24 05:28:27,666 - INFO - Epoch 1, Step 2300/2500 - Loss: 1.4773, Perplexity: 103.0880, LR: 9.82e-05, LM: 1.4761, Age: 0.90, Sex: 0.263
2025-10-24 05:28:40,488 - INFO - Epoch 1, Step 2350/2500 - Loss: 1.4482, Perplexity: 100.9204, LR: 9.82e-05, LM: 1.4470, Age: 0.90, Sex: 0.258
2025-10-24 05:28:53,073 - INFO - Epoch 1, Step 2400/2500 - Loss: 1.4197, Perplexity: 98.8444, LR: 9.81e-05, LM: 1.4185, Age: 0.90, Sex: 0.254
2025-10-24 05:29:05,661 - INFO - Epoch 1, Step 2450/2500 - Loss: 1.3921, Perplexity: 96.8492, LR: 9.80e-05, LM: 1.3910, Age: 0.89, Sex: 0.249
2025-10-24 05:29:18,514 - INFO - Epoch 1, Step 2500/2500 - Loss: 1.3651, Perplexity: 94.9332, LR: 9.80e-05, LM: 1.3639, Age: 0.89, Sex: 0.245
2025-10-24 05:29:18,516 - INFO - Epoch 1 Complete - Avg Loss: 1.3651, Avg Perplexity: 94.9332, LM: 1.3639, Age: 0.89, Sex: 0.245
2025-10-24 05:30:08,377 - INFO - Validation - Loss: 0.0514, Perplexity: 1.1025, Token Accuracy: 0.9925, Code Accuracy: 0.9914
2025-10-24 05:30:08,380 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:30:13,250 - INFO - TPL computed on 500 samples: 1.0887
2025-10-24 05:30:13,251 - INFO - Temporal Perplexity (TPL): 1.0887
2025-10-24 05:30:13,252 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:30:23,140 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0000
2025-10-24 05:30:23,141 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 05:30:23,141 - INFO - New best model! Validation loss: 0.0514
2025-10-24 05:30:27,576 - INFO - Checkpoint saved: epoch 1
2025-10-24 05:30:40,232 - INFO - Epoch 2, Step 50/2500 - Loss: 0.0743, Perplexity: 1.2490, LR: 9.79e-05, LM: 0.0735, Age: 0.72, Sex: 0.020
2025-10-24 05:30:52,508 - INFO - Epoch 2, Step 100/2500 - Loss: 0.0746, Perplexity: 1.2245, LR: 9.78e-05, LM: 0.0738, Age: 0.76, Sex: 0.028
2025-10-24 05:31:05,324 - INFO - Epoch 2, Step 150/2500 - Loss: 0.0657, Perplexity: 1.1683, LR: 9.78e-05, LM: 0.0649, Age: 0.75, Sex: 0.026
2025-10-24 05:31:18,068 - INFO - Epoch 2, Step 200/2500 - Loss: 0.0662, Perplexity: 1.1667, LR: 9.77e-05, LM: 0.0654, Age: 0.76, Sex: 0.024
2025-10-24 05:31:30,420 - INFO - Epoch 2, Step 250/2500 - Loss: 0.0871, Perplexity: 1.2085, LR: 9.76e-05, LM: 0.0863, Age: 0.76, Sex: 0.025
2025-10-24 05:31:42,675 - INFO - Epoch 2, Step 300/2500 - Loss: 0.0782, Perplexity: 1.1805, LR: 9.76e-05, LM: 0.0774, Age: 0.76, Sex: 0.023
2025-10-24 05:31:55,658 - INFO - Epoch 2, Step 350/2500 - Loss: 0.0717, Perplexity: 1.1599, LR: 9.75e-05, LM: 0.0710, Age: 0.75, Sex: 0.022
2025-10-24 05:32:08,782 - INFO - Epoch 2, Step 400/2500 - Loss: 0.0901, Perplexity: 1.2180, LR: 9.74e-05, LM: 0.0893, Age: 0.76, Sex: 0.026
2025-10-24 05:32:21,744 - INFO - Epoch 2, Step 450/2500 - Loss: 0.0825, Perplexity: 1.1964, LR: 9.74e-05, LM: 0.0817, Age: 0.76, Sex: 0.034
2025-10-24 05:32:34,684 - INFO - Epoch 2, Step 500/2500 - Loss: 0.0823, Perplexity: 1.1938, LR: 9.73e-05, LM: 0.0815, Age: 0.76, Sex: 0.033
2025-10-24 05:32:47,025 - INFO - Epoch 2, Step 550/2500 - Loss: 0.0836, Perplexity: 1.1992, LR: 9.72e-05, LM: 0.0828, Age: 0.77, Sex: 0.033
2025-10-24 05:32:59,576 - INFO - Epoch 2, Step 600/2500 - Loss: 0.0789, Perplexity: 1.1851, LR: 9.72e-05, LM: 0.0781, Age: 0.77, Sex: 0.032
2025-10-24 05:33:12,090 - INFO - Epoch 2, Step 650/2500 - Loss: 0.0766, Perplexity: 1.1757, LR: 9.71e-05, LM: 0.0758, Age: 0.76, Sex: 0.032
2025-10-24 05:33:24,770 - INFO - Epoch 2, Step 700/2500 - Loss: 0.0756, Perplexity: 1.1721, LR: 9.70e-05, LM: 0.0748, Age: 0.76, Sex: 0.031
2025-10-24 05:33:37,191 - INFO - Epoch 2, Step 750/2500 - Loss: 0.0723, Perplexity: 1.1626, LR: 9.70e-05, LM: 0.0715, Age: 0.76, Sex: 0.030
2025-10-24 05:33:49,985 - INFO - Epoch 2, Step 800/2500 - Loss: 0.0698, Perplexity: 1.1546, LR: 9.69e-05, LM: 0.0690, Age: 0.76, Sex: 0.029
2025-10-24 05:34:02,348 - INFO - Epoch 2, Step 850/2500 - Loss: 0.0688, Perplexity: 1.1523, LR: 9.68e-05, LM: 0.0680, Age: 0.75, Sex: 0.029
2025-10-24 05:34:15,277 - INFO - Epoch 2, Step 900/2500 - Loss: 0.0660, Perplexity: 1.1449, LR: 9.68e-05, LM: 0.0652, Age: 0.75, Sex: 0.028
2025-10-24 05:34:28,061 - INFO - Epoch 2, Step 950/2500 - Loss: 0.0670, Perplexity: 1.1480, LR: 9.67e-05, LM: 0.0662, Age: 0.75, Sex: 0.028
2025-10-24 05:34:40,535 - INFO - Epoch 2, Step 1000/2500 - Loss: 0.0662, Perplexity: 1.1487, LR: 9.66e-05, LM: 0.0654, Age: 0.75, Sex: 0.027
2025-10-24 05:34:53,410 - INFO - Epoch 2, Step 1050/2500 - Loss: 0.0649, Perplexity: 1.1438, LR: 9.66e-05, LM: 0.0642, Age: 0.75, Sex: 0.027
2025-10-24 05:35:05,806 - INFO - Epoch 2, Step 1100/2500 - Loss: 0.0697, Perplexity: 1.1696, LR: 9.65e-05, LM: 0.0689, Age: 0.74, Sex: 0.026
2025-10-24 05:35:18,348 - INFO - Epoch 2, Step 1150/2500 - Loss: 0.0679, Perplexity: 1.1639, LR: 9.64e-05, LM: 0.0671, Age: 0.74, Sex: 0.026
2025-10-24 05:35:31,062 - INFO - Epoch 2, Step 1200/2500 - Loss: 0.0675, Perplexity: 1.1612, LR: 9.64e-05, LM: 0.0667, Age: 0.74, Sex: 0.025
2025-10-24 05:35:43,570 - INFO - Epoch 2, Step 1250/2500 - Loss: 0.0655, Perplexity: 1.1556, LR: 9.63e-05, LM: 0.0647, Age: 0.74, Sex: 0.025
2025-10-24 05:35:56,146 - INFO - Epoch 2, Step 1300/2500 - Loss: 0.0665, Perplexity: 1.1569, LR: 9.62e-05, LM: 0.0657, Age: 0.74, Sex: 0.025
2025-10-24 05:36:08,885 - INFO - Epoch 2, Step 1350/2500 - Loss: 0.0713, Perplexity: 1.1782, LR: 9.61e-05, LM: 0.0706, Age: 0.74, Sex: 0.025
2025-10-24 05:36:21,726 - INFO - Epoch 2, Step 1400/2500 - Loss: 0.0702, Perplexity: 1.1737, LR: 9.61e-05, LM: 0.0694, Age: 0.74, Sex: 0.025
2025-10-24 05:36:34,311 - INFO - Epoch 2, Step 1450/2500 - Loss: 0.0716, Perplexity: 1.1778, LR: 9.60e-05, LM: 0.0709, Age: 0.74, Sex: 0.024
2025-10-24 05:36:47,333 - INFO - Epoch 2, Step 1500/2500 - Loss: 0.0711, Perplexity: 1.1762, LR: 9.59e-05, LM: 0.0703, Age: 0.74, Sex: 0.025
2025-10-24 05:36:59,595 - INFO - Epoch 2, Step 1550/2500 - Loss: 0.0714, Perplexity: 1.1765, LR: 9.59e-05, LM: 0.0707, Age: 0.74, Sex: 0.025
2025-10-24 05:37:12,481 - INFO - Epoch 2, Step 1600/2500 - Loss: 0.0727, Perplexity: 1.1793, LR: 9.58e-05, LM: 0.0720, Age: 0.74, Sex: 0.025
2025-10-24 05:37:25,427 - INFO - Epoch 2, Step 1650/2500 - Loss: 0.0726, Perplexity: 1.1794, LR: 9.57e-05, LM: 0.0719, Age: 0.74, Sex: 0.025
2025-10-24 05:37:38,185 - INFO - Epoch 2, Step 1700/2500 - Loss: 0.0723, Perplexity: 1.1791, LR: 9.57e-05, LM: 0.0716, Age: 0.74, Sex: 0.025
2025-10-24 05:37:50,873 - INFO - Epoch 2, Step 1750/2500 - Loss: 0.0709, Perplexity: 1.1747, LR: 9.56e-05, LM: 0.0701, Age: 0.74, Sex: 0.025
2025-10-24 05:38:03,500 - INFO - Epoch 2, Step 1800/2500 - Loss: 0.0705, Perplexity: 1.1735, LR: 9.55e-05, LM: 0.0697, Age: 0.74, Sex: 0.025
2025-10-24 05:38:16,136 - INFO - Epoch 2, Step 1850/2500 - Loss: 0.0714, Perplexity: 1.1791, LR: 9.55e-05, LM: 0.0706, Age: 0.74, Sex: 0.025
2025-10-24 05:38:28,478 - INFO - Epoch 2, Step 1900/2500 - Loss: 0.0705, Perplexity: 1.1759, LR: 9.54e-05, LM: 0.0697, Age: 0.74, Sex: 0.025
2025-10-24 05:38:41,591 - INFO - Epoch 2, Step 1950/2500 - Loss: 0.0690, Perplexity: 1.1717, LR: 9.53e-05, LM: 0.0682, Age: 0.73, Sex: 0.025
2025-10-24 05:38:54,324 - INFO - Epoch 2, Step 2000/2500 - Loss: 0.0695, Perplexity: 1.1716, LR: 9.53e-05, LM: 0.0688, Age: 0.73, Sex: 0.025
2025-10-24 05:39:07,018 - INFO - Epoch 2, Step 2050/2500 - Loss: 0.0683, Perplexity: 1.1680, LR: 9.52e-05, LM: 0.0676, Age: 0.73, Sex: 0.025
2025-10-24 05:39:20,027 - INFO - Epoch 2, Step 2100/2500 - Loss: 0.0675, Perplexity: 1.1652, LR: 9.51e-05, LM: 0.0667, Age: 0.73, Sex: 0.024
2025-10-24 05:39:32,779 - INFO - Epoch 2, Step 2150/2500 - Loss: 0.0692, Perplexity: 1.1691, LR: 9.51e-05, LM: 0.0684, Age: 0.74, Sex: 0.025
2025-10-24 05:39:45,436 - INFO - Epoch 2, Step 2200/2500 - Loss: 0.0679, Perplexity: 1.1656, LR: 9.50e-05, LM: 0.0671, Age: 0.74, Sex: 0.025
2025-10-24 05:39:58,552 - INFO - Epoch 2, Step 2250/2500 - Loss: 0.0666, Perplexity: 1.1622, LR: 9.49e-05, LM: 0.0659, Age: 0.74, Sex: 0.025
2025-10-24 05:40:11,187 - INFO - Epoch 2, Step 2300/2500 - Loss: 0.0656, Perplexity: 1.1590, LR: 9.49e-05, LM: 0.0648, Age: 0.74, Sex: 0.025
2025-10-24 05:40:24,086 - INFO - Epoch 2, Step 2350/2500 - Loss: 0.0649, Perplexity: 1.1564, LR: 9.48e-05, LM: 0.0641, Age: 0.73, Sex: 0.025
2025-10-24 05:40:36,444 - INFO - Epoch 2, Step 2400/2500 - Loss: 0.0638, Perplexity: 1.1535, LR: 9.47e-05, LM: 0.0630, Age: 0.73, Sex: 0.024
2025-10-24 05:40:48,724 - INFO - Epoch 2, Step 2450/2500 - Loss: 0.0627, Perplexity: 1.1506, LR: 9.47e-05, LM: 0.0620, Age: 0.73, Sex: 0.024
2025-10-24 05:41:01,693 - INFO - Epoch 2, Step 2500/2500 - Loss: 0.0627, Perplexity: 1.1503, LR: 9.46e-05, LM: 0.0619, Age: 0.73, Sex: 0.024
2025-10-24 05:41:01,695 - INFO - Epoch 2 Complete - Avg Loss: 0.0627, Avg Perplexity: 1.1503, LM: 0.0619, Age: 0.73, Sex: 0.024
2025-10-24 05:41:51,730 - INFO - Validation - Loss: 0.0212, Perplexity: 1.0355, Token Accuracy: 0.9968, Code Accuracy: 0.9962
2025-10-24 05:41:51,733 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:41:56,653 - INFO - TPL computed on 500 samples: 1.0408
2025-10-24 05:41:56,653 - INFO - Temporal Perplexity (TPL): 1.0408
2025-10-24 05:41:56,654 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:42:09,500 - INFO - Reconstruction Jaccard computed on 137 visits: 0.0000
2025-10-24 05:42:09,501 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 05:42:09,501 - INFO - New best model! Validation loss: 0.0212
2025-10-24 05:42:13,919 - INFO - Checkpoint saved: epoch 2
2025-10-24 05:42:26,772 - INFO - Epoch 3, Step 50/2500 - Loss: 0.0523, Perplexity: 1.1726, LR: 9.45e-05, LM: 0.0516, Age: 0.67, Sex: 0.051
2025-10-24 05:42:39,279 - INFO - Epoch 3, Step 100/2500 - Loss: 0.0449, Perplexity: 1.1145, LR: 9.45e-05, LM: 0.0441, Age: 0.67, Sex: 0.038
2025-10-24 05:42:52,130 - INFO - Epoch 3, Step 150/2500 - Loss: 0.0322, Perplexity: 1.0786, LR: 9.44e-05, LM: 0.0315, Age: 0.67, Sex: 0.025
2025-10-24 05:43:04,676 - INFO - Epoch 3, Step 200/2500 - Loss: 0.0493, Perplexity: 1.1295, LR: 9.43e-05, LM: 0.0486, Age: 0.69, Sex: 0.023
2025-10-24 05:43:17,289 - INFO - Epoch 3, Step 250/2500 - Loss: 0.0415, Perplexity: 1.1057, LR: 9.43e-05, LM: 0.0407, Age: 0.69, Sex: 0.019
2025-10-24 05:43:29,700 - INFO - Epoch 3, Step 300/2500 - Loss: 0.0488, Perplexity: 1.1229, LR: 9.42e-05, LM: 0.0481, Age: 0.69, Sex: 0.021
2025-10-24 05:43:42,441 - INFO - Epoch 3, Step 350/2500 - Loss: 0.0457, Perplexity: 1.1101, LR: 9.41e-05, LM: 0.0450, Age: 0.69, Sex: 0.020
2025-10-24 05:43:54,912 - INFO - Epoch 3, Step 400/2500 - Loss: 0.0416, Perplexity: 1.0979, LR: 9.41e-05, LM: 0.0409, Age: 0.69, Sex: 0.018
2025-10-24 05:44:07,525 - INFO - Epoch 3, Step 450/2500 - Loss: 0.0473, Perplexity: 1.1159, LR: 9.40e-05, LM: 0.0466, Age: 0.70, Sex: 0.019
2025-10-24 05:44:20,268 - INFO - Epoch 3, Step 500/2500 - Loss: 0.0442, Perplexity: 1.1059, LR: 9.39e-05, LM: 0.0435, Age: 0.70, Sex: 0.019
2025-10-24 05:44:32,706 - INFO - Epoch 3, Step 550/2500 - Loss: 0.0428, Perplexity: 1.0998, LR: 9.39e-05, LM: 0.0421, Age: 0.70, Sex: 0.019
2025-10-24 05:44:45,335 - INFO - Epoch 3, Step 600/2500 - Loss: 0.0411, Perplexity: 1.0936, LR: 9.38e-05, LM: 0.0404, Age: 0.71, Sex: 0.019
2025-10-24 05:44:57,997 - INFO - Epoch 3, Step 650/2500 - Loss: 0.0385, Perplexity: 1.0870, LR: 9.37e-05, LM: 0.0378, Age: 0.71, Sex: 0.018
2025-10-24 05:45:10,938 - INFO - Epoch 3, Step 700/2500 - Loss: 0.0388, Perplexity: 1.0859, LR: 9.36e-05, LM: 0.0381, Age: 0.71, Sex: 0.019
2025-10-24 05:45:23,256 - INFO - Epoch 3, Step 750/2500 - Loss: 0.0378, Perplexity: 1.0821, LR: 9.36e-05, LM: 0.0371, Age: 0.71, Sex: 0.019
2025-10-24 05:45:35,623 - INFO - Epoch 3, Step 800/2500 - Loss: 0.0360, Perplexity: 1.0774, LR: 9.35e-05, LM: 0.0352, Age: 0.71, Sex: 0.019
2025-10-24 05:45:48,497 - INFO - Epoch 3, Step 850/2500 - Loss: 0.0381, Perplexity: 1.0816, LR: 9.34e-05, LM: 0.0373, Age: 0.71, Sex: 0.018
2025-10-24 05:46:01,351 - INFO - Epoch 3, Step 900/2500 - Loss: 0.0376, Perplexity: 1.0792, LR: 9.34e-05, LM: 0.0368, Age: 0.70, Sex: 0.019
2025-10-24 05:46:13,916 - INFO - Epoch 3, Step 950/2500 - Loss: 0.0380, Perplexity: 1.0813, LR: 9.33e-05, LM: 0.0373, Age: 0.70, Sex: 0.018
2025-10-24 05:46:26,345 - INFO - Epoch 3, Step 1000/2500 - Loss: 0.0392, Perplexity: 1.0867, LR: 9.32e-05, LM: 0.0385, Age: 0.70, Sex: 0.018
2025-10-24 05:46:38,879 - INFO - Epoch 3, Step 1050/2500 - Loss: 0.0389, Perplexity: 1.0856, LR: 9.32e-05, LM: 0.0381, Age: 0.70, Sex: 0.018
2025-10-24 05:46:51,466 - INFO - Epoch 3, Step 1100/2500 - Loss: 0.0390, Perplexity: 1.0855, LR: 9.31e-05, LM: 0.0382, Age: 0.70, Sex: 0.018
2025-10-24 05:47:04,469 - INFO - Epoch 3, Step 1150/2500 - Loss: 0.0405, Perplexity: 1.0881, LR: 9.30e-05, LM: 0.0398, Age: 0.70, Sex: 0.018
2025-10-24 05:47:17,056 - INFO - Epoch 3, Step 1200/2500 - Loss: 0.0412, Perplexity: 1.0896, LR: 9.30e-05, LM: 0.0405, Age: 0.70, Sex: 0.017
2025-10-24 05:47:29,978 - INFO - Epoch 3, Step 1250/2500 - Loss: 0.0399, Perplexity: 1.0864, LR: 9.29e-05, LM: 0.0392, Age: 0.70, Sex: 0.017
2025-10-24 05:47:42,574 - INFO - Epoch 3, Step 1300/2500 - Loss: 0.0393, Perplexity: 1.0843, LR: 9.28e-05, LM: 0.0386, Age: 0.70, Sex: 0.018
2025-10-24 05:47:55,312 - INFO - Epoch 3, Step 1350/2500 - Loss: 0.0394, Perplexity: 1.0852, LR: 9.28e-05, LM: 0.0387, Age: 0.70, Sex: 0.018
2025-10-24 05:48:07,910 - INFO - Epoch 3, Step 1400/2500 - Loss: 0.0386, Perplexity: 1.0828, LR: 9.27e-05, LM: 0.0379, Age: 0.70, Sex: 0.018
2025-10-24 05:48:20,455 - INFO - Epoch 3, Step 1450/2500 - Loss: 0.0376, Perplexity: 1.0803, LR: 9.26e-05, LM: 0.0368, Age: 0.70, Sex: 0.017
2025-10-24 05:48:33,219 - INFO - Epoch 3, Step 1500/2500 - Loss: 0.0386, Perplexity: 1.0838, LR: 9.26e-05, LM: 0.0379, Age: 0.70, Sex: 0.018
2025-10-24 05:48:46,156 - INFO - Epoch 3, Step 1550/2500 - Loss: 0.0377, Perplexity: 1.0814, LR: 9.25e-05, LM: 0.0370, Age: 0.70, Sex: 0.017
2025-10-24 05:48:59,116 - INFO - Epoch 3, Step 1600/2500 - Loss: 0.0367, Perplexity: 1.0791, LR: 9.24e-05, LM: 0.0360, Age: 0.70, Sex: 0.017
2025-10-24 05:49:11,744 - INFO - Epoch 3, Step 1650/2500 - Loss: 0.0359, Perplexity: 1.0770, LR: 9.24e-05, LM: 0.0352, Age: 0.70, Sex: 0.017
2025-10-24 05:49:24,293 - INFO - Epoch 3, Step 1700/2500 - Loss: 0.0369, Perplexity: 1.0795, LR: 9.23e-05, LM: 0.0362, Age: 0.70, Sex: 0.017
2025-10-24 05:49:36,806 - INFO - Epoch 3, Step 1750/2500 - Loss: 0.0387, Perplexity: 1.0823, LR: 9.22e-05, LM: 0.0379, Age: 0.71, Sex: 0.018
2025-10-24 05:49:49,458 - INFO - Epoch 3, Step 1800/2500 - Loss: 0.0378, Perplexity: 1.0803, LR: 9.22e-05, LM: 0.0371, Age: 0.71, Sex: 0.018
2025-10-24 05:50:02,058 - INFO - Epoch 3, Step 1850/2500 - Loss: 0.0373, Perplexity: 1.0787, LR: 9.21e-05, LM: 0.0365, Age: 0.71, Sex: 0.018
2025-10-24 05:50:14,764 - INFO - Epoch 3, Step 1900/2500 - Loss: 0.0366, Perplexity: 1.0770, LR: 9.20e-05, LM: 0.0359, Age: 0.71, Sex: 0.017
2025-10-24 05:50:27,347 - INFO - Epoch 3, Step 1950/2500 - Loss: 0.0360, Perplexity: 1.0753, LR: 9.20e-05, LM: 0.0352, Age: 0.71, Sex: 0.017
2025-10-24 05:50:40,663 - INFO - Epoch 3, Step 2000/2500 - Loss: 0.0354, Perplexity: 1.0738, LR: 9.19e-05, LM: 0.0347, Age: 0.71, Sex: 0.017
2025-10-24 05:50:53,343 - INFO - Epoch 3, Step 2050/2500 - Loss: 0.0348, Perplexity: 1.0723, LR: 9.18e-05, LM: 0.0341, Age: 0.71, Sex: 0.017
2025-10-24 05:51:06,042 - INFO - Epoch 3, Step 2100/2500 - Loss: 0.0343, Perplexity: 1.0710, LR: 9.18e-05, LM: 0.0336, Age: 0.71, Sex: 0.017
2025-10-24 05:51:19,010 - INFO - Epoch 3, Step 2150/2500 - Loss: 0.0340, Perplexity: 1.0699, LR: 9.17e-05, LM: 0.0333, Age: 0.71, Sex: 0.017
2025-10-24 05:51:31,601 - INFO - Epoch 3, Step 2200/2500 - Loss: 0.0342, Perplexity: 1.0716, LR: 9.16e-05, LM: 0.0335, Age: 0.70, Sex: 0.017
2025-10-24 05:51:44,125 - INFO - Epoch 3, Step 2250/2500 - Loss: 0.0336, Perplexity: 1.0701, LR: 9.16e-05, LM: 0.0329, Age: 0.70, Sex: 0.017
2025-10-24 05:51:57,063 - INFO - Epoch 3, Step 2300/2500 - Loss: 0.0337, Perplexity: 1.0698, LR: 9.15e-05, LM: 0.0329, Age: 0.70, Sex: 0.017
2025-10-24 05:52:09,860 - INFO - Epoch 3, Step 2350/2500 - Loss: 0.0346, Perplexity: 1.0736, LR: 9.14e-05, LM: 0.0339, Age: 0.70, Sex: 0.017
2025-10-24 05:52:22,897 - INFO - Epoch 3, Step 2400/2500 - Loss: 0.0355, Perplexity: 1.0759, LR: 9.14e-05, LM: 0.0348, Age: 0.70, Sex: 0.017
2025-10-24 05:52:35,533 - INFO - Epoch 3, Step 2450/2500 - Loss: 0.0349, Perplexity: 1.0745, LR: 9.13e-05, LM: 0.0341, Age: 0.70, Sex: 0.017
2025-10-24 05:52:48,329 - INFO - Epoch 3, Step 2500/2500 - Loss: 0.0352, Perplexity: 1.0749, LR: 9.12e-05, LM: 0.0345, Age: 0.70, Sex: 0.017
2025-10-24 05:52:48,331 - INFO - Epoch 3 Complete - Avg Loss: 0.0352, Avg Perplexity: 1.0749, LM: 0.0345, Age: 0.70, Sex: 0.017
2025-10-24 05:53:38,252 - INFO - Validation - Loss: 0.0148, Perplexity: 1.0213, Token Accuracy: 0.9978, Code Accuracy: 0.9974
2025-10-24 05:53:38,254 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 05:53:43,191 - INFO - TPL computed on 500 samples: 1.0279
2025-10-24 05:53:43,191 - INFO - Temporal Perplexity (TPL): 1.0279
2025-10-24 05:53:43,192 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 05:53:54,037 - INFO - Reconstruction Jaccard computed on 123 visits: 0.0020
2025-10-24 05:53:54,037 - INFO - Reconstruction Jaccard: 0.0020
2025-10-24 05:53:54,038 - INFO - New best model! Validation loss: 0.0148
2025-10-24 05:53:58,505 - INFO - Checkpoint saved: epoch 3
2025-10-24 05:54:11,163 - INFO - Epoch 4, Step 50/2500 - Loss: 0.0280, Perplexity: 1.0381, LR: 9.11e-05, LM: 0.0272, Age: 0.73, Sex: 0.027
2025-10-24 05:54:23,756 - INFO - Epoch 4, Step 100/2500 - Loss: 0.0294, Perplexity: 1.0421, LR: 9.11e-05, LM: 0.0287, Age: 0.71, Sex: 0.023
2025-10-24 05:54:36,524 - INFO - Epoch 4, Step 150/2500 - Loss: 0.0251, Perplexity: 1.0341, LR: 9.10e-05, LM: 0.0244, Age: 0.70, Sex: 0.019
2025-10-24 05:54:48,984 - INFO - Epoch 4, Step 200/2500 - Loss: 0.0386, Perplexity: 1.0637, LR: 9.09e-05, LM: 0.0379, Age: 0.71, Sex: 0.020
2025-10-24 05:55:01,700 - INFO - Epoch 4, Step 250/2500 - Loss: 0.0340, Perplexity: 1.0544, LR: 9.09e-05, LM: 0.0332, Age: 0.70, Sex: 0.019
2025-10-24 05:55:14,411 - INFO - Epoch 4, Step 300/2500 - Loss: 0.0300, Perplexity: 1.0471, LR: 9.08e-05, LM: 0.0292, Age: 0.70, Sex: 0.018
2025-10-24 05:55:27,165 - INFO - Epoch 4, Step 350/2500 - Loss: 0.0283, Perplexity: 1.0434, LR: 9.07e-05, LM: 0.0276, Age: 0.70, Sex: 0.018
2025-10-24 05:55:39,889 - INFO - Epoch 4, Step 400/2500 - Loss: 0.0258, Perplexity: 1.0390, LR: 9.07e-05, LM: 0.0251, Age: 0.69, Sex: 0.018
2025-10-24 05:55:52,217 - INFO - Epoch 4, Step 450/2500 - Loss: 0.0240, Perplexity: 1.0358, LR: 9.06e-05, LM: 0.0233, Age: 0.69, Sex: 0.017
2025-10-24 05:56:04,914 - INFO - Epoch 4, Step 500/2500 - Loss: 0.0223, Perplexity: 1.0330, LR: 9.05e-05, LM: 0.0216, Age: 0.69, Sex: 0.016
2025-10-24 05:56:17,389 - INFO - Epoch 4, Step 550/2500 - Loss: 0.0210, Perplexity: 1.0307, LR: 9.05e-05, LM: 0.0203, Age: 0.69, Sex: 0.015
2025-10-24 05:56:30,107 - INFO - Epoch 4, Step 600/2500 - Loss: 0.0207, Perplexity: 1.0301, LR: 9.04e-05, LM: 0.0200, Age: 0.69, Sex: 0.014
2025-10-24 05:56:42,866 - INFO - Epoch 4, Step 650/2500 - Loss: 0.0213, Perplexity: 1.0317, LR: 9.03e-05, LM: 0.0206, Age: 0.69, Sex: 0.013
2025-10-24 05:56:55,435 - INFO - Epoch 4, Step 700/2500 - Loss: 0.0212, Perplexity: 1.0312, LR: 9.03e-05, LM: 0.0205, Age: 0.69, Sex: 0.013
2025-10-24 05:57:08,252 - INFO - Epoch 4, Step 750/2500 - Loss: 0.0202, Perplexity: 1.0295, LR: 9.02e-05, LM: 0.0195, Age: 0.69, Sex: 0.012
2025-10-24 05:57:20,972 - INFO - Epoch 4, Step 800/2500 - Loss: 0.0232, Perplexity: 1.0359, LR: 9.01e-05, LM: 0.0225, Age: 0.69, Sex: 0.013
2025-10-24 05:57:34,002 - INFO - Epoch 4, Step 850/2500 - Loss: 0.0226, Perplexity: 1.0346, LR: 9.01e-05, LM: 0.0219, Age: 0.69, Sex: 0.012
2025-10-24 05:57:46,569 - INFO - Epoch 4, Step 900/2500 - Loss: 0.0224, Perplexity: 1.0340, LR: 9.00e-05, LM: 0.0217, Age: 0.69, Sex: 0.012
2025-10-24 05:57:58,978 - INFO - Epoch 4, Step 950/2500 - Loss: 0.0216, Perplexity: 1.0327, LR: 8.99e-05, LM: 0.0209, Age: 0.69, Sex: 0.013
2025-10-24 05:58:11,520 - INFO - Epoch 4, Step 1000/2500 - Loss: 0.0235, Perplexity: 1.0367, LR: 8.99e-05, LM: 0.0228, Age: 0.68, Sex: 0.012
2025-10-24 05:58:24,052 - INFO - Epoch 4, Step 1050/2500 - Loss: 0.0233, Perplexity: 1.0361, LR: 8.98e-05, LM: 0.0226, Age: 0.68, Sex: 0.012
2025-10-24 05:58:36,996 - INFO - Epoch 4, Step 1100/2500 - Loss: 0.0224, Perplexity: 1.0347, LR: 8.97e-05, LM: 0.0218, Age: 0.68, Sex: 0.012
2025-10-24 05:58:49,183 - INFO - Epoch 4, Step 1150/2500 - Loss: 0.0231, Perplexity: 1.0369, LR: 8.97e-05, LM: 0.0224, Age: 0.68, Sex: 0.012
2025-10-24 05:59:02,034 - INFO - Epoch 4, Step 1200/2500 - Loss: 0.0230, Perplexity: 1.0365, LR: 8.96e-05, LM: 0.0223, Age: 0.68, Sex: 0.012
2025-10-24 05:59:14,787 - INFO - Epoch 4, Step 1250/2500 - Loss: 0.0233, Perplexity: 1.0376, LR: 8.95e-05, LM: 0.0227, Age: 0.68, Sex: 0.011
2025-10-24 05:59:27,322 - INFO - Epoch 4, Step 1300/2500 - Loss: 0.0229, Perplexity: 1.0367, LR: 8.95e-05, LM: 0.0222, Age: 0.68, Sex: 0.012
2025-10-24 05:59:40,235 - INFO - Epoch 4, Step 1350/2500 - Loss: 0.0228, Perplexity: 1.0361, LR: 8.94e-05, LM: 0.0221, Age: 0.68, Sex: 0.012
2025-10-24 05:59:52,548 - INFO - Epoch 4, Step 1400/2500 - Loss: 0.0225, Perplexity: 1.0354, LR: 8.93e-05, LM: 0.0218, Age: 0.68, Sex: 0.012
2025-10-24 06:00:05,002 - INFO - Epoch 4, Step 1450/2500 - Loss: 0.0222, Perplexity: 1.0347, LR: 8.93e-05, LM: 0.0215, Age: 0.68, Sex: 0.011
2025-10-24 06:00:17,311 - INFO - Epoch 4, Step 1500/2500 - Loss: 0.0217, Perplexity: 1.0338, LR: 8.92e-05, LM: 0.0210, Age: 0.68, Sex: 0.011
2025-10-24 06:00:29,978 - INFO - Epoch 4, Step 1550/2500 - Loss: 0.0217, Perplexity: 1.0337, LR: 8.91e-05, LM: 0.0210, Age: 0.68, Sex: 0.012
2025-10-24 06:00:42,494 - INFO - Epoch 4, Step 1600/2500 - Loss: 0.0221, Perplexity: 1.0349, LR: 8.91e-05, LM: 0.0214, Age: 0.68, Sex: 0.012
2025-10-24 06:00:55,298 - INFO - Epoch 4, Step 1650/2500 - Loss: 0.0217, Perplexity: 1.0341, LR: 8.90e-05, LM: 0.0210, Age: 0.68, Sex: 0.012
2025-10-24 06:01:07,856 - INFO - Epoch 4, Step 1700/2500 - Loss: 0.0218, Perplexity: 1.0339, LR: 8.89e-05, LM: 0.0211, Age: 0.68, Sex: 0.013
2025-10-24 06:01:20,652 - INFO - Epoch 4, Step 1750/2500 - Loss: 0.0216, Perplexity: 1.0333, LR: 8.89e-05, LM: 0.0209, Age: 0.68, Sex: 0.012
2025-10-24 06:01:33,323 - INFO - Epoch 4, Step 1800/2500 - Loss: 0.0216, Perplexity: 1.0334, LR: 8.88e-05, LM: 0.0210, Age: 0.68, Sex: 0.013
2025-10-24 06:01:45,878 - INFO - Epoch 4, Step 1850/2500 - Loss: 0.0212, Perplexity: 1.0326, LR: 8.87e-05, LM: 0.0205, Age: 0.68, Sex: 0.013
2025-10-24 06:01:58,674 - INFO - Epoch 4, Step 1900/2500 - Loss: 0.0209, Perplexity: 1.0320, LR: 8.86e-05, LM: 0.0202, Age: 0.68, Sex: 0.013
2025-10-24 06:02:11,641 - INFO - Epoch 4, Step 1950/2500 - Loss: 0.0207, Perplexity: 1.0315, LR: 8.86e-05, LM: 0.0200, Age: 0.68, Sex: 0.013
2025-10-24 06:02:24,264 - INFO - Epoch 4, Step 2000/2500 - Loss: 0.0206, Perplexity: 1.0313, LR: 8.85e-05, LM: 0.0199, Age: 0.68, Sex: 0.013
2025-10-24 06:02:37,146 - INFO - Epoch 4, Step 2050/2500 - Loss: 0.0210, Perplexity: 1.0320, LR: 8.84e-05, LM: 0.0203, Age: 0.67, Sex: 0.013
2025-10-24 06:02:49,842 - INFO - Epoch 4, Step 2100/2500 - Loss: 0.0207, Perplexity: 1.0315, LR: 8.84e-05, LM: 0.0200, Age: 0.67, Sex: 0.012
2025-10-24 06:03:02,681 - INFO - Epoch 4, Step 2150/2500 - Loss: 0.0206, Perplexity: 1.0311, LR: 8.83e-05, LM: 0.0199, Age: 0.67, Sex: 0.012
2025-10-24 06:03:15,229 - INFO - Epoch 4, Step 2200/2500 - Loss: 0.0202, Perplexity: 1.0305, LR: 8.82e-05, LM: 0.0195, Age: 0.67, Sex: 0.012
2025-10-24 06:03:27,952 - INFO - Epoch 4, Step 2250/2500 - Loss: 0.0210, Perplexity: 1.0321, LR: 8.82e-05, LM: 0.0203, Age: 0.67, Sex: 0.012
2025-10-24 06:03:40,905 - INFO - Epoch 4, Step 2300/2500 - Loss: 0.0212, Perplexity: 1.0328, LR: 8.81e-05, LM: 0.0206, Age: 0.67, Sex: 0.012
2025-10-24 06:03:53,448 - INFO - Epoch 4, Step 2350/2500 - Loss: 0.0218, Perplexity: 1.0338, LR: 8.80e-05, LM: 0.0211, Age: 0.67, Sex: 0.012
2025-10-24 06:04:05,995 - INFO - Epoch 4, Step 2400/2500 - Loss: 0.0214, Perplexity: 1.0332, LR: 8.80e-05, LM: 0.0207, Age: 0.67, Sex: 0.012
2025-10-24 06:04:18,795 - INFO - Epoch 4, Step 2450/2500 - Loss: 0.0212, Perplexity: 1.0329, LR: 8.79e-05, LM: 0.0205, Age: 0.67, Sex: 0.012
2025-10-24 06:04:31,197 - INFO - Epoch 4, Step 2500/2500 - Loss: 0.0219, Perplexity: 1.0345, LR: 8.78e-05, LM: 0.0212, Age: 0.67, Sex: 0.012
2025-10-24 06:04:31,199 - INFO - Epoch 4 Complete - Avg Loss: 0.0219, Avg Perplexity: 1.0345, LM: 0.0212, Age: 0.67, Sex: 0.012
2025-10-24 06:05:21,267 - INFO - Validation - Loss: 0.0046, Perplexity: 1.0055, Token Accuracy: 0.9994, Code Accuracy: 0.9992
2025-10-24 06:05:21,269 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:05:26,158 - INFO - TPL computed on 500 samples: 1.0069
2025-10-24 06:05:26,158 - INFO - Temporal Perplexity (TPL): 1.0069
2025-10-24 06:05:26,159 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:05:35,206 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0012
2025-10-24 06:05:35,206 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 06:05:35,206 - INFO - New best model! Validation loss: 0.0046
2025-10-24 06:05:39,694 - INFO - Checkpoint saved: epoch 4
2025-10-24 06:05:52,394 - INFO - Epoch 5, Step 50/2500 - Loss: 0.0305, Perplexity: 1.0497, LR: 8.78e-05, LM: 0.0298, Age: 0.67, Sex: 0.014
2025-10-24 06:06:05,153 - INFO - Epoch 5, Step 100/2500 - Loss: 0.0184, Perplexity: 1.0281, LR: 8.77e-05, LM: 0.0178, Age: 0.66, Sex: 0.014
2025-10-24 06:06:17,898 - INFO - Epoch 5, Step 150/2500 - Loss: 0.0146, Perplexity: 1.0211, LR: 8.76e-05, LM: 0.0139, Age: 0.66, Sex: 0.012
2025-10-24 06:06:30,373 - INFO - Epoch 5, Step 200/2500 - Loss: 0.0129, Perplexity: 1.0178, LR: 8.76e-05, LM: 0.0122, Age: 0.66, Sex: 0.009
2025-10-24 06:06:43,110 - INFO - Epoch 5, Step 250/2500 - Loss: 0.0130, Perplexity: 1.0170, LR: 8.75e-05, LM: 0.0124, Age: 0.66, Sex: 0.010
2025-10-24 06:06:55,920 - INFO - Epoch 5, Step 300/2500 - Loss: 0.0127, Perplexity: 1.0161, LR: 8.74e-05, LM: 0.0120, Age: 0.66, Sex: 0.009
2025-10-24 06:07:08,791 - INFO - Epoch 5, Step 350/2500 - Loss: 0.0137, Perplexity: 1.0171, LR: 8.74e-05, LM: 0.0130, Age: 0.66, Sex: 0.010
2025-10-24 06:07:21,312 - INFO - Epoch 5, Step 400/2500 - Loss: 0.0173, Perplexity: 1.0233, LR: 8.73e-05, LM: 0.0167, Age: 0.65, Sex: 0.011
2025-10-24 06:07:33,691 - INFO - Epoch 5, Step 450/2500 - Loss: 0.0192, Perplexity: 1.0267, LR: 8.72e-05, LM: 0.0185, Age: 0.65, Sex: 0.011
2025-10-24 06:07:46,374 - INFO - Epoch 5, Step 500/2500 - Loss: 0.0187, Perplexity: 1.0256, LR: 8.72e-05, LM: 0.0180, Age: 0.65, Sex: 0.011
2025-10-24 06:07:59,163 - INFO - Epoch 5, Step 550/2500 - Loss: 0.0175, Perplexity: 1.0238, LR: 8.71e-05, LM: 0.0168, Age: 0.65, Sex: 0.011
2025-10-24 06:08:11,864 - INFO - Epoch 5, Step 600/2500 - Loss: 0.0163, Perplexity: 1.0221, LR: 8.70e-05, LM: 0.0157, Age: 0.65, Sex: 0.010
2025-10-24 06:08:24,286 - INFO - Epoch 5, Step 650/2500 - Loss: 0.0162, Perplexity: 1.0218, LR: 8.70e-05, LM: 0.0156, Age: 0.65, Sex: 0.010
2025-10-24 06:08:37,244 - INFO - Epoch 5, Step 700/2500 - Loss: 0.0165, Perplexity: 1.0222, LR: 8.69e-05, LM: 0.0158, Age: 0.65, Sex: 0.010
2025-10-24 06:08:49,808 - INFO - Epoch 5, Step 750/2500 - Loss: 0.0169, Perplexity: 1.0233, LR: 8.68e-05, LM: 0.0162, Age: 0.65, Sex: 0.009
2025-10-24 06:09:02,168 - INFO - Epoch 5, Step 800/2500 - Loss: 0.0161, Perplexity: 1.0221, LR: 8.68e-05, LM: 0.0154, Age: 0.66, Sex: 0.009
2025-10-24 06:09:14,843 - INFO - Epoch 5, Step 850/2500 - Loss: 0.0165, Perplexity: 1.0224, LR: 8.67e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:09:27,475 - INFO - Epoch 5, Step 900/2500 - Loss: 0.0167, Perplexity: 1.0229, LR: 8.66e-05, LM: 0.0160, Age: 0.65, Sex: 0.010
2025-10-24 06:09:39,808 - INFO - Epoch 5, Step 950/2500 - Loss: 0.0171, Perplexity: 1.0238, LR: 8.66e-05, LM: 0.0164, Age: 0.65, Sex: 0.010
2025-10-24 06:09:52,665 - INFO - Epoch 5, Step 1000/2500 - Loss: 0.0173, Perplexity: 1.0241, LR: 8.65e-05, LM: 0.0167, Age: 0.65, Sex: 0.009
2025-10-24 06:10:05,321 - INFO - Epoch 5, Step 1050/2500 - Loss: 0.0168, Perplexity: 1.0233, LR: 8.64e-05, LM: 0.0162, Age: 0.65, Sex: 0.009
2025-10-24 06:10:18,506 - INFO - Epoch 5, Step 1100/2500 - Loss: 0.0163, Perplexity: 1.0225, LR: 8.64e-05, LM: 0.0156, Age: 0.65, Sex: 0.009
2025-10-24 06:10:31,054 - INFO - Epoch 5, Step 1150/2500 - Loss: 0.0158, Perplexity: 1.0217, LR: 8.63e-05, LM: 0.0152, Age: 0.65, Sex: 0.008
2025-10-24 06:10:43,848 - INFO - Epoch 5, Step 1200/2500 - Loss: 0.0155, Perplexity: 1.0212, LR: 8.62e-05, LM: 0.0149, Age: 0.65, Sex: 0.008
2025-10-24 06:10:56,508 - INFO - Epoch 5, Step 1250/2500 - Loss: 0.0160, Perplexity: 1.0218, LR: 8.61e-05, LM: 0.0154, Age: 0.66, Sex: 0.008
2025-10-24 06:11:09,309 - INFO - Epoch 5, Step 1300/2500 - Loss: 0.0156, Perplexity: 1.0211, LR: 8.61e-05, LM: 0.0149, Age: 0.66, Sex: 0.008
2025-10-24 06:11:21,707 - INFO - Epoch 5, Step 1350/2500 - Loss: 0.0153, Perplexity: 1.0207, LR: 8.60e-05, LM: 0.0146, Age: 0.66, Sex: 0.008
2025-10-24 06:11:34,128 - INFO - Epoch 5, Step 1400/2500 - Loss: 0.0149, Perplexity: 1.0201, LR: 8.59e-05, LM: 0.0143, Age: 0.66, Sex: 0.008
2025-10-24 06:11:46,981 - INFO - Epoch 5, Step 1450/2500 - Loss: 0.0149, Perplexity: 1.0199, LR: 8.59e-05, LM: 0.0142, Age: 0.66, Sex: 0.008
2025-10-24 06:11:59,839 - INFO - Epoch 5, Step 1500/2500 - Loss: 0.0165, Perplexity: 1.0230, LR: 8.58e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:12:12,386 - INFO - Epoch 5, Step 1550/2500 - Loss: 0.0173, Perplexity: 1.0244, LR: 8.57e-05, LM: 0.0166, Age: 0.66, Sex: 0.009
2025-10-24 06:12:24,972 - INFO - Epoch 5, Step 1600/2500 - Loss: 0.0175, Perplexity: 1.0250, LR: 8.57e-05, LM: 0.0168, Age: 0.66, Sex: 0.009
2025-10-24 06:12:37,899 - INFO - Epoch 5, Step 1650/2500 - Loss: 0.0175, Perplexity: 1.0248, LR: 8.56e-05, LM: 0.0168, Age: 0.66, Sex: 0.009
2025-10-24 06:12:50,542 - INFO - Epoch 5, Step 1700/2500 - Loss: 0.0172, Perplexity: 1.0242, LR: 8.55e-05, LM: 0.0165, Age: 0.66, Sex: 0.009
2025-10-24 06:13:02,950 - INFO - Epoch 5, Step 1750/2500 - Loss: 0.0168, Perplexity: 1.0237, LR: 8.55e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:13:15,366 - INFO - Epoch 5, Step 1800/2500 - Loss: 0.0170, Perplexity: 1.0240, LR: 8.54e-05, LM: 0.0163, Age: 0.66, Sex: 0.009
2025-10-24 06:13:28,062 - INFO - Epoch 5, Step 1850/2500 - Loss: 0.0170, Perplexity: 1.0239, LR: 8.53e-05, LM: 0.0163, Age: 0.66, Sex: 0.009
2025-10-24 06:13:40,687 - INFO - Epoch 5, Step 1900/2500 - Loss: 0.0168, Perplexity: 1.0236, LR: 8.53e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:13:53,544 - INFO - Epoch 5, Step 1950/2500 - Loss: 0.0170, Perplexity: 1.0242, LR: 8.52e-05, LM: 0.0164, Age: 0.66, Sex: 0.009
2025-10-24 06:14:06,149 - INFO - Epoch 5, Step 2000/2500 - Loss: 0.0168, Perplexity: 1.0238, LR: 8.51e-05, LM: 0.0162, Age: 0.66, Sex: 0.009
2025-10-24 06:14:18,926 - INFO - Epoch 5, Step 2050/2500 - Loss: 0.0168, Perplexity: 1.0238, LR: 8.51e-05, LM: 0.0161, Age: 0.66, Sex: 0.009
2025-10-24 06:14:31,289 - INFO - Epoch 5, Step 2100/2500 - Loss: 0.0165, Perplexity: 1.0233, LR: 8.50e-05, LM: 0.0158, Age: 0.66, Sex: 0.009
2025-10-24 06:14:43,990 - INFO - Epoch 5, Step 2150/2500 - Loss: 0.0167, Perplexity: 1.0235, LR: 8.49e-05, LM: 0.0160, Age: 0.66, Sex: 0.009
2025-10-24 06:14:56,555 - INFO - Epoch 5, Step 2200/2500 - Loss: 0.0165, Perplexity: 1.0232, LR: 8.49e-05, LM: 0.0159, Age: 0.66, Sex: 0.009
2025-10-24 06:15:09,106 - INFO - Epoch 5, Step 2250/2500 - Loss: 0.0163, Perplexity: 1.0228, LR: 8.48e-05, LM: 0.0156, Age: 0.66, Sex: 0.009
2025-10-24 06:15:21,819 - INFO - Epoch 5, Step 2300/2500 - Loss: 0.0160, Perplexity: 1.0224, LR: 8.47e-05, LM: 0.0154, Age: 0.66, Sex: 0.009
2025-10-24 06:15:34,936 - INFO - Epoch 5, Step 2350/2500 - Loss: 0.0159, Perplexity: 1.0222, LR: 8.47e-05, LM: 0.0152, Age: 0.66, Sex: 0.009
2025-10-24 06:15:47,469 - INFO - Epoch 5, Step 2400/2500 - Loss: 0.0158, Perplexity: 1.0219, LR: 8.46e-05, LM: 0.0151, Age: 0.66, Sex: 0.009
2025-10-24 06:16:00,077 - INFO - Epoch 5, Step 2450/2500 - Loss: 0.0155, Perplexity: 1.0215, LR: 8.45e-05, LM: 0.0149, Age: 0.66, Sex: 0.009
2025-10-24 06:16:12,887 - INFO - Epoch 5, Step 2500/2500 - Loss: 0.0154, Perplexity: 1.0213, LR: 8.45e-05, LM: 0.0148, Age: 0.66, Sex: 0.009
2025-10-24 06:16:12,889 - INFO - Epoch 5 Complete - Avg Loss: 0.0154, Avg Perplexity: 1.0213, LM: 0.0148, Age: 0.66, Sex: 0.009
2025-10-24 06:17:02,655 - INFO - Validation - Loss: 0.0067, Perplexity: 1.0078, Token Accuracy: 0.9990, Code Accuracy: 0.9989
2025-10-24 06:17:02,657 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:17:07,559 - INFO - TPL computed on 500 samples: 1.0137
2025-10-24 06:17:07,559 - INFO - Temporal Perplexity (TPL): 1.0137
2025-10-24 06:17:07,560 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:17:17,103 - INFO - Reconstruction Jaccard computed on 117 visits: 0.0038
2025-10-24 06:17:17,104 - INFO - Reconstruction Jaccard: 0.0038
2025-10-24 06:17:19,471 - INFO - Checkpoint saved: epoch 5
2025-10-24 06:17:32,246 - INFO - Epoch 6, Step 50/2500 - Loss: 0.0126, Perplexity: 1.0136, LR: 8.44e-05, LM: 0.0120, Age: 0.60, Sex: 0.018
2025-10-24 06:17:44,833 - INFO - Epoch 6, Step 100/2500 - Loss: 0.0109, Perplexity: 1.0116, LR: 8.43e-05, LM: 0.0103, Age: 0.61, Sex: 0.016
2025-10-24 06:17:57,189 - INFO - Epoch 6, Step 150/2500 - Loss: 0.0086, Perplexity: 1.0091, LR: 8.43e-05, LM: 0.0080, Age: 0.62, Sex: 0.012
2025-10-24 06:18:09,321 - INFO - Epoch 6, Step 200/2500 - Loss: 0.0077, Perplexity: 1.0081, LR: 8.42e-05, LM: 0.0070, Age: 0.64, Sex: 0.010
2025-10-24 06:18:21,934 - INFO - Epoch 6, Step 250/2500 - Loss: 0.0084, Perplexity: 1.0090, LR: 8.41e-05, LM: 0.0078, Age: 0.63, Sex: 0.013
2025-10-24 06:18:34,660 - INFO - Epoch 6, Step 300/2500 - Loss: 0.0095, Perplexity: 1.0109, LR: 8.41e-05, LM: 0.0089, Age: 0.63, Sex: 0.013
2025-10-24 06:18:47,512 - INFO - Epoch 6, Step 350/2500 - Loss: 0.0113, Perplexity: 1.0134, LR: 8.40e-05, LM: 0.0106, Age: 0.63, Sex: 0.013
2025-10-24 06:19:00,185 - INFO - Epoch 6, Step 400/2500 - Loss: 0.0122, Perplexity: 1.0154, LR: 8.39e-05, LM: 0.0116, Age: 0.62, Sex: 0.012
2025-10-24 06:19:12,992 - INFO - Epoch 6, Step 450/2500 - Loss: 0.0130, Perplexity: 1.0164, LR: 8.39e-05, LM: 0.0124, Age: 0.63, Sex: 0.013
2025-10-24 06:19:25,691 - INFO - Epoch 6, Step 500/2500 - Loss: 0.0145, Perplexity: 1.0193, LR: 8.38e-05, LM: 0.0138, Age: 0.62, Sex: 0.012
2025-10-24 06:19:38,162 - INFO - Epoch 6, Step 550/2500 - Loss: 0.0140, Perplexity: 1.0185, LR: 8.37e-05, LM: 0.0134, Age: 0.62, Sex: 0.012
2025-10-24 06:19:50,531 - INFO - Epoch 6, Step 600/2500 - Loss: 0.0136, Perplexity: 1.0177, LR: 8.36e-05, LM: 0.0130, Age: 0.62, Sex: 0.011
2025-10-24 06:20:03,581 - INFO - Epoch 6, Step 650/2500 - Loss: 0.0131, Perplexity: 1.0169, LR: 8.36e-05, LM: 0.0124, Age: 0.63, Sex: 0.012
2025-10-24 06:20:16,172 - INFO - Epoch 6, Step 700/2500 - Loss: 0.0126, Perplexity: 1.0161, LR: 8.35e-05, LM: 0.0119, Age: 0.63, Sex: 0.011
2025-10-24 06:20:29,101 - INFO - Epoch 6, Step 750/2500 - Loss: 0.0119, Perplexity: 1.0152, LR: 8.34e-05, LM: 0.0112, Age: 0.62, Sex: 0.012
2025-10-24 06:20:41,628 - INFO - Epoch 6, Step 800/2500 - Loss: 0.0119, Perplexity: 1.0151, LR: 8.34e-05, LM: 0.0113, Age: 0.63, Sex: 0.012
2025-10-24 06:20:54,206 - INFO - Epoch 6, Step 850/2500 - Loss: 0.0118, Perplexity: 1.0148, LR: 8.33e-05, LM: 0.0112, Age: 0.63, Sex: 0.012
2025-10-24 06:21:06,773 - INFO - Epoch 6, Step 900/2500 - Loss: 0.0128, Perplexity: 1.0164, LR: 8.32e-05, LM: 0.0122, Age: 0.64, Sex: 0.012
2025-10-24 06:21:19,515 - INFO - Epoch 6, Step 950/2500 - Loss: 0.0139, Perplexity: 1.0184, LR: 8.32e-05, LM: 0.0133, Age: 0.63, Sex: 0.012
2025-10-24 06:21:32,193 - INFO - Epoch 6, Step 1000/2500 - Loss: 0.0139, Perplexity: 1.0182, LR: 8.31e-05, LM: 0.0133, Age: 0.64, Sex: 0.012
2025-10-24 06:21:44,946 - INFO - Epoch 6, Step 1050/2500 - Loss: 0.0137, Perplexity: 1.0179, LR: 8.30e-05, LM: 0.0131, Age: 0.64, Sex: 0.011
2025-10-24 06:21:57,767 - INFO - Epoch 6, Step 1100/2500 - Loss: 0.0136, Perplexity: 1.0176, LR: 8.30e-05, LM: 0.0130, Age: 0.64, Sex: 0.012
2025-10-24 06:22:10,292 - INFO - Epoch 6, Step 1150/2500 - Loss: 0.0131, Perplexity: 1.0169, LR: 8.29e-05, LM: 0.0125, Age: 0.64, Sex: 0.011
2025-10-24 06:22:22,747 - INFO - Epoch 6, Step 1200/2500 - Loss: 0.0127, Perplexity: 1.0164, LR: 8.28e-05, LM: 0.0121, Age: 0.64, Sex: 0.011
2025-10-24 06:22:35,098 - INFO - Epoch 6, Step 1250/2500 - Loss: 0.0127, Perplexity: 1.0164, LR: 8.28e-05, LM: 0.0121, Age: 0.64, Sex: 0.010
2025-10-24 06:22:47,811 - INFO - Epoch 6, Step 1300/2500 - Loss: 0.0134, Perplexity: 1.0175, LR: 8.27e-05, LM: 0.0127, Age: 0.64, Sex: 0.010
2025-10-24 06:23:00,199 - INFO - Epoch 6, Step 1350/2500 - Loss: 0.0130, Perplexity: 1.0170, LR: 8.26e-05, LM: 0.0124, Age: 0.64, Sex: 0.010
2025-10-24 06:23:12,991 - INFO - Epoch 6, Step 1400/2500 - Loss: 0.0130, Perplexity: 1.0169, LR: 8.26e-05, LM: 0.0123, Age: 0.64, Sex: 0.010
2025-10-24 06:23:25,799 - INFO - Epoch 6, Step 1450/2500 - Loss: 0.0126, Perplexity: 1.0164, LR: 8.25e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:23:38,626 - INFO - Epoch 6, Step 1500/2500 - Loss: 0.0122, Perplexity: 1.0159, LR: 8.24e-05, LM: 0.0116, Age: 0.64, Sex: 0.009
2025-10-24 06:23:51,629 - INFO - Epoch 6, Step 1550/2500 - Loss: 0.0126, Perplexity: 1.0166, LR: 8.24e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:24:04,560 - INFO - Epoch 6, Step 1600/2500 - Loss: 0.0126, Perplexity: 1.0164, LR: 8.23e-05, LM: 0.0119, Age: 0.64, Sex: 0.009
2025-10-24 06:24:17,429 - INFO - Epoch 6, Step 1650/2500 - Loss: 0.0126, Perplexity: 1.0165, LR: 8.22e-05, LM: 0.0120, Age: 0.64, Sex: 0.009
2025-10-24 06:24:30,483 - INFO - Epoch 6, Step 1700/2500 - Loss: 0.0133, Perplexity: 1.0177, LR: 8.22e-05, LM: 0.0126, Age: 0.64, Sex: 0.010
2025-10-24 06:24:43,133 - INFO - Epoch 6, Step 1750/2500 - Loss: 0.0138, Perplexity: 1.0184, LR: 8.21e-05, LM: 0.0131, Age: 0.64, Sex: 0.010
2025-10-24 06:24:55,833 - INFO - Epoch 6, Step 1800/2500 - Loss: 0.0136, Perplexity: 1.0181, LR: 8.20e-05, LM: 0.0129, Age: 0.64, Sex: 0.009
2025-10-24 06:25:08,404 - INFO - Epoch 6, Step 1850/2500 - Loss: 0.0134, Perplexity: 1.0178, LR: 8.20e-05, LM: 0.0128, Age: 0.64, Sex: 0.009
2025-10-24 06:25:21,117 - INFO - Epoch 6, Step 1900/2500 - Loss: 0.0132, Perplexity: 1.0175, LR: 8.19e-05, LM: 0.0125, Age: 0.64, Sex: 0.009
2025-10-24 06:25:33,919 - INFO - Epoch 6, Step 1950/2500 - Loss: 0.0130, Perplexity: 1.0171, LR: 8.18e-05, LM: 0.0123, Age: 0.64, Sex: 0.009
2025-10-24 06:25:46,406 - INFO - Epoch 6, Step 2000/2500 - Loss: 0.0128, Perplexity: 1.0169, LR: 8.18e-05, LM: 0.0122, Age: 0.64, Sex: 0.009
2025-10-24 06:25:58,935 - INFO - Epoch 6, Step 2050/2500 - Loss: 0.0126, Perplexity: 1.0166, LR: 8.17e-05, LM: 0.0119, Age: 0.64, Sex: 0.009
2025-10-24 06:26:11,901 - INFO - Epoch 6, Step 2100/2500 - Loss: 0.0124, Perplexity: 1.0163, LR: 8.16e-05, LM: 0.0117, Age: 0.64, Sex: 0.009
2025-10-24 06:26:24,563 - INFO - Epoch 6, Step 2150/2500 - Loss: 0.0122, Perplexity: 1.0160, LR: 8.16e-05, LM: 0.0116, Age: 0.64, Sex: 0.009
2025-10-24 06:26:37,287 - INFO - Epoch 6, Step 2200/2500 - Loss: 0.0121, Perplexity: 1.0158, LR: 8.15e-05, LM: 0.0115, Age: 0.64, Sex: 0.008
2025-10-24 06:26:49,674 - INFO - Epoch 6, Step 2250/2500 - Loss: 0.0119, Perplexity: 1.0156, LR: 8.14e-05, LM: 0.0113, Age: 0.64, Sex: 0.008
2025-10-24 06:27:02,524 - INFO - Epoch 6, Step 2300/2500 - Loss: 0.0119, Perplexity: 1.0155, LR: 8.14e-05, LM: 0.0113, Age: 0.64, Sex: 0.008
2025-10-24 06:27:15,005 - INFO - Epoch 6, Step 2350/2500 - Loss: 0.0118, Perplexity: 1.0153, LR: 8.13e-05, LM: 0.0111, Age: 0.64, Sex: 0.008
2025-10-24 06:27:27,863 - INFO - Epoch 6, Step 2400/2500 - Loss: 0.0117, Perplexity: 1.0151, LR: 8.12e-05, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:27:40,626 - INFO - Epoch 6, Step 2450/2500 - Loss: 0.0118, Perplexity: 1.0153, LR: 8.11e-05, LM: 0.0111, Age: 0.64, Sex: 0.008
2025-10-24 06:27:53,353 - INFO - Epoch 6, Step 2500/2500 - Loss: 0.0116, Perplexity: 1.0151, LR: 8.11e-05, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:27:53,354 - INFO - Epoch 6 Complete - Avg Loss: 0.0116, Avg Perplexity: 1.0151, LM: 0.0110, Age: 0.64, Sex: 0.008
2025-10-24 06:28:43,057 - INFO - Validation - Loss: 0.0032, Perplexity: 1.0034, Token Accuracy: 0.9995, Code Accuracy: 0.9995
2025-10-24 06:28:43,059 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:28:47,917 - INFO - TPL computed on 500 samples: 1.0062
2025-10-24 06:28:47,917 - INFO - Temporal Perplexity (TPL): 1.0062
2025-10-24 06:28:47,918 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:28:54,354 - INFO - Reconstruction Jaccard computed on 116 visits: 0.0158
2025-10-24 06:28:54,354 - INFO - Reconstruction Jaccard: 0.0158
2025-10-24 06:28:54,355 - INFO - New best model! Validation loss: 0.0032
2025-10-24 06:28:58,853 - INFO - Checkpoint saved: epoch 6
2025-10-24 06:29:11,533 - INFO - Epoch 7, Step 50/2500 - Loss: 0.0253, Perplexity: 1.0321, LR: 8.10e-05, LM: 0.0247, Age: 0.63, Sex: 0.002
2025-10-24 06:29:23,964 - INFO - Epoch 7, Step 100/2500 - Loss: 0.0147, Perplexity: 1.0181, LR: 8.09e-05, LM: 0.0141, Age: 0.65, Sex: 0.001
2025-10-24 06:29:36,596 - INFO - Epoch 7, Step 150/2500 - Loss: 0.0162, Perplexity: 1.0200, LR: 8.09e-05, LM: 0.0155, Age: 0.68, Sex: 0.003
2025-10-24 06:29:49,420 - INFO - Epoch 7, Step 200/2500 - Loss: 0.0134, Perplexity: 1.0162, LR: 8.08e-05, LM: 0.0127, Age: 0.67, Sex: 0.003
2025-10-24 06:30:02,339 - INFO - Epoch 7, Step 250/2500 - Loss: 0.0133, Perplexity: 1.0161, LR: 8.07e-05, LM: 0.0126, Age: 0.66, Sex: 0.004
2025-10-24 06:30:15,022 - INFO - Epoch 7, Step 300/2500 - Loss: 0.0116, Perplexity: 1.0140, LR: 8.07e-05, LM: 0.0109, Age: 0.65, Sex: 0.004
2025-10-24 06:30:27,762 - INFO - Epoch 7, Step 350/2500 - Loss: 0.0107, Perplexity: 1.0128, LR: 8.06e-05, LM: 0.0101, Age: 0.65, Sex: 0.004
2025-10-24 06:30:40,723 - INFO - Epoch 7, Step 400/2500 - Loss: 0.0144, Perplexity: 1.0185, LR: 8.05e-05, LM: 0.0137, Age: 0.65, Sex: 0.005
2025-10-24 06:30:53,561 - INFO - Epoch 7, Step 450/2500 - Loss: 0.0143, Perplexity: 1.0182, LR: 8.05e-05, LM: 0.0137, Age: 0.65, Sex: 0.006
2025-10-24 06:31:06,297 - INFO - Epoch 7, Step 500/2500 - Loss: 0.0146, Perplexity: 1.0184, LR: 8.04e-05, LM: 0.0139, Age: 0.65, Sex: 0.007
2025-10-24 06:31:18,975 - INFO - Epoch 7, Step 550/2500 - Loss: 0.0138, Perplexity: 1.0173, LR: 8.03e-05, LM: 0.0131, Age: 0.65, Sex: 0.007
2025-10-24 06:31:31,809 - INFO - Epoch 7, Step 600/2500 - Loss: 0.0138, Perplexity: 1.0173, LR: 8.03e-05, LM: 0.0131, Age: 0.65, Sex: 0.007
2025-10-24 06:31:44,153 - INFO - Epoch 7, Step 650/2500 - Loss: 0.0142, Perplexity: 1.0181, LR: 8.02e-05, LM: 0.0135, Age: 0.65, Sex: 0.007
2025-10-24 06:31:56,976 - INFO - Epoch 7, Step 700/2500 - Loss: 0.0146, Perplexity: 1.0188, LR: 8.01e-05, LM: 0.0140, Age: 0.65, Sex: 0.007
2025-10-24 06:32:09,587 - INFO - Epoch 7, Step 750/2500 - Loss: 0.0144, Perplexity: 1.0185, LR: 8.01e-05, LM: 0.0138, Age: 0.64, Sex: 0.007
2025-10-24 06:32:22,342 - INFO - Epoch 7, Step 800/2500 - Loss: 0.0136, Perplexity: 1.0174, LR: 8.00e-05, LM: 0.0129, Age: 0.64, Sex: 0.007
2025-10-24 06:32:34,976 - INFO - Epoch 7, Step 850/2500 - Loss: 0.0136, Perplexity: 1.0173, LR: 7.99e-05, LM: 0.0129, Age: 0.64, Sex: 0.007
2025-10-24 06:32:47,188 - INFO - Epoch 7, Step 900/2500 - Loss: 0.0135, Perplexity: 1.0172, LR: 7.99e-05, LM: 0.0128, Age: 0.64, Sex: 0.007
2025-10-24 06:33:00,181 - INFO - Epoch 7, Step 950/2500 - Loss: 0.0140, Perplexity: 1.0178, LR: 7.98e-05, LM: 0.0133, Age: 0.64, Sex: 0.007
2025-10-24 06:33:12,926 - INFO - Epoch 7, Step 1000/2500 - Loss: 0.0134, Perplexity: 1.0170, LR: 7.97e-05, LM: 0.0127, Age: 0.63, Sex: 0.007
2025-10-24 06:33:25,951 - INFO - Epoch 7, Step 1050/2500 - Loss: 0.0130, Perplexity: 1.0165, LR: 7.97e-05, LM: 0.0123, Age: 0.63, Sex: 0.007
2025-10-24 06:33:38,711 - INFO - Epoch 7, Step 1100/2500 - Loss: 0.0131, Perplexity: 1.0166, LR: 7.96e-05, LM: 0.0124, Age: 0.63, Sex: 0.006
2025-10-24 06:33:51,522 - INFO - Epoch 7, Step 1150/2500 - Loss: 0.0127, Perplexity: 1.0161, LR: 7.95e-05, LM: 0.0121, Age: 0.63, Sex: 0.006
2025-10-24 06:34:03,918 - INFO - Epoch 7, Step 1200/2500 - Loss: 0.0126, Perplexity: 1.0159, LR: 7.95e-05, LM: 0.0120, Age: 0.63, Sex: 0.006
2025-10-24 06:34:16,479 - INFO - Epoch 7, Step 1250/2500 - Loss: 0.0124, Perplexity: 1.0155, LR: 7.94e-05, LM: 0.0117, Age: 0.63, Sex: 0.006
2025-10-24 06:34:29,272 - INFO - Epoch 7, Step 1300/2500 - Loss: 0.0122, Perplexity: 1.0152, LR: 7.93e-05, LM: 0.0115, Age: 0.63, Sex: 0.006
2025-10-24 06:34:41,980 - INFO - Epoch 7, Step 1350/2500 - Loss: 0.0118, Perplexity: 1.0147, LR: 7.93e-05, LM: 0.0112, Age: 0.63, Sex: 0.006
2025-10-24 06:34:54,839 - INFO - Epoch 7, Step 1400/2500 - Loss: 0.0116, Perplexity: 1.0144, LR: 7.92e-05, LM: 0.0109, Age: 0.63, Sex: 0.006
2025-10-24 06:35:07,482 - INFO - Epoch 7, Step 1450/2500 - Loss: 0.0113, Perplexity: 1.0140, LR: 7.91e-05, LM: 0.0107, Age: 0.62, Sex: 0.006
2025-10-24 06:35:20,340 - INFO - Epoch 7, Step 1500/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.91e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:35:33,053 - INFO - Epoch 7, Step 1550/2500 - Loss: 0.0109, Perplexity: 1.0135, LR: 7.90e-05, LM: 0.0103, Age: 0.62, Sex: 0.006
2025-10-24 06:35:45,726 - INFO - Epoch 7, Step 1600/2500 - Loss: 0.0108, Perplexity: 1.0133, LR: 7.89e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:35:58,462 - INFO - Epoch 7, Step 1650/2500 - Loss: 0.0108, Perplexity: 1.0132, LR: 7.89e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:11,237 - INFO - Epoch 7, Step 1700/2500 - Loss: 0.0107, Perplexity: 1.0132, LR: 7.88e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:23,834 - INFO - Epoch 7, Step 1750/2500 - Loss: 0.0105, Perplexity: 1.0129, LR: 7.87e-05, LM: 0.0099, Age: 0.62, Sex: 0.006
2025-10-24 06:36:36,938 - INFO - Epoch 7, Step 1800/2500 - Loss: 0.0108, Perplexity: 1.0132, LR: 7.86e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:36:49,865 - INFO - Epoch 7, Step 1850/2500 - Loss: 0.0108, Perplexity: 1.0131, LR: 7.86e-05, LM: 0.0101, Age: 0.62, Sex: 0.005
2025-10-24 06:37:02,577 - INFO - Epoch 7, Step 1900/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.85e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:37:15,335 - INFO - Epoch 7, Step 1950/2500 - Loss: 0.0110, Perplexity: 1.0136, LR: 7.84e-05, LM: 0.0104, Age: 0.62, Sex: 0.006
2025-10-24 06:37:28,262 - INFO - Epoch 7, Step 2000/2500 - Loss: 0.0109, Perplexity: 1.0134, LR: 7.84e-05, LM: 0.0102, Age: 0.62, Sex: 0.006
2025-10-24 06:37:41,291 - INFO - Epoch 7, Step 2050/2500 - Loss: 0.0107, Perplexity: 1.0132, LR: 7.83e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:37:53,957 - INFO - Epoch 7, Step 2100/2500 - Loss: 0.0107, Perplexity: 1.0131, LR: 7.82e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:38:06,441 - INFO - Epoch 7, Step 2150/2500 - Loss: 0.0110, Perplexity: 1.0135, LR: 7.82e-05, LM: 0.0103, Age: 0.62, Sex: 0.007
2025-10-24 06:38:19,205 - INFO - Epoch 7, Step 2200/2500 - Loss: 0.0109, Perplexity: 1.0134, LR: 7.81e-05, LM: 0.0103, Age: 0.62, Sex: 0.006
2025-10-24 06:38:31,867 - INFO - Epoch 7, Step 2250/2500 - Loss: 0.0107, Perplexity: 1.0131, LR: 7.80e-05, LM: 0.0101, Age: 0.62, Sex: 0.006
2025-10-24 06:38:44,604 - INFO - Epoch 7, Step 2300/2500 - Loss: 0.0105, Perplexity: 1.0129, LR: 7.80e-05, LM: 0.0099, Age: 0.62, Sex: 0.006
2025-10-24 06:38:57,075 - INFO - Epoch 7, Step 2350/2500 - Loss: 0.0103, Perplexity: 1.0126, LR: 7.79e-05, LM: 0.0097, Age: 0.62, Sex: 0.006
2025-10-24 06:39:09,813 - INFO - Epoch 7, Step 2400/2500 - Loss: 0.0104, Perplexity: 1.0127, LR: 7.78e-05, LM: 0.0098, Age: 0.62, Sex: 0.006
2025-10-24 06:39:22,796 - INFO - Epoch 7, Step 2450/2500 - Loss: 0.0102, Perplexity: 1.0125, LR: 7.78e-05, LM: 0.0096, Age: 0.62, Sex: 0.006
2025-10-24 06:39:35,369 - INFO - Epoch 7, Step 2500/2500 - Loss: 0.0100, Perplexity: 1.0123, LR: 7.77e-05, LM: 0.0094, Age: 0.62, Sex: 0.006
2025-10-24 06:39:35,370 - INFO - Epoch 7 Complete - Avg Loss: 0.0100, Avg Perplexity: 1.0123, LM: 0.0094, Age: 0.62, Sex: 0.006
2025-10-24 06:40:24,940 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0008, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 06:40:24,942 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:40:29,794 - INFO - TPL computed on 500 samples: 1.0022
2025-10-24 06:40:29,794 - INFO - Temporal Perplexity (TPL): 1.0022
2025-10-24 06:40:29,795 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:40:37,312 - INFO - Reconstruction Jaccard computed on 126 visits: 0.0191
2025-10-24 06:40:37,312 - INFO - Reconstruction Jaccard: 0.0191
2025-10-24 06:40:37,312 - INFO - New best model! Validation loss: 0.0007
2025-10-24 06:40:41,628 - INFO - Checkpoint saved: epoch 7
2025-10-24 06:40:54,196 - INFO - Epoch 8, Step 50/2500 - Loss: 0.0027, Perplexity: 1.0027, LR: 7.76e-05, LM: 0.0021, Age: 0.59, Sex: 0.001
2025-10-24 06:41:06,900 - INFO - Epoch 8, Step 100/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 7.76e-05, LM: 0.0014, Age: 0.57, Sex: 0.001
2025-10-24 06:41:19,629 - INFO - Epoch 8, Step 150/2500 - Loss: 0.0081, Perplexity: 1.0101, LR: 7.75e-05, LM: 0.0075, Age: 0.59, Sex: 0.004
2025-10-24 06:41:32,508 - INFO - Epoch 8, Step 200/2500 - Loss: 0.0081, Perplexity: 1.0099, LR: 7.74e-05, LM: 0.0075, Age: 0.60, Sex: 0.005
2025-10-24 06:41:45,278 - INFO - Epoch 8, Step 250/2500 - Loss: 0.0078, Perplexity: 1.0094, LR: 7.74e-05, LM: 0.0072, Age: 0.59, Sex: 0.005
2025-10-24 06:41:57,957 - INFO - Epoch 8, Step 300/2500 - Loss: 0.0076, Perplexity: 1.0089, LR: 7.73e-05, LM: 0.0070, Age: 0.60, Sex: 0.005
2025-10-24 06:42:10,683 - INFO - Epoch 8, Step 350/2500 - Loss: 0.0072, Perplexity: 1.0084, LR: 7.72e-05, LM: 0.0066, Age: 0.61, Sex: 0.005
2025-10-24 06:42:23,414 - INFO - Epoch 8, Step 400/2500 - Loss: 0.0074, Perplexity: 1.0085, LR: 7.72e-05, LM: 0.0067, Age: 0.61, Sex: 0.007
2025-10-24 06:42:35,892 - INFO - Epoch 8, Step 450/2500 - Loss: 0.0071, Perplexity: 1.0081, LR: 7.71e-05, LM: 0.0065, Age: 0.61, Sex: 0.008
2025-10-24 06:42:48,576 - INFO - Epoch 8, Step 500/2500 - Loss: 0.0066, Perplexity: 1.0076, LR: 7.70e-05, LM: 0.0060, Age: 0.61, Sex: 0.008
2025-10-24 06:43:01,333 - INFO - Epoch 8, Step 550/2500 - Loss: 0.0083, Perplexity: 1.0097, LR: 7.70e-05, LM: 0.0077, Age: 0.60, Sex: 0.008
2025-10-24 06:43:13,977 - INFO - Epoch 8, Step 600/2500 - Loss: 0.0077, Perplexity: 1.0091, LR: 7.69e-05, LM: 0.0071, Age: 0.61, Sex: 0.008
2025-10-24 06:43:26,628 - INFO - Epoch 8, Step 650/2500 - Loss: 0.0080, Perplexity: 1.0092, LR: 7.68e-05, LM: 0.0073, Age: 0.60, Sex: 0.010
2025-10-24 06:43:39,289 - INFO - Epoch 8, Step 700/2500 - Loss: 0.0086, Perplexity: 1.0101, LR: 7.68e-05, LM: 0.0080, Age: 0.60, Sex: 0.010
2025-10-24 06:43:52,365 - INFO - Epoch 8, Step 750/2500 - Loss: 0.0092, Perplexity: 1.0112, LR: 7.67e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:44:05,028 - INFO - Epoch 8, Step 800/2500 - Loss: 0.0095, Perplexity: 1.0116, LR: 7.66e-05, LM: 0.0089, Age: 0.60, Sex: 0.010
2025-10-24 06:44:17,800 - INFO - Epoch 8, Step 850/2500 - Loss: 0.0097, Perplexity: 1.0118, LR: 7.66e-05, LM: 0.0091, Age: 0.60, Sex: 0.010
2025-10-24 06:44:30,485 - INFO - Epoch 8, Step 900/2500 - Loss: 0.0092, Perplexity: 1.0113, LR: 7.65e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:44:43,232 - INFO - Epoch 8, Step 950/2500 - Loss: 0.0088, Perplexity: 1.0107, LR: 7.64e-05, LM: 0.0082, Age: 0.60, Sex: 0.009
2025-10-24 06:44:55,864 - INFO - Epoch 8, Step 1000/2500 - Loss: 0.0094, Perplexity: 1.0114, LR: 7.64e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:45:08,584 - INFO - Epoch 8, Step 1050/2500 - Loss: 0.0092, Perplexity: 1.0111, LR: 7.63e-05, LM: 0.0086, Age: 0.60, Sex: 0.009
2025-10-24 06:45:21,532 - INFO - Epoch 8, Step 1100/2500 - Loss: 0.0091, Perplexity: 1.0109, LR: 7.62e-05, LM: 0.0084, Age: 0.60, Sex: 0.009
2025-10-24 06:45:33,946 - INFO - Epoch 8, Step 1150/2500 - Loss: 0.0089, Perplexity: 1.0107, LR: 7.61e-05, LM: 0.0083, Age: 0.60, Sex: 0.010
2025-10-24 06:45:46,769 - INFO - Epoch 8, Step 1200/2500 - Loss: 0.0087, Perplexity: 1.0104, LR: 7.61e-05, LM: 0.0081, Age: 0.60, Sex: 0.010
2025-10-24 06:45:59,561 - INFO - Epoch 8, Step 1250/2500 - Loss: 0.0088, Perplexity: 1.0105, LR: 7.60e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:46:12,671 - INFO - Epoch 8, Step 1300/2500 - Loss: 0.0090, Perplexity: 1.0108, LR: 7.59e-05, LM: 0.0084, Age: 0.59, Sex: 0.010
2025-10-24 06:46:24,959 - INFO - Epoch 8, Step 1350/2500 - Loss: 0.0089, Perplexity: 1.0106, LR: 7.59e-05, LM: 0.0083, Age: 0.59, Sex: 0.010
2025-10-24 06:46:37,648 - INFO - Epoch 8, Step 1400/2500 - Loss: 0.0088, Perplexity: 1.0104, LR: 7.58e-05, LM: 0.0082, Age: 0.59, Sex: 0.010
2025-10-24 06:46:50,185 - INFO - Epoch 8, Step 1450/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.57e-05, LM: 0.0082, Age: 0.59, Sex: 0.010
2025-10-24 06:47:02,875 - INFO - Epoch 8, Step 1500/2500 - Loss: 0.0087, Perplexity: 1.0103, LR: 7.57e-05, LM: 0.0081, Age: 0.59, Sex: 0.010
2025-10-24 06:47:15,525 - INFO - Epoch 8, Step 1550/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.56e-05, LM: 0.0081, Age: 0.60, Sex: 0.010
2025-10-24 06:47:28,202 - INFO - Epoch 8, Step 1600/2500 - Loss: 0.0086, Perplexity: 1.0101, LR: 7.55e-05, LM: 0.0080, Age: 0.60, Sex: 0.010
2025-10-24 06:47:40,896 - INFO - Epoch 8, Step 1650/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.55e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:47:53,496 - INFO - Epoch 8, Step 1700/2500 - Loss: 0.0091, Perplexity: 1.0108, LR: 7.54e-05, LM: 0.0085, Age: 0.60, Sex: 0.010
2025-10-24 06:48:06,250 - INFO - Epoch 8, Step 1750/2500 - Loss: 0.0090, Perplexity: 1.0106, LR: 7.53e-05, LM: 0.0084, Age: 0.60, Sex: 0.010
2025-10-24 06:48:19,121 - INFO - Epoch 8, Step 1800/2500 - Loss: 0.0090, Perplexity: 1.0106, LR: 7.53e-05, LM: 0.0084, Age: 0.60, Sex: 0.010
2025-10-24 06:48:31,537 - INFO - Epoch 8, Step 1850/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.52e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:48:44,289 - INFO - Epoch 8, Step 1900/2500 - Loss: 0.0088, Perplexity: 1.0103, LR: 7.51e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:48:56,876 - INFO - Epoch 8, Step 1950/2500 - Loss: 0.0087, Perplexity: 1.0101, LR: 7.51e-05, LM: 0.0080, Age: 0.60, Sex: 0.009
2025-10-24 06:49:09,630 - INFO - Epoch 8, Step 2000/2500 - Loss: 0.0085, Perplexity: 1.0099, LR: 7.50e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:49:22,483 - INFO - Epoch 8, Step 2050/2500 - Loss: 0.0084, Perplexity: 1.0098, LR: 7.49e-05, LM: 0.0078, Age: 0.60, Sex: 0.009
2025-10-24 06:49:34,990 - INFO - Epoch 8, Step 2100/2500 - Loss: 0.0083, Perplexity: 1.0097, LR: 7.49e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:49:47,569 - INFO - Epoch 8, Step 2150/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.48e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:00,168 - INFO - Epoch 8, Step 2200/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.47e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:13,242 - INFO - Epoch 8, Step 2250/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.47e-05, LM: 0.0076, Age: 0.60, Sex: 0.008
2025-10-24 06:50:26,024 - INFO - Epoch 8, Step 2300/2500 - Loss: 0.0083, Perplexity: 1.0096, LR: 7.46e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:50:38,800 - INFO - Epoch 8, Step 2350/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.45e-05, LM: 0.0076, Age: 0.60, Sex: 0.009
2025-10-24 06:50:51,478 - INFO - Epoch 8, Step 2400/2500 - Loss: 0.0082, Perplexity: 1.0095, LR: 7.45e-05, LM: 0.0076, Age: 0.60, Sex: 0.010
2025-10-24 06:51:04,093 - INFO - Epoch 8, Step 2450/2500 - Loss: 0.0082, Perplexity: 1.0094, LR: 7.44e-05, LM: 0.0076, Age: 0.60, Sex: 0.010
2025-10-24 06:51:16,601 - INFO - Epoch 8, Step 2500/2500 - Loss: 0.0081, Perplexity: 1.0093, LR: 7.43e-05, LM: 0.0074, Age: 0.60, Sex: 0.010
2025-10-24 06:51:16,602 - INFO - Epoch 8 Complete - Avg Loss: 0.0081, Avg Perplexity: 1.0093, LM: 0.0074, Age: 0.60, Sex: 0.010
2025-10-24 06:52:06,763 - INFO - Validation - Loss: 0.0010, Perplexity: 1.0011, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 06:52:06,766 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 06:52:11,720 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 06:52:11,721 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 06:52:11,722 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 06:52:20,443 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0163
2025-10-24 06:52:20,443 - INFO - Reconstruction Jaccard: 0.0163
2025-10-24 06:52:32,933 - INFO - Epoch 9, Step 50/2500 - Loss: 0.0023, Perplexity: 1.0023, LR: 7.43e-05, LM: 0.0016, Age: 0.60, Sex: 0.008
2025-10-24 06:52:45,417 - INFO - Epoch 9, Step 100/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 7.42e-05, LM: 0.0009, Age: 0.58, Sex: 0.005
2025-10-24 06:52:58,246 - INFO - Epoch 9, Step 150/2500 - Loss: 0.0052, Perplexity: 1.0058, LR: 7.41e-05, LM: 0.0047, Age: 0.58, Sex: 0.008
2025-10-24 06:53:10,951 - INFO - Epoch 9, Step 200/2500 - Loss: 0.0099, Perplexity: 1.0121, LR: 7.41e-05, LM: 0.0092, Age: 0.59, Sex: 0.014
2025-10-24 06:53:23,576 - INFO - Epoch 9, Step 250/2500 - Loss: 0.0097, Perplexity: 1.0119, LR: 7.40e-05, LM: 0.0091, Age: 0.58, Sex: 0.015
2025-10-24 06:53:36,095 - INFO - Epoch 9, Step 300/2500 - Loss: 0.0090, Perplexity: 1.0109, LR: 7.39e-05, LM: 0.0084, Age: 0.60, Sex: 0.014
2025-10-24 06:53:48,795 - INFO - Epoch 9, Step 350/2500 - Loss: 0.0079, Perplexity: 1.0095, LR: 7.39e-05, LM: 0.0073, Age: 0.59, Sex: 0.012
2025-10-24 06:54:01,676 - INFO - Epoch 9, Step 400/2500 - Loss: 0.0070, Perplexity: 1.0084, LR: 7.38e-05, LM: 0.0064, Age: 0.58, Sex: 0.011
2025-10-24 06:54:14,701 - INFO - Epoch 9, Step 450/2500 - Loss: 0.0065, Perplexity: 1.0078, LR: 7.37e-05, LM: 0.0059, Age: 0.59, Sex: 0.010
2025-10-24 06:54:27,365 - INFO - Epoch 9, Step 500/2500 - Loss: 0.0064, Perplexity: 1.0076, LR: 7.36e-05, LM: 0.0058, Age: 0.58, Sex: 0.010
2025-10-24 06:54:40,328 - INFO - Epoch 9, Step 550/2500 - Loss: 0.0073, Perplexity: 1.0085, LR: 7.36e-05, LM: 0.0067, Age: 0.59, Sex: 0.011
2025-10-24 06:54:52,814 - INFO - Epoch 9, Step 600/2500 - Loss: 0.0114, Perplexity: 1.0314, LR: 7.35e-05, LM: 0.0108, Age: 0.59, Sex: 0.011
2025-10-24 06:55:05,448 - INFO - Epoch 9, Step 650/2500 - Loss: 0.0117, Perplexity: 1.0303, LR: 7.34e-05, LM: 0.0111, Age: 0.59, Sex: 0.011
2025-10-24 06:55:17,892 - INFO - Epoch 9, Step 700/2500 - Loss: 0.0115, Perplexity: 1.0289, LR: 7.34e-05, LM: 0.0109, Age: 0.60, Sex: 0.011
2025-10-24 06:55:30,758 - INFO - Epoch 9, Step 750/2500 - Loss: 0.0111, Perplexity: 1.0273, LR: 7.33e-05, LM: 0.0105, Age: 0.60, Sex: 0.011
2025-10-24 06:55:43,175 - INFO - Epoch 9, Step 800/2500 - Loss: 0.0106, Perplexity: 1.0258, LR: 7.32e-05, LM: 0.0100, Age: 0.60, Sex: 0.011
2025-10-24 06:55:55,986 - INFO - Epoch 9, Step 850/2500 - Loss: 0.0105, Perplexity: 1.0249, LR: 7.32e-05, LM: 0.0099, Age: 0.61, Sex: 0.010
2025-10-24 06:56:08,550 - INFO - Epoch 9, Step 900/2500 - Loss: 0.0103, Perplexity: 1.0239, LR: 7.31e-05, LM: 0.0097, Age: 0.60, Sex: 0.010
2025-10-24 06:56:21,113 - INFO - Epoch 9, Step 950/2500 - Loss: 0.0101, Perplexity: 1.0230, LR: 7.30e-05, LM: 0.0095, Age: 0.60, Sex: 0.010
2025-10-24 06:56:33,935 - INFO - Epoch 9, Step 1000/2500 - Loss: 0.0097, Perplexity: 1.0219, LR: 7.30e-05, LM: 0.0091, Age: 0.60, Sex: 0.009
2025-10-24 06:56:46,562 - INFO - Epoch 9, Step 1050/2500 - Loss: 0.0097, Perplexity: 1.0214, LR: 7.29e-05, LM: 0.0091, Age: 0.60, Sex: 0.009
2025-10-24 06:56:59,362 - INFO - Epoch 9, Step 1100/2500 - Loss: 0.0094, Perplexity: 1.0206, LR: 7.28e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:57:11,858 - INFO - Epoch 9, Step 1150/2500 - Loss: 0.0095, Perplexity: 1.0203, LR: 7.28e-05, LM: 0.0089, Age: 0.60, Sex: 0.009
2025-10-24 06:57:24,362 - INFO - Epoch 9, Step 1200/2500 - Loss: 0.0094, Perplexity: 1.0197, LR: 7.27e-05, LM: 0.0088, Age: 0.60, Sex: 0.009
2025-10-24 06:57:37,383 - INFO - Epoch 9, Step 1250/2500 - Loss: 0.0096, Perplexity: 1.0195, LR: 7.26e-05, LM: 0.0090, Age: 0.60, Sex: 0.009
2025-10-24 06:57:50,166 - INFO - Epoch 9, Step 1300/2500 - Loss: 0.0093, Perplexity: 1.0189, LR: 7.26e-05, LM: 0.0087, Age: 0.60, Sex: 0.010
2025-10-24 06:58:03,073 - INFO - Epoch 9, Step 1350/2500 - Loss: 0.0091, Perplexity: 1.0183, LR: 7.25e-05, LM: 0.0085, Age: 0.60, Sex: 0.010
2025-10-24 06:58:15,831 - INFO - Epoch 9, Step 1400/2500 - Loss: 0.0088, Perplexity: 1.0177, LR: 7.24e-05, LM: 0.0082, Age: 0.60, Sex: 0.009
2025-10-24 06:58:28,683 - INFO - Epoch 9, Step 1450/2500 - Loss: 0.0085, Perplexity: 1.0171, LR: 7.24e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:58:40,917 - INFO - Epoch 9, Step 1500/2500 - Loss: 0.0088, Perplexity: 1.0172, LR: 7.23e-05, LM: 0.0082, Age: 0.60, Sex: 0.010
2025-10-24 06:58:53,173 - INFO - Epoch 9, Step 1550/2500 - Loss: 0.0086, Perplexity: 1.0167, LR: 7.22e-05, LM: 0.0080, Age: 0.60, Sex: 0.009
2025-10-24 06:59:05,903 - INFO - Epoch 9, Step 1600/2500 - Loss: 0.0085, Perplexity: 1.0163, LR: 7.22e-05, LM: 0.0079, Age: 0.60, Sex: 0.010
2025-10-24 06:59:18,748 - INFO - Epoch 9, Step 1650/2500 - Loss: 0.0085, Perplexity: 1.0162, LR: 7.21e-05, LM: 0.0079, Age: 0.60, Sex: 0.009
2025-10-24 06:59:31,610 - INFO - Epoch 9, Step 1700/2500 - Loss: 0.0083, Perplexity: 1.0158, LR: 7.20e-05, LM: 0.0077, Age: 0.60, Sex: 0.009
2025-10-24 06:59:43,982 - INFO - Epoch 9, Step 1750/2500 - Loss: 0.0082, Perplexity: 1.0154, LR: 7.20e-05, LM: 0.0075, Age: 0.60, Sex: 0.009
2025-10-24 06:59:56,682 - INFO - Epoch 9, Step 1800/2500 - Loss: 0.0080, Perplexity: 1.0150, LR: 7.19e-05, LM: 0.0073, Age: 0.60, Sex: 0.009
2025-10-24 07:00:09,350 - INFO - Epoch 9, Step 1850/2500 - Loss: 0.0078, Perplexity: 1.0146, LR: 7.18e-05, LM: 0.0071, Age: 0.60, Sex: 0.009
2025-10-24 07:00:22,068 - INFO - Epoch 9, Step 1900/2500 - Loss: 0.0076, Perplexity: 1.0143, LR: 7.18e-05, LM: 0.0070, Age: 0.60, Sex: 0.008
2025-10-24 07:00:34,722 - INFO - Epoch 9, Step 1950/2500 - Loss: 0.0074, Perplexity: 1.0139, LR: 7.17e-05, LM: 0.0068, Age: 0.59, Sex: 0.008
2025-10-24 07:00:47,172 - INFO - Epoch 9, Step 2000/2500 - Loss: 0.0073, Perplexity: 1.0136, LR: 7.16e-05, LM: 0.0067, Age: 0.59, Sex: 0.008
2025-10-24 07:00:59,608 - INFO - Epoch 9, Step 2050/2500 - Loss: 0.0072, Perplexity: 1.0134, LR: 7.16e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:01:11,890 - INFO - Epoch 9, Step 2100/2500 - Loss: 0.0072, Perplexity: 1.0132, LR: 7.15e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:01:24,498 - INFO - Epoch 9, Step 2150/2500 - Loss: 0.0071, Perplexity: 1.0130, LR: 7.14e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:01:37,078 - INFO - Epoch 9, Step 2200/2500 - Loss: 0.0071, Perplexity: 1.0129, LR: 7.14e-05, LM: 0.0065, Age: 0.59, Sex: 0.007
2025-10-24 07:01:49,737 - INFO - Epoch 9, Step 2250/2500 - Loss: 0.0071, Perplexity: 1.0127, LR: 7.13e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:02,503 - INFO - Epoch 9, Step 2300/2500 - Loss: 0.0072, Perplexity: 1.0127, LR: 7.12e-05, LM: 0.0066, Age: 0.59, Sex: 0.009
2025-10-24 07:02:15,371 - INFO - Epoch 9, Step 2350/2500 - Loss: 0.0071, Perplexity: 1.0126, LR: 7.11e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:27,656 - INFO - Epoch 9, Step 2400/2500 - Loss: 0.0072, Perplexity: 1.0125, LR: 7.11e-05, LM: 0.0066, Age: 0.59, Sex: 0.008
2025-10-24 07:02:40,331 - INFO - Epoch 9, Step 2450/2500 - Loss: 0.0071, Perplexity: 1.0124, LR: 7.10e-05, LM: 0.0065, Age: 0.59, Sex: 0.008
2025-10-24 07:02:53,392 - INFO - Epoch 9, Step 2500/2500 - Loss: 0.0070, Perplexity: 1.0122, LR: 7.09e-05, LM: 0.0064, Age: 0.59, Sex: 0.008
2025-10-24 07:02:53,393 - INFO - Epoch 9 Complete - Avg Loss: 0.0070, Avg Perplexity: 1.0122, LM: 0.0064, Age: 0.59, Sex: 0.008
2025-10-24 07:03:43,052 - INFO - Validation - Loss: 0.0033, Perplexity: 1.0035, Token Accuracy: 0.9996, Code Accuracy: 0.9995
2025-10-24 07:03:43,054 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:03:47,887 - INFO - TPL computed on 500 samples: 1.0050
2025-10-24 07:03:47,887 - INFO - Temporal Perplexity (TPL): 1.0050
2025-10-24 07:03:47,888 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:03:57,228 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0215
2025-10-24 07:03:57,228 - INFO - Reconstruction Jaccard: 0.0215
2025-10-24 07:04:09,819 - INFO - Epoch 10, Step 50/2500 - Loss: 0.0070, Perplexity: 1.0073, LR: 7.09e-05, LM: 0.0065, Age: 0.54, Sex: 0.022
2025-10-24 07:04:22,321 - INFO - Epoch 10, Step 100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 7.08e-05, LM: 0.0035, Age: 0.54, Sex: 0.012
2025-10-24 07:04:34,766 - INFO - Epoch 10, Step 150/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 7.07e-05, LM: 0.0024, Age: 0.55, Sex: 0.008
2025-10-24 07:04:47,712 - INFO - Epoch 10, Step 200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 7.07e-05, LM: 0.0019, Age: 0.54, Sex: 0.006
2025-10-24 07:05:00,336 - INFO - Epoch 10, Step 250/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 7.06e-05, LM: 0.0019, Age: 0.55, Sex: 0.005
2025-10-24 07:05:13,003 - INFO - Epoch 10, Step 300/2500 - Loss: 0.0029, Perplexity: 1.0029, LR: 7.05e-05, LM: 0.0023, Age: 0.54, Sex: 0.005
2025-10-24 07:05:25,444 - INFO - Epoch 10, Step 350/2500 - Loss: 0.0041, Perplexity: 1.0046, LR: 7.05e-05, LM: 0.0035, Age: 0.55, Sex: 0.005
2025-10-24 07:05:37,906 - INFO - Epoch 10, Step 400/2500 - Loss: 0.0044, Perplexity: 1.0049, LR: 7.04e-05, LM: 0.0038, Age: 0.56, Sex: 0.005
2025-10-24 07:05:50,781 - INFO - Epoch 10, Step 450/2500 - Loss: 0.0042, Perplexity: 1.0046, LR: 7.03e-05, LM: 0.0036, Age: 0.57, Sex: 0.005
2025-10-24 07:06:03,134 - INFO - Epoch 10, Step 500/2500 - Loss: 0.0039, Perplexity: 1.0043, LR: 7.03e-05, LM: 0.0033, Age: 0.57, Sex: 0.005
2025-10-24 07:06:15,695 - INFO - Epoch 10, Step 550/2500 - Loss: 0.0039, Perplexity: 1.0042, LR: 7.02e-05, LM: 0.0033, Age: 0.57, Sex: 0.004
2025-10-24 07:06:28,323 - INFO - Epoch 10, Step 600/2500 - Loss: 0.0038, Perplexity: 1.0041, LR: 7.01e-05, LM: 0.0032, Age: 0.57, Sex: 0.005
2025-10-24 07:06:41,052 - INFO - Epoch 10, Step 650/2500 - Loss: 0.0040, Perplexity: 1.0044, LR: 7.01e-05, LM: 0.0034, Age: 0.57, Sex: 0.004
2025-10-24 07:06:53,553 - INFO - Epoch 10, Step 700/2500 - Loss: 0.0048, Perplexity: 1.0054, LR: 7.00e-05, LM: 0.0043, Age: 0.57, Sex: 0.004
2025-10-24 07:07:06,237 - INFO - Epoch 10, Step 750/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.99e-05, LM: 0.0049, Age: 0.57, Sex: 0.004
2025-10-24 07:07:19,153 - INFO - Epoch 10, Step 800/2500 - Loss: 0.0059, Perplexity: 1.0067, LR: 6.99e-05, LM: 0.0054, Age: 0.57, Sex: 0.005
2025-10-24 07:07:32,076 - INFO - Epoch 10, Step 850/2500 - Loss: 0.0061, Perplexity: 1.0069, LR: 6.98e-05, LM: 0.0056, Age: 0.57, Sex: 0.005
2025-10-24 07:07:44,759 - INFO - Epoch 10, Step 900/2500 - Loss: 0.0059, Perplexity: 1.0066, LR: 6.97e-05, LM: 0.0053, Age: 0.57, Sex: 0.004
2025-10-24 07:07:57,338 - INFO - Epoch 10, Step 950/2500 - Loss: 0.0058, Perplexity: 1.0065, LR: 6.97e-05, LM: 0.0052, Age: 0.57, Sex: 0.004
2025-10-24 07:08:10,273 - INFO - Epoch 10, Step 1000/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.96e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:08:22,596 - INFO - Epoch 10, Step 1050/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.95e-05, LM: 0.0048, Age: 0.57, Sex: 0.004
2025-10-24 07:08:35,455 - INFO - Epoch 10, Step 1100/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.95e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:08:48,009 - INFO - Epoch 10, Step 1150/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.94e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:09:00,319 - INFO - Epoch 10, Step 1200/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.93e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:09:13,297 - INFO - Epoch 10, Step 1250/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.93e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:09:25,908 - INFO - Epoch 10, Step 1300/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.92e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:09:38,494 - INFO - Epoch 10, Step 1350/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.91e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:09:50,980 - INFO - Epoch 10, Step 1400/2500 - Loss: 0.0058, Perplexity: 1.0064, LR: 6.91e-05, LM: 0.0052, Age: 0.57, Sex: 0.004
2025-10-24 07:10:03,740 - INFO - Epoch 10, Step 1450/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.90e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:10:16,191 - INFO - Epoch 10, Step 1500/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.89e-05, LM: 0.0049, Age: 0.57, Sex: 0.004
2025-10-24 07:10:29,177 - INFO - Epoch 10, Step 1550/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.89e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:10:41,847 - INFO - Epoch 10, Step 1600/2500 - Loss: 0.0060, Perplexity: 1.0067, LR: 6.88e-05, LM: 0.0054, Age: 0.57, Sex: 0.004
2025-10-24 07:10:54,691 - INFO - Epoch 10, Step 1650/2500 - Loss: 0.0058, Perplexity: 1.0065, LR: 6.87e-05, LM: 0.0053, Age: 0.57, Sex: 0.004
2025-10-24 07:11:07,357 - INFO - Epoch 10, Step 1700/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.86e-05, LM: 0.0051, Age: 0.57, Sex: 0.003
2025-10-24 07:11:19,990 - INFO - Epoch 10, Step 1750/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.86e-05, LM: 0.0050, Age: 0.57, Sex: 0.003
2025-10-24 07:11:32,873 - INFO - Epoch 10, Step 1800/2500 - Loss: 0.0054, Perplexity: 1.0061, LR: 6.85e-05, LM: 0.0049, Age: 0.57, Sex: 0.003
2025-10-24 07:11:45,272 - INFO - Epoch 10, Step 1850/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.84e-05, LM: 0.0048, Age: 0.56, Sex: 0.003
2025-10-24 07:11:58,271 - INFO - Epoch 10, Step 1900/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.84e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:12:11,278 - INFO - Epoch 10, Step 1950/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.83e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:12:24,155 - INFO - Epoch 10, Step 2000/2500 - Loss: 0.0056, Perplexity: 1.0063, LR: 6.82e-05, LM: 0.0051, Age: 0.56, Sex: 0.004
2025-10-24 07:12:36,856 - INFO - Epoch 10, Step 2050/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.82e-05, LM: 0.0050, Age: 0.57, Sex: 0.004
2025-10-24 07:12:49,057 - INFO - Epoch 10, Step 2100/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.81e-05, LM: 0.0052, Age: 0.56, Sex: 0.004
2025-10-24 07:13:01,524 - INFO - Epoch 10, Step 2150/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.80e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:13:14,053 - INFO - Epoch 10, Step 2200/2500 - Loss: 0.0057, Perplexity: 1.0064, LR: 6.80e-05, LM: 0.0051, Age: 0.57, Sex: 0.004
2025-10-24 07:13:26,865 - INFO - Epoch 10, Step 2250/2500 - Loss: 0.0056, Perplexity: 1.0062, LR: 6.79e-05, LM: 0.0050, Age: 0.56, Sex: 0.004
2025-10-24 07:13:39,439 - INFO - Epoch 10, Step 2300/2500 - Loss: 0.0055, Perplexity: 1.0061, LR: 6.78e-05, LM: 0.0049, Age: 0.56, Sex: 0.004
2025-10-24 07:13:52,159 - INFO - Epoch 10, Step 2350/2500 - Loss: 0.0054, Perplexity: 1.0060, LR: 6.78e-05, LM: 0.0048, Age: 0.56, Sex: 0.004
2025-10-24 07:14:05,079 - INFO - Epoch 10, Step 2400/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.77e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:17,629 - INFO - Epoch 10, Step 2450/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.76e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:30,570 - INFO - Epoch 10, Step 2500/2500 - Loss: 0.0053, Perplexity: 1.0059, LR: 6.76e-05, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:14:30,572 - INFO - Epoch 10 Complete - Avg Loss: 0.0053, Avg Perplexity: 1.0059, LM: 0.0047, Age: 0.56, Sex: 0.004
2025-10-24 07:15:20,448 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0008, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 07:15:20,450 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:15:25,333 - INFO - TPL computed on 500 samples: 1.0019
2025-10-24 07:15:25,333 - INFO - Temporal Perplexity (TPL): 1.0019
2025-10-24 07:15:25,334 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:15:34,367 - INFO - Reconstruction Jaccard computed on 117 visits: 0.0266
2025-10-24 07:15:34,367 - INFO - Reconstruction Jaccard: 0.0266
2025-10-24 07:15:36,829 - INFO - Checkpoint saved: epoch 10
2025-10-24 07:15:49,579 - INFO - Epoch 11, Step 50/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 6.75e-05, LM: 0.0011, Age: 0.59, Sex: 0.003
2025-10-24 07:16:02,416 - INFO - Epoch 11, Step 100/2500 - Loss: 0.0041, Perplexity: 1.0042, LR: 6.74e-05, LM: 0.0035, Age: 0.55, Sex: 0.004
2025-10-24 07:16:15,300 - INFO - Epoch 11, Step 150/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.74e-05, LM: 0.0030, Age: 0.53, Sex: 0.003
2025-10-24 07:16:27,928 - INFO - Epoch 11, Step 200/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 6.73e-05, LM: 0.0024, Age: 0.55, Sex: 0.003
2025-10-24 07:16:40,533 - INFO - Epoch 11, Step 250/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.72e-05, LM: 0.0029, Age: 0.54, Sex: 0.002
2025-10-24 07:16:53,069 - INFO - Epoch 11, Step 300/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.72e-05, LM: 0.0030, Age: 0.54, Sex: 0.003
2025-10-24 07:17:05,493 - INFO - Epoch 11, Step 350/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 6.71e-05, LM: 0.0027, Age: 0.54, Sex: 0.003
2025-10-24 07:17:18,371 - INFO - Epoch 11, Step 400/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 6.70e-05, LM: 0.0026, Age: 0.54, Sex: 0.003
2025-10-24 07:17:30,951 - INFO - Epoch 11, Step 450/2500 - Loss: 0.0032, Perplexity: 1.0032, LR: 6.70e-05, LM: 0.0026, Age: 0.55, Sex: 0.002
2025-10-24 07:17:43,647 - INFO - Epoch 11, Step 500/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.69e-05, LM: 0.0030, Age: 0.55, Sex: 0.003
2025-10-24 07:17:56,267 - INFO - Epoch 11, Step 550/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.68e-05, LM: 0.0032, Age: 0.55, Sex: 0.003
2025-10-24 07:18:09,476 - INFO - Epoch 11, Step 600/2500 - Loss: 0.0039, Perplexity: 1.0040, LR: 6.68e-05, LM: 0.0033, Age: 0.55, Sex: 0.003
2025-10-24 07:18:22,372 - INFO - Epoch 11, Step 650/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.67e-05, LM: 0.0035, Age: 0.55, Sex: 0.004
2025-10-24 07:18:35,406 - INFO - Epoch 11, Step 700/2500 - Loss: 0.0045, Perplexity: 1.0048, LR: 6.66e-05, LM: 0.0039, Age: 0.55, Sex: 0.004
2025-10-24 07:18:48,256 - INFO - Epoch 11, Step 750/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.66e-05, LM: 0.0044, Age: 0.55, Sex: 0.004
2025-10-24 07:19:01,073 - INFO - Epoch 11, Step 800/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.65e-05, LM: 0.0042, Age: 0.55, Sex: 0.004
2025-10-24 07:19:13,667 - INFO - Epoch 11, Step 850/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.64e-05, LM: 0.0042, Age: 0.54, Sex: 0.004
2025-10-24 07:19:26,256 - INFO - Epoch 11, Step 900/2500 - Loss: 0.0048, Perplexity: 1.0052, LR: 6.64e-05, LM: 0.0042, Age: 0.54, Sex: 0.004
2025-10-24 07:19:38,734 - INFO - Epoch 11, Step 950/2500 - Loss: 0.0047, Perplexity: 1.0051, LR: 6.63e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:19:51,388 - INFO - Epoch 11, Step 1000/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.62e-05, LM: 0.0044, Age: 0.54, Sex: 0.005
2025-10-24 07:20:04,064 - INFO - Epoch 11, Step 1050/2500 - Loss: 0.0048, Perplexity: 1.0052, LR: 6.61e-05, LM: 0.0043, Age: 0.54, Sex: 0.005
2025-10-24 07:20:17,009 - INFO - Epoch 11, Step 1100/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.61e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:20:29,781 - INFO - Epoch 11, Step 1150/2500 - Loss: 0.0045, Perplexity: 1.0048, LR: 6.60e-05, LM: 0.0039, Age: 0.54, Sex: 0.005
2025-10-24 07:20:42,547 - INFO - Epoch 11, Step 1200/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.59e-05, LM: 0.0041, Age: 0.54, Sex: 0.005
2025-10-24 07:20:54,955 - INFO - Epoch 11, Step 1250/2500 - Loss: 0.0049, Perplexity: 1.0053, LR: 6.59e-05, LM: 0.0043, Age: 0.54, Sex: 0.004
2025-10-24 07:21:07,779 - INFO - Epoch 11, Step 1300/2500 - Loss: 0.0051, Perplexity: 1.0055, LR: 6.58e-05, LM: 0.0045, Age: 0.53, Sex: 0.005
2025-10-24 07:21:20,228 - INFO - Epoch 11, Step 1350/2500 - Loss: 0.0441, Perplexity: 1.6338, LR: 6.57e-05, LM: 0.0435, Age: 0.54, Sex: 0.010
2025-10-24 07:21:32,758 - INFO - Epoch 11, Step 1400/2500 - Loss: 0.0426, Perplexity: 1.6113, LR: 6.57e-05, LM: 0.0420, Age: 0.54, Sex: 0.011
2025-10-24 07:21:45,382 - INFO - Epoch 11, Step 1450/2500 - Loss: 0.0413, Perplexity: 1.5904, LR: 6.56e-05, LM: 0.0407, Age: 0.54, Sex: 0.011
2025-10-24 07:21:58,075 - INFO - Epoch 11, Step 1500/2500 - Loss: 0.0401, Perplexity: 1.5709, LR: 6.55e-05, LM: 0.0395, Age: 0.54, Sex: 0.010
2025-10-24 07:22:10,890 - INFO - Epoch 11, Step 1550/2500 - Loss: 0.0389, Perplexity: 1.5525, LR: 6.55e-05, LM: 0.0383, Age: 0.54, Sex: 0.010
2025-10-24 07:22:23,582 - INFO - Epoch 11, Step 1600/2500 - Loss: 0.0377, Perplexity: 1.5353, LR: 6.54e-05, LM: 0.0372, Age: 0.54, Sex: 0.010
2025-10-24 07:22:36,038 - INFO - Epoch 11, Step 1650/2500 - Loss: 0.0368, Perplexity: 1.5193, LR: 6.53e-05, LM: 0.0362, Age: 0.54, Sex: 0.010
2025-10-24 07:22:48,341 - INFO - Epoch 11, Step 1700/2500 - Loss: 0.0358, Perplexity: 1.5041, LR: 6.53e-05, LM: 0.0352, Age: 0.55, Sex: 0.010
2025-10-24 07:23:01,135 - INFO - Epoch 11, Step 1750/2500 - Loss: 0.0348, Perplexity: 1.4898, LR: 6.52e-05, LM: 0.0342, Age: 0.54, Sex: 0.010
2025-10-24 07:23:14,006 - INFO - Epoch 11, Step 1800/2500 - Loss: 0.0339, Perplexity: 1.4762, LR: 6.51e-05, LM: 0.0333, Age: 0.54, Sex: 0.010
2025-10-24 07:23:26,588 - INFO - Epoch 11, Step 1850/2500 - Loss: 0.0331, Perplexity: 1.4635, LR: 6.51e-05, LM: 0.0326, Age: 0.55, Sex: 0.009
2025-10-24 07:23:38,909 - INFO - Epoch 11, Step 1900/2500 - Loss: 0.0325, Perplexity: 1.4516, LR: 6.50e-05, LM: 0.0319, Age: 0.55, Sex: 0.009
2025-10-24 07:23:51,636 - INFO - Epoch 11, Step 1950/2500 - Loss: 0.0318, Perplexity: 1.4402, LR: 6.49e-05, LM: 0.0312, Age: 0.55, Sex: 0.009
2025-10-24 07:24:04,591 - INFO - Epoch 11, Step 2000/2500 - Loss: 0.0311, Perplexity: 1.4292, LR: 6.49e-05, LM: 0.0305, Age: 0.55, Sex: 0.009
2025-10-24 07:24:17,009 - INFO - Epoch 11, Step 2050/2500 - Loss: 0.0303, Perplexity: 1.4188, LR: 6.48e-05, LM: 0.0298, Age: 0.55, Sex: 0.009
2025-10-24 07:24:29,575 - INFO - Epoch 11, Step 2100/2500 - Loss: 0.0296, Perplexity: 1.4088, LR: 6.47e-05, LM: 0.0291, Age: 0.55, Sex: 0.009
2025-10-24 07:24:42,104 - INFO - Epoch 11, Step 2150/2500 - Loss: 0.0290, Perplexity: 1.3994, LR: 6.47e-05, LM: 0.0285, Age: 0.55, Sex: 0.008
2025-10-24 07:24:54,754 - INFO - Epoch 11, Step 2200/2500 - Loss: 0.0284, Perplexity: 1.3904, LR: 6.46e-05, LM: 0.0279, Age: 0.55, Sex: 0.008
2025-10-24 07:25:07,736 - INFO - Epoch 11, Step 2250/2500 - Loss: 0.0279, Perplexity: 1.3818, LR: 6.45e-05, LM: 0.0273, Age: 0.55, Sex: 0.008
2025-10-24 07:25:20,434 - INFO - Epoch 11, Step 2300/2500 - Loss: 0.0273, Perplexity: 1.3735, LR: 6.45e-05, LM: 0.0267, Age: 0.55, Sex: 0.008
2025-10-24 07:25:33,243 - INFO - Epoch 11, Step 2350/2500 - Loss: 0.0268, Perplexity: 1.3656, LR: 6.44e-05, LM: 0.0262, Age: 0.55, Sex: 0.008
2025-10-24 07:25:45,894 - INFO - Epoch 11, Step 2400/2500 - Loss: 0.0262, Perplexity: 1.3580, LR: 6.43e-05, LM: 0.0257, Age: 0.55, Sex: 0.008
2025-10-24 07:25:58,687 - INFO - Epoch 11, Step 2450/2500 - Loss: 0.0257, Perplexity: 1.3508, LR: 6.43e-05, LM: 0.0252, Age: 0.55, Sex: 0.008
2025-10-24 07:26:11,489 - INFO - Epoch 11, Step 2500/2500 - Loss: 0.0253, Perplexity: 1.3438, LR: 6.42e-05, LM: 0.0247, Age: 0.55, Sex: 0.008
2025-10-24 07:26:11,491 - INFO - Epoch 11 Complete - Avg Loss: 0.0253, Avg Perplexity: 1.3438, LM: 0.0247, Age: 0.55, Sex: 0.008
2025-10-24 07:27:01,214 - INFO - Validation - Loss: 0.0008, Perplexity: 1.0009, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 07:27:01,217 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:27:06,065 - INFO - TPL computed on 500 samples: 1.0004
2025-10-24 07:27:06,066 - INFO - Temporal Perplexity (TPL): 1.0004
2025-10-24 07:27:06,067 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:27:15,890 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0144
2025-10-24 07:27:15,890 - INFO - Reconstruction Jaccard: 0.0144
2025-10-24 07:27:28,496 - INFO - Epoch 12, Step 50/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 6.41e-05, LM: 0.0003, Age: 0.52, Sex: 0.001
2025-10-24 07:27:41,353 - INFO - Epoch 12, Step 100/2500 - Loss: 0.0034, Perplexity: 1.0037, LR: 6.41e-05, LM: 0.0029, Age: 0.50, Sex: 0.004
2025-10-24 07:27:54,127 - INFO - Epoch 12, Step 150/2500 - Loss: 0.0055, Perplexity: 1.0062, LR: 6.40e-05, LM: 0.0050, Age: 0.52, Sex: 0.006
2025-10-24 07:28:06,721 - INFO - Epoch 12, Step 200/2500 - Loss: 0.0057, Perplexity: 1.0063, LR: 6.39e-05, LM: 0.0052, Age: 0.53, Sex: 0.004
2025-10-24 07:28:19,268 - INFO - Epoch 12, Step 250/2500 - Loss: 0.0051, Perplexity: 1.0056, LR: 6.39e-05, LM: 0.0046, Age: 0.54, Sex: 0.004
2025-10-24 07:28:32,386 - INFO - Epoch 12, Step 300/2500 - Loss: 0.0045, Perplexity: 1.0049, LR: 6.38e-05, LM: 0.0039, Age: 0.54, Sex: 0.004
2025-10-24 07:28:45,276 - INFO - Epoch 12, Step 350/2500 - Loss: 0.0040, Perplexity: 1.0044, LR: 6.37e-05, LM: 0.0035, Age: 0.54, Sex: 0.003
2025-10-24 07:28:57,712 - INFO - Epoch 12, Step 400/2500 - Loss: 0.0036, Perplexity: 1.0039, LR: 6.36e-05, LM: 0.0031, Age: 0.53, Sex: 0.003
2025-10-24 07:29:10,460 - INFO - Epoch 12, Step 450/2500 - Loss: 0.0038, Perplexity: 1.0041, LR: 6.36e-05, LM: 0.0032, Age: 0.53, Sex: 0.004
2025-10-24 07:29:23,203 - INFO - Epoch 12, Step 500/2500 - Loss: 0.0037, Perplexity: 1.0040, LR: 6.35e-05, LM: 0.0032, Age: 0.53, Sex: 0.004
2025-10-24 07:29:35,603 - INFO - Epoch 12, Step 550/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.34e-05, LM: 0.0037, Age: 0.53, Sex: 0.004
2025-10-24 07:29:48,412 - INFO - Epoch 12, Step 600/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.34e-05, LM: 0.0037, Age: 0.54, Sex: 0.004
2025-10-24 07:30:00,838 - INFO - Epoch 12, Step 650/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.33e-05, LM: 0.0036, Age: 0.54, Sex: 0.004
2025-10-24 07:30:13,580 - INFO - Epoch 12, Step 700/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.32e-05, LM: 0.0037, Age: 0.54, Sex: 0.003
2025-10-24 07:30:26,257 - INFO - Epoch 12, Step 750/2500 - Loss: 0.0042, Perplexity: 1.0044, LR: 6.32e-05, LM: 0.0037, Age: 0.54, Sex: 0.003
2025-10-24 07:30:38,874 - INFO - Epoch 12, Step 800/2500 - Loss: 0.0042, Perplexity: 1.0045, LR: 6.31e-05, LM: 0.0037, Age: 0.54, Sex: 0.004
2025-10-24 07:30:51,921 - INFO - Epoch 12, Step 850/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.30e-05, LM: 0.0035, Age: 0.54, Sex: 0.003
2025-10-24 07:31:04,662 - INFO - Epoch 12, Step 900/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.30e-05, LM: 0.0034, Age: 0.54, Sex: 0.003
2025-10-24 07:31:17,349 - INFO - Epoch 12, Step 950/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.29e-05, LM: 0.0033, Age: 0.54, Sex: 0.003
2025-10-24 07:31:30,208 - INFO - Epoch 12, Step 1000/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.28e-05, LM: 0.0032, Age: 0.54, Sex: 0.003
2025-10-24 07:31:42,938 - INFO - Epoch 12, Step 1050/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.28e-05, LM: 0.0032, Age: 0.54, Sex: 0.003
2025-10-24 07:31:55,901 - INFO - Epoch 12, Step 1100/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.27e-05, LM: 0.0031, Age: 0.54, Sex: 0.003
2025-10-24 07:32:08,775 - INFO - Epoch 12, Step 1150/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.26e-05, LM: 0.0030, Age: 0.54, Sex: 0.003
2025-10-24 07:32:21,734 - INFO - Epoch 12, Step 1200/2500 - Loss: 0.0034, Perplexity: 1.0036, LR: 6.26e-05, LM: 0.0028, Age: 0.54, Sex: 0.003
2025-10-24 07:32:34,522 - INFO - Epoch 12, Step 1250/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.25e-05, LM: 0.0029, Age: 0.54, Sex: 0.004
2025-10-24 07:32:47,108 - INFO - Epoch 12, Step 1300/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.24e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:32:59,536 - INFO - Epoch 12, Step 1350/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.24e-05, LM: 0.0033, Age: 0.54, Sex: 0.004
2025-10-24 07:33:12,280 - INFO - Epoch 12, Step 1400/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.23e-05, LM: 0.0032, Age: 0.54, Sex: 0.004
2025-10-24 07:33:24,943 - INFO - Epoch 12, Step 1450/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.22e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:33:37,597 - INFO - Epoch 12, Step 1500/2500 - Loss: 0.0037, Perplexity: 1.0038, LR: 6.22e-05, LM: 0.0031, Age: 0.54, Sex: 0.004
2025-10-24 07:33:50,306 - INFO - Epoch 12, Step 1550/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.21e-05, LM: 0.0032, Age: 0.54, Sex: 0.004
2025-10-24 07:34:03,149 - INFO - Epoch 12, Step 1600/2500 - Loss: 0.0039, Perplexity: 1.0041, LR: 6.20e-05, LM: 0.0033, Age: 0.54, Sex: 0.004
2025-10-24 07:34:15,692 - INFO - Epoch 12, Step 1650/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.20e-05, LM: 0.0035, Age: 0.54, Sex: 0.005
2025-10-24 07:34:28,354 - INFO - Epoch 12, Step 1700/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.19e-05, LM: 0.0035, Age: 0.54, Sex: 0.005
2025-10-24 07:34:40,771 - INFO - Epoch 12, Step 1750/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.18e-05, LM: 0.0035, Age: 0.54, Sex: 0.006
2025-10-24 07:34:53,775 - INFO - Epoch 12, Step 1800/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.18e-05, LM: 0.0035, Age: 0.54, Sex: 0.006
2025-10-24 07:35:06,016 - INFO - Epoch 12, Step 1850/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.17e-05, LM: 0.0035, Age: 0.55, Sex: 0.006
2025-10-24 07:35:18,719 - INFO - Epoch 12, Step 1900/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 6.16e-05, LM: 0.0035, Age: 0.55, Sex: 0.006
2025-10-24 07:35:31,576 - INFO - Epoch 12, Step 1950/2500 - Loss: 0.0040, Perplexity: 1.0042, LR: 6.16e-05, LM: 0.0034, Age: 0.55, Sex: 0.006
2025-10-24 07:35:44,100 - INFO - Epoch 12, Step 2000/2500 - Loss: 0.0039, Perplexity: 1.0041, LR: 6.15e-05, LM: 0.0034, Age: 0.54, Sex: 0.006
2025-10-24 07:35:56,709 - INFO - Epoch 12, Step 2050/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.14e-05, LM: 0.0033, Age: 0.54, Sex: 0.005
2025-10-24 07:36:09,636 - INFO - Epoch 12, Step 2100/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.14e-05, LM: 0.0032, Age: 0.55, Sex: 0.005
2025-10-24 07:36:22,251 - INFO - Epoch 12, Step 2150/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.13e-05, LM: 0.0032, Age: 0.55, Sex: 0.005
2025-10-24 07:36:34,843 - INFO - Epoch 12, Step 2200/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.12e-05, LM: 0.0031, Age: 0.54, Sex: 0.006
2025-10-24 07:36:47,334 - INFO - Epoch 12, Step 2250/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 6.11e-05, LM: 0.0031, Age: 0.55, Sex: 0.006
2025-10-24 07:36:59,854 - INFO - Epoch 12, Step 2300/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.11e-05, LM: 0.0031, Age: 0.54, Sex: 0.006
2025-10-24 07:37:12,363 - INFO - Epoch 12, Step 2350/2500 - Loss: 0.0036, Perplexity: 1.0038, LR: 6.10e-05, LM: 0.0030, Age: 0.54, Sex: 0.006
2025-10-24 07:37:24,886 - INFO - Epoch 12, Step 2400/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.09e-05, LM: 0.0030, Age: 0.55, Sex: 0.005
2025-10-24 07:37:37,302 - INFO - Epoch 12, Step 2450/2500 - Loss: 0.0035, Perplexity: 1.0036, LR: 6.09e-05, LM: 0.0029, Age: 0.54, Sex: 0.005
2025-10-24 07:37:50,124 - INFO - Epoch 12, Step 2500/2500 - Loss: 0.0034, Perplexity: 1.0036, LR: 6.08e-05, LM: 0.0028, Age: 0.54, Sex: 0.005
2025-10-24 07:37:50,126 - INFO - Epoch 12 Complete - Avg Loss: 0.0034, Avg Perplexity: 1.0036, LM: 0.0028, Age: 0.54, Sex: 0.005
2025-10-24 07:38:39,720 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 07:38:39,722 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:38:44,591 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 07:38:44,591 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 07:38:44,592 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:38:52,788 - INFO - Reconstruction Jaccard computed on 106 visits: 0.0013
2025-10-24 07:38:52,788 - INFO - Reconstruction Jaccard: 0.0013
2025-10-24 07:38:52,789 - INFO - New best model! Validation loss: 0.0001
2025-10-24 07:38:57,072 - INFO - Checkpoint saved: epoch 12
2025-10-24 07:39:10,060 - INFO - Epoch 13, Step 50/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 6.07e-05, LM: 0.0012, Age: 0.49, Sex: 0.000
2025-10-24 07:39:22,481 - INFO - Epoch 13, Step 100/2500 - Loss: 0.0036, Perplexity: 1.0039, LR: 6.07e-05, LM: 0.0031, Age: 0.52, Sex: 0.003
2025-10-24 07:39:34,829 - INFO - Epoch 13, Step 150/2500 - Loss: 0.0046, Perplexity: 1.0050, LR: 6.06e-05, LM: 0.0041, Age: 0.52, Sex: 0.006
2025-10-24 07:39:47,259 - INFO - Epoch 13, Step 200/2500 - Loss: 0.0039, Perplexity: 1.0042, LR: 6.05e-05, LM: 0.0034, Age: 0.52, Sex: 0.007
2025-10-24 07:39:59,732 - INFO - Epoch 13, Step 250/2500 - Loss: 0.0040, Perplexity: 1.0043, LR: 6.05e-05, LM: 0.0035, Age: 0.53, Sex: 0.006
2025-10-24 07:40:12,487 - INFO - Epoch 13, Step 300/2500 - Loss: 0.0038, Perplexity: 1.0040, LR: 6.04e-05, LM: 0.0032, Age: 0.51, Sex: 0.006
2025-10-24 07:40:25,130 - INFO - Epoch 13, Step 350/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.03e-05, LM: 0.0029, Age: 0.51, Sex: 0.005
2025-10-24 07:40:37,714 - INFO - Epoch 13, Step 400/2500 - Loss: 0.0033, Perplexity: 1.0035, LR: 6.03e-05, LM: 0.0028, Age: 0.51, Sex: 0.006
2025-10-24 07:40:50,232 - INFO - Epoch 13, Step 450/2500 - Loss: 0.0035, Perplexity: 1.0037, LR: 6.02e-05, LM: 0.0029, Age: 0.52, Sex: 0.005
2025-10-24 07:41:02,756 - INFO - Epoch 13, Step 500/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 6.01e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:15,686 - INFO - Epoch 13, Step 550/2500 - Loss: 0.0033, Perplexity: 1.0034, LR: 6.01e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:27,987 - INFO - Epoch 13, Step 600/2500 - Loss: 0.0031, Perplexity: 1.0032, LR: 6.00e-05, LM: 0.0025, Age: 0.52, Sex: 0.005
2025-10-24 07:41:40,463 - INFO - Epoch 13, Step 650/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 5.99e-05, LM: 0.0027, Age: 0.52, Sex: 0.005
2025-10-24 07:41:52,868 - INFO - Epoch 13, Step 700/2500 - Loss: 0.0033, Perplexity: 1.0035, LR: 5.99e-05, LM: 0.0028, Age: 0.52, Sex: 0.005
2025-10-24 07:42:05,361 - INFO - Epoch 13, Step 750/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.98e-05, LM: 0.0026, Age: 0.52, Sex: 0.004
2025-10-24 07:42:17,881 - INFO - Epoch 13, Step 800/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.97e-05, LM: 0.0026, Age: 0.52, Sex: 0.004
2025-10-24 07:42:30,720 - INFO - Epoch 13, Step 850/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.97e-05, LM: 0.0025, Age: 0.51, Sex: 0.004
2025-10-24 07:42:43,545 - INFO - Epoch 13, Step 900/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.96e-05, LM: 0.0024, Age: 0.51, Sex: 0.004
2025-10-24 07:42:56,420 - INFO - Epoch 13, Step 950/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.95e-05, LM: 0.0023, Age: 0.51, Sex: 0.004
2025-10-24 07:43:09,157 - INFO - Epoch 13, Step 1000/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.95e-05, LM: 0.0024, Age: 0.51, Sex: 0.004
2025-10-24 07:43:21,879 - INFO - Epoch 13, Step 1050/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.94e-05, LM: 0.0025, Age: 0.51, Sex: 0.004
2025-10-24 07:43:34,650 - INFO - Epoch 13, Step 1100/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.93e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:43:47,528 - INFO - Epoch 13, Step 1150/2500 - Loss: 0.0031, Perplexity: 1.0032, LR: 5.93e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:44:00,143 - INFO - Epoch 13, Step 1200/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.92e-05, LM: 0.0025, Age: 0.52, Sex: 0.004
2025-10-24 07:44:12,733 - INFO - Epoch 13, Step 1250/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.91e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:25,228 - INFO - Epoch 13, Step 1300/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.91e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:37,996 - INFO - Epoch 13, Step 1350/2500 - Loss: 0.0030, Perplexity: 1.0031, LR: 5.90e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:44:50,638 - INFO - Epoch 13, Step 1400/2500 - Loss: 0.0032, Perplexity: 1.0033, LR: 5.89e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:03,344 - INFO - Epoch 13, Step 1450/2500 - Loss: 0.0033, Perplexity: 1.0034, LR: 5.89e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:16,106 - INFO - Epoch 13, Step 1500/2500 - Loss: 0.0032, Perplexity: 1.0034, LR: 5.88e-05, LM: 0.0027, Age: 0.52, Sex: 0.004
2025-10-24 07:45:28,334 - INFO - Epoch 13, Step 1550/2500 - Loss: 0.0031, Perplexity: 1.0033, LR: 5.87e-05, LM: 0.0026, Age: 0.51, Sex: 0.004
2025-10-24 07:45:40,929 - INFO - Epoch 13, Step 1600/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.86e-05, LM: 0.0025, Age: 0.51, Sex: 0.005
2025-10-24 07:45:53,966 - INFO - Epoch 13, Step 1650/2500 - Loss: 0.0030, Perplexity: 1.0032, LR: 5.86e-05, LM: 0.0025, Age: 0.51, Sex: 0.005
2025-10-24 07:46:06,497 - INFO - Epoch 13, Step 1700/2500 - Loss: 0.0029, Perplexity: 1.0031, LR: 5.85e-05, LM: 0.0024, Age: 0.51, Sex: 0.005
2025-10-24 07:46:19,307 - INFO - Epoch 13, Step 1750/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.84e-05, LM: 0.0024, Age: 0.51, Sex: 0.005
2025-10-24 07:46:31,885 - INFO - Epoch 13, Step 1800/2500 - Loss: 0.0029, Perplexity: 1.0031, LR: 5.84e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:46:44,632 - INFO - Epoch 13, Step 1850/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.83e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:46:57,271 - INFO - Epoch 13, Step 1900/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.82e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:09,681 - INFO - Epoch 13, Step 1950/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.82e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:22,045 - INFO - Epoch 13, Step 2000/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.81e-05, LM: 0.0024, Age: 0.52, Sex: 0.005
2025-10-24 07:47:34,545 - INFO - Epoch 13, Step 2050/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.80e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:47:47,360 - INFO - Epoch 13, Step 2100/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.80e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:00,064 - INFO - Epoch 13, Step 2150/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.79e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:12,976 - INFO - Epoch 13, Step 2200/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.78e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:25,677 - INFO - Epoch 13, Step 2250/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.78e-05, LM: 0.0023, Age: 0.52, Sex: 0.005
2025-10-24 07:48:38,443 - INFO - Epoch 13, Step 2300/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.77e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:48:51,648 - INFO - Epoch 13, Step 2350/2500 - Loss: 0.0027, Perplexity: 1.0029, LR: 5.76e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:49:04,469 - INFO - Epoch 13, Step 2400/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.76e-05, LM: 0.0022, Age: 0.52, Sex: 0.005
2025-10-24 07:49:17,017 - INFO - Epoch 13, Step 2450/2500 - Loss: 0.0027, Perplexity: 1.0029, LR: 5.75e-05, LM: 0.0022, Age: 0.51, Sex: 0.005
2025-10-24 07:49:29,580 - INFO - Epoch 13, Step 2500/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.74e-05, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:49:29,582 - INFO - Epoch 13 Complete - Avg Loss: 0.0029, Avg Perplexity: 1.0030, LM: 0.0024, Age: 0.52, Sex: 0.004
2025-10-24 07:50:19,782 - INFO - Validation - Loss: 0.0006, Perplexity: 1.0006, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 07:50:19,785 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 07:50:24,604 - INFO - TPL computed on 500 samples: 1.0012
2025-10-24 07:50:24,604 - INFO - Temporal Perplexity (TPL): 1.0012
2025-10-24 07:50:24,605 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 07:50:33,910 - INFO - Reconstruction Jaccard computed on 119 visits: 0.0103
2025-10-24 07:50:33,910 - INFO - Reconstruction Jaccard: 0.0103
2025-10-24 07:50:46,539 - INFO - Epoch 14, Step 50/2500 - Loss: 0.0037, Perplexity: 1.0039, LR: 5.74e-05, LM: 0.0032, Age: 0.47, Sex: 0.002
2025-10-24 07:50:59,502 - INFO - Epoch 14, Step 100/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.73e-05, LM: 0.0016, Age: 0.49, Sex: 0.001
2025-10-24 07:51:12,311 - INFO - Epoch 14, Step 150/2500 - Loss: 0.0025, Perplexity: 1.0027, LR: 5.72e-05, LM: 0.0021, Age: 0.48, Sex: 0.001
2025-10-24 07:51:25,002 - INFO - Epoch 14, Step 200/2500 - Loss: 0.0023, Perplexity: 1.0024, LR: 5.72e-05, LM: 0.0018, Age: 0.48, Sex: 0.002
2025-10-24 07:51:38,049 - INFO - Epoch 14, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.71e-05, LM: 0.0015, Age: 0.49, Sex: 0.002
2025-10-24 07:51:50,084 - INFO - Epoch 14, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.70e-05, LM: 0.0017, Age: 0.49, Sex: 0.002
2025-10-24 07:52:02,992 - INFO - Epoch 14, Step 350/2500 - Loss: 0.0024, Perplexity: 1.0024, LR: 5.70e-05, LM: 0.0019, Age: 0.48, Sex: 0.002
2025-10-24 07:52:15,819 - INFO - Epoch 14, Step 400/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.69e-05, LM: 0.0023, Age: 0.49, Sex: 0.001
2025-10-24 07:52:28,448 - INFO - Epoch 14, Step 450/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.68e-05, LM: 0.0024, Age: 0.49, Sex: 0.001
2025-10-24 07:52:41,282 - INFO - Epoch 14, Step 500/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.68e-05, LM: 0.0023, Age: 0.50, Sex: 0.001
2025-10-24 07:52:53,907 - INFO - Epoch 14, Step 550/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.67e-05, LM: 0.0021, Age: 0.49, Sex: 0.001
2025-10-24 07:53:06,516 - INFO - Epoch 14, Step 600/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.66e-05, LM: 0.0021, Age: 0.51, Sex: 0.002
2025-10-24 07:53:19,051 - INFO - Epoch 14, Step 650/2500 - Loss: 0.0029, Perplexity: 1.0030, LR: 5.66e-05, LM: 0.0024, Age: 0.51, Sex: 0.002
2025-10-24 07:53:31,653 - INFO - Epoch 14, Step 700/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.65e-05, LM: 0.0022, Age: 0.51, Sex: 0.002
2025-10-24 07:53:44,877 - INFO - Epoch 14, Step 750/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.64e-05, LM: 0.0021, Age: 0.51, Sex: 0.002
2025-10-24 07:53:57,555 - INFO - Epoch 14, Step 800/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.64e-05, LM: 0.0022, Age: 0.51, Sex: 0.004
2025-10-24 07:54:10,259 - INFO - Epoch 14, Step 850/2500 - Loss: 0.0026, Perplexity: 1.0028, LR: 5.63e-05, LM: 0.0021, Age: 0.50, Sex: 0.004
2025-10-24 07:54:22,650 - INFO - Epoch 14, Step 900/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.62e-05, LM: 0.0021, Age: 0.50, Sex: 0.004
2025-10-24 07:54:34,985 - INFO - Epoch 14, Step 950/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.61e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 07:54:47,774 - INFO - Epoch 14, Step 1000/2500 - Loss: 0.0028, Perplexity: 1.0029, LR: 5.61e-05, LM: 0.0023, Age: 0.50, Sex: 0.004
2025-10-24 07:55:00,359 - INFO - Epoch 14, Step 1050/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.60e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 07:55:13,225 - INFO - Epoch 14, Step 1100/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 5.59e-05, LM: 0.0022, Age: 0.50, Sex: 0.003
2025-10-24 07:55:26,033 - INFO - Epoch 14, Step 1150/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.59e-05, LM: 0.0021, Age: 0.50, Sex: 0.003
2025-10-24 07:55:38,513 - INFO - Epoch 14, Step 1200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.58e-05, LM: 0.0020, Age: 0.50, Sex: 0.003
2025-10-24 07:55:51,094 - INFO - Epoch 14, Step 1250/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.57e-05, LM: 0.0020, Age: 0.50, Sex: 0.003
2025-10-24 07:56:03,706 - INFO - Epoch 14, Step 1300/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.57e-05, LM: 0.0021, Age: 0.50, Sex: 0.003
2025-10-24 07:56:16,654 - INFO - Epoch 14, Step 1350/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.56e-05, LM: 0.0021, Age: 0.50, Sex: 0.007
2025-10-24 07:56:29,341 - INFO - Epoch 14, Step 1400/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.55e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:56:41,845 - INFO - Epoch 14, Step 1450/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.55e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:56:54,214 - INFO - Epoch 14, Step 1500/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.54e-05, LM: 0.0021, Age: 0.50, Sex: 0.012
2025-10-24 07:57:06,788 - INFO - Epoch 14, Step 1550/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.53e-05, LM: 0.0020, Age: 0.50, Sex: 0.012
2025-10-24 07:57:19,313 - INFO - Epoch 14, Step 1600/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.53e-05, LM: 0.0020, Age: 0.50, Sex: 0.012
2025-10-24 07:57:31,977 - INFO - Epoch 14, Step 1650/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.52e-05, LM: 0.0020, Age: 0.50, Sex: 0.013
2025-10-24 07:57:44,694 - INFO - Epoch 14, Step 1700/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 5.51e-05, LM: 0.0019, Age: 0.50, Sex: 0.013
2025-10-24 07:57:57,080 - INFO - Epoch 14, Step 1750/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 5.51e-05, LM: 0.0019, Age: 0.50, Sex: 0.013
2025-10-24 07:58:09,935 - INFO - Epoch 14, Step 1800/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.50e-05, LM: 0.0020, Age: 0.50, Sex: 0.013
2025-10-24 07:58:22,601 - INFO - Epoch 14, Step 1850/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.49e-05, LM: 0.0020, Age: 0.50, Sex: 0.018
2025-10-24 07:58:35,570 - INFO - Epoch 14, Step 1900/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.49e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:58:48,733 - INFO - Epoch 14, Step 1950/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.48e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:59:01,154 - INFO - Epoch 14, Step 2000/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.47e-05, LM: 0.0021, Age: 0.50, Sex: 0.017
2025-10-24 07:59:13,619 - INFO - Epoch 14, Step 2050/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.47e-05, LM: 0.0020, Age: 0.50, Sex: 0.017
2025-10-24 07:59:26,330 - INFO - Epoch 14, Step 2100/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.46e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 07:59:39,187 - INFO - Epoch 14, Step 2150/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.45e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 07:59:51,743 - INFO - Epoch 14, Step 2200/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.45e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 08:00:04,635 - INFO - Epoch 14, Step 2250/2500 - Loss: 0.0026, Perplexity: 1.0027, LR: 5.44e-05, LM: 0.0021, Age: 0.50, Sex: 0.016
2025-10-24 08:00:17,793 - INFO - Epoch 14, Step 2300/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.43e-05, LM: 0.0020, Age: 0.50, Sex: 0.016
2025-10-24 08:00:30,366 - INFO - Epoch 14, Step 2350/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.43e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:00:43,061 - INFO - Epoch 14, Step 2400/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.42e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:00:55,672 - INFO - Epoch 14, Step 2450/2500 - Loss: 0.0025, Perplexity: 1.0025, LR: 5.41e-05, LM: 0.0019, Age: 0.50, Sex: 0.015
2025-10-24 08:01:08,352 - INFO - Epoch 14, Step 2500/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.41e-05, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:01:08,354 - INFO - Epoch 14 Complete - Avg Loss: 0.0025, Avg Perplexity: 1.0026, LM: 0.0020, Age: 0.50, Sex: 0.015
2025-10-24 08:01:57,961 - INFO - Validation - Loss: 0.0001, Perplexity: 1.0001, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:01:57,963 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:02:02,784 - INFO - TPL computed on 500 samples: 1.0013
2025-10-24 08:02:02,784 - INFO - Temporal Perplexity (TPL): 1.0013
2025-10-24 08:02:02,785 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:02:12,631 - INFO - Reconstruction Jaccard computed on 126 visits: 0.0000
2025-10-24 08:02:12,631 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 08:02:25,002 - INFO - Epoch 15, Step 50/2500 - Loss: 0.0012, Perplexity: 1.0012, LR: 5.40e-05, LM: 0.0007, Age: 0.48, Sex: 0.005
2025-10-24 08:02:37,812 - INFO - Epoch 15, Step 100/2500 - Loss: 0.0028, Perplexity: 1.0030, LR: 5.39e-05, LM: 0.0023, Age: 0.46, Sex: 0.012
2025-10-24 08:02:50,654 - INFO - Epoch 15, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.39e-05, LM: 0.0016, Age: 0.46, Sex: 0.009
2025-10-24 08:03:03,142 - INFO - Epoch 15, Step 200/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.38e-05, LM: 0.0013, Age: 0.46, Sex: 0.008
2025-10-24 08:03:16,122 - INFO - Epoch 15, Step 250/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.37e-05, LM: 0.0012, Age: 0.46, Sex: 0.009
2025-10-24 08:03:28,574 - INFO - Epoch 15, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.36e-05, LM: 0.0017, Age: 0.47, Sex: 0.009
2025-10-24 08:03:41,311 - INFO - Epoch 15, Step 350/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.36e-05, LM: 0.0015, Age: 0.47, Sex: 0.009
2025-10-24 08:03:53,692 - INFO - Epoch 15, Step 400/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.35e-05, LM: 0.0015, Age: 0.48, Sex: 0.010
2025-10-24 08:04:06,355 - INFO - Epoch 15, Step 450/2500 - Loss: 0.0019, Perplexity: 1.0020, LR: 5.34e-05, LM: 0.0015, Age: 0.48, Sex: 0.011
2025-10-24 08:04:18,889 - INFO - Epoch 15, Step 500/2500 - Loss: 0.0018, Perplexity: 1.0019, LR: 5.34e-05, LM: 0.0013, Age: 0.48, Sex: 0.010
2025-10-24 08:04:31,672 - INFO - Epoch 15, Step 550/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.33e-05, LM: 0.0012, Age: 0.47, Sex: 0.009
2025-10-24 08:04:44,258 - INFO - Epoch 15, Step 600/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 5.32e-05, LM: 0.0012, Age: 0.48, Sex: 0.009
2025-10-24 08:04:56,789 - INFO - Epoch 15, Step 650/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 5.32e-05, LM: 0.0012, Age: 0.47, Sex: 0.015
2025-10-24 08:05:09,753 - INFO - Epoch 15, Step 700/2500 - Loss: 0.0041, Perplexity: 1.0043, LR: 5.31e-05, LM: 0.0036, Age: 0.47, Sex: 0.021
2025-10-24 08:05:21,983 - INFO - Epoch 15, Step 750/2500 - Loss: 0.1663, Perplexity: 3.7070, LR: 5.30e-05, LM: 0.1657, Age: 0.49, Sex: 0.071
2025-10-24 08:05:34,584 - INFO - Epoch 15, Step 800/2500 - Loss: 0.1680, Perplexity: 3.5526, LR: 5.30e-05, LM: 0.1674, Age: 0.49, Sex: 0.094
2025-10-24 08:05:47,247 - INFO - Epoch 15, Step 850/2500 - Loss: 0.1673, Perplexity: 3.4146, LR: 5.29e-05, LM: 0.1667, Age: 0.50, Sex: 0.098
2025-10-24 08:06:00,059 - INFO - Epoch 15, Step 900/2500 - Loss: 0.1581, Perplexity: 3.2805, LR: 5.28e-05, LM: 0.1575, Age: 0.50, Sex: 0.093
2025-10-24 08:06:12,582 - INFO - Epoch 15, Step 950/2500 - Loss: 0.1501, Perplexity: 3.1609, LR: 5.28e-05, LM: 0.1495, Age: 0.50, Sex: 0.089
2025-10-24 08:06:25,074 - INFO - Epoch 15, Step 1000/2500 - Loss: 0.1427, Perplexity: 3.0529, LR: 5.27e-05, LM: 0.1421, Age: 0.50, Sex: 0.085
2025-10-24 08:06:37,465 - INFO - Epoch 15, Step 1050/2500 - Loss: 0.1359, Perplexity: 2.9552, LR: 5.26e-05, LM: 0.1354, Age: 0.50, Sex: 0.082
2025-10-24 08:06:49,866 - INFO - Epoch 15, Step 1100/2500 - Loss: 0.1298, Perplexity: 2.8664, LR: 5.26e-05, LM: 0.1292, Age: 0.50, Sex: 0.078
2025-10-24 08:07:02,349 - INFO - Epoch 15, Step 1150/2500 - Loss: 0.1242, Perplexity: 2.7853, LR: 5.25e-05, LM: 0.1237, Age: 0.50, Sex: 0.075
2025-10-24 08:07:15,098 - INFO - Epoch 15, Step 1200/2500 - Loss: 0.1191, Perplexity: 2.7109, LR: 5.24e-05, LM: 0.1185, Age: 0.50, Sex: 0.072
2025-10-24 08:07:27,699 - INFO - Epoch 15, Step 1250/2500 - Loss: 0.1143, Perplexity: 2.6425, LR: 5.24e-05, LM: 0.1138, Age: 0.50, Sex: 0.069
2025-10-24 08:07:40,360 - INFO - Epoch 15, Step 1300/2500 - Loss: 0.1100, Perplexity: 2.5794, LR: 5.23e-05, LM: 0.1094, Age: 0.50, Sex: 0.067
2025-10-24 08:07:52,894 - INFO - Epoch 15, Step 1350/2500 - Loss: 0.1060, Perplexity: 2.5209, LR: 5.22e-05, LM: 0.1054, Age: 0.50, Sex: 0.065
2025-10-24 08:08:05,185 - INFO - Epoch 15, Step 1400/2500 - Loss: 0.1022, Perplexity: 2.4667, LR: 5.22e-05, LM: 0.1017, Age: 0.50, Sex: 0.063
2025-10-24 08:08:17,820 - INFO - Epoch 15, Step 1450/2500 - Loss: 0.0987, Perplexity: 2.4161, LR: 5.21e-05, LM: 0.0982, Age: 0.50, Sex: 0.061
2025-10-24 08:08:30,145 - INFO - Epoch 15, Step 1500/2500 - Loss: 0.0955, Perplexity: 2.3690, LR: 5.20e-05, LM: 0.0950, Age: 0.50, Sex: 0.059
2025-10-24 08:08:43,107 - INFO - Epoch 15, Step 1550/2500 - Loss: 0.0926, Perplexity: 2.3250, LR: 5.20e-05, LM: 0.0920, Age: 0.50, Sex: 0.058
2025-10-24 08:08:56,217 - INFO - Epoch 15, Step 1600/2500 - Loss: 0.0897, Perplexity: 2.2836, LR: 5.19e-05, LM: 0.0892, Age: 0.50, Sex: 0.056
2025-10-24 08:09:09,273 - INFO - Epoch 15, Step 1650/2500 - Loss: 0.0870, Perplexity: 2.2447, LR: 5.18e-05, LM: 0.0865, Age: 0.50, Sex: 0.055
2025-10-24 08:09:22,074 - INFO - Epoch 15, Step 1700/2500 - Loss: 0.0845, Perplexity: 2.2082, LR: 5.18e-05, LM: 0.0839, Age: 0.50, Sex: 0.053
2025-10-24 08:09:34,733 - INFO - Epoch 15, Step 1750/2500 - Loss: 0.0821, Perplexity: 2.1737, LR: 5.17e-05, LM: 0.0816, Age: 0.50, Sex: 0.052
2025-10-24 08:09:47,163 - INFO - Epoch 15, Step 1800/2500 - Loss: 0.0799, Perplexity: 2.1411, LR: 5.16e-05, LM: 0.0794, Age: 0.50, Sex: 0.050
2025-10-24 08:09:59,802 - INFO - Epoch 15, Step 1850/2500 - Loss: 0.0778, Perplexity: 2.1103, LR: 5.16e-05, LM: 0.0772, Age: 0.50, Sex: 0.049
2025-10-24 08:10:12,540 - INFO - Epoch 15, Step 1900/2500 - Loss: 0.0757, Perplexity: 2.0811, LR: 5.15e-05, LM: 0.0752, Age: 0.50, Sex: 0.048
2025-10-24 08:10:25,392 - INFO - Epoch 15, Step 1950/2500 - Loss: 0.0738, Perplexity: 2.0534, LR: 5.14e-05, LM: 0.0733, Age: 0.50, Sex: 0.047
2025-10-24 08:10:38,018 - INFO - Epoch 15, Step 2000/2500 - Loss: 0.0720, Perplexity: 2.0271, LR: 5.14e-05, LM: 0.0714, Age: 0.50, Sex: 0.045
2025-10-24 08:10:50,745 - INFO - Epoch 15, Step 2050/2500 - Loss: 0.0703, Perplexity: 2.0021, LR: 5.13e-05, LM: 0.0697, Age: 0.50, Sex: 0.044
2025-10-24 08:11:03,759 - INFO - Epoch 15, Step 2100/2500 - Loss: 0.0686, Perplexity: 1.9783, LR: 5.12e-05, LM: 0.0681, Age: 0.50, Sex: 0.043
2025-10-24 08:11:16,687 - INFO - Epoch 15, Step 2150/2500 - Loss: 0.0670, Perplexity: 1.9555, LR: 5.11e-05, LM: 0.0665, Age: 0.50, Sex: 0.042
2025-10-24 08:11:29,109 - INFO - Epoch 15, Step 2200/2500 - Loss: 0.0656, Perplexity: 1.9338, LR: 5.11e-05, LM: 0.0650, Age: 0.50, Sex: 0.042
2025-10-24 08:11:41,876 - INFO - Epoch 15, Step 2250/2500 - Loss: 0.0641, Perplexity: 1.9131, LR: 5.10e-05, LM: 0.0636, Age: 0.50, Sex: 0.041
2025-10-24 08:11:54,335 - INFO - Epoch 15, Step 2300/2500 - Loss: 0.0627, Perplexity: 1.8933, LR: 5.09e-05, LM: 0.0622, Age: 0.50, Sex: 0.040
2025-10-24 08:12:07,307 - INFO - Epoch 15, Step 2350/2500 - Loss: 0.0614, Perplexity: 1.8743, LR: 5.09e-05, LM: 0.0609, Age: 0.50, Sex: 0.039
2025-10-24 08:12:19,882 - INFO - Epoch 15, Step 2400/2500 - Loss: 0.0602, Perplexity: 1.8561, LR: 5.08e-05, LM: 0.0596, Age: 0.49, Sex: 0.038
2025-10-24 08:12:32,778 - INFO - Epoch 15, Step 2450/2500 - Loss: 0.0589, Perplexity: 1.8386, LR: 5.07e-05, LM: 0.0584, Age: 0.49, Sex: 0.037
2025-10-24 08:12:45,692 - INFO - Epoch 15, Step 2500/2500 - Loss: 0.0578, Perplexity: 1.8219, LR: 5.07e-05, LM: 0.0573, Age: 0.50, Sex: 0.037
2025-10-24 08:12:45,694 - INFO - Epoch 15 Complete - Avg Loss: 0.0578, Avg Perplexity: 1.8219, LM: 0.0573, Age: 0.50, Sex: 0.037
2025-10-24 08:13:35,177 - INFO - Validation - Loss: 0.0022, Perplexity: 1.0023, Token Accuracy: 0.9998, Code Accuracy: 0.9998
2025-10-24 08:13:35,179 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:13:40,002 - INFO - TPL computed on 500 samples: 1.0041
2025-10-24 08:13:40,003 - INFO - Temporal Perplexity (TPL): 1.0041
2025-10-24 08:13:40,004 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:13:43,902 - INFO - Reconstruction Jaccard computed on 129 visits: 0.0450
2025-10-24 08:13:43,903 - INFO - Reconstruction Jaccard: 0.0450
2025-10-24 08:13:46,245 - INFO - Checkpoint saved: epoch 15
2025-10-24 08:13:58,868 - INFO - Epoch 16, Step 50/2500 - Loss: 0.0042, Perplexity: 1.0044, LR: 5.06e-05, LM: 0.0038, Age: 0.44, Sex: 0.005
2025-10-24 08:14:11,518 - INFO - Epoch 16, Step 100/2500 - Loss: 0.0025, Perplexity: 1.0026, LR: 5.05e-05, LM: 0.0020, Age: 0.47, Sex: 0.003
2025-10-24 08:14:24,410 - INFO - Epoch 16, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 5.05e-05, LM: 0.0016, Age: 0.50, Sex: 0.002
2025-10-24 08:14:37,026 - INFO - Epoch 16, Step 200/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 5.04e-05, LM: 0.0015, Age: 0.49, Sex: 0.001
2025-10-24 08:14:49,590 - INFO - Epoch 16, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 5.03e-05, LM: 0.0015, Age: 0.49, Sex: 0.003
2025-10-24 08:15:02,211 - INFO - Epoch 16, Step 300/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 5.03e-05, LM: 0.0017, Age: 0.48, Sex: 0.004
2025-10-24 08:15:14,642 - INFO - Epoch 16, Step 350/2500 - Loss: 0.0021, Perplexity: 1.0021, LR: 5.02e-05, LM: 0.0016, Age: 0.48, Sex: 0.003
2025-10-24 08:15:27,456 - INFO - Epoch 16, Step 400/2500 - Loss: 0.0019, Perplexity: 1.0020, LR: 5.01e-05, LM: 0.0015, Age: 0.48, Sex: 0.003
2025-10-24 08:15:39,932 - INFO - Epoch 16, Step 450/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 5.01e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:15:52,518 - INFO - Epoch 16, Step 500/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 5.00e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:16:05,287 - INFO - Epoch 16, Step 550/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.99e-05, LM: 0.0013, Age: 0.47, Sex: 0.003
2025-10-24 08:16:18,035 - INFO - Epoch 16, Step 600/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.99e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:16:30,963 - INFO - Epoch 16, Step 650/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.98e-05, LM: 0.0012, Age: 0.49, Sex: 0.003
2025-10-24 08:16:43,748 - INFO - Epoch 16, Step 700/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.97e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:16:56,496 - INFO - Epoch 16, Step 750/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.97e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:17:09,059 - INFO - Epoch 16, Step 800/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.96e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:17:21,534 - INFO - Epoch 16, Step 850/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.95e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:17:34,228 - INFO - Epoch 16, Step 900/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.95e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:17:46,907 - INFO - Epoch 16, Step 950/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.94e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:17:59,596 - INFO - Epoch 16, Step 1000/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.93e-05, LM: 0.0009, Age: 0.47, Sex: 0.002
2025-10-24 08:18:12,419 - INFO - Epoch 16, Step 1050/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.93e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:18:24,852 - INFO - Epoch 16, Step 1100/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.92e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:18:37,669 - INFO - Epoch 16, Step 1150/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.91e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:18:50,677 - INFO - Epoch 16, Step 1200/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.91e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:19:03,459 - INFO - Epoch 16, Step 1250/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.90e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:19:15,867 - INFO - Epoch 16, Step 1300/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.89e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:28,379 - INFO - Epoch 16, Step 1350/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.89e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:40,587 - INFO - Epoch 16, Step 1400/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.88e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:19:53,277 - INFO - Epoch 16, Step 1450/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.87e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:05,912 - INFO - Epoch 16, Step 1500/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.86e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:20:19,155 - INFO - Epoch 16, Step 1550/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.86e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:31,736 - INFO - Epoch 16, Step 1600/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.85e-05, LM: 0.0009, Age: 0.48, Sex: 0.003
2025-10-24 08:20:44,199 - INFO - Epoch 16, Step 1650/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.84e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:20:56,978 - INFO - Epoch 16, Step 1700/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.84e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:09,586 - INFO - Epoch 16, Step 1750/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.83e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:22,215 - INFO - Epoch 16, Step 1800/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.82e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:21:34,684 - INFO - Epoch 16, Step 1850/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.82e-05, LM: 0.0009, Age: 0.47, Sex: 0.003
2025-10-24 08:21:47,792 - INFO - Epoch 16, Step 1900/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.81e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:22:00,233 - INFO - Epoch 16, Step 1950/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.80e-05, LM: 0.0010, Age: 0.48, Sex: 0.004
2025-10-24 08:22:12,867 - INFO - Epoch 16, Step 2000/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.80e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:25,563 - INFO - Epoch 16, Step 2050/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.79e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:38,339 - INFO - Epoch 16, Step 2100/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.78e-05, LM: 0.0009, Age: 0.48, Sex: 0.004
2025-10-24 08:22:50,875 - INFO - Epoch 16, Step 2150/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.78e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:23:03,546 - INFO - Epoch 16, Step 2200/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.77e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:23:16,321 - INFO - Epoch 16, Step 2250/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.76e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:29,079 - INFO - Epoch 16, Step 2300/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.76e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:41,772 - INFO - Epoch 16, Step 2350/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.75e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:23:54,379 - INFO - Epoch 16, Step 2400/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.74e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:24:06,672 - INFO - Epoch 16, Step 2450/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.74e-05, LM: 0.0008, Age: 0.47, Sex: 0.004
2025-10-24 08:24:19,505 - INFO - Epoch 16, Step 2500/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.73e-05, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:24:19,507 - INFO - Epoch 16 Complete - Avg Loss: 0.0014, Avg Perplexity: 1.0014, LM: 0.0009, Age: 0.47, Sex: 0.004
2025-10-24 08:25:08,960 - INFO - Validation - Loss: 0.0007, Perplexity: 1.0007, Token Accuracy: 0.9999, Code Accuracy: 0.9999
2025-10-24 08:25:08,962 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:25:13,806 - INFO - TPL computed on 500 samples: 1.0020
2025-10-24 08:25:13,806 - INFO - Temporal Perplexity (TPL): 1.0020
2025-10-24 08:25:13,807 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:25:22,015 - INFO - Reconstruction Jaccard computed on 114 visits: 0.0000
2025-10-24 08:25:22,016 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 08:25:34,727 - INFO - Epoch 17, Step 50/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 4.72e-05, LM: 0.0002, Age: 0.46, Sex: 0.001
2025-10-24 08:25:47,352 - INFO - Epoch 17, Step 100/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 4.72e-05, LM: 0.0018, Age: 0.46, Sex: 0.001
2025-10-24 08:26:00,618 - INFO - Epoch 17, Step 150/2500 - Loss: 0.0021, Perplexity: 1.0022, LR: 4.71e-05, LM: 0.0016, Age: 0.47, Sex: 0.001
2025-10-24 08:26:13,167 - INFO - Epoch 17, Step 200/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.70e-05, LM: 0.0019, Age: 0.49, Sex: 0.002
2025-10-24 08:26:25,957 - INFO - Epoch 17, Step 250/2500 - Loss: 0.0029, Perplexity: 1.0029, LR: 4.70e-05, LM: 0.0024, Age: 0.50, Sex: 0.002
2025-10-24 08:26:38,392 - INFO - Epoch 17, Step 300/2500 - Loss: 0.0027, Perplexity: 1.0028, LR: 4.69e-05, LM: 0.0022, Age: 0.50, Sex: 0.004
2025-10-24 08:26:50,987 - INFO - Epoch 17, Step 350/2500 - Loss: 0.0025, Perplexity: 1.0025, LR: 4.68e-05, LM: 0.0020, Age: 0.51, Sex: 0.004
2025-10-24 08:27:03,709 - INFO - Epoch 17, Step 400/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.68e-05, LM: 0.0019, Age: 0.51, Sex: 0.005
2025-10-24 08:27:16,103 - INFO - Epoch 17, Step 450/2500 - Loss: 0.0024, Perplexity: 1.0025, LR: 4.67e-05, LM: 0.0019, Age: 0.50, Sex: 0.004
2025-10-24 08:27:28,618 - INFO - Epoch 17, Step 500/2500 - Loss: 0.0022, Perplexity: 1.0023, LR: 4.66e-05, LM: 0.0017, Age: 0.50, Sex: 0.004
2025-10-24 08:27:41,460 - INFO - Epoch 17, Step 550/2500 - Loss: 0.0022, Perplexity: 1.0022, LR: 4.66e-05, LM: 0.0017, Age: 0.49, Sex: 0.004
2025-10-24 08:27:54,319 - INFO - Epoch 17, Step 600/2500 - Loss: 0.0022, Perplexity: 1.0022, LR: 4.65e-05, LM: 0.0017, Age: 0.49, Sex: 0.004
2025-10-24 08:28:07,025 - INFO - Epoch 17, Step 650/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.64e-05, LM: 0.0015, Age: 0.49, Sex: 0.004
2025-10-24 08:28:19,691 - INFO - Epoch 17, Step 700/2500 - Loss: 0.0020, Perplexity: 1.0020, LR: 4.64e-05, LM: 0.0015, Age: 0.49, Sex: 0.004
2025-10-24 08:28:32,246 - INFO - Epoch 17, Step 750/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.63e-05, LM: 0.0014, Age: 0.49, Sex: 0.003
2025-10-24 08:28:45,079 - INFO - Epoch 17, Step 800/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.62e-05, LM: 0.0013, Age: 0.49, Sex: 0.003
2025-10-24 08:28:57,895 - INFO - Epoch 17, Step 850/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.61e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:29:10,402 - INFO - Epoch 17, Step 900/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.61e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:22,880 - INFO - Epoch 17, Step 950/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.60e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:35,064 - INFO - Epoch 17, Step 1000/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.59e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:29:47,781 - INFO - Epoch 17, Step 1050/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.59e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:30:00,742 - INFO - Epoch 17, Step 1100/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.58e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:30:13,407 - INFO - Epoch 17, Step 1150/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.57e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:30:26,325 - INFO - Epoch 17, Step 1200/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.57e-05, LM: 0.0011, Age: 0.48, Sex: 0.002
2025-10-24 08:30:38,874 - INFO - Epoch 17, Step 1250/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.56e-05, LM: 0.0011, Age: 0.48, Sex: 0.002
2025-10-24 08:30:51,564 - INFO - Epoch 17, Step 1300/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.55e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:31:04,017 - INFO - Epoch 17, Step 1350/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.55e-05, LM: 0.0010, Age: 0.48, Sex: 0.003
2025-10-24 08:31:16,900 - INFO - Epoch 17, Step 1400/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.54e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:31:29,414 - INFO - Epoch 17, Step 1450/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.53e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:31:42,326 - INFO - Epoch 17, Step 1500/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.53e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:31:55,247 - INFO - Epoch 17, Step 1550/2500 - Loss: 0.0018, Perplexity: 1.0018, LR: 4.52e-05, LM: 0.0013, Age: 0.48, Sex: 0.003
2025-10-24 08:32:07,567 - INFO - Epoch 17, Step 1600/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.51e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:19,854 - INFO - Epoch 17, Step 1650/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.51e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:32,860 - INFO - Epoch 17, Step 1700/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.50e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:32:45,873 - INFO - Epoch 17, Step 1750/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.49e-05, LM: 0.0012, Age: 0.47, Sex: 0.003
2025-10-24 08:32:58,292 - INFO - Epoch 17, Step 1800/2500 - Loss: 0.0017, Perplexity: 1.0017, LR: 4.49e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:33:11,002 - INFO - Epoch 17, Step 1850/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.48e-05, LM: 0.0012, Age: 0.48, Sex: 0.003
2025-10-24 08:33:23,320 - INFO - Epoch 17, Step 1900/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.47e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:33:35,943 - INFO - Epoch 17, Step 1950/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.47e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:33:48,809 - INFO - Epoch 17, Step 2000/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.46e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:01,512 - INFO - Epoch 17, Step 2050/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.45e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:14,071 - INFO - Epoch 17, Step 2100/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.45e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:34:27,008 - INFO - Epoch 17, Step 2150/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.44e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:34:39,562 - INFO - Epoch 17, Step 2200/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.43e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:34:52,331 - INFO - Epoch 17, Step 2250/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.43e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:35:05,206 - INFO - Epoch 17, Step 2300/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.42e-05, LM: 0.0011, Age: 0.47, Sex: 0.003
2025-10-24 08:35:17,969 - INFO - Epoch 17, Step 2350/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.41e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:30,521 - INFO - Epoch 17, Step 2400/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.41e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:43,057 - INFO - Epoch 17, Step 2450/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.40e-05, LM: 0.0011, Age: 0.48, Sex: 0.003
2025-10-24 08:35:55,703 - INFO - Epoch 17, Step 2500/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.39e-05, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:35:55,705 - INFO - Epoch 17 Complete - Avg Loss: 0.0015, Avg Perplexity: 1.0015, LM: 0.0010, Age: 0.47, Sex: 0.003
2025-10-24 08:36:45,051 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:36:45,054 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:36:49,907 - INFO - TPL computed on 500 samples: 1.0011
2025-10-24 08:36:49,907 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-24 08:36:49,908 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:37:00,055 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0108
2025-10-24 08:37:00,056 - INFO - Reconstruction Jaccard: 0.0108
2025-10-24 08:37:00,056 - INFO - New best model! Validation loss: 0.0000
2025-10-24 08:37:04,731 - INFO - Checkpoint saved: epoch 17
2025-10-24 08:37:17,448 - INFO - Epoch 18, Step 50/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 4.39e-05, LM: 0.0000, Age: 0.43, Sex: 0.001
2025-10-24 08:37:30,295 - INFO - Epoch 18, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 4.38e-05, LM: 0.0003, Age: 0.48, Sex: 0.001
2025-10-24 08:37:43,024 - INFO - Epoch 18, Step 150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 4.37e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 08:37:55,789 - INFO - Epoch 18, Step 200/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.36e-05, LM: 0.0016, Age: 0.44, Sex: 0.001
2025-10-24 08:38:08,595 - INFO - Epoch 18, Step 250/2500 - Loss: 0.0020, Perplexity: 1.0021, LR: 4.36e-05, LM: 0.0015, Age: 0.45, Sex: 0.002
2025-10-24 08:38:21,697 - INFO - Epoch 18, Step 300/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.35e-05, LM: 0.0014, Age: 0.44, Sex: 0.002
2025-10-24 08:38:34,324 - INFO - Epoch 18, Step 350/2500 - Loss: 0.0019, Perplexity: 1.0019, LR: 4.34e-05, LM: 0.0014, Age: 0.45, Sex: 0.002
2025-10-24 08:38:46,970 - INFO - Epoch 18, Step 400/2500 - Loss: 0.0017, Perplexity: 1.0018, LR: 4.34e-05, LM: 0.0013, Age: 0.45, Sex: 0.002
2025-10-24 08:39:00,290 - INFO - Epoch 18, Step 450/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.33e-05, LM: 0.0012, Age: 0.44, Sex: 0.002
2025-10-24 08:39:13,329 - INFO - Epoch 18, Step 500/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.32e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:25,573 - INFO - Epoch 18, Step 550/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.32e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:38,122 - INFO - Epoch 18, Step 600/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.31e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:39:50,677 - INFO - Epoch 18, Step 650/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.30e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:40:03,764 - INFO - Epoch 18, Step 700/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.30e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:40:16,425 - INFO - Epoch 18, Step 750/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.29e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:40:29,142 - INFO - Epoch 18, Step 800/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.28e-05, LM: 0.0010, Age: 0.45, Sex: 0.001
2025-10-24 08:40:41,645 - INFO - Epoch 18, Step 850/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.28e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 08:40:54,458 - INFO - Epoch 18, Step 900/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.27e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 08:41:07,291 - INFO - Epoch 18, Step 950/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.26e-05, LM: 0.0009, Age: 0.45, Sex: 0.002
2025-10-24 08:41:19,943 - INFO - Epoch 18, Step 1000/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.26e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:32,407 - INFO - Epoch 18, Step 1050/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.25e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:44,766 - INFO - Epoch 18, Step 1100/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.24e-05, LM: 0.0010, Age: 0.45, Sex: 0.002
2025-10-24 08:41:57,418 - INFO - Epoch 18, Step 1150/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.24e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:42:09,941 - INFO - Epoch 18, Step 1200/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.23e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:42:22,243 - INFO - Epoch 18, Step 1250/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.22e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:42:35,397 - INFO - Epoch 18, Step 1300/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.22e-05, LM: 0.0011, Age: 0.45, Sex: 0.002
2025-10-24 08:42:48,033 - INFO - Epoch 18, Step 1350/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.21e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:01,000 - INFO - Epoch 18, Step 1400/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.20e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:13,705 - INFO - Epoch 18, Step 1450/2500 - Loss: 0.0016, Perplexity: 1.0017, LR: 4.20e-05, LM: 0.0012, Age: 0.45, Sex: 0.003
2025-10-24 08:43:26,518 - INFO - Epoch 18, Step 1500/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.19e-05, LM: 0.0012, Age: 0.45, Sex: 0.003
2025-10-24 08:43:39,417 - INFO - Epoch 18, Step 1550/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.18e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:43:52,156 - INFO - Epoch 18, Step 1600/2500 - Loss: 0.0016, Perplexity: 1.0016, LR: 4.18e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:04,717 - INFO - Epoch 18, Step 1650/2500 - Loss: 0.0015, Perplexity: 1.0016, LR: 4.17e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:17,332 - INFO - Epoch 18, Step 1700/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.16e-05, LM: 0.0011, Age: 0.45, Sex: 0.003
2025-10-24 08:44:29,975 - INFO - Epoch 18, Step 1750/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.16e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:44:42,821 - INFO - Epoch 18, Step 1800/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.15e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:44:55,712 - INFO - Epoch 18, Step 1850/2500 - Loss: 0.0015, Perplexity: 1.0015, LR: 4.14e-05, LM: 0.0010, Age: 0.45, Sex: 0.003
2025-10-24 08:45:08,585 - INFO - Epoch 18, Step 1900/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.14e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:45:21,281 - INFO - Epoch 18, Step 1950/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.13e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:45:33,973 - INFO - Epoch 18, Step 2000/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.12e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:45:46,569 - INFO - Epoch 18, Step 2050/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.11e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:45:59,009 - INFO - Epoch 18, Step 2100/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.11e-05, LM: 0.0010, Age: 0.46, Sex: 0.003
2025-10-24 08:46:11,667 - INFO - Epoch 18, Step 2150/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.10e-05, LM: 0.0009, Age: 0.46, Sex: 0.003
2025-10-24 08:46:24,192 - INFO - Epoch 18, Step 2200/2500 - Loss: 0.0014, Perplexity: 1.0015, LR: 4.09e-05, LM: 0.0010, Age: 0.46, Sex: 0.002
2025-10-24 08:46:36,792 - INFO - Epoch 18, Step 2250/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.09e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:46:49,350 - INFO - Epoch 18, Step 2300/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.08e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:02,107 - INFO - Epoch 18, Step 2350/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.07e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:14,846 - INFO - Epoch 18, Step 2400/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 4.07e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:27,439 - INFO - Epoch 18, Step 2450/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.06e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:39,950 - INFO - Epoch 18, Step 2500/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 4.05e-05, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:47:39,952 - INFO - Epoch 18 Complete - Avg Loss: 0.0013, Avg Perplexity: 1.0014, LM: 0.0009, Age: 0.46, Sex: 0.002
2025-10-24 08:48:29,539 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 08:48:29,542 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 08:48:34,413 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 08:48:34,413 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 08:48:34,414 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 08:48:44,597 - INFO - Reconstruction Jaccard computed on 131 visits: 0.0119
2025-10-24 08:48:44,597 - INFO - Reconstruction Jaccard: 0.0119
2025-10-24 08:48:44,597 - INFO - New best model! Validation loss: 0.0000
2025-10-24 08:48:49,189 - INFO - Checkpoint saved: epoch 18
2025-10-24 08:49:01,899 - INFO - Epoch 19, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 4.05e-05, LM: 0.0000, Age: 0.42, Sex: 0.000
2025-10-24 08:49:14,533 - INFO - Epoch 19, Step 100/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.04e-05, LM: 0.0006, Age: 0.45, Sex: 0.002
2025-10-24 08:49:27,102 - INFO - Epoch 19, Step 150/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.03e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:49:39,881 - INFO - Epoch 19, Step 200/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 4.03e-05, LM: 0.0009, Age: 0.43, Sex: 0.003
2025-10-24 08:49:52,533 - INFO - Epoch 19, Step 250/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 4.02e-05, LM: 0.0007, Age: 0.42, Sex: 0.002
2025-10-24 08:50:05,396 - INFO - Epoch 19, Step 300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 4.01e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:50:18,035 - INFO - Epoch 19, Step 350/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 4.01e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:50:30,965 - INFO - Epoch 19, Step 400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 4.00e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:50:43,495 - INFO - Epoch 19, Step 450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.99e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:50:56,127 - INFO - Epoch 19, Step 500/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.99e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:51:08,847 - INFO - Epoch 19, Step 550/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.98e-05, LM: 0.0005, Age: 0.42, Sex: 0.001
2025-10-24 08:51:21,848 - INFO - Epoch 19, Step 600/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.97e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:51:34,707 - INFO - Epoch 19, Step 650/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.97e-05, LM: 0.0004, Age: 0.42, Sex: 0.001
2025-10-24 08:51:47,573 - INFO - Epoch 19, Step 700/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.96e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:52:00,535 - INFO - Epoch 19, Step 750/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.95e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:13,202 - INFO - Epoch 19, Step 800/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.95e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:25,842 - INFO - Epoch 19, Step 850/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.94e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:52:38,510 - INFO - Epoch 19, Step 900/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.93e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:52:51,125 - INFO - Epoch 19, Step 950/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.93e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:53:04,051 - INFO - Epoch 19, Step 1000/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.92e-05, LM: 0.0007, Age: 0.43, Sex: 0.002
2025-10-24 08:53:16,590 - INFO - Epoch 19, Step 1050/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.91e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:53:28,961 - INFO - Epoch 19, Step 1100/2500 - Loss: 0.0010, Perplexity: 1.0011, LR: 3.91e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:53:41,465 - INFO - Epoch 19, Step 1150/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.90e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:53:54,064 - INFO - Epoch 19, Step 1200/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.89e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:07,048 - INFO - Epoch 19, Step 1250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.89e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:19,803 - INFO - Epoch 19, Step 1300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.88e-05, LM: 0.0006, Age: 0.42, Sex: 0.002
2025-10-24 08:54:31,876 - INFO - Epoch 19, Step 1350/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.87e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:54:44,791 - INFO - Epoch 19, Step 1400/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.86e-05, LM: 0.0006, Age: 0.43, Sex: 0.002
2025-10-24 08:54:57,910 - INFO - Epoch 19, Step 1450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.86e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:10,699 - INFO - Epoch 19, Step 1500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.85e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:23,113 - INFO - Epoch 19, Step 1550/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.84e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:35,796 - INFO - Epoch 19, Step 1600/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.84e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:55:48,731 - INFO - Epoch 19, Step 1650/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.83e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:01,734 - INFO - Epoch 19, Step 1700/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.82e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:14,985 - INFO - Epoch 19, Step 1750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.82e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:27,769 - INFO - Epoch 19, Step 1800/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.81e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:40,531 - INFO - Epoch 19, Step 1850/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.80e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:56:53,387 - INFO - Epoch 19, Step 1900/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.80e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:06,144 - INFO - Epoch 19, Step 1950/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.79e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:18,751 - INFO - Epoch 19, Step 2000/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.78e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:31,713 - INFO - Epoch 19, Step 2050/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.78e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:44,296 - INFO - Epoch 19, Step 2100/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.77e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:57:57,010 - INFO - Epoch 19, Step 2150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.76e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:09,221 - INFO - Epoch 19, Step 2200/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.76e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 08:58:21,898 - INFO - Epoch 19, Step 2250/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.75e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:34,163 - INFO - Epoch 19, Step 2300/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.74e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:46,501 - INFO - Epoch 19, Step 2350/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.74e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 08:58:59,390 - INFO - Epoch 19, Step 2400/2500 - Loss: 0.0010, Perplexity: 1.0011, LR: 3.73e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:11,602 - INFO - Epoch 19, Step 2450/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.72e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:24,379 - INFO - Epoch 19, Step 2500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.72e-05, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 08:59:24,380 - INFO - Epoch 19 Complete - Avg Loss: 0.0010, Avg Perplexity: 1.0010, LM: 0.0006, Age: 0.44, Sex: 0.002
2025-10-24 09:00:14,623 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:00:14,626 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:00:19,479 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 09:00:19,479 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 09:00:19,480 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:00:29,327 - INFO - Reconstruction Jaccard computed on 125 visits: 0.0117
2025-10-24 09:00:29,327 - INFO - Reconstruction Jaccard: 0.0117
2025-10-24 09:00:29,327 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:00:33,663 - INFO - Checkpoint saved: epoch 19
2025-10-24 09:00:46,518 - INFO - Epoch 20, Step 50/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.71e-05, LM: 0.0005, Age: 0.42, Sex: 0.000
2025-10-24 09:00:59,291 - INFO - Epoch 20, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.70e-05, LM: 0.0004, Age: 0.45, Sex: 0.001
2025-10-24 09:01:11,880 - INFO - Epoch 20, Step 150/2500 - Loss: 0.0013, Perplexity: 1.0014, LR: 3.70e-05, LM: 0.0009, Age: 0.45, Sex: 0.001
2025-10-24 09:01:24,028 - INFO - Epoch 20, Step 200/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.69e-05, LM: 0.0007, Age: 0.45, Sex: 0.001
2025-10-24 09:01:36,597 - INFO - Epoch 20, Step 250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.68e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:01:49,228 - INFO - Epoch 20, Step 300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.68e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:02:01,822 - INFO - Epoch 20, Step 350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.67e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:14,409 - INFO - Epoch 20, Step 400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.66e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:27,052 - INFO - Epoch 20, Step 450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.66e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:02:39,820 - INFO - Epoch 20, Step 500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.65e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:02:52,629 - INFO - Epoch 20, Step 550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.64e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:03:05,014 - INFO - Epoch 20, Step 600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.64e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:03:17,492 - INFO - Epoch 20, Step 650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.63e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:30,140 - INFO - Epoch 20, Step 700/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.62e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:42,900 - INFO - Epoch 20, Step 750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.61e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:03:55,614 - INFO - Epoch 20, Step 800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.61e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:04:08,402 - INFO - Epoch 20, Step 850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.60e-05, LM: 0.0003, Age: 0.43, Sex: 0.001
2025-10-24 09:04:20,819 - INFO - Epoch 20, Step 900/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.59e-05, LM: 0.0005, Age: 0.43, Sex: 0.001
2025-10-24 09:04:33,641 - INFO - Epoch 20, Step 950/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.59e-05, LM: 0.0005, Age: 0.43, Sex: 0.001
2025-10-24 09:04:46,385 - INFO - Epoch 20, Step 1000/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.58e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:04:59,458 - INFO - Epoch 20, Step 1050/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.57e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:11,754 - INFO - Epoch 20, Step 1100/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.57e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:24,541 - INFO - Epoch 20, Step 1150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.56e-05, LM: 0.0004, Age: 0.44, Sex: 0.001
2025-10-24 09:05:37,115 - INFO - Epoch 20, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.55e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:05:49,685 - INFO - Epoch 20, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.55e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:06:02,122 - INFO - Epoch 20, Step 1300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.54e-05, LM: 0.0004, Age: 0.43, Sex: 0.001
2025-10-24 09:06:15,195 - INFO - Epoch 20, Step 1350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.53e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:27,355 - INFO - Epoch 20, Step 1400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.53e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:39,908 - INFO - Epoch 20, Step 1450/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.52e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:06:52,205 - INFO - Epoch 20, Step 1500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.51e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:04,510 - INFO - Epoch 20, Step 1550/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.51e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:17,521 - INFO - Epoch 20, Step 1600/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.50e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:30,266 - INFO - Epoch 20, Step 1650/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.49e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:42,714 - INFO - Epoch 20, Step 1700/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 3.49e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:07:55,532 - INFO - Epoch 20, Step 1750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.48e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:08,649 - INFO - Epoch 20, Step 1800/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.47e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:21,133 - INFO - Epoch 20, Step 1850/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.47e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:08:33,711 - INFO - Epoch 20, Step 1900/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.46e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:08:46,592 - INFO - Epoch 20, Step 1950/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.45e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:08:59,458 - INFO - Epoch 20, Step 2000/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.45e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:09:11,822 - INFO - Epoch 20, Step 2050/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.44e-05, LM: 0.0005, Age: 0.44, Sex: 0.001
2025-10-24 09:09:24,586 - INFO - Epoch 20, Step 2100/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.43e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:09:37,347 - INFO - Epoch 20, Step 2150/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.43e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:09:50,216 - INFO - Epoch 20, Step 2200/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.42e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:02,840 - INFO - Epoch 20, Step 2250/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.41e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:15,888 - INFO - Epoch 20, Step 2300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.41e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:28,255 - INFO - Epoch 20, Step 2350/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.40e-05, LM: 0.0005, Age: 0.44, Sex: 0.002
2025-10-24 09:10:41,275 - INFO - Epoch 20, Step 2400/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.39e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:10:53,937 - INFO - Epoch 20, Step 2450/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.39e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:06,635 - INFO - Epoch 20, Step 2500/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.38e-05, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:06,636 - INFO - Epoch 20 Complete - Avg Loss: 0.0009, Avg Perplexity: 1.0009, LM: 0.0005, Age: 0.43, Sex: 0.002
2025-10-24 09:11:56,396 - INFO - Validation - Loss: 0.0002, Perplexity: 1.0002, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:11:56,398 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:12:01,248 - INFO - TPL computed on 500 samples: 1.0017
2025-10-24 09:12:01,248 - INFO - Temporal Perplexity (TPL): 1.0017
2025-10-24 09:12:01,249 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:12:13,761 - INFO - Reconstruction Jaccard computed on 138 visits: 0.0020
2025-10-24 09:12:13,761 - INFO - Reconstruction Jaccard: 0.0020
2025-10-24 09:12:16,166 - INFO - Checkpoint saved: epoch 20
2025-10-24 09:12:28,878 - INFO - Epoch 21, Step 50/2500 - Loss: 0.0014, Perplexity: 1.0014, LR: 3.37e-05, LM: 0.0010, Age: 0.38, Sex: 0.002
2025-10-24 09:12:41,506 - INFO - Epoch 21, Step 100/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 3.36e-05, LM: 0.0009, Age: 0.40, Sex: 0.003
2025-10-24 09:12:54,002 - INFO - Epoch 21, Step 150/2500 - Loss: 0.0013, Perplexity: 1.0013, LR: 3.36e-05, LM: 0.0009, Age: 0.41, Sex: 0.003
2025-10-24 09:13:06,867 - INFO - Epoch 21, Step 200/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 3.35e-05, LM: 0.0007, Age: 0.41, Sex: 0.003
2025-10-24 09:13:19,559 - INFO - Epoch 21, Step 250/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.34e-05, LM: 0.0006, Age: 0.41, Sex: 0.002
2025-10-24 09:13:31,911 - INFO - Epoch 21, Step 300/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 3.34e-05, LM: 0.0005, Age: 0.40, Sex: 0.002
2025-10-24 09:13:44,740 - INFO - Epoch 21, Step 350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.33e-05, LM: 0.0004, Age: 0.40, Sex: 0.002
2025-10-24 09:13:57,369 - INFO - Epoch 21, Step 400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.32e-05, LM: 0.0004, Age: 0.39, Sex: 0.002
2025-10-24 09:14:10,230 - INFO - Epoch 21, Step 450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.32e-05, LM: 0.0004, Age: 0.39, Sex: 0.002
2025-10-24 09:14:23,037 - INFO - Epoch 21, Step 500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.31e-05, LM: 0.0003, Age: 0.40, Sex: 0.002
2025-10-24 09:14:35,296 - INFO - Epoch 21, Step 550/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.30e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:14:47,938 - INFO - Epoch 21, Step 600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.30e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:00,810 - INFO - Epoch 21, Step 650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.29e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:13,636 - INFO - Epoch 21, Step 700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.28e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:15:26,434 - INFO - Epoch 21, Step 750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.28e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:15:39,234 - INFO - Epoch 21, Step 800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.27e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:15:52,002 - INFO - Epoch 21, Step 850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.26e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:16:04,920 - INFO - Epoch 21, Step 900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.26e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:16:17,406 - INFO - Epoch 21, Step 950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.25e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:16:29,901 - INFO - Epoch 21, Step 1000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.24e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:16:42,231 - INFO - Epoch 21, Step 1050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.24e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:16:55,046 - INFO - Epoch 21, Step 1100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.23e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:17:08,164 - INFO - Epoch 21, Step 1150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.22e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:17:20,856 - INFO - Epoch 21, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.22e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:17:33,498 - INFO - Epoch 21, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.21e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:17:46,181 - INFO - Epoch 21, Step 1300/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.20e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:17:59,179 - INFO - Epoch 21, Step 1350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.20e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:18:11,453 - INFO - Epoch 21, Step 1400/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 3.19e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:18:24,109 - INFO - Epoch 21, Step 1450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.18e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:18:36,899 - INFO - Epoch 21, Step 1500/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.18e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:18:49,542 - INFO - Epoch 21, Step 1550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.17e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:02,148 - INFO - Epoch 21, Step 1600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.16e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:15,138 - INFO - Epoch 21, Step 1650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.16e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:19:28,138 - INFO - Epoch 21, Step 1700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.15e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:19:40,861 - INFO - Epoch 21, Step 1750/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.14e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:19:53,588 - INFO - Epoch 21, Step 1800/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.14e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:06,661 - INFO - Epoch 21, Step 1850/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.13e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:19,442 - INFO - Epoch 21, Step 1900/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.12e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:32,151 - INFO - Epoch 21, Step 1950/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.11e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:44,437 - INFO - Epoch 21, Step 2000/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.11e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:20:57,689 - INFO - Epoch 21, Step 2050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.10e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:10,237 - INFO - Epoch 21, Step 2100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.09e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:22,802 - INFO - Epoch 21, Step 2150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.09e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:35,625 - INFO - Epoch 21, Step 2200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.08e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:21:48,306 - INFO - Epoch 21, Step 2250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.07e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:00,688 - INFO - Epoch 21, Step 2300/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.07e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:13,296 - INFO - Epoch 21, Step 2350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.06e-05, LM: 0.0004, Age: 0.41, Sex: 0.001
2025-10-24 09:22:25,872 - INFO - Epoch 21, Step 2400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.05e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:38,603 - INFO - Epoch 21, Step 2450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.05e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:51,248 - INFO - Epoch 21, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 3.04e-05, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:22:51,250 - INFO - Epoch 21 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.41, Sex: 0.001
2025-10-24 09:23:40,972 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:23:40,974 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:23:45,828 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 09:23:45,829 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 09:23:45,830 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:23:55,936 - INFO - Reconstruction Jaccard computed on 132 visits: 0.0000
2025-10-24 09:23:55,936 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 09:23:55,936 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:24:00,238 - INFO - Checkpoint saved: epoch 21
2025-10-24 09:24:12,996 - INFO - Epoch 22, Step 50/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.03e-05, LM: 0.0003, Age: 0.35, Sex: 0.001
2025-10-24 09:24:25,323 - INFO - Epoch 22, Step 100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 3.03e-05, LM: 0.0004, Age: 0.39, Sex: 0.001
2025-10-24 09:24:37,939 - INFO - Epoch 22, Step 150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.02e-05, LM: 0.0002, Age: 0.40, Sex: 0.001
2025-10-24 09:24:50,591 - INFO - Epoch 22, Step 200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.01e-05, LM: 0.0002, Age: 0.40, Sex: 0.001
2025-10-24 09:25:03,417 - INFO - Epoch 22, Step 250/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 3.01e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:25:16,015 - INFO - Epoch 22, Step 300/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 3.00e-05, LM: 0.0006, Age: 0.39, Sex: 0.001
2025-10-24 09:25:28,800 - INFO - Epoch 22, Step 350/2500 - Loss: 0.0009, Perplexity: 1.0010, LR: 2.99e-05, LM: 0.0005, Age: 0.39, Sex: 0.001
2025-10-24 09:25:41,713 - INFO - Epoch 22, Step 400/2500 - Loss: 0.0012, Perplexity: 1.0012, LR: 2.99e-05, LM: 0.0008, Age: 0.39, Sex: 0.001
2025-10-24 09:25:54,280 - INFO - Epoch 22, Step 450/2500 - Loss: 0.0011, Perplexity: 1.0011, LR: 2.98e-05, LM: 0.0007, Age: 0.40, Sex: 0.001
2025-10-24 09:26:07,068 - INFO - Epoch 22, Step 500/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.97e-05, LM: 0.0006, Age: 0.40, Sex: 0.001
2025-10-24 09:26:20,103 - INFO - Epoch 22, Step 550/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.97e-05, LM: 0.0006, Age: 0.41, Sex: 0.001
2025-10-24 09:26:32,902 - INFO - Epoch 22, Step 600/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.96e-05, LM: 0.0006, Age: 0.41, Sex: 0.001
2025-10-24 09:26:45,660 - INFO - Epoch 22, Step 650/2500 - Loss: 0.0010, Perplexity: 1.0010, LR: 2.95e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:26:58,047 - INFO - Epoch 22, Step 700/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.95e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:27:10,712 - INFO - Epoch 22, Step 750/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.94e-05, LM: 0.0005, Age: 0.41, Sex: 0.001
2025-10-24 09:27:23,596 - INFO - Epoch 22, Step 800/2500 - Loss: 0.0009, Perplexity: 1.0009, LR: 2.93e-05, LM: 0.0005, Age: 0.40, Sex: 0.001
2025-10-24 09:27:36,413 - INFO - Epoch 22, Step 850/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.93e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:27:49,010 - INFO - Epoch 22, Step 900/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.92e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:01,355 - INFO - Epoch 22, Step 950/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.91e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:14,182 - INFO - Epoch 22, Step 1000/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.91e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:27,294 - INFO - Epoch 22, Step 1050/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.90e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:40,088 - INFO - Epoch 22, Step 1100/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.89e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:28:52,911 - INFO - Epoch 22, Step 1150/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.89e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:05,104 - INFO - Epoch 22, Step 1200/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.88e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:18,150 - INFO - Epoch 22, Step 1250/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.87e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:30,802 - INFO - Epoch 22, Step 1300/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.86e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:43,837 - INFO - Epoch 22, Step 1350/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.86e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:29:56,442 - INFO - Epoch 22, Step 1400/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.85e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:08,830 - INFO - Epoch 22, Step 1450/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.84e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:21,653 - INFO - Epoch 22, Step 1500/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.84e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:34,620 - INFO - Epoch 22, Step 1550/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.83e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:30:47,678 - INFO - Epoch 22, Step 1600/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.82e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:00,441 - INFO - Epoch 22, Step 1650/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.82e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:13,090 - INFO - Epoch 22, Step 1700/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.81e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:25,623 - INFO - Epoch 22, Step 1750/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.80e-05, LM: 0.0004, Age: 0.40, Sex: 0.001
2025-10-24 09:31:38,167 - INFO - Epoch 22, Step 1800/2500 - Loss: 0.0007, Perplexity: 1.0008, LR: 2.80e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:31:50,788 - INFO - Epoch 22, Step 1850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.79e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:03,307 - INFO - Epoch 22, Step 1900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.78e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:16,294 - INFO - Epoch 22, Step 1950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.78e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:28,979 - INFO - Epoch 22, Step 2000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.77e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:41,493 - INFO - Epoch 22, Step 2050/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.76e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:32:54,045 - INFO - Epoch 22, Step 2100/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.76e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:06,550 - INFO - Epoch 22, Step 2150/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.75e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:19,290 - INFO - Epoch 22, Step 2200/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.74e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:31,910 - INFO - Epoch 22, Step 2250/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.74e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:44,619 - INFO - Epoch 22, Step 2300/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.73e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:33:57,174 - INFO - Epoch 22, Step 2350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.72e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:09,712 - INFO - Epoch 22, Step 2400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.72e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:22,769 - INFO - Epoch 22, Step 2450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.71e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:35,465 - INFO - Epoch 22, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.70e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:34:35,467 - INFO - Epoch 22 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:35:24,959 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:35:24,961 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:35:29,780 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 09:35:29,780 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 09:35:29,781 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:35:40,036 - INFO - Reconstruction Jaccard computed on 129 visits: 0.0012
2025-10-24 09:35:40,036 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 09:35:52,453 - INFO - Epoch 23, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.70e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:05,459 - INFO - Epoch 23, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.69e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:18,155 - INFO - Epoch 23, Step 150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.68e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:36:30,677 - INFO - Epoch 23, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.68e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:36:43,573 - INFO - Epoch 23, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.67e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:36:56,430 - INFO - Epoch 23, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.66e-05, LM: 0.0000, Age: 0.39, Sex: 0.000
2025-10-24 09:37:09,470 - INFO - Epoch 23, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.66e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:22,020 - INFO - Epoch 23, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.65e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:34,751 - INFO - Epoch 23, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.64e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:37:47,715 - INFO - Epoch 23, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.64e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:38:00,198 - INFO - Epoch 23, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.63e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:38:12,771 - INFO - Epoch 23, Step 600/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.62e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:38:25,630 - INFO - Epoch 23, Step 650/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.61e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:38:38,082 - INFO - Epoch 23, Step 700/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.61e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:38:50,498 - INFO - Epoch 23, Step 750/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.60e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:03,040 - INFO - Epoch 23, Step 800/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.59e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:15,650 - INFO - Epoch 23, Step 850/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.59e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:39:28,507 - INFO - Epoch 23, Step 900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.58e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:39:41,451 - INFO - Epoch 23, Step 950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.57e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:39:54,093 - INFO - Epoch 23, Step 1000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.57e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:06,830 - INFO - Epoch 23, Step 1050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.56e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:19,631 - INFO - Epoch 23, Step 1100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.55e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:32,075 - INFO - Epoch 23, Step 1150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.55e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:40:44,454 - INFO - Epoch 23, Step 1200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.54e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:40:57,321 - INFO - Epoch 23, Step 1250/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.53e-05, LM: 0.0002, Age: 0.39, Sex: 0.001
2025-10-24 09:41:10,364 - INFO - Epoch 23, Step 1300/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.53e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:41:23,102 - INFO - Epoch 23, Step 1350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.52e-05, LM: 0.0003, Age: 0.38, Sex: 0.001
2025-10-24 09:41:35,880 - INFO - Epoch 23, Step 1400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.51e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:41:48,385 - INFO - Epoch 23, Step 1450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.51e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:42:00,972 - INFO - Epoch 23, Step 1500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.50e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:13,640 - INFO - Epoch 23, Step 1550/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.49e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:26,625 - INFO - Epoch 23, Step 1600/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.49e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:42:39,242 - INFO - Epoch 23, Step 1650/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.48e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:42:51,988 - INFO - Epoch 23, Step 1700/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.47e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:43:04,613 - INFO - Epoch 23, Step 1750/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.47e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:43:17,325 - INFO - Epoch 23, Step 1800/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.46e-05, LM: 0.0003, Age: 0.39, Sex: 0.002
2025-10-24 09:43:30,056 - INFO - Epoch 23, Step 1850/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.45e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:43:42,478 - INFO - Epoch 23, Step 1900/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.45e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:43:54,746 - INFO - Epoch 23, Step 1950/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.44e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:07,495 - INFO - Epoch 23, Step 2000/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.43e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:20,289 - INFO - Epoch 23, Step 2050/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.43e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:44:32,806 - INFO - Epoch 23, Step 2100/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.42e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:44:45,435 - INFO - Epoch 23, Step 2150/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.41e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:44:57,997 - INFO - Epoch 23, Step 2200/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.41e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:10,558 - INFO - Epoch 23, Step 2250/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.40e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:23,071 - INFO - Epoch 23, Step 2300/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.39e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:36,305 - INFO - Epoch 23, Step 2350/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.39e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:45:49,001 - INFO - Epoch 23, Step 2400/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.38e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:46:01,731 - INFO - Epoch 23, Step 2450/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.37e-05, LM: 0.0003, Age: 0.40, Sex: 0.001
2025-10-24 09:46:14,450 - INFO - Epoch 23, Step 2500/2500 - Loss: 0.0007, Perplexity: 1.0007, LR: 2.36e-05, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:46:14,452 - INFO - Epoch 23 Complete - Avg Loss: 0.0007, Avg Perplexity: 1.0007, LM: 0.0003, Age: 0.39, Sex: 0.001
2025-10-24 09:47:04,266 - INFO - Validation - Loss: 0.0004, Perplexity: 1.0004, Token Accuracy: 1.0000, Code Accuracy: 0.9999
2025-10-24 09:47:04,268 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:47:09,086 - INFO - TPL computed on 500 samples: 1.0011
2025-10-24 09:47:09,086 - INFO - Temporal Perplexity (TPL): 1.0011
2025-10-24 09:47:09,087 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:47:18,915 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0033
2025-10-24 09:47:18,915 - INFO - Reconstruction Jaccard: 0.0033
2025-10-24 09:47:31,481 - INFO - Epoch 24, Step 50/2500 - Loss: 0.0008, Perplexity: 1.0008, LR: 2.36e-05, LM: 0.0004, Age: 0.38, Sex: 0.000
2025-10-24 09:47:44,180 - INFO - Epoch 24, Step 100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.35e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:47:57,129 - INFO - Epoch 24, Step 150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.34e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:48:10,093 - INFO - Epoch 24, Step 200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.34e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:48:22,712 - INFO - Epoch 24, Step 250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.33e-05, LM: 0.0001, Age: 0.39, Sex: 0.000
2025-10-24 09:48:35,575 - INFO - Epoch 24, Step 300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.32e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:48:48,139 - INFO - Epoch 24, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.32e-05, LM: 0.0001, Age: 0.39, Sex: 0.000
2025-10-24 09:49:00,715 - INFO - Epoch 24, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.31e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:13,616 - INFO - Epoch 24, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.30e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:26,244 - INFO - Epoch 24, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.30e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 09:49:38,920 - INFO - Epoch 24, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.29e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:49:51,674 - INFO - Epoch 24, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.28e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:50:04,280 - INFO - Epoch 24, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.28e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:50:17,144 - INFO - Epoch 24, Step 700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.27e-05, LM: 0.0001, Age: 0.37, Sex: 0.000
2025-10-24 09:50:30,004 - INFO - Epoch 24, Step 750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.26e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:50:42,226 - INFO - Epoch 24, Step 800/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.26e-05, LM: 0.0001, Age: 0.38, Sex: 0.000
2025-10-24 09:50:55,119 - INFO - Epoch 24, Step 850/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.25e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:07,867 - INFO - Epoch 24, Step 900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.24e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:20,340 - INFO - Epoch 24, Step 950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.24e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:33,144 - INFO - Epoch 24, Step 1000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.23e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:51:45,227 - INFO - Epoch 24, Step 1050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.22e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:51:57,620 - INFO - Epoch 24, Step 1100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.22e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:10,123 - INFO - Epoch 24, Step 1150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.21e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:22,751 - INFO - Epoch 24, Step 1200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.20e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:52:35,595 - INFO - Epoch 24, Step 1250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.20e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:52:48,130 - INFO - Epoch 24, Step 1300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.19e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:01,088 - INFO - Epoch 24, Step 1350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.18e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:13,432 - INFO - Epoch 24, Step 1400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.18e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:53:25,980 - INFO - Epoch 24, Step 1450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.17e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:53:39,022 - INFO - Epoch 24, Step 1500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.16e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:53:51,481 - INFO - Epoch 24, Step 1550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.16e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:04,169 - INFO - Epoch 24, Step 1600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.15e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:17,055 - INFO - Epoch 24, Step 1650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.14e-05, LM: 0.0002, Age: 0.37, Sex: 0.000
2025-10-24 09:54:29,810 - INFO - Epoch 24, Step 1700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.14e-05, LM: 0.0002, Age: 0.37, Sex: 0.001
2025-10-24 09:54:42,813 - INFO - Epoch 24, Step 1750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.13e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:54:55,883 - INFO - Epoch 24, Step 1800/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.12e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:08,292 - INFO - Epoch 24, Step 1850/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.11e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:21,092 - INFO - Epoch 24, Step 1900/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.11e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:33,931 - INFO - Epoch 24, Step 1950/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.10e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:46,427 - INFO - Epoch 24, Step 2000/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.09e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:55:58,804 - INFO - Epoch 24, Step 2050/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.09e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:11,491 - INFO - Epoch 24, Step 2100/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.08e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:24,195 - INFO - Epoch 24, Step 2150/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.07e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:56:36,667 - INFO - Epoch 24, Step 2200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 2.07e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:56:49,032 - INFO - Epoch 24, Step 2250/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.06e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:01,520 - INFO - Epoch 24, Step 2300/2500 - Loss: 0.0005, Perplexity: 1.0006, LR: 2.05e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:13,912 - INFO - Epoch 24, Step 2350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.05e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:26,258 - INFO - Epoch 24, Step 2400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.04e-05, LM: 0.0002, Age: 0.38, Sex: 0.001
2025-10-24 09:57:38,693 - INFO - Epoch 24, Step 2450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.03e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:51,350 - INFO - Epoch 24, Step 2500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 2.03e-05, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:57:51,352 - INFO - Epoch 24 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0005, LM: 0.0002, Age: 0.38, Sex: 0.000
2025-10-24 09:58:41,328 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 09:58:41,330 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 09:58:46,260 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 09:58:46,260 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 09:58:46,261 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 09:58:56,800 - INFO - Reconstruction Jaccard computed on 133 visits: 0.0000
2025-10-24 09:58:56,801 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 09:58:56,801 - INFO - New best model! Validation loss: 0.0000
2025-10-24 09:59:01,098 - INFO - Checkpoint saved: epoch 24
2025-10-24 09:59:13,777 - INFO - Epoch 25, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.02e-05, LM: 0.0000, Age: 0.42, Sex: 0.000
2025-10-24 09:59:26,787 - INFO - Epoch 25, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.01e-05, LM: 0.0000, Age: 0.40, Sex: 0.000
2025-10-24 09:59:39,683 - INFO - Epoch 25, Step 150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.01e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 09:59:52,583 - INFO - Epoch 25, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 2.00e-05, LM: 0.0000, Age: 0.38, Sex: 0.001
2025-10-24 10:00:05,082 - INFO - Epoch 25, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.99e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 10:00:17,978 - INFO - Epoch 25, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.99e-05, LM: 0.0000, Age: 0.38, Sex: 0.002
2025-10-24 10:00:31,385 - INFO - Epoch 25, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.98e-05, LM: 0.0000, Age: 0.38, Sex: 0.002
2025-10-24 10:00:44,431 - INFO - Epoch 25, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.97e-05, LM: 0.0001, Age: 0.38, Sex: 0.002
2025-10-24 10:00:56,947 - INFO - Epoch 25, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.97e-05, LM: 0.0001, Age: 0.37, Sex: 0.003
2025-10-24 10:01:09,604 - INFO - Epoch 25, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.96e-05, LM: 0.0001, Age: 0.37, Sex: 0.003
2025-10-24 10:01:22,521 - INFO - Epoch 25, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.95e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:01:35,349 - INFO - Epoch 25, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.95e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:01:48,076 - INFO - Epoch 25, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.94e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:02:00,520 - INFO - Epoch 25, Step 700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.93e-05, LM: 0.0001, Age: 0.37, Sex: 0.002
2025-10-24 10:02:12,878 - INFO - Epoch 25, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.93e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:25,507 - INFO - Epoch 25, Step 800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.92e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:37,775 - INFO - Epoch 25, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.91e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:02:50,214 - INFO - Epoch 25, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.91e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:02,839 - INFO - Epoch 25, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.90e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:15,538 - INFO - Epoch 25, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.89e-05, LM: 0.0001, Age: 0.36, Sex: 0.002
2025-10-24 10:03:28,015 - INFO - Epoch 25, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.89e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:03:40,438 - INFO - Epoch 25, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.88e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:03:52,879 - INFO - Epoch 25, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.87e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:04:05,490 - INFO - Epoch 25, Step 1200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.86e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:18,108 - INFO - Epoch 25, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.86e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:30,905 - INFO - Epoch 25, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.85e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:43,979 - INFO - Epoch 25, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.84e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:04:56,914 - INFO - Epoch 25, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.84e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:05:09,781 - INFO - Epoch 25, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.83e-05, LM: 0.0000, Age: 0.37, Sex: 0.001
2025-10-24 10:05:22,361 - INFO - Epoch 25, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.82e-05, LM: 0.0000, Age: 0.36, Sex: 0.001
2025-10-24 10:05:35,379 - INFO - Epoch 25, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.82e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:05:47,825 - INFO - Epoch 25, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.81e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:00,604 - INFO - Epoch 25, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.80e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:13,193 - INFO - Epoch 25, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.80e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:25,981 - INFO - Epoch 25, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.79e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:38,762 - INFO - Epoch 25, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.78e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:06:51,478 - INFO - Epoch 25, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.78e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:04,130 - INFO - Epoch 25, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.77e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:16,688 - INFO - Epoch 25, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.76e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:29,568 - INFO - Epoch 25, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.76e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:07:42,381 - INFO - Epoch 25, Step 2050/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.75e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:07:55,543 - INFO - Epoch 25, Step 2100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.74e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:08,415 - INFO - Epoch 25, Step 2150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.74e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:21,104 - INFO - Epoch 25, Step 2200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.73e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:33,982 - INFO - Epoch 25, Step 2250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.72e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:46,606 - INFO - Epoch 25, Step 2300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.72e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:08:59,155 - INFO - Epoch 25, Step 2350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.71e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:09:11,806 - INFO - Epoch 25, Step 2400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.70e-05, LM: 0.0001, Age: 0.37, Sex: 0.001
2025-10-24 10:09:24,475 - INFO - Epoch 25, Step 2450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.70e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:09:37,290 - INFO - Epoch 25, Step 2500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.69e-05, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:09:37,291 - INFO - Epoch 25 Complete - Avg Loss: 0.0005, Avg Perplexity: 1.0005, LM: 0.0001, Age: 0.36, Sex: 0.001
2025-10-24 10:10:27,334 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:10:27,336 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:10:32,167 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 10:10:32,168 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 10:10:32,169 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:10:42,076 - INFO - Reconstruction Jaccard computed on 124 visits: 0.0012
2025-10-24 10:10:42,076 - INFO - Reconstruction Jaccard: 0.0012
2025-10-24 10:10:44,483 - INFO - Checkpoint saved: epoch 25
2025-10-24 10:10:57,100 - INFO - Epoch 26, Step 50/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.68e-05, LM: 0.0000, Age: 0.38, Sex: 0.000
2025-10-24 10:11:09,644 - INFO - Epoch 26, Step 100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.68e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:11:22,625 - INFO - Epoch 26, Step 150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.67e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:11:34,812 - INFO - Epoch 26, Step 200/2500 - Loss: 0.0006, Perplexity: 1.0006, LR: 1.66e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:11:47,392 - INFO - Epoch 26, Step 250/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.66e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:11:59,916 - INFO - Epoch 26, Step 300/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.65e-05, LM: 0.0001, Age: 0.36, Sex: 0.000
2025-10-24 10:12:12,409 - INFO - Epoch 26, Step 350/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.64e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:12:24,901 - INFO - Epoch 26, Step 400/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.64e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:12:37,852 - INFO - Epoch 26, Step 450/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.63e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:12:50,407 - INFO - Epoch 26, Step 500/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.62e-05, LM: 0.0002, Age: 0.35, Sex: 0.000
2025-10-24 10:13:02,984 - INFO - Epoch 26, Step 550/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.61e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:15,389 - INFO - Epoch 26, Step 600/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.61e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:28,079 - INFO - Epoch 26, Step 650/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.60e-05, LM: 0.0002, Age: 0.34, Sex: 0.000
2025-10-24 10:13:40,883 - INFO - Epoch 26, Step 700/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.59e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:13:53,313 - INFO - Epoch 26, Step 750/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.59e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:14:05,953 - INFO - Epoch 26, Step 800/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.58e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:14:18,940 - INFO - Epoch 26, Step 850/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.57e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:31,768 - INFO - Epoch 26, Step 900/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.57e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:44,460 - INFO - Epoch 26, Step 950/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.56e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:14:57,008 - INFO - Epoch 26, Step 1000/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.55e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:10,159 - INFO - Epoch 26, Step 1050/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.55e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:22,953 - INFO - Epoch 26, Step 1100/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.54e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:35,437 - INFO - Epoch 26, Step 1150/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.53e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:15:47,738 - INFO - Epoch 26, Step 1200/2500 - Loss: 0.0005, Perplexity: 1.0005, LR: 1.53e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:00,357 - INFO - Epoch 26, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.52e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:13,265 - INFO - Epoch 26, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.51e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:25,759 - INFO - Epoch 26, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.51e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:38,287 - INFO - Epoch 26, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.50e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:16:50,914 - INFO - Epoch 26, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.49e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:03,849 - INFO - Epoch 26, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.49e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:16,540 - INFO - Epoch 26, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.48e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:29,301 - INFO - Epoch 26, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.47e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:41,768 - INFO - Epoch 26, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.47e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:17:54,857 - INFO - Epoch 26, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.46e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:07,645 - INFO - Epoch 26, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.45e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:20,390 - INFO - Epoch 26, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.45e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:18:33,033 - INFO - Epoch 26, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.44e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:18:45,875 - INFO - Epoch 26, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.43e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:18:58,498 - INFO - Epoch 26, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.43e-05, LM: 0.0001, Age: 0.35, Sex: 0.001
2025-10-24 10:19:11,397 - INFO - Epoch 26, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.42e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:23,994 - INFO - Epoch 26, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.41e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:36,585 - INFO - Epoch 26, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.41e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:19:49,048 - INFO - Epoch 26, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.40e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:01,569 - INFO - Epoch 26, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.39e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:14,463 - INFO - Epoch 26, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.39e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:26,876 - INFO - Epoch 26, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.38e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:39,430 - INFO - Epoch 26, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.37e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:20:52,026 - INFO - Epoch 26, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.36e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:04,615 - INFO - Epoch 26, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.36e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:17,046 - INFO - Epoch 26, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.35e-05, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:21:17,048 - INFO - Epoch 26 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0001, Age: 0.35, Sex: 0.000
2025-10-24 10:22:06,593 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:22:06,595 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:22:11,418 - INFO - TPL computed on 500 samples: 1.0012
2025-10-24 10:22:11,418 - INFO - Temporal Perplexity (TPL): 1.0012
2025-10-24 10:22:11,419 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:22:20,869 - INFO - Reconstruction Jaccard computed on 120 visits: 0.0006
2025-10-24 10:22:20,870 - INFO - Reconstruction Jaccard: 0.0006
2025-10-24 10:22:20,870 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:22:25,426 - INFO - Checkpoint saved: epoch 26
2025-10-24 10:22:38,376 - INFO - Epoch 27, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.34e-05, LM: 0.0000, Age: 0.29, Sex: 0.000
2025-10-24 10:22:50,869 - INFO - Epoch 27, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.34e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:03,819 - INFO - Epoch 27, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.33e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:16,795 - INFO - Epoch 27, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.32e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:29,663 - INFO - Epoch 27, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.32e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:23:42,250 - INFO - Epoch 27, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.31e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:23:55,293 - INFO - Epoch 27, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.30e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:07,642 - INFO - Epoch 27, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.30e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:20,229 - INFO - Epoch 27, Step 450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.29e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:32,675 - INFO - Epoch 27, Step 500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.28e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:45,435 - INFO - Epoch 27, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.28e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:24:57,859 - INFO - Epoch 27, Step 600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.27e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:25:10,350 - INFO - Epoch 27, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.26e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:25:23,166 - INFO - Epoch 27, Step 700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.26e-05, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:25:36,288 - INFO - Epoch 27, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.25e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:25:48,907 - INFO - Epoch 27, Step 800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.24e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:01,513 - INFO - Epoch 27, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.24e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:14,215 - INFO - Epoch 27, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.23e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:26,947 - INFO - Epoch 27, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.22e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:26:39,657 - INFO - Epoch 27, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.22e-05, LM: 0.0001, Age: 0.33, Sex: 0.000
2025-10-24 10:26:52,027 - INFO - Epoch 27, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.21e-05, LM: 0.0001, Age: 0.33, Sex: 0.000
2025-10-24 10:27:04,816 - INFO - Epoch 27, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.20e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:17,517 - INFO - Epoch 27, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.20e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:30,078 - INFO - Epoch 27, Step 1200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.19e-05, LM: 0.0001, Age: 0.34, Sex: 0.000
2025-10-24 10:27:42,673 - INFO - Epoch 27, Step 1250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.18e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:27:55,229 - INFO - Epoch 27, Step 1300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.18e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:07,957 - INFO - Epoch 27, Step 1350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.17e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:20,643 - INFO - Epoch 27, Step 1400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.16e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:33,620 - INFO - Epoch 27, Step 1450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.16e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:46,125 - INFO - Epoch 27, Step 1500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.15e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:28:58,544 - INFO - Epoch 27, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.14e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:11,087 - INFO - Epoch 27, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.14e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:23,893 - INFO - Epoch 27, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.13e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:36,422 - INFO - Epoch 27, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.12e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:29:48,565 - INFO - Epoch 27, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.11e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:01,254 - INFO - Epoch 27, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.11e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:14,230 - INFO - Epoch 27, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.10e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:26,919 - INFO - Epoch 27, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.09e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:39,313 - INFO - Epoch 27, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.09e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:30:52,162 - INFO - Epoch 27, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.08e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:04,880 - INFO - Epoch 27, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.07e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:17,398 - INFO - Epoch 27, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.07e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:30,299 - INFO - Epoch 27, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.06e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:43,142 - INFO - Epoch 27, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.05e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:31:55,838 - INFO - Epoch 27, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.05e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:08,596 - INFO - Epoch 27, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.04e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:21,369 - INFO - Epoch 27, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.03e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:33,886 - INFO - Epoch 27, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.03e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:46,298 - INFO - Epoch 27, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.02e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:58,816 - INFO - Epoch 27, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 1.01e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:32:58,818 - INFO - Epoch 27 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:33:48,162 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:33:48,165 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:33:53,069 - INFO - TPL computed on 500 samples: 1.0009
2025-10-24 10:33:53,069 - INFO - Temporal Perplexity (TPL): 1.0009
2025-10-24 10:33:53,070 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:34:02,951 - INFO - Reconstruction Jaccard computed on 128 visits: 0.0000
2025-10-24 10:34:02,951 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 10:34:15,536 - INFO - Epoch 28, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.01e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:34:28,182 - INFO - Epoch 28, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.00e-05, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:34:41,075 - INFO - Epoch 28, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.93e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:34:53,711 - INFO - Epoch 28, Step 200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.86e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:06,138 - INFO - Epoch 28, Step 250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.80e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:18,919 - INFO - Epoch 28, Step 300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.73e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:35:31,944 - INFO - Epoch 28, Step 350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.66e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:35:44,560 - INFO - Epoch 28, Step 400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.59e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:35:57,042 - INFO - Epoch 28, Step 450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.53e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:09,952 - INFO - Epoch 28, Step 500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.46e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:36:22,545 - INFO - Epoch 28, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.39e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:35,533 - INFO - Epoch 28, Step 600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.32e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:36:47,982 - INFO - Epoch 28, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.26e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:37:00,705 - INFO - Epoch 28, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.19e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:13,271 - INFO - Epoch 28, Step 750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 9.12e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:37:25,828 - INFO - Epoch 28, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.05e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:38,411 - INFO - Epoch 28, Step 850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.99e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:37:51,270 - INFO - Epoch 28, Step 900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.92e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:04,206 - INFO - Epoch 28, Step 950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.85e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:16,848 - INFO - Epoch 28, Step 1000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.78e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:29,475 - INFO - Epoch 28, Step 1050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.72e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:42,400 - INFO - Epoch 28, Step 1100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.65e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:38:54,697 - INFO - Epoch 28, Step 1150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.58e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:07,502 - INFO - Epoch 28, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.51e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:20,311 - INFO - Epoch 28, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.45e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:33,300 - INFO - Epoch 28, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.38e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:45,937 - INFO - Epoch 28, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.31e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:39:58,629 - INFO - Epoch 28, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.24e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:11,634 - INFO - Epoch 28, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.18e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:23,938 - INFO - Epoch 28, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.11e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:36,894 - INFO - Epoch 28, Step 1550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 8.04e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:40:49,785 - INFO - Epoch 28, Step 1600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.97e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:02,205 - INFO - Epoch 28, Step 1650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.91e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:14,602 - INFO - Epoch 28, Step 1700/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.84e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:27,421 - INFO - Epoch 28, Step 1750/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.77e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:41:39,894 - INFO - Epoch 28, Step 1800/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.70e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:41:53,029 - INFO - Epoch 28, Step 1850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.64e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:05,496 - INFO - Epoch 28, Step 1900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.57e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:17,854 - INFO - Epoch 28, Step 1950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.50e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:42:30,420 - INFO - Epoch 28, Step 2000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.43e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:43,132 - INFO - Epoch 28, Step 2050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.36e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:42:55,699 - INFO - Epoch 28, Step 2100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.30e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:08,200 - INFO - Epoch 28, Step 2150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.23e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:43:20,869 - INFO - Epoch 28, Step 2200/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.16e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:33,600 - INFO - Epoch 28, Step 2250/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.09e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:43:45,869 - INFO - Epoch 28, Step 2300/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 7.03e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:43:58,372 - INFO - Epoch 28, Step 2350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.96e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:44:10,805 - INFO - Epoch 28, Step 2400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.89e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:23,583 - INFO - Epoch 28, Step 2450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.82e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:36,242 - INFO - Epoch 28, Step 2500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.76e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:44:36,244 - INFO - Epoch 28 Complete - Avg Loss: 0.0004, Avg Perplexity: 1.0004, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:45:26,233 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:45:26,235 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:45:31,143 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 10:45:31,143 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 10:45:31,144 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:45:40,949 - INFO - Reconstruction Jaccard computed on 122 visits: 0.0000
2025-10-24 10:45:40,949 - INFO - Reconstruction Jaccard: 0.0000
2025-10-24 10:45:40,950 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:45:45,629 - INFO - Checkpoint saved: epoch 28
2025-10-24 10:45:58,076 - INFO - Epoch 29, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.69e-06, LM: 0.0000, Age: 0.29, Sex: 0.000
2025-10-24 10:46:10,562 - INFO - Epoch 29, Step 100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.62e-06, LM: 0.0000, Age: 0.32, Sex: 0.001
2025-10-24 10:46:23,255 - INFO - Epoch 29, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.55e-06, LM: 0.0000, Age: 0.33, Sex: 0.001
2025-10-24 10:46:36,057 - INFO - Epoch 29, Step 200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.49e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:46:48,772 - INFO - Epoch 29, Step 250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.42e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:47:01,406 - INFO - Epoch 29, Step 300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.35e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:47:13,917 - INFO - Epoch 29, Step 350/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.28e-06, LM: 0.0001, Age: 0.31, Sex: 0.000
2025-10-24 10:47:26,147 - INFO - Epoch 29, Step 400/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.22e-06, LM: 0.0001, Age: 0.31, Sex: 0.000
2025-10-24 10:47:39,471 - INFO - Epoch 29, Step 450/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.15e-06, LM: 0.0001, Age: 0.32, Sex: 0.000
2025-10-24 10:47:52,182 - INFO - Epoch 29, Step 500/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.08e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:04,845 - INFO - Epoch 29, Step 550/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 6.01e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:17,688 - INFO - Epoch 29, Step 600/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.95e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:48:29,959 - INFO - Epoch 29, Step 650/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.88e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:48:42,344 - INFO - Epoch 29, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.81e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:48:54,955 - INFO - Epoch 29, Step 750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.74e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:49:08,073 - INFO - Epoch 29, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.68e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:20,379 - INFO - Epoch 29, Step 850/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.61e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:33,565 - INFO - Epoch 29, Step 900/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.54e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:46,114 - INFO - Epoch 29, Step 950/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.47e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:49:58,780 - INFO - Epoch 29, Step 1000/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.41e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:11,159 - INFO - Epoch 29, Step 1050/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.34e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:23,768 - INFO - Epoch 29, Step 1100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.27e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:36,618 - INFO - Epoch 29, Step 1150/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 5.20e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:50:49,435 - INFO - Epoch 29, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.14e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:02,514 - INFO - Epoch 29, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.07e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:15,158 - INFO - Epoch 29, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.00e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:51:28,137 - INFO - Epoch 29, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.93e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:51:40,565 - INFO - Epoch 29, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.86e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:51:53,689 - INFO - Epoch 29, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.80e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:06,479 - INFO - Epoch 29, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.73e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:19,293 - INFO - Epoch 29, Step 1550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.66e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:31,459 - INFO - Epoch 29, Step 1600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.59e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:44,293 - INFO - Epoch 29, Step 1650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.53e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:52:57,020 - INFO - Epoch 29, Step 1700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.46e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:09,962 - INFO - Epoch 29, Step 1750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.39e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:22,805 - INFO - Epoch 29, Step 1800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.32e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:35,362 - INFO - Epoch 29, Step 1850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.26e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:53:47,859 - INFO - Epoch 29, Step 1900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.19e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:00,481 - INFO - Epoch 29, Step 1950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.12e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:13,095 - INFO - Epoch 29, Step 2000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.05e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:25,867 - INFO - Epoch 29, Step 2050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.99e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:38,346 - INFO - Epoch 29, Step 2100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.92e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:54:50,940 - INFO - Epoch 29, Step 2150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.85e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:03,699 - INFO - Epoch 29, Step 2200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.78e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:16,606 - INFO - Epoch 29, Step 2250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.72e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:29,245 - INFO - Epoch 29, Step 2300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.65e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:42,046 - INFO - Epoch 29, Step 2350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.58e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:55:54,932 - INFO - Epoch 29, Step 2400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.51e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:07,499 - INFO - Epoch 29, Step 2450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.45e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:20,420 - INFO - Epoch 29, Step 2500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.38e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:56:20,422 - INFO - Epoch 29 Complete - Avg Loss: 0.0003, Avg Perplexity: 1.0003, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 10:57:10,218 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 10:57:10,220 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 10:57:15,098 - INFO - TPL computed on 500 samples: 1.0010
2025-10-24 10:57:15,098 - INFO - Temporal Perplexity (TPL): 1.0010
2025-10-24 10:57:15,099 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 10:57:26,218 - INFO - Reconstruction Jaccard computed on 134 visits: 0.0008
2025-10-24 10:57:26,218 - INFO - Reconstruction Jaccard: 0.0008
2025-10-24 10:57:26,218 - INFO - New best model! Validation loss: 0.0000
2025-10-24 10:57:30,658 - INFO - Checkpoint saved: epoch 29
2025-10-24 10:57:43,369 - INFO - Epoch 30, Step 50/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.31e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:57:56,051 - INFO - Epoch 30, Step 100/2500 - Loss: 0.0004, Perplexity: 1.0004, LR: 3.24e-06, LM: 0.0000, Age: 0.35, Sex: 0.000
2025-10-24 10:58:08,729 - INFO - Epoch 30, Step 150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.18e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:58:21,321 - INFO - Epoch 30, Step 200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.11e-06, LM: 0.0000, Age: 0.34, Sex: 0.000
2025-10-24 10:58:33,859 - INFO - Epoch 30, Step 250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.04e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:58:46,611 - INFO - Epoch 30, Step 300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.97e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:58:59,294 - INFO - Epoch 30, Step 350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.91e-06, LM: 0.0000, Age: 0.33, Sex: 0.000
2025-10-24 10:59:12,009 - INFO - Epoch 30, Step 400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.84e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:24,848 - INFO - Epoch 30, Step 450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.77e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:37,789 - INFO - Epoch 30, Step 500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.70e-06, LM: 0.0000, Age: 0.32, Sex: 0.000
2025-10-24 10:59:50,197 - INFO - Epoch 30, Step 550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.64e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:02,643 - INFO - Epoch 30, Step 600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.57e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:15,615 - INFO - Epoch 30, Step 650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.50e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:00:28,278 - INFO - Epoch 30, Step 700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.43e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:00:40,849 - INFO - Epoch 30, Step 750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.36e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:00:53,431 - INFO - Epoch 30, Step 800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.30e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:01:05,933 - INFO - Epoch 30, Step 850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.23e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:01:18,370 - INFO - Epoch 30, Step 900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.16e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:31,119 - INFO - Epoch 30, Step 950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.09e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:43,827 - INFO - Epoch 30, Step 1000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.03e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:01:56,732 - INFO - Epoch 30, Step 1050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.96e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:09,437 - INFO - Epoch 30, Step 1100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.89e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:02:22,030 - INFO - Epoch 30, Step 1150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.82e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:34,946 - INFO - Epoch 30, Step 1200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.76e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:02:47,321 - INFO - Epoch 30, Step 1250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.69e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:00,249 - INFO - Epoch 30, Step 1300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.62e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:12,786 - INFO - Epoch 30, Step 1350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.55e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:25,296 - INFO - Epoch 30, Step 1400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.49e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:38,175 - INFO - Epoch 30, Step 1450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.42e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:03:50,923 - INFO - Epoch 30, Step 1500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.35e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:04:03,471 - INFO - Epoch 30, Step 1550/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.28e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:16,618 - INFO - Epoch 30, Step 1600/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.22e-06, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:04:29,284 - INFO - Epoch 30, Step 1650/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.15e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:41,785 - INFO - Epoch 30, Step 1700/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.08e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:04:54,604 - INFO - Epoch 30, Step 1750/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.01e-06, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:07,138 - INFO - Epoch 30, Step 1800/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 9.46e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:20,238 - INFO - Epoch 30, Step 1850/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.78e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:33,268 - INFO - Epoch 30, Step 1900/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 8.11e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:45,879 - INFO - Epoch 30, Step 1950/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 7.43e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:05:58,552 - INFO - Epoch 30, Step 2000/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.76e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:11,223 - INFO - Epoch 30, Step 2050/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.08e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:23,831 - INFO - Epoch 30, Step 2100/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 5.41e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:36,516 - INFO - Epoch 30, Step 2150/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.73e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:06:49,508 - INFO - Epoch 30, Step 2200/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 4.05e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:02,161 - INFO - Epoch 30, Step 2250/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 3.38e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:14,663 - INFO - Epoch 30, Step 2300/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.70e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:27,440 - INFO - Epoch 30, Step 2350/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 2.03e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:39,864 - INFO - Epoch 30, Step 2400/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 1.35e-07, LM: 0.0000, Age: 0.31, Sex: 0.000
2025-10-24 11:07:52,481 - INFO - Epoch 30, Step 2450/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 6.76e-08, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:05,051 - INFO - Epoch 30, Step 2500/2500 - Loss: 0.0003, Perplexity: 1.0003, LR: 0.00e+00, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:05,053 - INFO - Epoch 30 Complete - Avg Loss: 0.0003, Avg Perplexity: 1.0003, LM: 0.0000, Age: 0.30, Sex: 0.000
2025-10-24 11:08:54,466 - INFO - Validation - Loss: 0.0000, Perplexity: 1.0000, Token Accuracy: 1.0000, Code Accuracy: 1.0000
2025-10-24 11:08:54,468 - INFO - Computing TPL on 500 patients with 2+ visits
2025-10-24 11:08:59,302 - INFO - TPL computed on 500 samples: 1.0000
2025-10-24 11:08:59,303 - INFO - Temporal Perplexity (TPL): 1.0000
2025-10-24 11:08:59,304 - INFO - Computing reconstruction Jaccard on 100 patients
2025-10-24 11:09:10,016 - INFO - Reconstruction Jaccard computed on 131 visits: 0.0004
2025-10-24 11:09:10,016 - INFO - Reconstruction Jaccard: 0.0004
2025-10-24 11:09:10,016 - INFO - New best model! Validation loss: 0.0000
2025-10-24 11:09:14,534 - INFO - Checkpoint saved: epoch 30
2025-10-24 11:09:14,534 - INFO - 
================================================================================
2025-10-24 11:09:14,534 - INFO - Training Complete!
2025-10-24 11:09:14,534 - INFO - ================================================================================
2025-10-24 11:09:14,534 - INFO - Best validation loss: 0.0000
2025-10-24 11:09:14,534 - INFO - Best validation perplexity: 1.0000
========================================
Training completed
End Time: Fri Oct 24 11:09:15 CDT 2025
Exit Code: 0
========================================
